import{u as V}from"./ebook-Btb4HGlG.js";import{d as T,u as K,o as L,c as i,a as t,b as R,w as j,t as q,e as b,m as h,i as c,h as S,j as G,k as u,_ as H}from"./index-CwM7aKQM.js";const J={class:"settings"},O={class:"header"},Q={class:"main"},W={class:"settings-container"},X={class:"setting-section"},Y={class:"setting-card"},Z={class:"form-group"},ee={class:"radio-group"},te={class:"radio-item"},oe=["model-value"],se={class:"radio-item"},ae=["model-value"],le={class:"form-group"},ne={class:"input-group"},ie=["model-value"],ue={key:0,class:"form-group"},re={class:"baidupan-config"},de={class:"form-group"},pe=["model-value"],ve={class:"form-group"},ce=["model-value"],ge={class:"form-group"},me=["model-value"],fe={class:"form-group"},be={class:"auth-status"},ye={key:0,class:"status success"},_e={key:1,class:"status error"},Ce={class:"auth-buttons"},he=["disabled"],Se={class:"form-group"},we={class:"form-label"},ke=["checked"],ze={key:1,class:"form-group"},Ie=["model-value"],Ue={class:"setting-section"},xe={class:"setting-card"},Me={class:"form-group"},Be={class:"input-group"},Ae=["model-value"],De={class:"form-group"},$e=["model-value"],Fe={class:"form-group"},Pe={class:"radio-group"},Ee={class:"radio-item"},Ne=["model-value"],Ve={class:"radio-item"},Te=["model-value"],Ke={class:"radio-item"},Le=["model-value"],Re={class:"form-group"},je={class:"radio-group"},qe={class:"radio-item"},Ge=["model-value"],He={class:"radio-item"},Je=["model-value"],Oe={class:"form-group"},Qe=["model-value"],We={class:"setting-section"},Xe={class:"setting-card"},Ye={class:"form-group"},Ze={class:"radio-group"},et={class:"radio-item"},tt=["model-value"],ot={class:"radio-item"},st=["model-value"],at={class:"form-group"},lt=["model-value"],nt=T({__name:"index",setup(it){const s=V(),r=K(),v=c(()=>s.isBaidupanTokenValid()),g=S(""),m=S(""),l=c(()=>s.userConfig.storage),a=c(()=>s.userConfig.reader),d=c(()=>s.userConfig.ui),y=async o=>{await s.updateUserConfig({storage:{...l.value,default:o}})},w=async o=>{const e=o.target;await s.updateUserConfig({storage:{...l.value,localPath:e.value}})},k=async o=>{const e=o.target;await s.updateUserConfig({storage:{...l.value,baidupan:{...l.value.baidupan,rootPath:e.value}}})},z=o=>{const e=o.target;g.value=e.value,s.updateBaidupanApiConfig(e.value,m.value)},I=o=>{const e=o.target;m.value=e.value,s.updateBaidupanApiConfig(g.value,e.value)},U=async o=>{const e=o.target;await s.updateUserConfig({storage:{...l.value,autoSync:e.checked}})},x=async o=>{const e=o.target;await s.updateUserConfig({storage:{...l.value,syncInterval:parseInt(e.value)}})},M=async o=>{const e=o.target,p=parseInt(e.value);p>=12&&p<=32&&await s.updateUserConfig({reader:{...a.value,fontSize:p}})},B=async o=>{const e=o.target;await s.updateUserConfig({reader:{...a.value,fontFamily:e.value}})},f=async o=>{await s.updateUserConfig({reader:{...a.value,theme:o}})},_=async o=>{await s.updateUserConfig({reader:{...a.value,pageMode:o}})},A=async o=>{const e=o.target;await s.updateUserConfig({reader:{...a.value,autoSaveInterval:parseInt(e.value)}})},C=async o=>{await s.updateUserConfig({ui:{...d.value,viewMode:o}})},D=async o=>{const e=o.target;await s.updateUserConfig({ui:{...d.value,language:e.value}})},$=async()=>{r.showDialog({title:"确认取消授权",message:"确定要取消百度网盘授权吗？",type:"warning",buttons:[{text:"取消"},{text:"确定",primary:!0,callback:async()=>{await s.updateUserConfig({storage:{...l.value,baidupan:{...l.value.baidupan,accessToken:"",refreshToken:"",expiration:0,userId:""}}}),r.showSuccessDialog("百度网盘授权已取消")}}]})},F=async()=>{try{await s.authorizeBaidupan()?r.showSuccessDialog("百度网盘授权成功"):r.showErrorDialog("百度网盘授权失败，请重试")}catch(o){console.error("百度网盘授权失败:",o),r.showErrorDialog("百度网盘授权失败，请重试",o instanceof Error?o.message:String(o))}},P=async()=>{a.value.fontSize>12&&await s.updateUserConfig({reader:{...a.value,fontSize:a.value.fontSize-1}})},E=async()=>{a.value.fontSize<32&&await s.updateUserConfig({reader:{...a.value,fontSize:a.value.fontSize+1}})},N=async()=>{try{await s.saveUserConfig(),alert("设置已保存")}catch(o){console.error("保存设置失败:",o),alert("保存设置失败，请重试")}};return L(async()=>{await s.initialize()}),(o,e)=>{const p=G("router-link");return u(),i("div",J,[t("header",O,[e[10]||(e[10]=t("h1",{class:"title"},"设置",-1)),R(p,{to:"/",class:"btn btn-secondary"},{default:j(()=>[...e[9]||(e[9]=[h(" ← 返回 ",-1)])]),_:1})]),t("main",Q,[t("div",W,[t("section",X,[e[25]||(e[25]=t("h2",{class:"section-title"},"存储配置",-1)),t("div",Y,[t("div",Z,[e[13]||(e[13]=t("label",{class:"form-label"},"默认存储方式",-1)),t("div",ee,[t("label",te,[t("input",{type:"radio","model-value":l.value.default,onChange:e[0]||(e[0]=n=>y("local")),value:"local",name:"storage"},null,40,oe),e[11]||(e[11]=t("span",null,"本地存储",-1))]),t("label",se,[t("input",{type:"radio","model-value":l.value.default,onChange:e[1]||(e[1]=n=>y("baidupan")),value:"baidupan",name:"storage"},null,40,ae),e[12]||(e[12]=t("span",null,"百度网盘",-1))])])]),t("div",le,[e[15]||(e[15]=t("label",{class:"form-label"},"本地存储路径",-1)),t("div",ne,[t("input",{type:"text",class:"form-control","model-value":l.value.localPath,onInput:w,placeholder:"选择本地存储路径"},null,40,ie),e[14]||(e[14]=t("button",{class:"btn btn-secondary"},"浏览",-1))])]),l.value.default==="baidupan"?(u(),i("div",ue,[e[20]||(e[20]=t("label",{class:"form-label"},"百度网盘配置",-1)),t("div",re,[t("div",de,[e[16]||(e[16]=t("label",{class:"form-label"},"百度网盘根路径",-1)),t("input",{type:"text",class:"form-control","model-value":l.value.baidupan.rootPath,onInput:k,placeholder:"/NeatReader"},null,40,pe)]),t("div",ve,[e[17]||(e[17]=t("label",{class:"form-label"},"App Key",-1)),t("input",{type:"text",class:"form-control","model-value":g.value,onInput:z,placeholder:"请输入百度网盘 App Key"},null,40,ce)]),t("div",ge,[e[18]||(e[18]=t("label",{class:"form-label"},"App Secret",-1)),t("input",{type:"password",class:"form-control","model-value":m.value,onInput:I,placeholder:"请输入百度网盘 App Secret"},null,40,me)]),t("div",fe,[e[19]||(e[19]=t("label",{class:"form-label"},"授权状态",-1)),t("div",be,[v.value?(u(),i("span",ye,"已授权")):(u(),i("span",_e,"未授权")),t("div",Ce,[t("button",{class:"btn btn-primary",onClick:F,disabled:v.value},q(v.value?"已授权":"授权百度网盘"),9,he),v.value?(u(),i("button",{key:0,class:"btn btn-danger",onClick:$}," 取消授权 ")):b("",!0)])])])])])):b("",!0),t("div",Se,[t("label",we,[t("input",{type:"checkbox",checked:l.value.autoSync,onChange:U},null,40,ke),e[21]||(e[21]=h(" 自动同步 ",-1))]),e[22]||(e[22]=t("p",{class:"help-text"},"开启后，阅读进度将自动同步到百度网盘",-1))]),l.value.autoSync?(u(),i("div",ze,[e[24]||(e[24]=t("label",{class:"form-label"},"同步间隔（分钟）",-1)),t("select",{class:"form-control","model-value":l.value.syncInterval,onChange:x},[...e[23]||(e[23]=[t("option",{value:"5"},"5分钟",-1),t("option",{value:"15"},"15分钟",-1),t("option",{value:"30"},"30分钟",-1),t("option",{value:"60"},"1小时",-1)])],40,Ie)])):b("",!0)])]),t("section",Ue,[e[38]||(e[38]=t("h2",{class:"section-title"},"阅读偏好",-1)),t("div",xe,[t("div",Me,[e[26]||(e[26]=t("label",{class:"form-label"},"默认字体大小",-1)),t("div",Be,[t("button",{class:"btn btn-secondary",onClick:P},"-"),t("input",{type:"number",class:"form-control","model-value":a.value.fontSize,onInput:M,min:"12",max:"32"},null,40,Ae),t("button",{class:"btn btn-secondary",onClick:E},"+")])]),t("div",De,[e[28]||(e[28]=t("label",{class:"form-label"},"默认字体",-1)),t("select",{class:"form-control","model-value":a.value.fontFamily,onChange:B},[...e[27]||(e[27]=[t("option",{value:"system"},"系统默认",-1),t("option",{value:"sans-serif"},"Sans Serif",-1),t("option",{value:"serif"},"Serif",-1),t("option",{value:"monospace"},"Monospace",-1)])],40,$e)]),t("div",Fe,[e[32]||(e[32]=t("label",{class:"form-label"},"默认主题",-1)),t("div",Pe,[t("label",Ee,[t("input",{type:"radio","model-value":a.value.theme,onChange:e[2]||(e[2]=n=>f("light")),value:"light",name:"theme"},null,40,Ne),e[29]||(e[29]=t("span",null,"浅色",-1))]),t("label",Ve,[t("input",{type:"radio","model-value":a.value.theme,onChange:e[3]||(e[3]=n=>f("sepia")),value:"sepia",name:"theme"},null,40,Te),e[30]||(e[30]=t("span",null,"护眼",-1))]),t("label",Ke,[t("input",{type:"radio","model-value":a.value.theme,onChange:e[4]||(e[4]=n=>f("dark")),value:"dark",name:"theme"},null,40,Le),e[31]||(e[31]=t("span",null,"深色",-1))])])]),t("div",Re,[e[35]||(e[35]=t("label",{class:"form-label"},"默认翻页模式",-1)),t("div",je,[t("label",qe,[t("input",{type:"radio","model-value":a.value.pageMode,onChange:e[5]||(e[5]=n=>_("page")),value:"page",name:"pageMode"},null,40,Ge),e[33]||(e[33]=t("span",null,"单页",-1))]),t("label",He,[t("input",{type:"radio","model-value":a.value.pageMode,onChange:e[6]||(e[6]=n=>_("scroll")),value:"scroll",name:"pageMode"},null,40,Je),e[34]||(e[34]=t("span",null,"滚动",-1))])])]),t("div",Oe,[e[37]||(e[37]=t("label",{class:"form-label"},"自动保存间隔（秒）",-1)),t("select",{class:"form-control","model-value":a.value.autoSaveInterval,onChange:A},[...e[36]||(e[36]=[t("option",{value:"5"},"5秒",-1),t("option",{value:"10"},"10秒",-1),t("option",{value:"30"},"30秒",-1),t("option",{value:"60"},"1分钟",-1)])],40,Qe)])])]),t("section",We,[e[44]||(e[44]=t("h2",{class:"section-title"},"界面设置",-1)),t("div",Xe,[t("div",Ye,[e[41]||(e[41]=t("label",{class:"form-label"},"默认视图模式",-1)),t("div",Ze,[t("label",et,[t("input",{type:"radio","model-value":d.value.viewMode,onChange:e[7]||(e[7]=n=>C("grid")),value:"grid",name:"viewMode"},null,40,tt),e[39]||(e[39]=t("span",null,"网格视图",-1))]),t("label",ot,[t("input",{type:"radio","model-value":d.value.viewMode,onChange:e[8]||(e[8]=n=>C("list")),value:"list",name:"viewMode"},null,40,st),e[40]||(e[40]=t("span",null,"列表视图",-1))])])]),t("div",at,[e[43]||(e[43]=t("label",{class:"form-label"},"界面语言",-1)),t("select",{class:"form-control","model-value":d.value.language,onChange:D},[...e[42]||(e[42]=[t("option",{value:"zh-CN"},"简体中文",-1),t("option",{value:"en-US"},"English",-1)])],40,lt)])])]),t("div",{class:"save-section"},[t("button",{class:"btn btn-primary btn-lg",onClick:N}," 保存设置 ")])])])])}}}),dt=H(nt,[["__scopeId","data-v-e6c94bb0"]]);export{dt as default};
