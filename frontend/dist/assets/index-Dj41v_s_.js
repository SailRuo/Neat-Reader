import{d as T,o as V,c as u,b as t,t as o,k as j,l as U,n as p,F as Y,p as H,e as h,r as d,h as k,K,g as v,A as D,q,_ as A}from"./index-DzThwDyM.js";import{d as G}from"./dayjs.min-Bi3FP3uJ.js";import{u as J}from"./ebook-6ZYtjjao.js";const W={class:"file-manager"},X={class:"header"},O={class:"header-actions"},Q={class:"main"},Z={class:"file-manager-container"},ee={class:"path-nav"},te=["disabled"],ae={class:"current-path"},se={class:"file-list-container"},oe={class:"file-list-header"},ie={class:"section-title"},ne={class:"file-type-filter"},le={class:"file-list"},re=["onClick"],ce={class:"file-icon"},de={class:"file-info"},ue={class:"file-name"},pe={class:"file-meta"},ve={class:"file-date"},fe={class:"file-actions"},me=["onClick","disabled"],_e={key:0,class:"empty-state"},ye={class:"empty-icon"},be=T({__name:"index",setup(he){const m=J(),n=d("local"),r=d("/"),i=d("all"),_=d([]),c=d(!1),g=k(()=>r.value==="/"),y=k(()=>_.value.filter(e=>e.isDirectory||i.value==="all"?!0:e.name.toLowerCase().endsWith("."+i.value))),x=[{id:"1",name:"ä¹¦ç±",isDirectory:!0,path:"/books",size:0,lastModified:Date.now()-36e5},{id:"2",name:"JavaScripté«˜çº§ç¨‹åºè®¾è®¡.pdf",isDirectory:!1,path:"/js-advanced.pdf",size:1024*1024*5,lastModified:Date.now()-864e5},{id:"3",name:"Vue.jsè®¾è®¡ä¸å®ç°.epub",isDirectory:!1,path:"/vue-design.epub",size:1024*1024*3,lastModified:Date.now()-1728e5},{id:"4",name:"æµ‹è¯•æ–‡æœ¬.txt",isDirectory:!1,path:"/test.txt",size:1024*100,lastModified:Date.now()-2592e5}],F=[{id:"5",name:"NeatReader",isDirectory:!0,path:"/NeatReader",size:0,lastModified:Date.now()-36e5},{id:"6",name:"epub",isDirectory:!0,path:"/NeatReader/epub",size:0,lastModified:Date.now()-72e5},{id:"7",name:"pdf",isDirectory:!0,path:"/NeatReader/pdf",size:0,lastModified:Date.now()-72e5},{id:"8",name:"txt",isDirectory:!0,path:"/NeatReader/txt",size:0,lastModified:Date.now()-72e5},{id:"9",name:"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ.pdf",isDirectory:!1,path:"/NeatReader/pdf/csapp.pdf",size:1024*1024*8,lastModified:Date.now()-864e5}],w=()=>{n.value=n.value==="local"?"baidupan":"local",r.value="/",f()},f=()=>{console.log(`åŠ è½½${n.value}æ–‡ä»¶: ${r.value}`),_.value=n.value==="local"?x:F},C=()=>{if(r.value==="/")return;const e=r.value.split("/").filter(Boolean);e.pop(),r.value="/"+e.join("/"),f()},M=e=>{r.value=e.path,f()},B=e=>{console.log("é€‰æ‹©æ–‡ä»¶:",e)},N=async e=>{try{c.value=!0,console.log("å¯¼å…¥æ–‡ä»¶:",e);const a=new File([""],e.name,{type:$(e.name)}),l=await m.importEbookFile(a);alert(l?`å·²æˆåŠŸå¯¼å…¥æ–‡ä»¶: ${l.title}`:"å¯¼å…¥æ–‡ä»¶å¤±è´¥")}catch(a){console.error("å¯¼å…¥æ–‡ä»¶å¤±è´¥:",a),alert("å¯¼å…¥æ–‡ä»¶å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{c.value=!1}},$=e=>{switch(e.split(".").pop()?.toLowerCase()||""){case"epub":return"application/epub+zip";case"pdf":return"application/pdf";case"txt":return"text/plain";default:return"application/octet-stream"}},b=d(null),z=()=>{b.value?.click()},R=async e=>{const l=e.target.files;if(l&&l.length>0)for(let s=0;s<l.length;s++)await S(l[s])},S=async e=>{try{c.value=!0,console.log("å¯¼å…¥ä¸Šä¼ çš„æ–‡ä»¶:",e.name);const a=await m.importEbookFile(e);alert(a?`å·²æˆåŠŸå¯¼å…¥æ–‡ä»¶: ${a.title}`:"å¯¼å…¥æ–‡ä»¶å¤±è´¥")}catch(a){console.error("å¯¼å…¥æ–‡ä»¶å¤±è´¥:",a),alert("å¯¼å…¥æ–‡ä»¶å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{c.value=!1}},E=e=>{switch(e.name.split(".").pop()?.toLowerCase()||""){case"epub":return"ğŸ“š";case"pdf":return"ğŸ“„";case"txt":return"ğŸ“";default:return"ğŸ“„"}},I=e=>e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":e<1024*1024*1024?(e/(1024*1024)).toFixed(1)+" MB":(e/(1024*1024*1024)).toFixed(1)+" GB",L=e=>G(e).format("YYYY-MM-DD HH:mm");return V(async()=>{await m.initialize(),f()}),(e,a)=>{const l=K("router-link");return v(),u("div",W,[t("header",X,[a[5]||(a[5]=t("h1",{class:"title"},"æ–‡ä»¶ç®¡ç†",-1)),t("div",O,[t("button",{class:"btn btn-primary",onClick:z}," ğŸ“ ä¸Šä¼ æ–‡ä»¶ "),t("button",{class:"btn btn-secondary",onClick:w},o(n.value==="local"?"æœ¬åœ°æ–‡ä»¶":"ç™¾åº¦ç½‘ç›˜"),1),j(l,{to:"/",class:"btn btn-secondary"},{default:U(()=>[...a[4]||(a[4]=[D(" â† è¿”å› ",-1)])]),_:1}),t("input",{ref_key:"fileInput",ref:b,type:"file",multiple:"",accept:".epub,.pdf,.txt",style:{display:"none"},onChange:R},null,544)])]),t("main",Q,[t("div",Z,[t("div",ee,[t("button",{class:"btn btn-secondary",onClick:C,disabled:g.value}," â†‘ ä¸Šä¸€çº§ ",8,te),t("span",ae,o(r.value),1)]),t("div",se,[t("div",oe,[t("h2",ie,o(n.value==="local"?"æœ¬åœ°æ–‡ä»¶":"ç™¾åº¦ç½‘ç›˜æ–‡ä»¶"),1),t("div",ne,[t("button",{class:p(["btn btn-secondary",{active:i.value==="all"}]),onClick:a[0]||(a[0]=s=>i.value="all")}," å…¨éƒ¨ ",2),t("button",{class:p(["btn btn-secondary",{active:i.value==="epub"}]),onClick:a[1]||(a[1]=s=>i.value="epub")}," EPUB ",2),t("button",{class:p(["btn btn-secondary",{active:i.value==="pdf"}]),onClick:a[2]||(a[2]=s=>i.value="pdf")}," PDF ",2),t("button",{class:p(["btn btn-secondary",{active:i.value==="txt"}]),onClick:a[3]||(a[3]=s=>i.value="txt")}," TXT ",2)])]),t("div",le,[(v(!0),u(Y,null,H(y.value,s=>(v(),u("div",{key:s.id||s.path,class:p(["file-item",{directory:s.isDirectory}]),onClick:P=>s.isDirectory?M(s):B(s)},[t("div",ce,o(s.isDirectory?"ğŸ“":E(s)),1),t("div",de,[t("div",ue,o(s.name),1),t("div",pe,[D(o(s.isDirectory?"ç›®å½•":I(s.size))+" ",1),t("span",ve,o(L(s.lastModified)),1)])]),t("div",fe,[s.isDirectory?h("",!0):(v(),u("button",{key:0,class:"btn btn-primary",onClick:q(P=>N(s),["stop"]),disabled:c.value},o(c.value?"å¯¼å…¥ä¸­...":"å¯¼å…¥"),9,me))])],10,re))),128))]),y.value.length===0?(v(),u("div",_e,[t("div",ye,o(n.value==="local"?"ğŸ’»":"â˜ï¸"),1),t("h3",null,o(n.value==="local"?"æœ¬åœ°æ²¡æœ‰æ–‡ä»¶":"ç™¾åº¦ç½‘ç›˜æ²¡æœ‰æ–‡ä»¶"),1),t("p",null,o(n.value==="local"?"è¯·æµè§ˆåˆ°åŒ…å«ç”µå­ä¹¦çš„æ–‡ä»¶å¤¹":"è¯·ä¸Šä¼ ç”µå­ä¹¦åˆ°ç™¾åº¦ç½‘ç›˜"),1)])):h("",!0)])])])])}}}),xe=A(be,[["__scopeId","data-v-e8a43e24"]]);export{xe as default};
