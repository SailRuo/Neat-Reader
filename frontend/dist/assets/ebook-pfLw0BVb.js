import{K as Ha,r as qt,k as ai}from"./index-DA789M3t.js";var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hr(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function $t(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oi={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var Sn;function Va(){return Sn||(Sn=1,(function(a,e){(function(t){a.exports=t()})(function(){return(function t(r,i,n){function s(f,d){if(!i[f]){if(!r[f]){var p=typeof $t=="function"&&$t;if(!d&&p)return p(f,!0);if(o)return o(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var y=i[f]={exports:{}};r[f][0].call(y.exports,function(S){var _=r[f][1][S];return s(_||S)},y,y.exports,t,r,i,n)}return i[f].exports}for(var o=typeof $t=="function"&&$t,u=0;u<n.length;u++)s(n[u]);return s})({1:[function(t,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,o;if(s){var u=0,f=new s(S),d=n.document.createTextNode("");f.observe(d,{characterData:!0}),o=function(){d.data=u=++u%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var p=new n.MessageChannel;p.port1.onmessage=S,o=function(){p.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var h=n.document.createElement("script");h.onreadystatechange=function(){S(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:o=function(){setTimeout(S,0)};var b,y=[];function S(){b=!0;for(var h,v,m=y.length;m;){for(v=y,y=[],h=-1;++h<m;)v[h]();m=y.length}b=!1}r.exports=_;function _(h){y.push(h)===1&&!b&&o()}}).call(this,typeof kt<"u"?kt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,i){var n=t(1);function s(){}var o={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];r.exports=p;function p(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,E!==s&&_(this,E)}p.prototype.catch=function(E){return this.then(null,E)},p.prototype.then=function(E,k){if(typeof E!="function"&&this.state===f||typeof k!="function"&&this.state===u)return this;var N=new this.constructor(s);if(this.state!==d){var B=this.state===f?E:k;y(N,B,this.outcome)}else this.queue.push(new b(N,E,k));return N};function b(E,k,N){this.promise=E,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(E){o.resolve(this.promise,E)},b.prototype.otherCallFulfilled=function(E){y(this.promise,this.onFulfilled,E)},b.prototype.callRejected=function(E){o.reject(this.promise,E)},b.prototype.otherCallRejected=function(E){y(this.promise,this.onRejected,E)};function y(E,k,N){n(function(){var B;try{B=k(N)}catch(I){return o.reject(E,I)}B===E?o.reject(E,new TypeError("Cannot resolve promise with itself")):o.resolve(E,B)})}o.resolve=function(E,k){var N=h(S,k);if(N.status==="error")return o.reject(E,N.value);var B=N.value;if(B)_(E,B);else{E.state=f,E.outcome=k;for(var I=-1,L=E.queue.length;++I<L;)E.queue[I].callFulfilled(k)}return E},o.reject=function(E,k){E.state=u,E.outcome=k;for(var N=-1,B=E.queue.length;++N<B;)E.queue[N].callRejected(k);return E};function S(E){var k=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof k=="function")return function(){k.apply(E,arguments)}}function _(E,k){var N=!1;function B($){N||(N=!0,o.reject(E,$))}function I($){N||(N=!0,o.resolve(E,$))}function L(){k(I,B)}var K=h(L);K.status==="error"&&B(K.value)}function h(E,k){var N={};try{N.value=E(k),N.status="success"}catch(B){N.status="error",N.value=B}return N}p.resolve=v;function v(E){return E instanceof this?E:o.resolve(new this(s),E)}p.reject=m;function m(E){var k=new this(s);return o.reject(k,E)}p.all=D;function D(E){var k=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,B=!1;if(!N)return this.resolve([]);for(var I=new Array(N),L=0,K=-1,$=new this(s);++K<N;)J(E[K],K);return $;function J(ne,ae){k.resolve(ne).then(le,function(se){B||(B=!0,o.reject($,se))});function le(se){I[ae]=se,++L===N&&!B&&(B=!0,o.resolve($,I))}}}p.race=O;function O(E){var k=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,B=!1;if(!N)return this.resolve([]);for(var I=-1,L=new this(s);++I<N;)K(E[I]);return L;function K($){k.resolve($).then(function(J){B||(B=!0,o.resolve(L,J))},function(J){B||(B=!0,o.reject(L,J))})}}},{1:1}],3:[function(t,r,i){(function(n){typeof n.Promise!="function"&&(n.Promise=t(2))}).call(this,typeof kt<"u"?kt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,i){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C};function s(C,U){if(!(C instanceof U))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var u=o();function f(){try{if(!u||!u.open)return!1;var C=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),U=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!C||U)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(C,U){C=C||[],U=U||{};try{return new Blob(C,U)}catch(j){if(j.name!=="TypeError")throw j;for(var R=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,H=new R,G=0;G<C.length;G+=1)H.append(C[G]);return H.getBlob(U.type)}}typeof Promise>"u"&&t(3);var p=Promise;function b(C,U){U&&C.then(function(R){U(null,R)},function(R){U(R)})}function y(C,U,R){typeof U=="function"&&C.then(U),typeof R=="function"&&C.catch(R)}function S(C){return typeof C!="string"&&(console.warn(C+" used as a key, but it is not a string."),C=String(C)),C}function _(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",v=void 0,m={},D=Object.prototype.toString,O="readonly",E="readwrite";function k(C){for(var U=C.length,R=new ArrayBuffer(U),H=new Uint8Array(R),G=0;G<U;G++)H[G]=C.charCodeAt(G);return R}function N(C){return new p(function(U){var R=C.transaction(h,E),H=d([""]);R.objectStore(h).put(H,"key"),R.onabort=function(G){G.preventDefault(),G.stopPropagation(),U(!1)},R.oncomplete=function(){var G=navigator.userAgent.match(/Chrome\/(\d+)/),j=navigator.userAgent.match(/Edge\//);U(j||!G||parseInt(G[1],10)>=43)}}).catch(function(){return!1})}function B(C){return typeof v=="boolean"?p.resolve(v):N(C).then(function(U){return v=U,v})}function I(C){var U=m[C.name],R={};R.promise=new p(function(H,G){R.resolve=H,R.reject=G}),U.deferredOperations.push(R),U.dbReady?U.dbReady=U.dbReady.then(function(){return R.promise}):U.dbReady=R.promise}function L(C){var U=m[C.name],R=U.deferredOperations.pop();if(R)return R.resolve(),R.promise}function K(C,U){var R=m[C.name],H=R.deferredOperations.pop();if(H)return H.reject(U),H.promise}function $(C,U){return new p(function(R,H){if(m[C.name]=m[C.name]||ve(),C.db)if(U)I(C),C.db.close();else return R(C.db);var G=[C.name];U&&G.push(C.version);var j=u.open.apply(u,G);U&&(j.onupgradeneeded=function(re){var oe=j.result;try{oe.createObjectStore(C.storeName),re.oldVersion<=1&&oe.createObjectStore(h)}catch(ce){if(ce.name==="ConstraintError")console.warn('The database "'+C.name+'" has been upgraded from version '+re.oldVersion+" to version "+re.newVersion+', but the storage "'+C.storeName+'" already exists.');else throw ce}}),j.onerror=function(re){re.preventDefault(),H(j.error)},j.onsuccess=function(){var re=j.result;re.onversionchange=function(oe){oe.target.close()},R(re),L(C)}})}function J(C){return $(C,!1)}function ne(C){return $(C,!0)}function ae(C,U){if(!C.db)return!0;var R=!C.db.objectStoreNames.contains(C.storeName),H=C.version<C.db.version,G=C.version>C.db.version;if(H&&(C.version!==U&&console.warn('The database "'+C.name+`" can't be downgraded from version `+C.db.version+" to version "+C.version+"."),C.version=C.db.version),G||R){if(R){var j=C.db.version+1;j>C.version&&(C.version=j)}return!0}return!1}function le(C){return new p(function(U,R){var H=new FileReader;H.onerror=R,H.onloadend=function(G){var j=btoa(G.target.result||"");U({__local_forage_encoded_blob:!0,data:j,type:C.type})},H.readAsBinaryString(C)})}function se(C){var U=k(atob(C.data));return d([U],{type:C.type})}function ie(C){return C&&C.__local_forage_encoded_blob}function pe(C){var U=this,R=U._initReady().then(function(){var H=m[U._dbInfo.name];if(H&&H.dbReady)return H.dbReady});return y(R,C,C),R}function Ee(C){I(C);for(var U=m[C.name],R=U.forages,H=0;H<R.length;H++){var G=R[H];G._dbInfo.db&&(G._dbInfo.db.close(),G._dbInfo.db=null)}return C.db=null,J(C).then(function(j){return C.db=j,ae(C)?ne(C):j}).then(function(j){C.db=U.db=j;for(var re=0;re<R.length;re++)R[re]._dbInfo.db=j}).catch(function(j){throw K(C,j),j})}function ue(C,U,R,H){H===void 0&&(H=1);try{var G=C.db.transaction(C.storeName,U);R(null,G)}catch(j){if(H>0&&(!C.db||j.name==="InvalidStateError"||j.name==="NotFoundError"))return p.resolve().then(function(){if(!C.db||j.name==="NotFoundError"&&!C.db.objectStoreNames.contains(C.storeName)&&C.version<=C.db.version)return C.db&&(C.version=C.db.version+1),ne(C)}).then(function(){return Ee(C).then(function(){ue(C,U,R,H-1)})}).catch(R);R(j)}}function ve(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Te(C){var U=this,R={db:null};if(C)for(var H in C)R[H]=C[H];var G=m[R.name];G||(G=ve(),m[R.name]=G),G.forages.push(U),U._initReady||(U._initReady=U.ready,U.ready=pe);var j=[];function re(){return p.resolve()}for(var oe=0;oe<G.forages.length;oe++){var ce=G.forages[oe];ce!==U&&j.push(ce._initReady().catch(re))}var he=G.forages.slice(0);return p.all(j).then(function(){return R.db=G.db,J(R)}).then(function(de){return R.db=de,ae(R,U._defaultConfig.version)?ne(R):de}).then(function(de){R.db=G.db=de,U._dbInfo=R;for(var be=0;be<he.length;be++){var Pe=he[be];Pe!==U&&(Pe._dbInfo.db=R.db,Pe._dbInfo.version=R.version)}})}function we(C,U){var R=this;C=S(C);var H=new p(function(G,j){R.ready().then(function(){ue(R._dbInfo,O,function(re,oe){if(re)return j(re);try{var ce=oe.objectStore(R._dbInfo.storeName),he=ce.get(C);he.onsuccess=function(){var de=he.result;de===void 0&&(de=null),ie(de)&&(de=se(de)),G(de)},he.onerror=function(){j(he.error)}}catch(de){j(de)}})}).catch(j)});return b(H,U),H}function Ne(C,U){var R=this,H=new p(function(G,j){R.ready().then(function(){ue(R._dbInfo,O,function(re,oe){if(re)return j(re);try{var ce=oe.objectStore(R._dbInfo.storeName),he=ce.openCursor(),de=1;he.onsuccess=function(){var be=he.result;if(be){var Pe=be.value;ie(Pe)&&(Pe=se(Pe));var Xe=C(Pe,be.key,de++);Xe!==void 0?G(Xe):be.continue()}else G()},he.onerror=function(){j(he.error)}}catch(be){j(be)}})}).catch(j)});return b(H,U),H}function Ge(C,U,R){var H=this;C=S(C);var G=new p(function(j,re){var oe;H.ready().then(function(){return oe=H._dbInfo,D.call(U)==="[object Blob]"?B(oe.db).then(function(ce){return ce?U:le(U)}):U}).then(function(ce){ue(H._dbInfo,E,function(he,de){if(he)return re(he);try{var be=de.objectStore(H._dbInfo.storeName);ce===null&&(ce=void 0);var Pe=be.put(ce,C);de.oncomplete=function(){ce===void 0&&(ce=null),j(ce)},de.onabort=de.onerror=function(){var Xe=Pe.error?Pe.error:Pe.transaction.error;re(Xe)}}catch(Xe){re(Xe)}})}).catch(re)});return b(G,R),G}function Ve(C,U){var R=this;C=S(C);var H=new p(function(G,j){R.ready().then(function(){ue(R._dbInfo,E,function(re,oe){if(re)return j(re);try{var ce=oe.objectStore(R._dbInfo.storeName),he=ce.delete(C);oe.oncomplete=function(){G()},oe.onerror=function(){j(he.error)},oe.onabort=function(){var de=he.error?he.error:he.transaction.error;j(de)}}catch(de){j(de)}})}).catch(j)});return b(H,U),H}function _e(C){var U=this,R=new p(function(H,G){U.ready().then(function(){ue(U._dbInfo,E,function(j,re){if(j)return G(j);try{var oe=re.objectStore(U._dbInfo.storeName),ce=oe.clear();re.oncomplete=function(){H()},re.onabort=re.onerror=function(){var he=ce.error?ce.error:ce.transaction.error;G(he)}}catch(he){G(he)}})}).catch(G)});return b(R,C),R}function We(C){var U=this,R=new p(function(H,G){U.ready().then(function(){ue(U._dbInfo,O,function(j,re){if(j)return G(j);try{var oe=re.objectStore(U._dbInfo.storeName),ce=oe.count();ce.onsuccess=function(){H(ce.result)},ce.onerror=function(){G(ce.error)}}catch(he){G(he)}})}).catch(G)});return b(R,C),R}function Ie(C,U){var R=this,H=new p(function(G,j){if(C<0){G(null);return}R.ready().then(function(){ue(R._dbInfo,O,function(re,oe){if(re)return j(re);try{var ce=oe.objectStore(R._dbInfo.storeName),he=!1,de=ce.openKeyCursor();de.onsuccess=function(){var be=de.result;if(!be){G(null);return}C===0||he?G(be.key):(he=!0,be.advance(C))},de.onerror=function(){j(de.error)}}catch(be){j(be)}})}).catch(j)});return b(H,U),H}function ke(C){var U=this,R=new p(function(H,G){U.ready().then(function(){ue(U._dbInfo,O,function(j,re){if(j)return G(j);try{var oe=re.objectStore(U._dbInfo.storeName),ce=oe.openKeyCursor(),he=[];ce.onsuccess=function(){var de=ce.result;if(!de){H(he);return}he.push(de.key),de.continue()},ce.onerror=function(){G(ce.error)}}catch(de){G(de)}})}).catch(G)});return b(R,C),R}function Be(C,U){U=_.apply(this,arguments);var R=this.config();C=typeof C!="function"&&C||{},C.name||(C.name=C.name||R.name,C.storeName=C.storeName||R.storeName);var H=this,G;if(!C.name)G=p.reject("Invalid arguments");else{var j=C.name===R.name&&H._dbInfo.db,re=j?p.resolve(H._dbInfo.db):J(C).then(function(oe){var ce=m[C.name],he=ce.forages;ce.db=oe;for(var de=0;de<he.length;de++)he[de]._dbInfo.db=oe;return oe});C.storeName?G=re.then(function(oe){if(oe.objectStoreNames.contains(C.storeName)){var ce=oe.version+1;I(C);var he=m[C.name],de=he.forages;oe.close();for(var be=0;be<de.length;be++){var Pe=de[be];Pe._dbInfo.db=null,Pe._dbInfo.version=ce}var Xe=new p(function(Ye,ct){var ut=u.open(C.name,ce);ut.onerror=function(Ct){var pr=ut.result;pr.close(),ct(Ct)},ut.onupgradeneeded=function(){var Ct=ut.result;Ct.deleteObjectStore(C.storeName)},ut.onsuccess=function(){var Ct=ut.result;Ct.close(),Ye(Ct)}});return Xe.then(function(Ye){he.db=Ye;for(var ct=0;ct<de.length;ct++){var ut=de[ct];ut._dbInfo.db=Ye,L(ut._dbInfo)}}).catch(function(Ye){throw(K(C,Ye)||p.resolve()).catch(function(){}),Ye})}}):G=re.then(function(oe){I(C);var ce=m[C.name],he=ce.forages;oe.close();for(var de=0;de<he.length;de++){var be=he[de];be._dbInfo.db=null}var Pe=new p(function(Xe,Ye){var ct=u.deleteDatabase(C.name);ct.onerror=function(){var ut=ct.result;ut&&ut.close(),Ye(ct.error)},ct.onblocked=function(){console.warn('dropInstance blocked for database "'+C.name+'" until all open connections are closed')},ct.onsuccess=function(){var ut=ct.result;ut&&ut.close(),Xe(ut)}});return Pe.then(function(Xe){ce.db=Xe;for(var Ye=0;Ye<he.length;Ye++){var ct=he[Ye];L(ct._dbInfo)}}).catch(function(Xe){throw(K(C,Xe)||p.resolve()).catch(function(){}),Xe})})}return b(G,U),G}var Ae={_driver:"asyncStorage",_initStorage:Te,_support:f(),iterate:Ne,getItem:we,setItem:Ge,removeItem:Ve,clear:_e,length:We,key:Ie,keys:ke,dropInstance:Be};function ze(){return typeof openDatabase=="function"}var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",He="~~local_forage_type~",Le=/^~~local_forage_type~([^~]+)~/,Je="__lfsc__:",rt=Je.length,et="arbf",De="blob",Se="si08",xe="ui08",it="uic8",mt="si16",dt="si32",Qe="ur16",yt="ui32",wt="fl32",ht="fl64",bt=rt+et.length,P=Object.prototype.toString;function z(C){var U=C.length*.75,R=C.length,H,G=0,j,re,oe,ce;C[C.length-1]==="="&&(U--,C[C.length-2]==="="&&U--);var he=new ArrayBuffer(U),de=new Uint8Array(he);for(H=0;H<R;H+=4)j=Ue.indexOf(C[H]),re=Ue.indexOf(C[H+1]),oe=Ue.indexOf(C[H+2]),ce=Ue.indexOf(C[H+3]),de[G++]=j<<2|re>>4,de[G++]=(re&15)<<4|oe>>2,de[G++]=(oe&3)<<6|ce&63;return he}function V(C){var U=new Uint8Array(C),R="",H;for(H=0;H<U.length;H+=3)R+=Ue[U[H]>>2],R+=Ue[(U[H]&3)<<4|U[H+1]>>4],R+=Ue[(U[H+1]&15)<<2|U[H+2]>>6],R+=Ue[U[H+2]&63];return U.length%3===2?R=R.substring(0,R.length-1)+"=":U.length%3===1&&(R=R.substring(0,R.length-2)+"=="),R}function Q(C,U){var R="";if(C&&(R=P.call(C)),C&&(R==="[object ArrayBuffer]"||C.buffer&&P.call(C.buffer)==="[object ArrayBuffer]")){var H,G=Je;C instanceof ArrayBuffer?(H=C,G+=et):(H=C.buffer,R==="[object Int8Array]"?G+=Se:R==="[object Uint8Array]"?G+=xe:R==="[object Uint8ClampedArray]"?G+=it:R==="[object Int16Array]"?G+=mt:R==="[object Uint16Array]"?G+=Qe:R==="[object Int32Array]"?G+=dt:R==="[object Uint32Array]"?G+=yt:R==="[object Float32Array]"?G+=wt:R==="[object Float64Array]"?G+=ht:U(new Error("Failed to get type for BinaryArray"))),U(G+V(H))}else if(R==="[object Blob]"){var j=new FileReader;j.onload=function(){var re=He+C.type+"~"+V(this.result);U(Je+De+re)},j.readAsArrayBuffer(C)}else try{U(JSON.stringify(C))}catch(re){console.error("Couldn't convert value into a JSON string: ",C),U(null,re)}}function w(C){if(C.substring(0,rt)!==Je)return JSON.parse(C);var U=C.substring(bt),R=C.substring(rt,bt),H;if(R===De&&Le.test(U)){var G=U.match(Le);H=G[1],U=U.substring(G[0].length)}var j=z(U);switch(R){case et:return j;case De:return d([j],{type:H});case Se:return new Int8Array(j);case xe:return new Uint8Array(j);case it:return new Uint8ClampedArray(j);case mt:return new Int16Array(j);case Qe:return new Uint16Array(j);case dt:return new Int32Array(j);case yt:return new Uint32Array(j);case wt:return new Float32Array(j);case ht:return new Float64Array(j);default:throw new Error("Unkown type: "+R)}}var Z={serialize:Q,deserialize:w,stringToBuffer:z,bufferToString:V};function Y(C,U,R,H){C.executeSql("CREATE TABLE IF NOT EXISTS "+U.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],R,H)}function te(C){var U=this,R={db:null};if(C)for(var H in C)R[H]=typeof C[H]!="string"?C[H].toString():C[H];var G=new p(function(j,re){try{R.db=openDatabase(R.name,String(R.version),R.description,R.size)}catch(oe){return re(oe)}R.db.transaction(function(oe){Y(oe,R,function(){U._dbInfo=R,j()},function(ce,he){re(he)})},re)});return R.serializer=Z,G}function T(C,U,R,H,G,j){C.executeSql(R,H,G,function(re,oe){oe.code===oe.SYNTAX_ERR?re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[U.storeName],function(ce,he){he.rows.length?j(ce,oe):Y(ce,U,function(){ce.executeSql(R,H,G,j)},j)},j):j(re,oe)},j)}function g(C,U){var R=this;C=S(C);var H=new p(function(G,j){R.ready().then(function(){var re=R._dbInfo;re.db.transaction(function(oe){T(oe,re,"SELECT * FROM "+re.storeName+" WHERE key = ? LIMIT 1",[C],function(ce,he){var de=he.rows.length?he.rows.item(0).value:null;de&&(de=re.serializer.deserialize(de)),G(de)},function(ce,he){j(he)})})}).catch(j)});return b(H,U),H}function l(C,U){var R=this,H=new p(function(G,j){R.ready().then(function(){var re=R._dbInfo;re.db.transaction(function(oe){T(oe,re,"SELECT * FROM "+re.storeName,[],function(ce,he){for(var de=he.rows,be=de.length,Pe=0;Pe<be;Pe++){var Xe=de.item(Pe),Ye=Xe.value;if(Ye&&(Ye=re.serializer.deserialize(Ye)),Ye=C(Ye,Xe.key,Pe+1),Ye!==void 0){G(Ye);return}}G()},function(ce,he){j(he)})})}).catch(j)});return b(H,U),H}function A(C,U,R,H){var G=this;C=S(C);var j=new p(function(re,oe){G.ready().then(function(){U===void 0&&(U=null);var ce=U,he=G._dbInfo;he.serializer.serialize(U,function(de,be){be?oe(be):he.db.transaction(function(Pe){T(Pe,he,"INSERT OR REPLACE INTO "+he.storeName+" (key, value) VALUES (?, ?)",[C,de],function(){re(ce)},function(Xe,Ye){oe(Ye)})},function(Pe){if(Pe.code===Pe.QUOTA_ERR){if(H>0){re(A.apply(G,[C,ce,R,H-1]));return}oe(Pe)}})})}).catch(oe)});return b(j,R),j}function M(C,U,R){return A.apply(this,[C,U,R,1])}function c(C,U){var R=this;C=S(C);var H=new p(function(G,j){R.ready().then(function(){var re=R._dbInfo;re.db.transaction(function(oe){T(oe,re,"DELETE FROM "+re.storeName+" WHERE key = ?",[C],function(){G()},function(ce,he){j(he)})})}).catch(j)});return b(H,U),H}function q(C){var U=this,R=new p(function(H,G){U.ready().then(function(){var j=U._dbInfo;j.db.transaction(function(re){T(re,j,"DELETE FROM "+j.storeName,[],function(){H()},function(oe,ce){G(ce)})})}).catch(G)});return b(R,C),R}function W(C){var U=this,R=new p(function(H,G){U.ready().then(function(){var j=U._dbInfo;j.db.transaction(function(re){T(re,j,"SELECT COUNT(key) as c FROM "+j.storeName,[],function(oe,ce){var he=ce.rows.item(0).c;H(he)},function(oe,ce){G(ce)})})}).catch(G)});return b(R,C),R}function x(C,U){var R=this,H=new p(function(G,j){R.ready().then(function(){var re=R._dbInfo;re.db.transaction(function(oe){T(oe,re,"SELECT key FROM "+re.storeName+" WHERE id = ? LIMIT 1",[C+1],function(ce,he){var de=he.rows.length?he.rows.item(0).key:null;G(de)},function(ce,he){j(he)})})}).catch(j)});return b(H,U),H}function F(C){var U=this,R=new p(function(H,G){U.ready().then(function(){var j=U._dbInfo;j.db.transaction(function(re){T(re,j,"SELECT key FROM "+j.storeName,[],function(oe,ce){for(var he=[],de=0;de<ce.rows.length;de++)he.push(ce.rows.item(de).key);H(he)},function(oe,ce){G(ce)})})}).catch(G)});return b(R,C),R}function X(C){return new p(function(U,R){C.transaction(function(H){H.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(G,j){for(var re=[],oe=0;oe<j.rows.length;oe++)re.push(j.rows.item(oe).name);U({db:C,storeNames:re})},function(G,j){R(j)})},function(H){R(H)})})}function me(C,U){U=_.apply(this,arguments);var R=this.config();C=typeof C!="function"&&C||{},C.name||(C.name=C.name||R.name,C.storeName=C.storeName||R.storeName);var H=this,G;return C.name?G=new p(function(j){var re;C.name===R.name?re=H._dbInfo.db:re=openDatabase(C.name,"","",0),C.storeName?j({db:re,storeNames:[C.storeName]}):j(X(re))}).then(function(j){return new p(function(re,oe){j.db.transaction(function(ce){function he(Xe){return new p(function(Ye,ct){ce.executeSql("DROP TABLE IF EXISTS "+Xe,[],function(){Ye()},function(ut,Ct){ct(Ct)})})}for(var de=[],be=0,Pe=j.storeNames.length;be<Pe;be++)de.push(he(j.storeNames[be]));p.all(de).then(function(){re()}).catch(function(Xe){oe(Xe)})},function(ce){oe(ce)})})}):G=p.reject("Invalid arguments"),b(G,U),G}var fe={_driver:"webSQLStorage",_initStorage:te,_support:ze(),iterate:l,getItem:g,setItem:M,removeItem:c,clear:q,length:W,key:x,keys:F,dropInstance:me};function ge(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Re(C,U){var R=C.name+"/";return C.storeName!==U.storeName&&(R+=C.storeName+"/"),R}function nt(){var C="_localforage_support_test";try{return localStorage.setItem(C,!0),localStorage.removeItem(C),!1}catch{return!0}}function $e(){return!nt()||localStorage.length>0}function Oe(C){var U=this,R={};if(C)for(var H in C)R[H]=C[H];return R.keyPrefix=Re(C,U._defaultConfig),$e()?(U._dbInfo=R,R.serializer=Z,p.resolve()):p.reject()}function Fe(C){var U=this,R=U.ready().then(function(){for(var H=U._dbInfo.keyPrefix,G=localStorage.length-1;G>=0;G--){var j=localStorage.key(G);j.indexOf(H)===0&&localStorage.removeItem(j)}});return b(R,C),R}function ot(C,U){var R=this;C=S(C);var H=R.ready().then(function(){var G=R._dbInfo,j=localStorage.getItem(G.keyPrefix+C);return j&&(j=G.serializer.deserialize(j)),j});return b(H,U),H}function tt(C,U){var R=this,H=R.ready().then(function(){for(var G=R._dbInfo,j=G.keyPrefix,re=j.length,oe=localStorage.length,ce=1,he=0;he<oe;he++){var de=localStorage.key(he);if(de.indexOf(j)===0){var be=localStorage.getItem(de);if(be&&(be=G.serializer.deserialize(be)),be=C(be,de.substring(re),ce++),be!==void 0)return be}}});return b(H,U),H}function Mt(C,U){var R=this,H=R.ready().then(function(){var G=R._dbInfo,j;try{j=localStorage.key(C)}catch{j=null}return j&&(j=j.substring(G.keyPrefix.length)),j});return b(H,U),H}function Kt(C){var U=this,R=U.ready().then(function(){for(var H=U._dbInfo,G=localStorage.length,j=[],re=0;re<G;re++){var oe=localStorage.key(re);oe.indexOf(H.keyPrefix)===0&&j.push(oe.substring(H.keyPrefix.length))}return j});return b(R,C),R}function st(C){var U=this,R=U.keys().then(function(H){return H.length});return b(R,C),R}function _t(C,U){var R=this;C=S(C);var H=R.ready().then(function(){var G=R._dbInfo;localStorage.removeItem(G.keyPrefix+C)});return b(H,U),H}function ft(C,U,R){var H=this;C=S(C);var G=H.ready().then(function(){U===void 0&&(U=null);var j=U;return new p(function(re,oe){var ce=H._dbInfo;ce.serializer.serialize(U,function(he,de){if(de)oe(de);else try{localStorage.setItem(ce.keyPrefix+C,he),re(j)}catch(be){(be.name==="QuotaExceededError"||be.name==="NS_ERROR_DOM_QUOTA_REACHED")&&oe(be),oe(be)}})})});return b(G,R),G}function Rt(C,U){if(U=_.apply(this,arguments),C=typeof C!="function"&&C||{},!C.name){var R=this.config();C.name=C.name||R.name,C.storeName=C.storeName||R.storeName}var H=this,G;return C.name?G=new p(function(j){C.storeName?j(Re(C,H._defaultConfig)):j(C.name+"/")}).then(function(j){for(var re=localStorage.length-1;re>=0;re--){var oe=localStorage.key(re);oe.indexOf(j)===0&&localStorage.removeItem(oe)}}):G=p.reject("Invalid arguments"),b(G,U),G}var Dt={_driver:"localStorageWrapper",_initStorage:Oe,_support:ge(),iterate:tt,getItem:ot,setItem:ft,removeItem:_t,clear:Fe,length:st,key:Mt,keys:Kt,dropInstance:Rt},Tr=function(U,R){return U===R||typeof U=="number"&&typeof R=="number"&&isNaN(U)&&isNaN(R)},La=function(U,R){for(var H=U.length,G=0;G<H;){if(Tr(U[G],R))return!0;G++}return!1},An=Array.isArray||function(C){return Object.prototype.toString.call(C)==="[object Array]"},dr={},Dn={},Jt={INDEXEDDB:Ae,WEBSQL:fe,LOCALSTORAGE:Dt},Fa=[Jt.INDEXEDDB._driver,Jt.WEBSQL._driver,Jt.LOCALSTORAGE._driver],kr=["dropInstance"],ri=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(kr),Pa={description:"",driver:Fa.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function za(C,U){C[U]=function(){var R=arguments;return C.ready().then(function(){return C[U].apply(C,R)})}}function ii(){for(var C=1;C<arguments.length;C++){var U=arguments[C];if(U)for(var R in U)U.hasOwnProperty(R)&&(An(U[R])?arguments[0][R]=U[R].slice():arguments[0][R]=U[R])}return arguments[0]}var Ua=(function(){function C(U){s(this,C);for(var R in Jt)if(Jt.hasOwnProperty(R)){var H=Jt[R],G=H._driver;this[R]=G,dr[G]||this.defineDriver(H)}this._defaultConfig=ii({},Pa),this._config=ii({},this._defaultConfig,U),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return C.prototype.config=function(R){if((typeof R>"u"?"undefined":n(R))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var H in R){if(H==="storeName"&&(R[H]=R[H].replace(/\W/g,"_")),H==="version"&&typeof R[H]!="number")return new Error("Database version must be a number.");this._config[H]=R[H]}return"driver"in R&&R.driver?this.setDriver(this._config.driver):!0}else return typeof R=="string"?this._config[R]:this._config},C.prototype.defineDriver=function(R,H,G){var j=new p(function(re,oe){try{var ce=R._driver,he=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!R._driver){oe(he);return}for(var de=ri.concat("_initStorage"),be=0,Pe=de.length;be<Pe;be++){var Xe=de[be],Ye=!La(kr,Xe);if((Ye||R[Xe])&&typeof R[Xe]!="function"){oe(he);return}}var ct=function(){for(var pr=function(ja){return function(){var Wa=new Error("Method "+ja+" is not implemented by the current driver"),Cn=p.reject(Wa);return b(Cn,arguments[arguments.length-1]),Cn}},ni=0,qa=kr.length;ni<qa;ni++){var si=kr[ni];R[si]||(R[si]=pr(si))}};ct();var ut=function(pr){dr[ce]&&console.info("Redefining LocalForage driver: "+ce),dr[ce]=R,Dn[ce]=pr,re()};"_support"in R?R._support&&typeof R._support=="function"?R._support().then(ut,oe):ut(!!R._support):ut(!0)}catch(Ct){oe(Ct)}});return y(j,H,G),j},C.prototype.driver=function(){return this._driver||null},C.prototype.getDriver=function(R,H,G){var j=dr[R]?p.resolve(dr[R]):p.reject(new Error("Driver not found."));return y(j,H,G),j},C.prototype.getSerializer=function(R){var H=p.resolve(Z);return y(H,R),H},C.prototype.ready=function(R){var H=this,G=H._driverSet.then(function(){return H._ready===null&&(H._ready=H._initDriver()),H._ready});return y(G,R,R),G},C.prototype.setDriver=function(R,H,G){var j=this;An(R)||(R=[R]);var re=this._getSupportedDrivers(R);function oe(){j._config.driver=j.driver()}function ce(be){return j._extend(be),oe(),j._ready=j._initStorage(j._config),j._ready}function he(be){return function(){var Pe=0;function Xe(){for(;Pe<be.length;){var Ye=be[Pe];return Pe++,j._dbInfo=null,j._ready=null,j.getDriver(Ye).then(ce).catch(Xe)}oe();var ct=new Error("No available storage method found.");return j._driverSet=p.reject(ct),j._driverSet}return Xe()}}var de=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=de.then(function(){var be=re[0];return j._dbInfo=null,j._ready=null,j.getDriver(be).then(function(Pe){j._driver=Pe._driver,oe(),j._wrapLibraryMethodsWithReady(),j._initDriver=he(re)})}).catch(function(){oe();var be=new Error("No available storage method found.");return j._driverSet=p.reject(be),j._driverSet}),y(this._driverSet,H,G),this._driverSet},C.prototype.supports=function(R){return!!Dn[R]},C.prototype._extend=function(R){ii(this,R)},C.prototype._getSupportedDrivers=function(R){for(var H=[],G=0,j=R.length;G<j;G++){var re=R[G];this.supports(re)&&H.push(re)}return H},C.prototype._wrapLibraryMethodsWithReady=function(){for(var R=0,H=ri.length;R<H;R++)za(this,ri[R])},C.prototype.createInstance=function(R){return new C(R)},C})(),Ma=new Ua;r.exports=Ma},{3:3}]},{},[4])(4)})})(oi)),oi.exports}var $a=Va();const Me=hr($a);var Rr={exports:{}},ui={exports:{}},li,Tn;function Ws(){if(Tn)return li;Tn=1;var a=void 0;return li=function(e){return e!==a&&e!==null},li}var ci,kn;function Ga(){if(kn)return ci;kn=1;var a=Ws(),e={object:!0,function:!0,undefined:!0};return ci=function(t){return a(t)?hasOwnProperty.call(e,typeof t):!1},ci}var hi,Rn;function Za(){if(Rn)return hi;Rn=1;var a=Ga();return hi=function(e){if(!a(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},hi}var fi,Nn;function Xa(){if(Nn)return fi;Nn=1;var a=Za();return fi=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!a(e)},fi}var di,In;function Ya(){if(In)return di;In=1;var a=Xa(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return di=function(r){return!(!a(r)||e.test(t.call(r)))},di}var pi,On;function Ka(){return On||(On=1,pi=function(){var a=Object.assign,e;return typeof a!="function"?!1:(e={foo:"raz"},a(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),pi}var gi,Bn;function Ja(){return Bn||(Bn=1,gi=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),gi}var vi,Ln;function Qa(){return Ln||(Ln=1,vi=function(){}),vi}var mi,Fn;function cn(){if(Fn)return mi;Fn=1;var a=Qa()();return mi=function(e){return e!==a&&e!==null},mi}var yi,Pn;function eo(){if(Pn)return yi;Pn=1;var a=cn(),e=Object.keys;return yi=function(t){return e(a(t)?Object(t):t)},yi}var wi,zn;function to(){return zn||(zn=1,wi=Ja()()?Object.keys:eo()),wi}var bi,Un;function ro(){if(Un)return bi;Un=1;var a=cn();return bi=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e},bi}var _i,Mn;function io(){if(Mn)return _i;Mn=1;var a=to(),e=ro(),t=Math.max;return _i=function(r,i){var n,s,o=t(arguments.length,2),u;for(r=Object(e(r)),u=function(f){try{r[f]=i[f]}catch(d){n||(n=d)}},s=1;s<o;++s)i=arguments[s],a(i).forEach(u);if(n!==void 0)throw n;return r},_i}var Ei,qn;function no(){return qn||(qn=1,Ei=Ka()()?Object.assign:io()),Ei}var xi,jn;function so(){if(jn)return xi;jn=1;var a=cn(),e=Array.prototype.forEach,t=Object.create,r=function(i,n){var s;for(s in i)n[s]=i[s]};return xi=function(i){var n=t(null);return e.call(arguments,function(s){a(s)&&r(Object(s),n)}),n},xi}var Ai,Wn;function ao(){if(Wn)return Ai;Wn=1;var a="razdwatrzy";return Ai=function(){return typeof a.contains!="function"?!1:a.contains("dwa")===!0&&a.contains("foo")===!1},Ai}var Di,Hn;function oo(){if(Hn)return Di;Hn=1;var a=String.prototype.indexOf;return Di=function(e){return a.call(this,e,arguments[1])>-1},Di}var Ci,Vn;function uo(){return Vn||(Vn=1,Ci=ao()()?String.prototype.contains:oo()),Ci}var $n;function lo(){if($n)return ui.exports;$n=1;var a=Ws(),e=Ya(),t=no(),r=so(),i=uo(),n=ui.exports=function(s,o){var u,f,d,p,b;return arguments.length<2||typeof s!="string"?(p=o,o=s,s=null):p=arguments[2],a(s)?(u=i.call(s,"c"),f=i.call(s,"e"),d=i.call(s,"w")):(u=d=!0,f=!1),b={value:o,configurable:u,enumerable:f,writable:d},p?t(r(p),b):b};return n.gs=function(s,o,u){var f,d,p,b;return typeof s!="string"?(p=u,u=o,o=s,s=null):p=arguments[3],a(o)?e(o)?a(u)?e(u)||(p=u,u=void 0):u=void 0:(p=o,o=u=void 0):o=void 0,a(s)?(f=i.call(s,"c"),d=i.call(s,"e")):(f=!0,d=!1),b={get:o,set:u,configurable:f,enumerable:d},p?t(r(p),b):b},ui.exports}var Si,Gn;function co(){return Gn||(Gn=1,Si=function(a){if(typeof a!="function")throw new TypeError(a+" is not a function");return a}),Si}var Zn;function ho(){return Zn||(Zn=1,(function(a,e){var t=lo(),r=co(),i=Function.prototype.apply,n=Function.prototype.call,s=Object.create,o=Object.defineProperty,u=Object.defineProperties,f=Object.prototype.hasOwnProperty,d={configurable:!0,enumerable:!1,writable:!0},p,b,y,S,_,h,v;p=function(m,D){var O;return r(D),f.call(this,"__ee__")?O=this.__ee__:(O=d.value=s(null),o(this,"__ee__",d),d.value=null),O[m]?typeof O[m]=="object"?O[m].push(D):O[m]=[O[m],D]:O[m]=D,this},b=function(m,D){var O,E;return r(D),E=this,p.call(this,m,O=function(){y.call(E,m,O),i.call(D,this,arguments)}),O.__eeOnceListener__=D,this},y=function(m,D){var O,E,k,N;if(r(D),!f.call(this,"__ee__"))return this;if(O=this.__ee__,!O[m])return this;if(E=O[m],typeof E=="object")for(N=0;k=E[N];++N)(k===D||k.__eeOnceListener__===D)&&(E.length===2?O[m]=E[N?0:1]:E.splice(N,1));else(E===D||E.__eeOnceListener__===D)&&delete O[m];return this},S=function(m){var D,O,E,k,N;if(f.call(this,"__ee__")&&(k=this.__ee__[m],!!k))if(typeof k=="object"){for(O=arguments.length,N=new Array(O-1),D=1;D<O;++D)N[D-1]=arguments[D];for(k=k.slice(),D=0;E=k[D];++D)i.call(E,this,N)}else switch(arguments.length){case 1:n.call(k,this);break;case 2:n.call(k,this,arguments[1]);break;case 3:n.call(k,this,arguments[1],arguments[2]);break;default:for(O=arguments.length,N=new Array(O-1),D=1;D<O;++D)N[D-1]=arguments[D];i.call(k,this,N)}},_={on:p,once:b,off:y,emit:S},h={on:t(p),once:t(b),off:t(y),emit:t(S)},v=u({},h),a.exports=e=function(m){return m==null?s(v):u(Object(m),h)},e.methods=_})(Rr,Rr.exports)),Rr.exports}var fo=ho();const Ut=hr(fo);var gr={},jt={},Qt={},Xn;function Zr(){if(Xn)return Qt;Xn=1;function a(i,n,s){if(s===void 0&&(s=Array.prototype),i&&typeof s.find=="function")return s.find.call(i,n);for(var o=0;o<i.length;o++)if(Object.prototype.hasOwnProperty.call(i,o)){var u=i[o];if(n.call(void 0,u,o,i))return u}}function e(i,n){return n===void 0&&(n=Object),n&&typeof n.freeze=="function"?n.freeze(i):i}var t=e({HTML:"text/html",isHTML:function(i){return i===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Qt.find=a,Qt.freeze=e,Qt.MIME_TYPE=t,Qt.NAMESPACE=r,Qt}var Yn;function Hs(){if(Yn)return jt;Yn=1;var a=Zr(),e=a.find,t=a.NAMESPACE;function r(g){return g!==""}function i(g){return g?g.split(/[\t\n\f\r ]+/).filter(r):[]}function n(g,l){return g.hasOwnProperty(l)||(g[l]=!0),g}function s(g){if(!g)return[];var l=i(g);return Object.keys(l.reduce(n,{}))}function o(g){return function(l){return g&&g.indexOf(l)!==-1}}function u(g,l){for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(l[A]=g[A])}function f(g,l){var A=g.prototype;if(!(A instanceof l)){let M=function(){};M.prototype=l.prototype,M=new M,u(A,M),g.prototype=A=M}A.constructor!=g&&(typeof g!="function"&&console.error("unknown Class:"+g),A.constructor=g)}var d={},p=d.ELEMENT_NODE=1,b=d.ATTRIBUTE_NODE=2,y=d.TEXT_NODE=3,S=d.CDATA_SECTION_NODE=4,_=d.ENTITY_REFERENCE_NODE=5,h=d.ENTITY_NODE=6,v=d.PROCESSING_INSTRUCTION_NODE=7,m=d.COMMENT_NODE=8,D=d.DOCUMENT_NODE=9,O=d.DOCUMENT_TYPE_NODE=10,E=d.DOCUMENT_FRAGMENT_NODE=11,k=d.NOTATION_NODE=12,N={},B={};N.INDEX_SIZE_ERR=(B[1]="Index size error",1),N.DOMSTRING_SIZE_ERR=(B[2]="DOMString size error",2);var I=N.HIERARCHY_REQUEST_ERR=(B[3]="Hierarchy request error",3);N.WRONG_DOCUMENT_ERR=(B[4]="Wrong document",4),N.INVALID_CHARACTER_ERR=(B[5]="Invalid character",5),N.NO_DATA_ALLOWED_ERR=(B[6]="No data allowed",6),N.NO_MODIFICATION_ALLOWED_ERR=(B[7]="No modification allowed",7);var L=N.NOT_FOUND_ERR=(B[8]="Not found",8);N.NOT_SUPPORTED_ERR=(B[9]="Not supported",9);var K=N.INUSE_ATTRIBUTE_ERR=(B[10]="Attribute in use",10);N.INVALID_STATE_ERR=(B[11]="Invalid state",11),N.SYNTAX_ERR=(B[12]="Syntax error",12),N.INVALID_MODIFICATION_ERR=(B[13]="Invalid modification",13),N.NAMESPACE_ERR=(B[14]="Invalid namespace",14),N.INVALID_ACCESS_ERR=(B[15]="Invalid access",15);function $(g,l){if(l instanceof Error)var A=l;else A=this,Error.call(this,B[g]),this.message=B[g],Error.captureStackTrace&&Error.captureStackTrace(this,$);return A.code=g,l&&(this.message=this.message+": "+l),A}$.prototype=Error.prototype,u(N,$);function J(){}J.prototype={length:0,item:function(g){return g>=0&&g<this.length?this[g]:null},toString:function(g,l){for(var A=[],M=0;M<this.length;M++)Z(this[M],A,g,l);return A.join("")},filter:function(g){return Array.prototype.filter.call(this,g)},indexOf:function(g){return Array.prototype.indexOf.call(this,g)}};function ne(g,l){this._node=g,this._refresh=l,ae(this)}function ae(g){var l=g._node._inc||g._node.ownerDocument._inc;if(g._inc!==l){var A=g._refresh(g._node);if(T(g,"length",A.length),!g.$$length||A.length<g.$$length)for(var M=A.length;M in g;M++)Object.prototype.hasOwnProperty.call(g,M)&&delete g[M];u(A,g),g._inc=l}}ne.prototype.item=function(g){return ae(this),this[g]||null},f(ne,J);function le(){}function se(g,l){for(var A=g.length;A--;)if(g[A]===l)return A}function ie(g,l,A,M){if(M?l[se(l,M)]=A:l[l.length++]=A,g){A.ownerElement=g;var c=g.ownerDocument;c&&(M&&Ge(c,g,M),Ne(c,g,A))}}function pe(g,l,A){var M=se(l,A);if(M>=0){for(var c=l.length-1;M<c;)l[M]=l[++M];if(l.length=c,g){var q=g.ownerDocument;q&&(Ge(q,g,A),A.ownerElement=null)}}else throw new $(L,new Error(g.tagName+"@"+A))}le.prototype={length:0,item:J.prototype.item,getNamedItem:function(g){for(var l=this.length;l--;){var A=this[l];if(A.nodeName==g)return A}},setNamedItem:function(g){var l=g.ownerElement;if(l&&l!=this._ownerElement)throw new $(K);var A=this.getNamedItem(g.nodeName);return ie(this._ownerElement,this,g,A),A},setNamedItemNS:function(g){var l=g.ownerElement,A;if(l&&l!=this._ownerElement)throw new $(K);return A=this.getNamedItemNS(g.namespaceURI,g.localName),ie(this._ownerElement,this,g,A),A},removeNamedItem:function(g){var l=this.getNamedItem(g);return pe(this._ownerElement,this,l),l},removeNamedItemNS:function(g,l){var A=this.getNamedItemNS(g,l);return pe(this._ownerElement,this,A),A},getNamedItemNS:function(g,l){for(var A=this.length;A--;){var M=this[A];if(M.localName==l&&M.namespaceURI==g)return M}return null}};function Ee(){}Ee.prototype={hasFeature:function(g,l){return!0},createDocument:function(g,l,A){var M=new we;if(M.implementation=this,M.childNodes=new J,M.doctype=A||null,A&&M.appendChild(A),l){var c=M.createElementNS(g,l);M.appendChild(c)}return M},createDocumentType:function(g,l,A){var M=new Qe;return M.name=g,M.nodeName=g,M.publicId=l||"",M.systemId=A||"",M}};function ue(){}ue.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(g,l){return rt(this,g,l)},replaceChild:function(g,l){rt(this,g,l,Je),l&&this.removeChild(l)},removeChild:function(g){return _e(this,g)},appendChild:function(g){return this.insertBefore(g,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(g){return te(this.ownerDocument||this,this,g)},normalize:function(){for(var g=this.firstChild;g;){var l=g.nextSibling;l&&l.nodeType==y&&g.nodeType==y?(this.removeChild(l),g.appendData(l.data)):(g.normalize(),g=l)}},isSupported:function(g,l){return this.ownerDocument.implementation.hasFeature(g,l)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(g){for(var l=this;l;){var A=l._nsMap;if(A){for(var M in A)if(Object.prototype.hasOwnProperty.call(A,M)&&A[M]===g)return M}l=l.nodeType==b?l.ownerDocument:l.parentNode}return null},lookupNamespaceURI:function(g){for(var l=this;l;){var A=l._nsMap;if(A&&g in A&&Object.prototype.hasOwnProperty.call(A,g))return A[g];l=l.nodeType==b?l.ownerDocument:l.parentNode}return null},isDefaultNamespace:function(g){var l=this.lookupPrefix(g);return l==null}};function ve(g){return g=="<"&&"&lt;"||g==">"&&"&gt;"||g=="&"&&"&amp;"||g=='"'&&"&quot;"||"&#"+g.charCodeAt()+";"}u(d,ue),u(d,ue.prototype);function Te(g,l){if(l(g))return!0;if(g=g.firstChild)do if(Te(g,l))return!0;while(g=g.nextSibling)}function we(){this.ownerDocument=this}function Ne(g,l,A){g&&g._inc++;var M=A.namespaceURI;M===t.XMLNS&&(l._nsMap[A.prefix?A.localName:""]=A.value)}function Ge(g,l,A,M){g&&g._inc++;var c=A.namespaceURI;c===t.XMLNS&&delete l._nsMap[A.prefix?A.localName:""]}function Ve(g,l,A){if(g&&g._inc){g._inc++;var M=l.childNodes;if(A)M[M.length++]=A;else{for(var c=l.firstChild,q=0;c;)M[q++]=c,c=c.nextSibling;M.length=q,delete M[M.length]}}}function _e(g,l){var A=l.previousSibling,M=l.nextSibling;return A?A.nextSibling=M:g.firstChild=M,M?M.previousSibling=A:g.lastChild=A,l.parentNode=null,l.previousSibling=null,l.nextSibling=null,Ve(g.ownerDocument,g),l}function We(g){return g&&(g.nodeType===ue.DOCUMENT_NODE||g.nodeType===ue.DOCUMENT_FRAGMENT_NODE||g.nodeType===ue.ELEMENT_NODE)}function Ie(g){return g&&(Be(g)||Ae(g)||ke(g)||g.nodeType===ue.DOCUMENT_FRAGMENT_NODE||g.nodeType===ue.COMMENT_NODE||g.nodeType===ue.PROCESSING_INSTRUCTION_NODE)}function ke(g){return g&&g.nodeType===ue.DOCUMENT_TYPE_NODE}function Be(g){return g&&g.nodeType===ue.ELEMENT_NODE}function Ae(g){return g&&g.nodeType===ue.TEXT_NODE}function ze(g,l){var A=g.childNodes||[];if(e(A,Be)||ke(l))return!1;var M=e(A,ke);return!(l&&M&&A.indexOf(M)>A.indexOf(l))}function Ue(g,l){var A=g.childNodes||[];function M(q){return Be(q)&&q!==l}if(e(A,M))return!1;var c=e(A,ke);return!(l&&c&&A.indexOf(c)>A.indexOf(l))}function He(g,l,A){if(!We(g))throw new $(I,"Unexpected parent node type "+g.nodeType);if(A&&A.parentNode!==g)throw new $(L,"child not in parent");if(!Ie(l)||ke(l)&&g.nodeType!==ue.DOCUMENT_NODE)throw new $(I,"Unexpected node type "+l.nodeType+" for parent node type "+g.nodeType)}function Le(g,l,A){var M=g.childNodes||[],c=l.childNodes||[];if(l.nodeType===ue.DOCUMENT_FRAGMENT_NODE){var q=c.filter(Be);if(q.length>1||e(c,Ae))throw new $(I,"More than one element or text in fragment");if(q.length===1&&!ze(g,A))throw new $(I,"Element in fragment can not be inserted before doctype")}if(Be(l)&&!ze(g,A))throw new $(I,"Only one element can be added and only after doctype");if(ke(l)){if(e(M,ke))throw new $(I,"Only one doctype is allowed");var W=e(M,Be);if(A&&M.indexOf(W)<M.indexOf(A))throw new $(I,"Doctype can only be inserted before an element");if(!A&&W)throw new $(I,"Doctype can not be appended since element is present")}}function Je(g,l,A){var M=g.childNodes||[],c=l.childNodes||[];if(l.nodeType===ue.DOCUMENT_FRAGMENT_NODE){var q=c.filter(Be);if(q.length>1||e(c,Ae))throw new $(I,"More than one element or text in fragment");if(q.length===1&&!Ue(g,A))throw new $(I,"Element in fragment can not be inserted before doctype")}if(Be(l)&&!Ue(g,A))throw new $(I,"Only one element can be added and only after doctype");if(ke(l)){if(e(M,function(F){return ke(F)&&F!==A}))throw new $(I,"Only one doctype is allowed");var W=e(M,Be);if(A&&M.indexOf(W)<M.indexOf(A))throw new $(I,"Doctype can only be inserted before an element")}}function rt(g,l,A,M){He(g,l,A),g.nodeType===ue.DOCUMENT_NODE&&(M||Le)(g,l,A);var c=l.parentNode;if(c&&c.removeChild(l),l.nodeType===E){var q=l.firstChild;if(q==null)return l;var W=l.lastChild}else q=W=l;var x=A?A.previousSibling:g.lastChild;q.previousSibling=x,W.nextSibling=A,x?x.nextSibling=q:g.firstChild=q,A==null?g.lastChild=W:A.previousSibling=W;do q.parentNode=g;while(q!==W&&(q=q.nextSibling));return Ve(g.ownerDocument||g,g),l.nodeType==E&&(l.firstChild=l.lastChild=null),l}function et(g,l){return l.parentNode&&l.parentNode.removeChild(l),l.parentNode=g,l.previousSibling=g.lastChild,l.nextSibling=null,l.previousSibling?l.previousSibling.nextSibling=l:g.firstChild=l,g.lastChild=l,Ve(g.ownerDocument,g,l),l}we.prototype={nodeName:"#document",nodeType:D,doctype:null,documentElement:null,_inc:1,insertBefore:function(g,l){if(g.nodeType==E){for(var A=g.firstChild;A;){var M=A.nextSibling;this.insertBefore(A,l),A=M}return g}return rt(this,g,l),g.ownerDocument=this,this.documentElement===null&&g.nodeType===p&&(this.documentElement=g),g},removeChild:function(g){return this.documentElement==g&&(this.documentElement=null),_e(this,g)},replaceChild:function(g,l){rt(this,g,l,Je),g.ownerDocument=this,l&&this.removeChild(l),Be(g)&&(this.documentElement=g)},importNode:function(g,l){return Y(this,g,l)},getElementById:function(g){var l=null;return Te(this.documentElement,function(A){if(A.nodeType==p&&A.getAttribute("id")==g)return l=A,!0}),l},getElementsByClassName:function(g){var l=s(g);return new ne(this,function(A){var M=[];return l.length>0&&Te(A.documentElement,function(c){if(c!==A&&c.nodeType===p){var q=c.getAttribute("class");if(q){var W=g===q;if(!W){var x=s(q);W=l.every(o(x))}W&&M.push(c)}}}),M})},createElement:function(g){var l=new De;l.ownerDocument=this,l.nodeName=g,l.tagName=g,l.localName=g,l.childNodes=new J;var A=l.attributes=new le;return A._ownerElement=l,l},createDocumentFragment:function(){var g=new bt;return g.ownerDocument=this,g.childNodes=new J,g},createTextNode:function(g){var l=new it;return l.ownerDocument=this,l.appendData(g),l},createComment:function(g){var l=new mt;return l.ownerDocument=this,l.appendData(g),l},createCDATASection:function(g){var l=new dt;return l.ownerDocument=this,l.appendData(g),l},createProcessingInstruction:function(g,l){var A=new P;return A.ownerDocument=this,A.tagName=A.nodeName=A.target=g,A.nodeValue=A.data=l,A},createAttribute:function(g){var l=new Se;return l.ownerDocument=this,l.name=g,l.nodeName=g,l.localName=g,l.specified=!0,l},createEntityReference:function(g){var l=new ht;return l.ownerDocument=this,l.nodeName=g,l},createElementNS:function(g,l){var A=new De,M=l.split(":"),c=A.attributes=new le;return A.childNodes=new J,A.ownerDocument=this,A.nodeName=l,A.tagName=l,A.namespaceURI=g,M.length==2?(A.prefix=M[0],A.localName=M[1]):A.localName=l,c._ownerElement=A,A},createAttributeNS:function(g,l){var A=new Se,M=l.split(":");return A.ownerDocument=this,A.nodeName=l,A.name=l,A.namespaceURI=g,A.specified=!0,M.length==2?(A.prefix=M[0],A.localName=M[1]):A.localName=l,A}},f(we,ue);function De(){this._nsMap={}}De.prototype={nodeType:p,hasAttribute:function(g){return this.getAttributeNode(g)!=null},getAttribute:function(g){var l=this.getAttributeNode(g);return l&&l.value||""},getAttributeNode:function(g){return this.attributes.getNamedItem(g)},setAttribute:function(g,l){var A=this.ownerDocument.createAttribute(g);A.value=A.nodeValue=""+l,this.setAttributeNode(A)},removeAttribute:function(g){var l=this.getAttributeNode(g);l&&this.removeAttributeNode(l)},appendChild:function(g){return g.nodeType===E?this.insertBefore(g,null):et(this,g)},setAttributeNode:function(g){return this.attributes.setNamedItem(g)},setAttributeNodeNS:function(g){return this.attributes.setNamedItemNS(g)},removeAttributeNode:function(g){return this.attributes.removeNamedItem(g.nodeName)},removeAttributeNS:function(g,l){var A=this.getAttributeNodeNS(g,l);A&&this.removeAttributeNode(A)},hasAttributeNS:function(g,l){return this.getAttributeNodeNS(g,l)!=null},getAttributeNS:function(g,l){var A=this.getAttributeNodeNS(g,l);return A&&A.value||""},setAttributeNS:function(g,l,A){var M=this.ownerDocument.createAttributeNS(g,l);M.value=M.nodeValue=""+A,this.setAttributeNode(M)},getAttributeNodeNS:function(g,l){return this.attributes.getNamedItemNS(g,l)},getElementsByTagName:function(g){return new ne(this,function(l){var A=[];return Te(l,function(M){M!==l&&M.nodeType==p&&(g==="*"||M.tagName==g)&&A.push(M)}),A})},getElementsByTagNameNS:function(g,l){return new ne(this,function(A){var M=[];return Te(A,function(c){c!==A&&c.nodeType===p&&(g==="*"||c.namespaceURI===g)&&(l==="*"||c.localName==l)&&M.push(c)}),M})}},we.prototype.getElementsByTagName=De.prototype.getElementsByTagName,we.prototype.getElementsByTagNameNS=De.prototype.getElementsByTagNameNS,f(De,ue);function Se(){}Se.prototype.nodeType=b,f(Se,ue);function xe(){}xe.prototype={data:"",substringData:function(g,l){return this.data.substring(g,g+l)},appendData:function(g){g=this.data+g,this.nodeValue=this.data=g,this.length=g.length},insertData:function(g,l){this.replaceData(g,0,l)},appendChild:function(g){throw new Error(B[I])},deleteData:function(g,l){this.replaceData(g,l,"")},replaceData:function(g,l,A){var M=this.data.substring(0,g),c=this.data.substring(g+l);A=M+A+c,this.nodeValue=this.data=A,this.length=A.length}},f(xe,ue);function it(){}it.prototype={nodeName:"#text",nodeType:y,splitText:function(g){var l=this.data,A=l.substring(g);l=l.substring(0,g),this.data=this.nodeValue=l,this.length=l.length;var M=this.ownerDocument.createTextNode(A);return this.parentNode&&this.parentNode.insertBefore(M,this.nextSibling),M}},f(it,xe);function mt(){}mt.prototype={nodeName:"#comment",nodeType:m},f(mt,xe);function dt(){}dt.prototype={nodeName:"#cdata-section",nodeType:S},f(dt,xe);function Qe(){}Qe.prototype.nodeType=O,f(Qe,ue);function yt(){}yt.prototype.nodeType=k,f(yt,ue);function wt(){}wt.prototype.nodeType=h,f(wt,ue);function ht(){}ht.prototype.nodeType=_,f(ht,ue);function bt(){}bt.prototype.nodeName="#document-fragment",bt.prototype.nodeType=E,f(bt,ue);function P(){}P.prototype.nodeType=v,f(P,ue);function z(){}z.prototype.serializeToString=function(g,l,A){return V.call(g,l,A)},ue.prototype.toString=V;function V(g,l){var A=[],M=this.nodeType==9&&this.documentElement||this,c=M.prefix,q=M.namespaceURI;if(q&&c==null){var c=M.lookupPrefix(q);if(c==null)var W=[{namespace:q,prefix:null}]}return Z(this,A,g,l,W),A.join("")}function Q(g,l,A){var M=g.prefix||"",c=g.namespaceURI;if(!c||M==="xml"&&c===t.XML||c===t.XMLNS)return!1;for(var q=A.length;q--;){var W=A[q];if(W.prefix===M)return W.namespace!==c}return!0}function w(g,l,A){g.push(" ",l,'="',A.replace(/[<&"]/g,ve),'"')}function Z(g,l,A,M,c){if(c||(c=[]),M)if(g=M(g),g){if(typeof g=="string"){l.push(g);return}}else return;switch(g.nodeType){case p:var q=g.attributes,W=q.length,Fe=g.firstChild,x=g.tagName;A=t.isHTML(g.namespaceURI)||A;var F=x;if(!A&&!g.prefix&&g.namespaceURI){for(var X,me=0;me<q.length;me++)if(q.item(me).name==="xmlns"){X=q.item(me).value;break}if(!X)for(var fe=c.length-1;fe>=0;fe--){var ge=c[fe];if(ge.prefix===""&&ge.namespace===g.namespaceURI){X=ge.namespace;break}}if(X!==g.namespaceURI)for(var fe=c.length-1;fe>=0;fe--){var ge=c[fe];if(ge.namespace===g.namespaceURI){ge.prefix&&(F=ge.prefix+":"+x);break}}}l.push("<",F);for(var Re=0;Re<W;Re++){var nt=q.item(Re);nt.prefix=="xmlns"?c.push({prefix:nt.localName,namespace:nt.value}):nt.nodeName=="xmlns"&&c.push({prefix:"",namespace:nt.value})}for(var Re=0;Re<W;Re++){var nt=q.item(Re);if(Q(nt,A,c)){var $e=nt.prefix||"",Oe=nt.namespaceURI;w(l,$e?"xmlns:"+$e:"xmlns",Oe),c.push({prefix:$e,namespace:Oe})}Z(nt,l,A,M,c)}if(x===F&&Q(g,A,c)){var $e=g.prefix||"",Oe=g.namespaceURI;w(l,$e?"xmlns:"+$e:"xmlns",Oe),c.push({prefix:$e,namespace:Oe})}if(Fe||A&&!/^(?:meta|link|img|br|hr|input)$/i.test(x)){if(l.push(">"),A&&/^script$/i.test(x))for(;Fe;)Fe.data?l.push(Fe.data):Z(Fe,l,A,M,c.slice()),Fe=Fe.nextSibling;else for(;Fe;)Z(Fe,l,A,M,c.slice()),Fe=Fe.nextSibling;l.push("</",F,">")}else l.push("/>");return;case D:case E:for(var Fe=g.firstChild;Fe;)Z(Fe,l,A,M,c.slice()),Fe=Fe.nextSibling;return;case b:return w(l,g.name,g.value);case y:return l.push(g.data.replace(/[<&]/g,ve).replace(/]]>/g,"]]&gt;"));case S:return l.push("<![CDATA[",g.data,"]]>");case m:return l.push("<!--",g.data,"-->");case O:var ot=g.publicId,tt=g.systemId;if(l.push("<!DOCTYPE ",g.name),ot)l.push(" PUBLIC ",ot),tt&&tt!="."&&l.push(" ",tt),l.push(">");else if(tt&&tt!=".")l.push(" SYSTEM ",tt,">");else{var Mt=g.internalSubset;Mt&&l.push(" [",Mt,"]"),l.push(">")}return;case v:return l.push("<?",g.target," ",g.data,"?>");case _:return l.push("&",g.nodeName,";");default:l.push("??",g.nodeName)}}function Y(g,l,A){var M;switch(l.nodeType){case p:M=l.cloneNode(!1),M.ownerDocument=g;case E:break;case b:A=!0;break}if(M||(M=l.cloneNode(!1)),M.ownerDocument=g,M.parentNode=null,A)for(var c=l.firstChild;c;)M.appendChild(Y(g,c,A)),c=c.nextSibling;return M}function te(g,l,A){var M=new l.constructor;for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var q=l[c];typeof q!="object"&&q!=M[c]&&(M[c]=q)}switch(l.childNodes&&(M.childNodes=new J),M.ownerDocument=g,M.nodeType){case p:var W=l.attributes,x=M.attributes=new le,F=W.length;x._ownerElement=M;for(var X=0;X<F;X++)M.setAttributeNode(te(g,W.item(X),!0));break;case b:A=!0}if(A)for(var me=l.firstChild;me;)M.appendChild(te(g,me,A)),me=me.nextSibling;return M}function T(g,l,A){g[l]=A}try{if(Object.defineProperty){let g=function(l){switch(l.nodeType){case p:case E:var A=[];for(l=l.firstChild;l;)l.nodeType!==7&&l.nodeType!==8&&A.push(g(l)),l=l.nextSibling;return A.join("");default:return l.nodeValue}};Object.defineProperty(ne.prototype,"length",{get:function(){return ae(this),this.$$length}}),Object.defineProperty(ue.prototype,"textContent",{get:function(){return g(this)},set:function(l){switch(this.nodeType){case p:case E:for(;this.firstChild;)this.removeChild(this.firstChild);(l||String(l))&&this.appendChild(this.ownerDocument.createTextNode(l));break;default:this.data=l,this.value=l,this.nodeValue=l}}}),T=function(l,A,M){l["$$"+A]=M}}}catch{}return jt.DocumentType=Qe,jt.DOMException=$,jt.DOMImplementation=Ee,jt.Element=De,jt.Node=ue,jt.NodeList=J,jt.XMLSerializer=z,jt}var er={},Ti={},Kn;function po(){return Kn||(Kn=1,(function(a){var e=Zr().freeze;a.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),a.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),a.entityMap=a.HTML_ENTITIES})(Ti)),Ti}var Nr={},Jn;function go(){if(Jn)return Nr;Jn=1;var a=Zr().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),i=0,n=1,s=2,o=3,u=4,f=5,d=6,p=7;function b(I,L){this.message=I,this.locator=L,Error.captureStackTrace&&Error.captureStackTrace(this,b)}b.prototype=new Error,b.prototype.name=b.name;function y(){}y.prototype={parse:function(I,L,K){var $=this.domBuilder;$.startDocument(),O(L,L={}),S(I,L,K,$,this.errorHandler),$.endDocument()}};function S(I,L,K,$,J){function ne(De){if(De>65535){De-=65536;var Se=55296+(De>>10),xe=56320+(De&1023);return String.fromCharCode(Se,xe)}else return String.fromCharCode(De)}function ae(De){var Se=De.slice(1,-1);return Se in K?K[Se]:Se.charAt(0)==="#"?ne(parseInt(Se.substr(1).replace("x","0x"))):(J.error("entity not found:"+De),De)}function le(De){if(De>we){var Se=I.substring(we,De).replace(/&#?\w+;/g,ae);ue&&se(we),$.characters(Se,0,De-we),we=De}}function se(De,Se){for(;De>=pe&&(Se=Ee.exec(I));)ie=Se.index,pe=ie+Se[0].length,ue.lineNumber++;ue.columnNumber=De-ie+1}for(var ie=0,pe=0,Ee=/.*(?:\r\n?|\n)|.*$/g,ue=$.locator,ve=[{currentNSMap:L}],Te={},we=0;;){try{var Ne=I.indexOf("<",we);if(Ne<0){if(!I.substr(we).match(/^\s*$/)){var Ge=$.doc,Ve=Ge.createTextNode(I.substr(we));Ge.appendChild(Ve),$.currentElement=Ve}return}switch(Ne>we&&le(Ne),I.charAt(Ne+1)){case"/":var He=I.indexOf(">",Ne+3),_e=I.substring(Ne+2,He).replace(/[ \t\n\r]+$/g,""),We=ve.pop();He<0?(_e=I.substring(Ne+2).replace(/[\s<].*/,""),J.error("end tag name: "+_e+" is not complete:"+We.tagName),He=Ne+1+_e.length):_e.match(/\s</)&&(_e=_e.replace(/[\s<].*/,""),J.error("end tag name: "+_e+" maybe not complete"),He=Ne+1+_e.length);var Ie=We.localNSMap,ke=We.tagName==_e,Be=ke||We.tagName&&We.tagName.toLowerCase()==_e.toLowerCase();if(Be){if($.endElement(We.uri,We.localName,_e),Ie)for(var Ae in Ie)Object.prototype.hasOwnProperty.call(Ie,Ae)&&$.endPrefixMapping(Ae);ke||J.fatalError("end tag name: "+_e+" is not match the current start tagName:"+We.tagName)}else ve.push(We);He++;break;case"?":ue&&se(Ne),He=k(I,Ne,$);break;case"!":ue&&se(Ne),He=E(I,Ne,$,J);break;default:ue&&se(Ne);var ze=new N,Ue=ve[ve.length-1].currentNSMap,He=h(I,Ne,ze,Ue,ae,J),Le=ze.length;if(!ze.closed&&D(I,He,ze.tagName,Te)&&(ze.closed=!0,K.nbsp||J.warning("unclosed xml attribute")),ue&&Le){for(var Je=_(ue,{}),rt=0;rt<Le;rt++){var et=ze[rt];se(et.offset),et.locator=_(ue,{})}$.locator=Je,v(ze,$,Ue)&&ve.push(ze),$.locator=ue}else v(ze,$,Ue)&&ve.push(ze);a.isHTML(ze.uri)&&!ze.closed?He=m(I,He,ze.tagName,ae,$):He++}}catch(De){if(De instanceof b)throw De;J.error("element parse error: "+De),He=-1}He>we?we=He:le(Math.max(Ne,we)+1)}}function _(I,L){return L.lineNumber=I.lineNumber,L.columnNumber=I.columnNumber,L}function h(I,L,K,$,J,ne){function ae(ue,ve,Te){K.attributeNames.hasOwnProperty(ue)&&ne.fatalError("Attribute "+ue+" redefined"),K.addValue(ue,ve,Te)}for(var le,se,ie=++L,pe=i;;){var Ee=I.charAt(ie);switch(Ee){case"=":if(pe===n)le=I.slice(L,ie),pe=o;else if(pe===s)pe=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(pe===o||pe===n)if(pe===n&&(ne.warning('attribute value must after "="'),le=I.slice(L,ie)),L=ie+1,ie=I.indexOf(Ee,L),ie>0)se=I.slice(L,ie).replace(/&#?\w+;/g,J),ae(le,se,L-1),pe=f;else throw new Error("attribute value no end '"+Ee+"' match");else if(pe==u)se=I.slice(L,ie).replace(/&#?\w+;/g,J),ae(le,se,L),ne.warning('attribute "'+le+'" missed start quot('+Ee+")!!"),L=ie+1,pe=f;else throw new Error('attribute value must after "="');break;case"/":switch(pe){case i:K.setTagName(I.slice(L,ie));case f:case d:case p:pe=p,K.closed=!0;case u:case n:break;case s:K.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return ne.error("unexpected end of input"),pe==i&&K.setTagName(I.slice(L,ie)),ie;case">":switch(pe){case i:K.setTagName(I.slice(L,ie));case f:case d:case p:break;case u:case n:se=I.slice(L,ie),se.slice(-1)==="/"&&(K.closed=!0,se=se.slice(0,-1));case s:pe===s&&(se=le),pe==u?(ne.warning('attribute "'+se+'" missed quot(")!'),ae(le,se.replace(/&#?\w+;/g,J),L)):((!a.isHTML($[""])||!se.match(/^(?:disabled|checked|selected)$/i))&&ne.warning('attribute "'+se+'" missed value!! "'+se+'" instead!!'),ae(se,se,L));break;case o:throw new Error("attribute value missed!!")}return ie;case"":Ee=" ";default:if(Ee<=" ")switch(pe){case i:K.setTagName(I.slice(L,ie)),pe=d;break;case n:le=I.slice(L,ie),pe=s;break;case u:var se=I.slice(L,ie).replace(/&#?\w+;/g,J);ne.warning('attribute "'+se+'" missed quot(")!!'),ae(le,se,L);case f:pe=d;break}else switch(pe){case s:K.tagName,(!a.isHTML($[""])||!le.match(/^(?:disabled|checked|selected)$/i))&&ne.warning('attribute "'+le+'" missed value!! "'+le+'" instead2!!'),ae(le,le,L),L=ie,pe=n;break;case f:ne.warning('attribute space is required"'+le+'"!!');case d:pe=n,L=ie;break;case o:pe=u,L=ie;break;case p:throw new Error("elements closed character '/' and '>' must be connected to")}}ie++}}function v(I,L,K){for(var $=I.tagName,J=null,Ee=I.length;Ee--;){var ne=I[Ee],ae=ne.qName,le=ne.value,ue=ae.indexOf(":");if(ue>0)var se=ne.prefix=ae.slice(0,ue),ie=ae.slice(ue+1),pe=se==="xmlns"&&ie;else ie=ae,se=null,pe=ae==="xmlns"&&"";ne.localName=ie,pe!==!1&&(J==null&&(J={},O(K,K={})),K[pe]=J[pe]=le,ne.uri=a.XMLNS,L.startPrefixMapping(pe,le))}for(var Ee=I.length;Ee--;){ne=I[Ee];var se=ne.prefix;se&&(se==="xml"&&(ne.uri=a.XML),se!=="xmlns"&&(ne.uri=K[se||""]))}var ue=$.indexOf(":");ue>0?(se=I.prefix=$.slice(0,ue),ie=I.localName=$.slice(ue+1)):(se=null,ie=I.localName=$);var ve=I.uri=K[se||""];if(L.startElement(ve,ie,$,I),I.closed){if(L.endElement(ve,ie,$),J)for(se in J)Object.prototype.hasOwnProperty.call(J,se)&&L.endPrefixMapping(se)}else return I.currentNSMap=K,I.localNSMap=J,!0}function m(I,L,K,$,J){if(/^(?:script|textarea)$/i.test(K)){var ne=I.indexOf("</"+K+">",L),ae=I.substring(L+1,ne);if(/[&<]/.test(ae))return/^script$/i.test(K)?(J.characters(ae,0,ae.length),ne):(ae=ae.replace(/&#?\w+;/g,$),J.characters(ae,0,ae.length),ne)}return L+1}function D(I,L,K,$){var J=$[K];return J==null&&(J=I.lastIndexOf("</"+K+">"),J<L&&(J=I.lastIndexOf("</"+K)),$[K]=J),J<L}function O(I,L){for(var K in I)Object.prototype.hasOwnProperty.call(I,K)&&(L[K]=I[K])}function E(I,L,K,$){var J=I.charAt(L+2);switch(J){case"-":if(I.charAt(L+3)==="-"){var ne=I.indexOf("-->",L+4);return ne>L?(K.comment(I,L+4,ne-L-4),ne+3):($.error("Unclosed comment"),-1)}else return-1;default:if(I.substr(L+3,6)=="CDATA["){var ne=I.indexOf("]]>",L+9);return K.startCDATA(),K.characters(I,L+9,ne-L-9),K.endCDATA(),ne+3}var ae=B(I,L),le=ae.length;if(le>1&&/!doctype/i.test(ae[0][0])){var se=ae[1][0],ie=!1,pe=!1;le>3&&(/^public$/i.test(ae[2][0])?(ie=ae[3][0],pe=le>4&&ae[4][0]):/^system$/i.test(ae[2][0])&&(pe=ae[3][0]));var Ee=ae[le-1];return K.startDTD(se,ie,pe),K.endDTD(),Ee.index+Ee[0].length}}return-1}function k(I,L,K){var $=I.indexOf("?>",L);if($){var J=I.substring(L,$).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return J?(J[0].length,K.processingInstruction(J[1],J[2]),$+2):-1}return-1}function N(){this.attributeNames={}}N.prototype={setTagName:function(I){if(!r.test(I))throw new Error("invalid tagName:"+I);this.tagName=I},addValue:function(I,L,K){if(!r.test(I))throw new Error("invalid attribute:"+I);this.attributeNames[I]=this.length,this[this.length++]={qName:I,value:L,offset:K}},length:0,getLocalName:function(I){return this[I].localName},getLocator:function(I){return this[I].locator},getQName:function(I){return this[I].qName},getURI:function(I){return this[I].uri},getValue:function(I){return this[I].value}};function B(I,L){var K,$=[],J=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(J.lastIndex=L,J.exec(I);K=J.exec(I);)if($.push(K),K[1])return $}return Nr.XMLReader=y,Nr.ParseError=b,Nr}var Qn;function vo(){if(Qn)return er;Qn=1;var a=Zr(),e=Hs(),t=po(),r=go(),i=e.DOMImplementation,n=a.NAMESPACE,s=r.ParseError,o=r.XMLReader;function u(_){this.options=_||{locator:{}}}u.prototype.parseFromString=function(_,h){var v=this.options,m=new o,D=v.domBuilder||new d,O=v.errorHandler,E=v.locator,k=v.xmlns||{},N=/\/x?html?$/.test(h),B=N?t.HTML_ENTITIES:t.XML_ENTITIES;return E&&D.setDocumentLocator(E),m.errorHandler=f(O,D,E),m.domBuilder=v.domBuilder||D,N&&(k[""]=n.HTML),k.xml=k.xml||n.XML,_&&typeof _=="string"?m.parse(_,k,B):m.errorHandler.error("invalid doc source"),D.doc};function f(_,h,v){if(!_){if(h instanceof d)return h;_=h}var m={},D=_ instanceof Function;v=v||{};function O(E){var k=_[E];!k&&D&&(k=_.length==2?function(N){_(E,N)}:_),m[E]=k&&function(N){k("[xmldom "+E+"]	"+N+b(v))}||function(){}}return O("warning"),O("error"),O("fatalError"),m}function d(){this.cdata=!1}function p(_,h){h.lineNumber=_.lineNumber,h.columnNumber=_.columnNumber}d.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(_,h,v,m){var D=this.doc,O=D.createElementNS(_,v||h),E=m.length;S(this,O),this.currentElement=O,this.locator&&p(this.locator,O);for(var k=0;k<E;k++){var _=m.getURI(k),N=m.getValue(k),v=m.getQName(k),B=D.createAttributeNS(_,v);this.locator&&p(m.getLocator(k),B),B.value=B.nodeValue=N,O.setAttributeNode(B)}},endElement:function(_,h,v){var m=this.currentElement;m.tagName,this.currentElement=m.parentNode},startPrefixMapping:function(_,h){},endPrefixMapping:function(_){},processingInstruction:function(_,h){var v=this.doc.createProcessingInstruction(_,h);this.locator&&p(this.locator,v),S(this,v)},ignorableWhitespace:function(_,h,v){},characters:function(_,h,v){if(_=y.apply(this,arguments),_){if(this.cdata)var m=this.doc.createCDATASection(_);else var m=this.doc.createTextNode(_);this.currentElement?this.currentElement.appendChild(m):/^\s*$/.test(_)&&this.doc.appendChild(m),this.locator&&p(this.locator,m)}},skippedEntity:function(_){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(_){(this.locator=_)&&(_.lineNumber=0)},comment:function(_,h,v){_=y.apply(this,arguments);var m=this.doc.createComment(_);this.locator&&p(this.locator,m),S(this,m)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(_,h,v){var m=this.doc.implementation;if(m&&m.createDocumentType){var D=m.createDocumentType(_,h,v);this.locator&&p(this.locator,D),S(this,D),this.doc.doctype=D}},warning:function(_){console.warn("[xmldom warning]	"+_,b(this.locator))},error:function(_){console.error("[xmldom error]	"+_,b(this.locator))},fatalError:function(_){throw new s(_,this.locator)}};function b(_){if(_)return`
@`+(_.systemId||"")+"#[line:"+_.lineNumber+",col:"+_.columnNumber+"]"}function y(_,h,v){return typeof _=="string"?_.substr(h,v):_.length>=h+v||h?new java.lang.String(_,h,v)+"":_}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(_){d.prototype[_]=function(){return null}});function S(_,h){_.currentElement?_.currentElement.appendChild(h):_.doc.appendChild(h)}return er.__DOMHandler=d,er.DOMParser=u,er.DOMImplementation=e.DOMImplementation,er.XMLSerializer=e.XMLSerializer,er}var es;function mo(){if(es)return gr;es=1;var a=Hs();return gr.DOMImplementation=a.DOMImplementation,gr.XMLSerializer=a.XMLSerializer,gr.DOMParser=vo().DOMParser,gr}var Vs=mo();const hn=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,yo=1,wo=3,$s=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function Xr(){var a=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(a+Math.random()*16)%16|0;return a=Math.floor(a/16),(t=="x"?r:r&7|8).toString(16)});return e}function bo(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function Gs(a){return!!(a&&a.nodeType==1)}function at(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Zs(a){let e=parseFloat(a);return at(a)===!1?!1:typeof a=="string"&&a.indexOf(".")>-1?!0:Math.floor(e)!==e}function ir(a){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=a.toLowerCase(),i=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return a;for(var n=0;n<i;n++)if(typeof document.body.style[t[n]+r]<"u")return t[n]+r;return a}function Xs(a){for(var e=1,t=arguments.length;e<t;e++){var r=arguments[e];for(var i in r)a[i]===void 0&&(a[i]=r[i])}return a}function gt(a){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}),a}function _o(a,e,t){var r=lr(a,e,t);return e.splice(r,0,a),r}function lr(a,e,t,r,i){var n=r||0,s=i||e.length,o=parseInt(n+(s-n)/2),u;return t||(t=function(f,d){if(f>d)return 1;if(f<d)return-1;if(f==d)return 0}),s-n<=0?o:(u=t(e[o],a),s-n===1?u>=0?o:o+1:u===0?o:u===-1?lr(a,e,t,o,s):lr(a,e,t,n,o))}function Ur(a,e,t,r,i){var n=r||0,s=i||e.length,o=parseInt(n+(s-n)/2),u;return t||(t=function(f,d){if(f>d)return 1;if(f<d)return-1;if(f==d)return 0}),s-n<=0?-1:(u=t(e[o],a),s-n===1?u===0?o:-1:u===0?o:u===-1?Ur(a,e,t,o,s):Ur(a,e,t,n,o))}function Br(a){var e=window.getComputedStyle(a),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return t.forEach(function(s){i+=parseFloat(e[s])||0}),r.forEach(function(s){n+=parseFloat(e[s])||0}),{height:n,width:i}}function Mr(a){var e=window.getComputedStyle(a),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return t.forEach(function(s){i+=parseFloat(e[s])||0}),r.forEach(function(s){n+=parseFloat(e[s])||0}),{height:n,width:i}}function Qi(a){let e,t=a.ownerDocument;if(a.nodeType==Node.TEXT_NODE){let r=t.createRange();r.selectNodeContents(a),e=r.getBoundingClientRect()}else e=a.getBoundingClientRect();return e}function qr(){var a=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:a,bottom:e,width:a,height:e}}function fn(a,e){for(var t=a.parentNode,r=t.childNodes,i,n=-1,s=0;s<r.length&&(i=r[s],i.nodeType===e&&n++,i!=a);s++);return n}function Eo(a){return fn(a,wo)}function Ys(a){return fn(a,yo)}function _r(a){return["xml","opf","ncx"].indexOf(a)>-1}function Ks(a,e){return new Blob([a],{type:e})}function jr(a,e){var t,r=Ks(a,e);return t=$s.createObjectURL(r),t}function Js(a){return $s.revokeObjectURL(a)}function en(a,e){var t,r;if(typeof a=="string")return t=btoa(a),r="data:"+e+";base64,"+t,r}function Qs(a){return Object.prototype.toString.call(a).slice(8,-1)}function zt(a,e,t){var r,i;return typeof DOMParser>"u"||t?i=Vs.DOMParser:i=DOMParser,a.charCodeAt(0)===65279&&(a=a.slice(1)),r=new i().parseFromString(a,e),r}function Ke(a,e){var t;if(!a)throw new Error("No Element Provided");if(typeof a.querySelector<"u")return a.querySelector(e);if(t=a.getElementsByTagName(e),t.length)return t[0]}function Ht(a,e){return typeof a.querySelector<"u"?a.querySelectorAll(e):a.getElementsByTagName(e)}function nr(a,e,t){var r,i;if(typeof a.querySelector<"u"){e+="[";for(var n in t)e+=n+"~='"+t[n]+"'";return e+="]",a.querySelector(e)}else if(r=a.getElementsByTagName(e),i=Array.prototype.slice.call(r,0).filter(function(s){for(var o in t)if(s.getAttribute(o)===t[o])return!0;return!1}),i)return i[0]}function Wr(a,e){var t=a.ownerDocument||a;typeof t.createTreeWalker<"u"?ea(a,e,NodeFilter.SHOW_TEXT):dn(a,function(r){r&&r.nodeType===3&&e(r)})}function ea(a,e,t){var r=document.createTreeWalker(a,t,null,!1);let i;for(;i=r.nextNode();)e(i)}function dn(a,e){if(e(a))return!0;if(a=a.firstChild,a)do{if(dn(a,e))return!0;a=a.nextSibling}while(a)}function ta(a){return new Promise(function(e,t){var r=new FileReader;r.readAsDataURL(a),r.onloadend=function(){e(r.result)}})}function qe(){this.resolve=null,this.reject=null,this.id=Xr(),this.promise=new Promise((a,e)=>{this.resolve=a,this.reject=e}),Object.freeze(this)}function Hr(a,e,t){var r;if(typeof a.querySelector<"u"&&(r=a.querySelector(`${e}[*|type="${t}"]`)),!r||r.length===0){r=Ht(a,e);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||r[i].getAttribute("epub:type")===t)return r[i]}else return r}function tn(a){for(var e=[],t=a.childNodes,r=0;r<t.length;r++){let i=t[r];i.nodeType===1&&e.push(i)}return e}function rn(a){for(var e=[a];a;a=a.parentNode)e.unshift(a);return e}function sr(a,e,t){for(var r=[],i=a.childNodes,n=0;n<i.length;n++){let s=i[n];if(s.nodeType===1&&s.nodeName.toLowerCase()===e){if(t)return s;r.push(s)}}if(!t)return r}function xo(a,e){let t;if(!(a===null||e===""))for(t=a.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class ra{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,r=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,r),this.setEnd(t,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var r=rn(e||this.startContainer),i=rn(t||this.endContainer);if(r[0]==i[0]){for(var n=0;n<r.length;n++)if(r[n]!=i[n])return r[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const Ao=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:ra,blob2base64:ta,borders:Mr,bounds:Br,createBase64Url:en,createBlob:Ks,createBlobUrl:jr,defaults:Xs,defer:qe,documentHeight:bo,extend:gt,filterChildren:sr,findChildren:tn,getParentByTagName:xo,indexOfElementNode:Ys,indexOfNode:fn,indexOfSorted:Ur,indexOfTextNode:Eo,insert:_o,isElement:Gs,isFloat:Zs,isNumber:at,isXml:_r,locationOf:lr,nodeBounds:Qi,parents:rn,parse:zt,prefixed:ir,qs:Ke,qsa:Ht,qsp:nr,querySelectorByType:Hr,requestAnimationFrame:hn,revokeBlobUrl:Js,sprint:Wr,treeWalker:ea,type:Qs,uuid:Xr,walk:dn,windowBounds:qr},Symbol.toStringTag,{value:"Module"}));var ki,ts;function Do(){if(ts)return ki;if(ts=1,!a)var a={cwd:function(){return"/"}};function e(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function t(n,s){for(var o="",u=-1,f=0,d,p=0;p<=n.length;++p){if(p<n.length)d=n.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(u===p-1||f===1))if(u!==p-1&&f===2){if(o.length<2||o.charCodeAt(o.length-1)!==46||o.charCodeAt(o.length-2)!==46){if(o.length>2){for(var b=o.length-1,y=b;y>=0&&o.charCodeAt(y)!==47;--y);if(y!==b){y===-1?o="":o=o.slice(0,y),u=p,f=0;continue}}else if(o.length===2||o.length===1){o="",u=p,f=0;continue}}s&&(o.length>0?o+="/..":o="..")}else o.length>0?o+="/"+n.slice(u+1,p):o=n.slice(u+1,p);u=p,f=0}else d===46&&f!==-1?++f:f=-1}return o}function r(n,s){var o=s.dir||s.root,u=s.base||(s.name||"")+(s.ext||"");return o?o===s.root?o+u:o+n+u:u}var i={resolve:function(){for(var s="",o=!1,u,f=arguments.length-1;f>=-1&&!o;f--){var d;f>=0?d=arguments[f]:(u===void 0&&(u=a.cwd()),d=u),e(d),d.length!==0&&(s=d+"/"+s,o=d.charCodeAt(0)===47)}return s=t(s,!o),o?s.length>0?"/"+s:"/":s.length>0?s:"."},normalize:function(s){if(e(s),s.length===0)return".";var o=s.charCodeAt(0)===47,u=s.charCodeAt(s.length-1)===47;return s=t(s,!o),s.length===0&&!o&&(s="."),s.length>0&&u&&(s+="/"),o?"/"+s:s},isAbsolute:function(s){return e(s),s.length>0&&s.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var s,o=0;o<arguments.length;++o){var u=arguments[o];e(u),u.length>0&&(s===void 0?s=u:s+="/"+u)}return s===void 0?".":i.normalize(s)},relative:function(s,o){if(e(s),e(o),s===o||(s=i.resolve(s),o=i.resolve(o),s===o))return"";for(var u=1;u<s.length&&s.charCodeAt(u)===47;++u);for(var f=s.length,d=f-u,p=1;p<o.length&&o.charCodeAt(p)===47;++p);for(var b=o.length,y=b-p,S=d<y?d:y,_=-1,h=0;h<=S;++h){if(h===S){if(y>S){if(o.charCodeAt(p+h)===47)return o.slice(p+h+1);if(h===0)return o.slice(p+h)}else d>S&&(s.charCodeAt(u+h)===47?_=h:h===0&&(_=0));break}var v=s.charCodeAt(u+h),m=o.charCodeAt(p+h);if(v!==m)break;v===47&&(_=h)}var D="";for(h=u+_+1;h<=f;++h)(h===f||s.charCodeAt(h)===47)&&(D.length===0?D+="..":D+="/..");return D.length>0?D+o.slice(p+_):(p+=_,o.charCodeAt(p)===47&&++p,o.slice(p))},_makeLong:function(s){return s},dirname:function(s){if(e(s),s.length===0)return".";for(var o=s.charCodeAt(0),u=o===47,f=-1,d=!0,p=s.length-1;p>=1;--p)if(o=s.charCodeAt(p),o===47){if(!d){f=p;break}}else d=!1;return f===-1?u?"/":".":u&&f===1?"//":s.slice(0,f)},basename:function(s,o){if(o!==void 0&&typeof o!="string")throw new TypeError('"ext" argument must be a string');e(s);var u=0,f=-1,d=!0,p;if(o!==void 0&&o.length>0&&o.length<=s.length){if(o.length===s.length&&o===s)return"";var b=o.length-1,y=-1;for(p=s.length-1;p>=0;--p){var S=s.charCodeAt(p);if(S===47){if(!d){u=p+1;break}}else y===-1&&(d=!1,y=p+1),b>=0&&(S===o.charCodeAt(b)?--b===-1&&(f=p):(b=-1,f=y))}return u===f?f=y:f===-1&&(f=s.length),s.slice(u,f)}else{for(p=s.length-1;p>=0;--p)if(s.charCodeAt(p)===47){if(!d){u=p+1;break}}else f===-1&&(d=!1,f=p+1);return f===-1?"":s.slice(u,f)}},extname:function(s){e(s);for(var o=-1,u=0,f=-1,d=!0,p=0,b=s.length-1;b>=0;--b){var y=s.charCodeAt(b);if(y===47){if(!d){u=b+1;break}continue}f===-1&&(d=!1,f=b+1),y===46?o===-1?o=b:p!==1&&(p=1):o!==-1&&(p=-1)}return o===-1||f===-1||p===0||p===1&&o===f-1&&o===u+1?"":s.slice(o,f)},format:function(s){if(s===null||typeof s!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof s);return r("/",s)},parse:function(s){e(s);var o={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return o;var u=s.charCodeAt(0),f=u===47,d;f?(o.root="/",d=1):d=0;for(var p=-1,b=0,y=-1,S=!0,_=s.length-1,h=0;_>=d;--_){if(u=s.charCodeAt(_),u===47){if(!S){b=_+1;break}continue}y===-1&&(S=!1,y=_+1),u===46?p===-1?p=_:h!==1&&(h=1):p!==-1&&(h=-1)}return p===-1||y===-1||h===0||h===1&&p===y-1&&p===b+1?y!==-1&&(b===0&&f?o.base=o.name=s.slice(1,y):o.base=o.name=s.slice(b,y)):(b===0&&f?(o.name=s.slice(1,p),o.base=s.slice(1,y)):(o.name=s.slice(b,p),o.base=s.slice(b,y)),o.ext=s.slice(p,y)),b>0?o.dir=s.slice(0,b-1):f&&(o.dir="/"),o},sep:"/",delimiter:":",posix:null};return ki=i,ki}var Co=Do();const Gt=hr(Co);class Vt{constructor(e){var t,r;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return Gt.parse(e)}isAbsolute(e){return Gt.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Gt.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Gt.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Bt{constructor(e,t){var r=e.indexOf("://")>-1,i=e,n;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!r&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(n=new Vt(this.base),i=n.resolve(i))}this.Path=new Vt(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,r;return t?e:(r=Gt.resolve(this.directory,e),this.origin+r)}relative(e){return Gt.relative(e,this.directory)}toString(){return this.href}}const tr=1,St=3,So=9;class je{constructor(e,t,r){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof je))return new je(e,t,r);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),i=this.checkType(e),i==="string")return this.str=e,gt(this,this.parse(e));if(i==="range")return gt(this,this.fromRange(e,this.base,r));if(i==="node")return gt(this,this.fromNode(e,this.base,r));if(i==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(Qs(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof je?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,i,n;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(t.base=this.parseComponent(r),i=this.getPathComponent(e),t.path=this.parseComponent(i),n=this.getRange(e),n&&(t.range=!0,t.start=this.parseComponent(n[0]),t.end=this.parseComponent(n[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),i=r[0].split("/"),n;return r.length>1&&(n=r[1],t.terminal=this.parseTerminal(n)),i[0]===""&&i.shift(),t.steps=i.map(function(s){return this.parseStep(s)}.bind(this)),t}parseStep(e){var t,r,i,n,s;if(n=e.match(/\[(.*)\]/),n&&n[1]&&(s=n[1]),r=parseInt(e),!isNaN(r))return r%2===0?(t="element",i=r/2-1):(t="text",i=(r-1)/2),{type:t,index:i,id:s||null}}parseTerminal(e){var t,r,i=e.match(/\[(.*)\]/);return i&&i[1]?(t=parseInt(e.split("[")[0]),r=i[1]):t=parseInt(e),at(t)||(t=null),{offset:t,assertion:r}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var r="";return t.type==="element"&&(r+=(t.index+1)*2),t.type==="text"&&(r+=1+2*t.index),t.id&&(r+="["+t.id+"]"),r}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var r,i,n,s;if(typeof e=="string"&&(e=new je(e)),typeof t=="string"&&(t=new je(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),n=e.start.terminal):(r=e.path.steps,n=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),s=t.start.terminal):(i=t.path.steps,s=t.path.terminal);for(var o=0;o<r.length;o++){if(!r[o])return-1;if(!i[o]||r[o].index>i[o].index)return 1;if(r[o].index<i[o].index)return-1}return r.length<i.length?-1:n.offset>s.offset?1:n.offset<s.offset?-1:0}step(e){var t=e.nodeType===St?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var r=this.filter(e,t),i;if(r)return i=r.nodeType===St?"text":"element",{id:r.id,tagName:r.tagName,type:i,index:this.filteredPosition(r,t)}}pathTo(e,t,r){for(var i={steps:[],terminal:{offset:null,assertion:null}},n=e,s;n&&n.parentNode&&n.parentNode.nodeType!=So;)r?s=this.filteredStep(n,r):s=this.step(n),s&&i.steps.unshift(s),n=n.parentNode;return t!=null&&t>=0&&(i.terminal.offset=t,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null},n=e.startContainer,s=e.endContainer,o=e.startOffset,u=e.endOffset,f=!1;if(r&&(f=n.ownerDocument.querySelector("."+r)!=null),typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),e.collapsed)f&&(o=this.patchOffset(n,o,r)),i.path=this.pathTo(n,o,r);else{i.range=!0,f&&(o=this.patchOffset(n,o,r)),i.start=this.pathTo(n,o,r),f&&(u=this.patchOffset(s,u,r)),i.end=this.pathTo(s,u,r),i.path={steps:[],terminal:null};var d=i.start.steps.length,p;for(p=0;p<d&&this.equalStep(i.start.steps[p],i.end.steps[p]);p++)p===d-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[p]),i.range=!1):i.path.steps.push(i.start.steps[p]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),i.path=this.pathTo(e,null,r),i}filter(e,t){var r,i,n,s,o,u=!1;return e.nodeType===St?(u=!0,n=e.parentNode,r=e.parentNode.classList.contains(t)):(u=!1,r=e.classList.contains(t)),r&&u?(s=n.previousSibling,o=n.nextSibling,s&&s.nodeType===St?i=s:o&&o.nodeType===St&&(i=o),i||e):r&&!u?!1:e}patchOffset(e,t,r){if(e.nodeType!=St)throw new Error("Anchor must be a text node");var i=e,n=t;for(e.parentNode.classList.contains(r)&&(i=e.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===tr)if(i.previousSibling.classList.contains(r))n+=i.previousSibling.textContent.length;else break;else n+=i.previousSibling.textContent.length;i=i.previousSibling}return n}normalizedMap(e,t,r){var i={},n=-1,s,o=e.length,u,f;for(s=0;s<o;s++)u=e[s].nodeType,u===tr&&e[s].classList.contains(r)&&(u=St),s>0&&u===St&&f===St?i[s]=n:t===u&&(n=n+1,i[s]=n),f=u;return i}position(e){var t,r;return e.nodeType===tr?(t=e.parentNode.children,t||(t=tn(e.parentNode)),r=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),r=t.indexOf(e)),r}filteredPosition(e,t){var r,i,n;return e.nodeType===tr?(r=e.parentNode.children,n=this.normalizedMap(r,tr,t)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,r=e.parentNode.childNodes),n=this.normalizedMap(r,St,t)),i=Array.prototype.indexOf.call(r,e),n[i]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("*[position()="+i+" and @id='"+r.id+"']"):r.type==="text"?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("#"+r.id):r.type==="text"||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===St?!0:!!(t&&r.classList.contains(t))})}walkToNode(e,t,r){var i=t||document,n=i.documentElement,s,o,u=e.length,f;for(f=0;f<u&&(o=e[f],o.type==="element"?o.id?n=i.getElementById(o.id):(s=n.children||tn(n),n=s[o.index]):o.type==="text"&&(n=this.textNodes(n,r)[o.index]),!!n);f++);return n}findNode(e,t,r){var i=t||document,n,s;return!r&&typeof i.evaluate<"u"?(s=this.stepsToXpath(e),n=i.evaluate(s,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?n=this.walkToNode(e,i,r):n=this.walkToNode(e,i),n}fixMiss(e,t,r,i){var n=this.findNode(e.slice(0,-1),r,i),s=n.childNodes,o=this.normalizedMap(s,St,i),u,f,d=e[e.length-1].index;for(let p in o){if(!o.hasOwnProperty(p))return;if(o[p]===d)if(u=s[p],f=u.textContent.length,t>f)t=t-f;else{u.nodeType===tr?n=u.childNodes[0]:n=u;break}}return{container:n,offset:t}}toRange(e,t){var r=e||document,i,n,s,o,u,f=this,d,p,b=t?r.querySelector("."+t)!=null:!1,y;if(typeof r.createRange<"u"?i=r.createRange():i=new ra,f.range?(n=f.start,d=f.path.steps.concat(n.steps),o=this.findNode(d,r,b?t:null),s=f.end,p=f.path.steps.concat(s.steps),u=this.findNode(p,r,b?t:null)):(n=f.path,d=f.path.steps,o=this.findNode(f.path.steps,r,b?t:null)),o)try{n.terminal.offset!=null?i.setStart(o,n.terminal.offset):i.setStart(o,0)}catch{y=this.fixMiss(d,n.terminal.offset,r,b?t:null),i.setStart(y.container,y.offset)}else return console.log("No startContainer found for",this.toString()),null;if(u)try{s.terminal.offset!=null?i.setEnd(u,s.terminal.offset):i.setEnd(u,0)}catch{y=this.fixMiss(p,f.end.terminal.offset,r,b?t:null),i.setEnd(y.container,y.offset)}return i}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,r){var i=parseInt(t),n=(e+1)*2,s="/"+n+"/";return s+=(i+1)*2,r&&(s+="["+r+"]"),s}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class Lt{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let r=0;r<this.hooks.length;r++)if(t=this.hooks[r],t===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,t=this.context,r=[];return this.hooks.forEach(function(i){try{var n=i.apply(t,e)}catch(s){console.log(s)}n&&typeof n.then=="function"&&r.push(n)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function ia(a,e){var t,r,i=e.url,n=i.indexOf("://")>-1;a&&(r=Ke(a,"head"),t=Ke(r,"base"),t||(t=a.createElement("base"),r.insertBefore(t,r.firstChild)),!n&&window&&window.location&&(i=window.location.origin+i),t.setAttribute("href",i))}function To(a,e){var t,r,i=e.canonical;a&&(t=Ke(a,"head"),r=Ke(t,"link[rel='canonical']"),r?r.setAttribute("href",i):(r=a.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",i),t.appendChild(r)))}function ko(a,e){var t,r,i=e.idref;a&&(t=Ke(a,"head"),r=Ke(t,"link[property='dc.identifier']"),r?r.setAttribute("content",i):(r=a.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",i),t.appendChild(r)))}function Ro(a,e){var t=a.querySelectorAll("a[href]");if(t.length)for(var r=Ke(a.ownerDocument,"base"),i=r?r.getAttribute("href"):void 0,n=function(o){var u=o.getAttribute("href");if(u.indexOf("mailto:")!==0){var f=u.indexOf("://")>-1;if(f)o.setAttribute("target","_blank");else{var d;try{d=new Bt(u,i)}catch{}o.onclick=function(){return d&&d.hash?e(d.Path.path+d.hash):e(d?d.Path.path:u),!1}}}}.bind(this),s=0;s<t.length;s++)n(t[s])}function rs(a,e,t){return e.forEach(function(r,i){r&&t[i]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),a=a.replace(new RegExp(r,"g"),t[i]))}),a}function Er(a,e,t,r){var i=typeof window<"u"?window.URL:!1,n=i?"blob":"arraybuffer",s=new qe,o=new XMLHttpRequest,u=XMLHttpRequest.prototype,f;"overrideMimeType"in u||Object.defineProperty(u,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=p,o.onerror=d,o.open("GET",a,!0);for(f in r)o.setRequestHeader(f,r[f]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new Vt(a).extension),e=="blob"&&(o.responseType=n),_r(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function d(b){s.reject(b)}function p(){if(this.readyState===XMLHttpRequest.DONE){var b=!1;if((this.responseType===""||this.responseType==="document")&&(b=this.responseXML),this.status===200||this.status===0||b){var y;if(!this.response&&!b)return s.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),s.promise;if(this.status===403)return s.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),s.promise;b?y=this.responseXML:_r(e)?y=zt(this.response,"text/xml"):e=="xhtml"?y=zt(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?y=zt(this.response,"text/html"):e=="json"?y=JSON.parse(this.response):e=="blob"?i?y=this.response:y=new Blob([this.response]):y=this.response,s.resolve(y)}else s.reject({status:this.status,message:this.response,stack:new Error().stack})}}return s.promise}class No{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new Lt(this),this.hooks.content=new Lt(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||Er,r=new qe,i=r.promise;return this.contents?r.resolve(this.contents):t(this.url).then(function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){r.resolve(this.contents)}.bind(this)).catch(function(n){r.reject(n)}),i}base(){return ia(this.document,this)}render(e){var t=new qe,r=t.promise;return this.output,this.load(e).then(function(i){var n=typeof navigator<"u"&&navigator.userAgent||"",s=n.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||s?o=Vs.DOMParser:o=XMLSerializer;var u=new o;return this.output=u.serializeToString(i),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch(function(i){t.reject(i)}),r}find(e){var t=this,r=[],i=e.toLowerCase(),n=function(s){for(var o=s.textContent.toLowerCase(),u=t.document.createRange(),f,d,p=-1,b,y=150;d!=-1;)d=o.indexOf(i,p+1),d!=-1&&(u=t.document.createRange(),u.setStart(s,d),u.setEnd(s,d+i.length),f=t.cfiFromRange(u),s.textContent.length<y?b=s.textContent:(b=s.textContent.substring(d-y/2,d+y/2),b="..."+b+"..."),r.push({cfi:f,excerpt:b})),p=d};return Wr(t.document,function(s){n(s)}),r}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const i=150,n=this,s=e.toLowerCase(),o=function(p){const S=p.reduce((_,h)=>_+h.textContent,"").toLowerCase().indexOf(s);if(S!=-1){const h=S+s.length;let v=0,m=0;if(S<p[0].length){let D;for(;v<p.length-1&&(m+=p[v].length,!(h<=m));)v+=1;let O=p[0],E=p[v],k=n.document.createRange();k.setStart(O,S);let N=p.slice(0,v).reduce((I,L)=>I+L.textContent.length,0);k.setEnd(E,N>h?h:h-N),D=n.cfiFromRange(k);let B=p.slice(0,v+1).reduce((I,L)=>I+L.textContent,"");B.length>i&&(B=B.substring(S-i/2,S+i/2),B="..."+B+"..."),r.push({cfi:D,excerpt:B})}}},u=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let f,d=[];for(;f=u.nextNode();)d.push(f),d.length==t&&(o(d.slice(0,t)),d=d.slice(1,t));return d.length>0&&o(d),r}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var i=r.replace("rendition:",""),n=i.indexOf("-"),s,o;n!=-1&&(s=i.slice(0,n),o=i.slice(n+1),t[s]=o)}),t}cfiFromRange(e){return new je(e,this.cfiBase).toString()}cfiFromElement(e){return new je(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class Io{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Lt,this.hooks.content=new Lt,this.hooks.content.register(ia),this.hooks.content.register(To),this.hooks.content.register(ko),this.epubcfi=new je,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((i,n)=>{var s=this.manifest[i.idref],o;i.index=n,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=t(i.href,!0),i.canonical=r(i.href)),s&&(i.href=s.href,i.url=t(i.href,!0),i.canonical=r(i.href),s.properties.length&&i.properties.push.apply(i.properties,s.properties)),i.linear==="yes"?(i.prev=function(){let u=i.index;for(;u>0;){let f=this.get(u-1);if(f&&f.linear)return f;u-=1}}.bind(this),i.next=function(){let u=i.index;for(;u<this.spineItems.length-1;){let f=this.get(u+1);if(f&&f.linear)return f;u+=1}}.bind(this)):(i.prev=function(){},i.next=function(){}),o=new No(i,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let r=this.spineItems[t];if(r&&r.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new je(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,r){t.index=r}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class pn{constructor(e){this._q=[],this.context=e,this.tick=hn,this.running=!1,this.paused=!1}enqueue(){var e,t,r,i=[].shift.call(arguments),n=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(e=new qe,t=e.promise,r={task:i,args:n,deferred:e,promise:t}):r={promise:i},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,t,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return r=t.apply(this.context,e.args),r&&typeof r.then=="function"?r.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new qe,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new qe),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const Yr="0.3",Lr=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],ye={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class na{constructor(e,t,r){this.spine=e,this.request=t,this.pause=r||100,this.q=new pn(this),this.epubcfi=new je,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var r=new qe,i=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(i),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(i),this.pause),r.promise}.bind(this))}parse(e,t,r){var i=[],n,s=e.ownerDocument,o=Ke(s,"body"),u=0,f,d=r||this.break,p=function(b){var y=b.length,S,_=0;if(b.textContent.trim().length===0)return!1;for(u==0&&(n=this.createRange(),n.startContainer=b,n.startOffset=0),S=d-u,S>y&&(u+=y,_=y);_<y;)if(S=d-u,u===0&&(_+=1,n=this.createRange(),n.startContainer=b,n.startOffset=_),_+S>=y)u+=y-_,_=y;else{_+=S,n.endContainer=b,n.endOffset=_;let h=new je(n,t).toString();i.push(h),u=0}f=b};if(Wr(o,p.bind(this)),n&&n.startContainer&&f){n.endContainer=f,n.endOffset=f.length;let b=new je(n,t).toString();i.push(b),u=0}return i}generateFromWords(e,t,r){var i=e?new je(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(n){n.linear&&(i?n.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),n,t,i,r):this.q.enqueue(this.processWords.bind(this),n,t,i,r))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,r,i){return i&&this._locationsWords.length>=i?Promise.resolve():e.load(this.request).then(function(n){var s=new qe,o=this.parseWords(n,e,t,r),u=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=i?o.slice(0,u):o),e.unload(),this.processingTimeout=setTimeout(()=>s.resolve(o),this.pause),s.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,r,i){var n=t.cfiBase,s=[],o=e.ownerDocument,u=Ke(o,"body"),f=r,d=i?i.spinePos!==t.index:!0,p;i&&t.index===i.spinePos&&(p=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,e.ownerDocument));var b=function(y){if(!d)if(y===p)d=!0;else return!1;if(y.textContent.length<10&&y.textContent.trim().length===0)return!1;var S=this.countWords(y.textContent),_,h=0;if(S===0)return!1;for(_=f-this._wordCounter,_>S&&(this._wordCounter+=S,h=S);h<S;)if(_=f-this._wordCounter,h+_>=S)this._wordCounter+=S-h,h=S;else{h+=_;let v=new je(y,n);s.push({cfi:v.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return Wr(u,b.bind(this)),s}locationFromCfi(e){let t;return je.prototype.isCfiString(e)&&(e=new je(e)),this._locations.length===0?-1:(t=lr(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new je(this._locations[this.total]);return r.collapse(),r.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(ye.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}Ut(na.prototype);class Oo{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=Ke(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Gt.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class is{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,r,i;if(!e)throw new Error("Package File Not Found");if(t=Ke(e,"metadata"),!t)throw new Error("No Metadata Found");if(r=Ke(e,"manifest"),!r)throw new Error("No Manifest Found");if(i=Ke(e,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,i),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=Ys(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},r=Ht(e,"item"),i=Array.prototype.slice.call(r);return i.forEach(function(n){var s=n.getAttribute("id"),o=n.getAttribute("href")||"",u=n.getAttribute("media-type")||"",f=n.getAttribute("media-overlay")||"",d=n.getAttribute("properties")||"";t[s]={href:o,type:u,overlay:f,properties:d.length?d.split(" "):[]}}),t}parseSpine(e,t){var r=[],i=Ht(e,"itemref"),n=Array.prototype.slice.call(i);return n.forEach(function(s,o){var u=s.getAttribute("idref"),f=s.getAttribute("properties")||"",d=f.length?f.split(" "):[],p={id:s.getAttribute("id"),idref:u,linear:s.getAttribute("linear")||"yes",properties:d,index:o};r.push(p)}),r}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var r=e.getElementById(t);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=nr(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var r=nr(e,"item",{"media-type":"application/x-dtbncx+xml"}),i;return r||(i=t.getAttribute("toc"),i&&(r=e.querySelector(`#${i}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var t=Ke(e,"package");t.getAttribute("version");var r=nr(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var i=nr(e,"meta",{name:"cover"});if(i){var n=i.getAttribute("content"),s=e.getElementById(n);return s?s.getAttribute("href"):""}else return!1}getElementText(e,t){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),i;return!r||r.length===0?"":(i=r[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(e,t){var r=nr(e,"meta",{property:t});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((r,i)=>(r.index=i,r.linear=r.linear||"yes",r)),e.resources.forEach((r,i)=>{this.manifest[i]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,i)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Ri{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,r,i;t&&(r=Ke(e,"html"),i=Ke(e,"ncx")),t?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,r=0;r<e.length;r++)t=e[r],t.href&&(this.tocByHref[t.href]=r),t.id&&(this.tocById[t.id]=r),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,r){if(r.length===0)return;const i=r[t];if(i&&(e===i.id||e===i.href))return i;{let n;for(let s=0;s<r.length&&(n=this.getByIndex(e,t,r[s].subitems),!n);++s);return n}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=Hr(e,"nav","toc"),r=[];if(!t)return r;let i=sr(t,"ol",!0);return i&&(r=this.parseNavList(i)),r}parseNavList(e,t){const r=[];if(!e||!e.children)return r;for(let i=0;i<e.children.length;i++){const n=this.navItem(e.children[i],t);n&&r.push(n)}return r}navItem(e,t){let r=e.getAttribute("id")||void 0,i=sr(e,"a",!0)||sr(e,"span",!0);if(!i)return;let n=i.getAttribute("href")||"";r||(r=n);let s=i.textContent||"",o=[],u=sr(e,"ol",!0);return u&&(o=this.parseNavList(u,r)),{id:r,href:n,label:s,subitems:o,parent:t}}parseLandmarks(e){var t=Hr(e,"nav","landmarks"),r=t?Ht(t,"li"):[],i=r.length,n,s=[],o;if(!r||i===0)return s;for(n=0;n<i;++n)o=this.landmarkItem(r[n]),o&&(s.push(o),this.landmarksByType[o.type]=n);return s}landmarkItem(e){let t=sr(e,"a",!0);if(!t)return;let r=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=t.getAttribute("href")||"",n=t.textContent||"";return{href:i,label:n,type:r}}parseNcx(e){var t=Ht(e,"navPoint"),r=t.length,i,n={},s=[],o,u;if(!t||r===0)return s;for(i=0;i<r;++i)o=this.ncxItem(t[i]),n[o.id]=o,o.parent?(u=n[o.parent],u.subitems.push(o)):s.push(o);return s}ncxItem(e){var t=e.getAttribute("id")||!1,r=Ke(e,"content"),i=r.getAttribute("src"),n=Ke(e,"navLabel"),s=n.textContent?n.textContent:"",o=[],u=e.parentNode,f;return u&&(u.nodeName==="navPoint"||u.nodeName.split(":").slice(-1)[0]==="navPoint")&&(f=u.getAttribute("id")),{id:t,href:i,label:s,subitems:o,parent:f}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var vr={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},Bo=(function(){var a,e,t,r,i={};for(a in vr)if(vr.hasOwnProperty(a)){for(e in vr[a])if(vr[a].hasOwnProperty(e))if(t=vr[a][e],typeof t=="string")i[t]=a+"/"+e;else for(r=0;r<t.length;r++)i[t[r]]=a+"/"+e}return i})(),Lo="text/plain";function Fo(a){return a&&Bo[a.split(".").pop().toLowerCase()]||Lo}const ur={lookup:Fo};class Po{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Bt(e),r=ur.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(i=>ta(i)).then(i=>en(i,r)):this.settings.request(e,"blob").then(i=>jr(i,r))}replacements(){if(this.settings.replacements==="none")return new Promise(function(t){t(this.urls)}.bind(this));var e=this.urls.map(t=>{var r=this.settings.resolver(t);return this.createUrl(r).catch(i=>(console.error(i),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(r=>typeof r=="string"),t))}replaceCss(e,t){var r=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach(function(i){var n=this.createCssFile(i,e,t).then(function(s){var o=this.urls.indexOf(i);o>-1&&(this.replacementUrls[o]=s)}.bind(this));r.push(n)}.bind(this)),Promise.all(r)}createCssFile(e){var t;if(Gt.isAbsolute(e))return new Promise(function(s){s()});var r=this.settings.resolver(e),i;this.settings.archive?i=this.settings.archive.getText(r):i=this.settings.request(r,"text");var n=this.urls.map(s=>{var o=this.settings.resolver(s),u=new Vt(r).relative(o);return u});return i?i.then(s=>(s=rs(s,n,this.replacementUrls),this.settings.replacements==="base64"?t=en(s,"text/css"):t=jr(s,"text/css"),t),s=>new Promise(function(o){o()})):new Promise(function(s){s()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map(function(r){var i=t(r),n=new Vt(e).relative(i);return n}.bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise(function(r,i){r(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){var r;return t?r=this.relativeTo(t):r=this.urls,rs(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Ni{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new je,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=Ke(e,"html"),r=Ke(e,"ncx");if(t)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var t=Hr(e,"nav","page-list"),r=t?Ht(t,"li"):[],i=r.length,n,s=[],o;if(!r||i===0)return s;for(n=0;n<i;++n)o=this.item(r[n]),s.push(o);return s}parseNcx(e){var t=[],r=0,i,n,s,o=0;if(n=Ke(e,"pageList"),!n||(s=Ht(n,"pageTarget"),o=s.length,!s||s.length===0))return t;for(r=0;r<o;++r)i=this.ncxItem(s[r]),t.push(i);return t}ncxItem(e){var t=Ke(e,"navLabel"),r=Ke(t,"text"),i=r.textContent,n=Ke(e,"content"),s=n.getAttribute("src"),o=parseInt(i,10);return{href:s,page:o}}item(e){var t=Ke(e,"a"),r=t.getAttribute("href")||"",i=t.textContent||"",n=parseInt(i),s=r.indexOf("epubcfi"),o,u,f;return s!=-1?(o=r.split("#"),u=o[0],f=o.length>1?o[1]:!1,{cfi:f,href:r,packageUrl:u,page:n}):{href:r,page:n}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var r=Ur(e,this.locations,this.epubcfi.compare);return r!=-1?t=this.pages[r]:(r=lr(e,this.locations,this.epubcfi.compare),t=r-1>=0?this.pages[r-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(t=this.locations[r]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),r=this.percentageFromPage(t);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class sa{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,r){var i=1,n=r||0,s=e,o=t,u=Math.floor(s/12),f,d,p,b;this._spread&&s>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(n=u%2===0?u:u-1),this.name==="pre-paginated"&&(n=0),i>1?(f=s/i-n,p=f+n):(f=s,p=s),this.name==="pre-paginated"&&i>1&&(s=f),d=f*i+n,b=s,this.width=s,this.height=o,this.spreadWidth=d,this.pageWidth=p,this.delta=b,this.columnWidth=f,this.gap=n,this.divisor=i,this.update({width:s,height:o,spreadWidth:d,pageWidth:p,delta:b,columnWidth:f,gap:n,divisor:i})}format(e,t,r){var i;return this.name==="pre-paginated"?i=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?i=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?i=e.size(null,this.height):i=e.size(this.width,null),i}count(e,t){let r,i;return this.name==="pre-paginated"?(r=1,i=1):this._flow==="paginated"?(t=t||this.delta,r=Math.ceil(e/t),i=r*this.divisor):(t=t||this.height,r=Math.ceil(e/t),i=r),{spreads:r,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=gt(this.props,e);this.emit(ye.LAYOUT.UPDATED,t,e)}}}Ut(sa.prototype);class zo{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var r=new Bt(t);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(r=>{this.add(e,r)})}inject(e){var t=[],r=this._themes,i;for(var n in r)r.hasOwnProperty(n)&&(n===this._current||n==="default")&&(i=r[n],(i.rules&&Object.keys(i.rules).length>0||i.url&&t.indexOf(i.url)===-1)&&this.add(n,e),this._injected.push(n));this._current!="default"&&e.addClass(this._current)}add(e,t){var r=this._themes[e];!r||!t||(r.url?t.addStylesheet(r.url):r.serialized?(t.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(t.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,t,r){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:r===!0},i.forEach(n=>{n.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(r=>{r.css(e)})}overrides(e){var t=this._overrides;for(var r in t)t.hasOwnProperty(r)&&e.css(r,t[r].value,t[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class Vr{constructor(e,t,r,i=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,t);return r}page(e,t,r,i){var n=e&&e.document?e.document.body:!1,s;if(n){if(s=this.rangePairToCfiPair(t,{start:this.findStart(n,r,i),end:this.findEnd(n,r,i)}),this._dev===!0){let o=e.document,u=new je(s.start).toRange(o),f=new je(s.end).toRange(o),d=o.defaultView.getSelection(),p=o.createRange();d.removeAllRanges(),p.setStart(u.startContainer,u.startOffset),p.setEnd(f.endContainer,f.endOffset),d.addRange(p)}return s}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(u){return u.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=r.acceptNode;i.acceptNode=r.acceptNode;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1),s,o;(s=n.nextNode())&&(o=t(s),!o););return o}}findRanges(e){for(var t=[],r=e.contents.scrollWidth(),i=Math.ceil(r/this.layout.spreadWidth),n=i*this.layout.divisor,s=this.layout.columnWidth,o=this.layout.gap,u,f,d=0;d<n.pages;d++)u=(s+o)*d,f=s*(d+1)+o*d,t.push({start:this.findStart(e.document.body,u,f),end:this.findEnd(e.document.body,u,f)});return t}findStart(e,t,r){for(var i=[e],n,s,o=e;i.length;)if(n=i.shift(),s=this.walk(n,u=>{var f,d,p,b,y;if(y=Qi(u),this.horizontal&&this.direction==="ltr"){if(f=this.horizontal?y.left:y.top,d=this.horizontal?y.right:y.bottom,f>=t&&f<=r)return u;if(d>t)return u;o=u,i.push(u)}else if(this.horizontal&&this.direction==="rtl"){if(f=y.left,d=y.right,d<=r&&d>=t)return u;if(f<r)return u;o=u,i.push(u)}else{if(p=y.top,b=y.bottom,p>=t&&p<=r)return u;if(b>t)return u;o=u,i.push(u)}}),s)return this.findTextStartRange(s,t,r);return this.findTextStartRange(o,t,r)}findEnd(e,t,r){for(var i=[e],n,s=e,o;i.length;)if(n=i.shift(),o=this.walk(n,u=>{var f,d,p,b,y;if(y=Qi(u),this.horizontal&&this.direction==="ltr"){if(f=Math.round(y.left),d=Math.round(y.right),f>r&&s)return s;if(d>r)return u;s=u,i.push(u)}else if(this.horizontal&&this.direction==="rtl"){if(f=Math.round(this.horizontal?y.left:y.top),d=Math.round(this.horizontal?y.right:y.bottom),d<t&&s)return s;if(f<t)return u;s=u,i.push(u)}else{if(p=Math.round(y.top),b=Math.round(y.bottom),p>r&&s)return s;if(b>r)return u;s=u,i.push(u)}}),o)return this.findTextEndRange(o,t,r);return this.findTextEndRange(s,t,r)}findTextStartRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),n,s,o,u,f,d=0;d<i.length;d++)if(n=i[d],s=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=s.left,o>=t)return n}else if(this.horizontal&&this.direction==="rtl"){if(f=s.right,f<=r)return n}else if(u=s.top,u>=t)return n;return i[0]}findTextEndRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),n,s,o,u,f,d,p,b=0;b<i.length;b++){if(s=i[b],o=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(u=o.left,f=o.right,u>r&&n)return n;if(f>r)return s}else if(this.horizontal&&this.direction==="rtl"){if(u=o.left,f=o.right,f<t&&n)return n;if(u<t)return s}else{if(d=o.top,p=o.bottom,d>r&&n)return n;if(p>r)return s}n=s}return i[i.length-1]}splitTextNodeIntoRanges(e,t){var r=[],i=e.textContent||"",n=i.trim(),s,o=e.ownerDocument,u=t||" ",f=n.indexOf(u);if(f===-1||e.nodeType!=Node.TEXT_NODE)return s=o.createRange(),s.selectNodeContents(e),[s];for(s=o.createRange(),s.setStart(e,0),s.setEnd(e,f),r.push(s),s=!1;f!=-1;)f=n.indexOf(u,f+1),f>0&&(s&&(s.setEnd(e,f),r.push(s)),s=o.createRange(),s.setStart(e,f+1));return s&&(s.setEnd(e,n.length),r.push(s)),r}rangePairToCfiPair(e,t){var r=t.start,i=t.end;r.collapse(!0),i.collapse(!1);let n=new je(r,e).toString(),s=new je(i,e).toString();return{start:n,end:s}}rangeListToCfiList(e,t){for(var r=[],i,n=0;n<t.length;n++)i=this.rangePairToCfiPair(e,t[n]),r.push(i);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const aa=typeof navigator<"u",Uo=aa&&/Chrome/.test(navigator.userAgent),ns=aa&&!Uo&&/AppleWebKit/.test(navigator.userAgent),Mo=1;class gn{constructor(e,t,r,i){this.epubcfi=new je,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",Yr),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Lr}width(e){var t=this.content;return e&&at(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&at(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&at(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&at(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,r=this.document.createRange(),i=this.content||this.document.body,n=Mr(i);return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.width,n&&n.width&&(t+=n.width),Math.round(t)}textHeight(){let e,t,r=this.document.createRange(),i=this.content||this.document.body;return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,r){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,r?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],n={};if(t&&t.hasAttribute("content")){let s=t.getAttribute("content"),o=s.match(/width\s*=\s*([^,]*)/),u=s.match(/height\s*=\s*([^,]*)/),f=s.match(/initial-scale\s*=\s*([^,]*)/),d=s.match(/minimum-scale\s*=\s*([^,]*)/),p=s.match(/maximum-scale\s*=\s*([^,]*)/),b=s.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(r.width=o[1]),u&&u.length&&typeof u[1]<"u"&&(r.height=u[1]),f&&f.length&&typeof f[1]<"u"&&(r.scale=f[1]),d&&d.length&&typeof d[1]<"u"&&(r.minimum=d[1]),p&&p.length&&typeof p[1]<"u"&&(r.maximum=p[1]),b&&b.length&&typeof b[1]<"u"&&(r.scalable=b[1])}return n=Xs(e||{},r),e&&(n.width&&i.push("width="+n.width),n.height&&i.push("height="+n.height),n.scale&&i.push("initial-scale="+n.scale),n.scalable==="no"?(i.push("minimum-scale="+n.scale),i.push("maximum-scale="+n.scale),i.push("user-scalable="+n.scalable)):(n.scalable&&i.push("user-scalable="+n.scalable),n.minimum&&i.push("minimum-scale="+n.minimum),n.maximum&&i.push("minimum-scale="+n.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(ye.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(ye.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),r=0;r<e.length;r+=1){var i;try{i=e[r].cssRules}catch{return}if(!i)return;for(var n=0;n<i.length;n+=1)if(i[n].media){var s=this.window.matchMedia(i[n].media.mediaText);s.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,r=0;r<e.length;r++)t=e[r],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var r,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let n=new je(e).toRange(this.document,t);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let s=n.startContainer.textContent.indexOf(" ",n.startOffset);s==-1&&(s=n.startContainer.textContent.length),n.setEnd(n.startContainer,s)}}catch(s){console.error("setting end offset to start container length failed",s)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)r=n.startContainer.getBoundingClientRect(),i.left=r.left,i.top=r.top;else if(ns){let s=n.startContainer,o=new Range;try{s.nodeType===Mo?r=s.getBoundingClientRect():n.startOffset+2<s.length?(o.setStart(s,n.startOffset),o.setEnd(s,n.startOffset+2),r=o.getBoundingClientRect()):n.startOffset-2>0?(o.setStart(s,n.startOffset-2),o.setEnd(s,n.startOffset),r=o.getBoundingClientRect()):r=s.parentNode.getBoundingClientRect()}catch(u){console.error(u,u.stack)}}else r=n.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let n=e.substring(e.indexOf("#")+1),s=this.document.getElementById(n);if(s)if(ns){let o=new Range;o.selectNode(s),r=o.getBoundingClientRect()}else r=s.getBoundingClientRect()}return r&&(i.left=r.left,i.top=r.top),i}addStylesheet(e){return new Promise(function(t,r){var i,n=!1;if(!this.document){t(!1);return}if(i=this.document.querySelector("link[href='"+e+"']"),i){t(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)}.bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(t),r.innerHTML=e,!0}addStylesheetRules(e,t){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var i=0,n=e.length;i<n;i++){var s=1,o=e[i],u=e[i][0],f="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],s=0);for(var d=o.length;s<d;s++){var p=o[s];f+=p[0]+":"+p[1]+(p[2]?" !important":"")+`;
`}r.insertRule(u+"{"+f+"}",r.cssRules.length)}else Object.keys(e).forEach(y=>{const S=e[y];if(Array.isArray(S))S.forEach(_=>{const v=Object.keys(_).map(m=>`${m}:${_[m]}`).join(";");r.insertRule(`${y}{${v}}`,r.cssRules.length)});else{const h=Object.keys(S).map(v=>`${v}:${S[v]}`).join(";");r.insertRule(`${y}{${h}}`,r.cssRules.length)}})}addScript(e){return new Promise(function(t,r){var i,n=!1;if(!this.document){t(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)}.bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Lr.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Lr.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}triggerSelectedEvent(e){var t,r;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(r=new je(t,this.cfiBase).toString(),this.emit(ye.CONTENTS.SELECTED,r),this.emit(ye.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var r=new je(e);return r.toRange(this.document,t)}cfiFromRange(e,t){return new je(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new je(e,this.cfiBase,t).toString()}map(e){var t=new Vr(e);return t.section()}size(e,t){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),r.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,t,r,i,n){let s=ir("column-axis"),o=ir("column-gap"),u=ir("column-width"),f=ir("column-fill"),p=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&p==="horizontal"&&this.direction(n),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),p==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(s,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(s,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(f,"auto"),this.css(o,i+"px"),this.css(u,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,r){var i="scale("+e+")",n="";this.css("transform-origin","top left"),(t>=0||r>=0)&&(n=" translate("+(t||0)+"px, "+(r||0)+"px )"),this.css("transform",i+n)}fit(e,t,r){var i=this.viewport(),n=parseInt(i.width),s=parseInt(i.height),o=e/n,u=t/s,f=o<u?o:u;if(this.layoutStyle("paginated"),this.width(n),this.height(s),this.overflow("hidden"),this.scaler(f,0,0),this.css("background-size",n*f+"px "+s*f+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var d=e-n*f;this.css("margin-left",d+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,r,i,n){var s=new Vr(t,n);return s.page(this,e,r,i)}linksHandler(){Ro(this.content,e=>{this.emit(ye.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=ir("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}Ut(gn.prototype);class qo{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,r,i,n,s){let o=encodeURI(t+e),f=new je(t).spinePos,d=new oa({type:e,cfiRange:t,data:r,sectionIndex:f,cb:i,className:n,styles:s});return this._annotations[o]=d,f in this._annotationsBySectionIndex?this._annotationsBySectionIndex[f].push(o):this._annotationsBySectionIndex[f]=[o],this.rendition.views().forEach(b=>{d.sectionIndex===b.index&&d.attach(b)}),d}remove(e,t){let r=encodeURI(e+t);if(r in this._annotations){let i=this._annotations[r];if(t&&i.type!==t)return;this.rendition.views().forEach(s=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,r),i.sectionIndex===s.index&&i.detach(s)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,r,i,n){return this.add("highlight",e,t,r,i,n)}underline(e,t,r,i,n){return this.add("underline",e,t,r,i,n)}mark(e,t,r){return this.add("mark",e,t,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].detach(e)})}show(){}hide(){}}class oa{constructor({type:e,cfiRange:t,data:r,sectionIndex:i,cb:n,className:s,styles:o}){this.type=e,this.cfiRange=t,this.data=r,this.sectionIndex=i,this.mark=void 0,this.cb=n,this.className=s,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:r,type:i,mark:n,cb:s,className:o,styles:u}=this,f;return i==="highlight"?f=e.highlight(t,r,s,o,u):i==="underline"?f=e.underline(t,r,s,o,u):i==="mark"&&(f=e.mark(t,r,s)),this.mark=f,this.emit(ye.ANNOTATION.ATTACH,f),f}detach(e){let{cfiRange:t,type:r}=this,i;return e&&(r==="highlight"?i=e.unhighlight(t):r==="underline"?i=e.ununderline(t):r==="mark"&&(i=e.unmark(t))),this.mark=void 0,this.emit(ye.ANNOTATION.DETACH,i),i}text(){}}Ut(oa.prototype);var Nt={},mr={},ss;function jo(){if(ss)return mr;ss=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.createElement=a;function a(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}return mr.default={createElement:a},mr}var rr={},as;function Wo(){if(as)return rr;as=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.proxyMouse=a,rr.clone=e,rr.default={proxyMouse:a};function a(r,i){function n(f){for(var d=i.length-1;d>=0;d--){var p=i[d],b=f.clientX,y=f.clientY;if(f.touches&&f.touches.length&&(b=f.touches[0].clientX,y=f.touches[0].clientY),!!t(p,r,b,y)){p.dispatchEvent(e(f));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var s=["mouseup","mousedown","click","touchstart"],o=0;o<s.length;o++){var u=s[o];this.target.addEventListener(u,function(f){return n(f)},!1)}}function e(r){var i=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,i)}catch{var n=document.createEvent("MouseEvents");return n.initMouseEvent(r.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),n}}function t(r,i,n,s){var o=i.getBoundingClientRect();function u(y,S,_){var h=y.top-o.top,v=y.left-o.left,m=h+y.height,D=v+y.width;return h<=_&&v<=S&&m>_&&D>S}var f=r.getBoundingClientRect();if(!u(f,n,s))return!1;for(var d=r.getClientRects(),p=0,b=d.length;p<b;p++)if(u(d[p],n,s))return!0;return!1}return rr}var os;function Ho(){if(os)return Nt;os=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.Underline=Nt.Highlight=Nt.Mark=Nt.Pane=void 0;var a=function _(h,v,m){h===null&&(h=Function.prototype);var D=Object.getOwnPropertyDescriptor(h,v);if(D===void 0){var O=Object.getPrototypeOf(h);return O===null?void 0:_(O,v,m)}else{if("value"in D)return D.value;var E=D.get;return E===void 0?void 0:E.call(m)}},e=(function(){function _(h,v){for(var m=0;m<v.length;m++){var D=v[m];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(h,D.key,D)}}return function(h,v,m){return v&&_(h.prototype,v),m&&_(h,m),h}})(),t=jo(),r=s(t),i=Wo(),n=s(i);function s(_){return _&&_.__esModule?_:{default:_}}function o(_,h){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:_}function u(_,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);_.prototype=Object.create(h&&h.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(_,h):_.__proto__=h)}function f(_,h){if(!(_ instanceof h))throw new TypeError("Cannot call a class as a function")}Nt.Pane=(function(){function _(h){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;f(this,_),this.target=h,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),n.default.proxyMouse(this.target,this.marks),this.container=v,this.container.appendChild(this.element),this.render()}return e(_,[{key:"addMark",value:function(v){var m=r.default.createElement("g");return this.element.appendChild(m),v.bind(m,this.container),this.marks.push(v),v.render(),v}},{key:"removeMark",value:function(v){var m=this.marks.indexOf(v);if(m!==-1){var D=v.unbind();this.element.removeChild(D),this.marks.splice(m,1)}}},{key:"render",value:function(){y(this.element,b(this.target,this.container));var v=!0,m=!1,D=void 0;try{for(var O=this.marks[Symbol.iterator](),E;!(v=(E=O.next()).done);v=!0){var k=E.value;k.render()}}catch(N){m=!0,D=N}finally{try{!v&&O.return&&O.return()}finally{if(m)throw D}}}}]),_})();var d=Nt.Mark=(function(){function _(){f(this,_),this.element=null}return e(_,[{key:"bind",value:function(v,m){this.element=v,this.container=m}},{key:"unbind",value:function(){var v=this.element;return this.element=null,v}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(v){this.element&&this.element.dispatchEvent(v)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var v=[],m=this.element.firstChild;m;)v.push(m.getBoundingClientRect()),m=m.nextSibling;return v}},{key:"filteredRanges",value:function(){var v=Array.from(this.range.getClientRects());return v.filter(function(m){for(var D=0;D<v.length;D++){if(v[D]===m)return!0;var O=S(v[D],m);if(O)return!1}return!0})}}]),_})(),p=Nt.Highlight=(function(_){u(h,_);function h(v,m,D,O){f(this,h);var E=o(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return E.range=v,E.className=m,E.data=D||{},E.attributes=O||{},E}return e(h,[{key:"bind",value:function(m,D){a(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"bind",this).call(this,m,D);for(var O in this.data)this.data.hasOwnProperty(O)&&(this.element.dataset[O]=this.data[O]);for(var O in this.attributes)this.attributes.hasOwnProperty(O)&&this.element.setAttribute(O,this.attributes[O]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var m=this.element.ownerDocument.createDocumentFragment(),D=this.filteredRanges(),O=this.element.getBoundingClientRect(),E=this.container.getBoundingClientRect(),k=0,N=D.length;k<N;k++){var B=D[k],I=r.default.createElement("rect");I.setAttribute("x",B.left-O.left+E.left),I.setAttribute("y",B.top-O.top+E.top),I.setAttribute("height",B.height),I.setAttribute("width",B.width),m.appendChild(I)}this.element.appendChild(m)}}]),h})(d);Nt.Underline=(function(_){u(h,_);function h(v,m,D,O){return f(this,h),o(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,v,m,D,O))}return e(h,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var m=this.element.ownerDocument.createDocumentFragment(),D=this.filteredRanges(),O=this.element.getBoundingClientRect(),E=this.container.getBoundingClientRect(),k=0,N=D.length;k<N;k++){var B=D[k],I=r.default.createElement("rect");I.setAttribute("x",B.left-O.left+E.left),I.setAttribute("y",B.top-O.top+E.top),I.setAttribute("height",B.height),I.setAttribute("width",B.width),I.setAttribute("fill","none");var L=r.default.createElement("line");L.setAttribute("x1",B.left-O.left+E.left),L.setAttribute("x2",B.left-O.left+E.left+B.width),L.setAttribute("y1",B.top-O.top+E.top+B.height-1),L.setAttribute("y2",B.top-O.top+E.top+B.height-1),L.setAttribute("stroke-width",1),L.setAttribute("stroke","black"),L.setAttribute("stroke-linecap","square"),m.appendChild(I),m.appendChild(L)}this.element.appendChild(m)}}]),h})(p);function b(_,h){var v=h.getBoundingClientRect(),m=_.getBoundingClientRect();return{top:m.top-v.top,left:m.left-v.left,height:_.scrollHeight,width:_.scrollWidth}}function y(_,h){_.style.setProperty("top",h.top+"px","important"),_.style.setProperty("left",h.left+"px","important"),_.style.setProperty("height",h.height+"px","important"),_.style.setProperty("width",h.width+"px","important")}function S(_,h){return h.right<=_.right&&h.left>=_.left&&h.top>=_.top&&h.bottom<=_.bottom}return Nt}var Ir=Ho();class ua{constructor(e,t){this.settings=gt({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+Xr(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new je,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Br(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(r){return this.load(r)}.bind(this)).then(function(){let r=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=r.indexOf("vertical")===0?"horizontal":"vertical":i=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(ye.VIEWS.AXIS,i),this.setWritingMode(r),this.emit(ye.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,s)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}.bind(this),function(r){return this.emit(ye.VIEWS.LOAD_ERROR,r),new Promise((i,n)=>{n(r)})}.bind(this)).then(function(){this.emit(ye.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var r=e||this.settings.width,i=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,i):this.settings.axis==="horizontal"?this.lock("height",r,i):this.lock("width",r,i),this.settings.width=r,this.settings.height=i}lock(e,t,r){var i=Mr(this.element),n;this.iframe?n=Mr(this.iframe):n={width:0,height:0},e=="width"&&at(t)&&(this.lockedWidth=t-i.width-n.width),e=="height"&&at(r)&&(this.lockedHeight=r-i.height-n.height),e==="both"&&at(t)&&at(r)&&(this.lockedWidth=t-i.width-n.width,this.lockedHeight=r-i.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,r=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||r!=this._height)&&this.reframe(t,r),this._expanding=!1)}reframe(e,t){var r;at(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),at(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let i=this.prevBounds?e-this.prevBounds.width:e,n=this.prevBounds?t-this.prevBounds.height:t;r={width:e,height:t,widthDelta:i,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let s;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(s=this.marks[o],this.placeMark(s.element,s.range))}),this.onResize(this,r),this.emit(ye.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=Br(this.element)}load(e){var t=new qe,r=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=function(n){this.onLoad(n,t)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=jr(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new gn(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(ye.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(ye.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new qe;return this.displayed?t.resolve(this):this.render(e).then(function(){this.emit(ye.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}.bind(this),function(r){t.reject(r,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(ye.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(ye.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=Br(this.element)),this.elementBounds}highlight(e,t={},r,i="epubjs-hl",n={}){if(!this.contents)return;const s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),u=()=>{this.emit(ye.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Ir.Pane(this.iframe,this.element));let f=new Ir.Highlight(o,i,t,s),d=this.pane.addMark(f);return this.highlights[e]={mark:d,element:d.element,listeners:[u,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",u),d.element.addEventListener("touchstart",u),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}underline(e,t={},r,i="epubjs-ul",n={}){if(!this.contents)return;const s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),u=()=>{this.emit(ye.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Ir.Pane(this.iframe,this.element));let f=new Ir.Underline(o,i,t,s),d=this.pane.addMark(f);return this.underlines[e]={mark:d,element:d.element,listeners:[u,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",u),d.element.addEventListener("touchstart",u),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}mark(e,t={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let n=i.commonAncestorContainer,s=n.nodeType===1?n:n.parentNode,o=f=>{this.emit(ye.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&n.nodeType===1?(i=new Range,i.selectNodeContents(n)):i.collapsed&&(i=new Range,i.selectNodeContents(s));let u=this.document.createElement("a");return u.setAttribute("ref","epubjs-mk"),u.style.position="absolute",u.dataset.epubcfi=e,t&&Object.keys(t).forEach(f=>{u.dataset[f]=t[f]}),r&&(u.addEventListener("click",r),u.addEventListener("touchstart",r)),u.addEventListener("click",o),u.addEventListener("touchstart",o),this.placeMark(u,i),this.element.appendChild(u),this.marks[e]={element:u,range:i,listeners:[o,r]},s}placeMark(e,t){let r,i,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();r=o.top,i=o.right}else{let o=t.getClientRects(),u;for(var s=0;s!=o.length;s++)u=o[s],(!n||u.left<n)&&(n=u.left,i=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=u.top)}e.style.top=`${r}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&Js(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}Ut(ua.prototype);function Vo(){var a="reverse",e=$o();return document.body.appendChild(e),e.scrollLeft>0?a="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(a="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(a="negative")),document.body.removeChild(e),a}function $o(){var a=document.createElement("div");a.dir="rtl",a.style.position="fixed",a.style.width="1px",a.style.height="1px",a.style.top="0px",a.style.left="0px",a.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(t),e.appendChild(r),a.appendChild(e),a}var Ii,us;function vn(){if(us)return Ii;us=1;function a(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Ii=a,Ii}var Oi,ls;function Go(){if(ls)return Oi;ls=1;var a=typeof kt=="object"&&kt&&kt.Object===Object&&kt;return Oi=a,Oi}var Bi,cs;function la(){if(cs)return Bi;cs=1;var a=Go(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=a||e||Function("return this")();return Bi=t,Bi}var Li,hs;function Zo(){if(hs)return Li;hs=1;var a=la(),e=function(){return a.Date.now()};return Li=e,Li}var Fi,fs;function Xo(){if(fs)return Fi;fs=1;var a=/\s/;function e(t){for(var r=t.length;r--&&a.test(t.charAt(r)););return r}return Fi=e,Fi}var Pi,ds;function Yo(){if(ds)return Pi;ds=1;var a=Xo(),e=/^\s+/;function t(r){return r&&r.slice(0,a(r)+1).replace(e,"")}return Pi=t,Pi}var zi,ps;function ca(){if(ps)return zi;ps=1;var a=la(),e=a.Symbol;return zi=e,zi}var Ui,gs;function Ko(){if(gs)return Ui;gs=1;var a=ca(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,i=a?a.toStringTag:void 0;function n(s){var o=t.call(s,i),u=s[i];try{s[i]=void 0;var f=!0}catch{}var d=r.call(s);return f&&(o?s[i]=u:delete s[i]),d}return Ui=n,Ui}var Mi,vs;function Jo(){if(vs)return Mi;vs=1;var a=Object.prototype,e=a.toString;function t(r){return e.call(r)}return Mi=t,Mi}var qi,ms;function Qo(){if(ms)return qi;ms=1;var a=ca(),e=Ko(),t=Jo(),r="[object Null]",i="[object Undefined]",n=a?a.toStringTag:void 0;function s(o){return o==null?o===void 0?i:r:n&&n in Object(o)?e(o):t(o)}return qi=s,qi}var ji,ys;function eu(){if(ys)return ji;ys=1;function a(e){return e!=null&&typeof e=="object"}return ji=a,ji}var Wi,ws;function tu(){if(ws)return Wi;ws=1;var a=Qo(),e=eu(),t="[object Symbol]";function r(i){return typeof i=="symbol"||e(i)&&a(i)==t}return Wi=r,Wi}var Hi,bs;function ru(){if(bs)return Hi;bs=1;var a=Yo(),e=vn(),t=tu(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function u(f){if(typeof f=="number")return f;if(t(f))return r;if(e(f)){var d=typeof f.valueOf=="function"?f.valueOf():f;f=e(d)?d+"":d}if(typeof f!="string")return f===0?f:+f;f=a(f);var p=n.test(f);return p||s.test(f)?o(f.slice(2),p?2:8):i.test(f)?r:+f}return Hi=u,Hi}var Vi,_s;function ha(){if(_s)return Vi;_s=1;var a=vn(),e=Zo(),t=ru(),r="Expected a function",i=Math.max,n=Math.min;function s(o,u,f){var d,p,b,y,S,_,h=0,v=!1,m=!1,D=!0;if(typeof o!="function")throw new TypeError(r);u=t(u)||0,a(f)&&(v=!!f.leading,m="maxWait"in f,b=m?i(t(f.maxWait)||0,u):b,D="trailing"in f?!!f.trailing:D);function O(J){var ne=d,ae=p;return d=p=void 0,h=J,y=o.apply(ae,ne),y}function E(J){return h=J,S=setTimeout(B,u),v?O(J):y}function k(J){var ne=J-_,ae=J-h,le=u-ne;return m?n(le,b-ae):le}function N(J){var ne=J-_,ae=J-h;return _===void 0||ne>=u||ne<0||m&&ae>=b}function B(){var J=e();if(N(J))return I(J);S=setTimeout(B,k(J))}function I(J){return S=void 0,D&&d?O(J):(d=p=void 0,y)}function L(){S!==void 0&&clearTimeout(S),h=0,d=_=p=S=void 0}function K(){return S===void 0?y:I(e())}function $(){var J=e(),ne=N(J);if(d=arguments,p=this,_=J,ne){if(S===void 0)return E(_);if(m)return clearTimeout(S),S=setTimeout(B,u),O(_)}return S===void 0&&(S=setTimeout(B,u)),y}return $.cancel=L,$.flush=K,$}return Vi=s,Vi}var $i,Es;function iu(){if(Es)return $i;Es=1;var a=ha(),e=vn(),t="Expected a function";function r(i,n,s){var o=!0,u=!0;if(typeof i!="function")throw new TypeError(t);return e(s)&&(o="leading"in s?!!s.leading:o,u="trailing"in s?!!s.trailing:u),a(i,n,{leading:o,maxWait:n,trailing:u})}return $i=r,$i}var nu=iu();const su=hr(nu);class au{constructor(e){this.settings=e||{},this.id="epubjs-container-"+Xr(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,r=e.width,i=e.overflow||!1,n=e.axis||"vertical",s=e.direction;gt(this.settings,e),e.height&&at(e.height)&&(t=e.height+"px"),e.width&&at(e.width)&&(r=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",n==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),r&&(o.style.width=r),t&&(o.style.height=t),i&&(i==="scroll"&&n==="vertical"?(o.style["overflow-y"]=i,o.style["overflow-x"]="hidden"):i==="scroll"&&n==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=i):o.style.overflow=i),s&&(o.dir=s,o.style.direction=s),s&&this.settings.fullsize&&(document.body.style.direction=s),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(Gs(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),r;if(t)return this.settings.hidden?r=this.wrapper:r=this.container,t.appendChild(r),this.element=t,t}getContainer(){return this.container}onResize(e){(!at(this.settings.width)||!at(this.settings.height))&&(this.resizeFunc=su(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var r;let i=e||this.settings.width,n=t||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):at(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(r=r||this.element.getBoundingClientRect(),r.height&&(t=r.height,this.container.style.height=t+"px")):at(t)?this.container.style.height=t+"px":this.container.style.height=t,at(e)||(e=this.container.clientWidth),at(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let s=qr(),o=window.getComputedStyle(document.body),u={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return i||(e=s.width-u.left-u.right),(this.settings.fullsize&&!n||!n)&&(t=s.height-u.top-u.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?qr():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var r="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(n){for(var s in n)n.hasOwnProperty(s)&&(i+=s+":"+n[s]+";")}),this.sheet.insertRule(r+e+" {"+i+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class ou{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var r=0;r<t;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,r=this.length,i=0;i<r;i++)if(t=this._views[i],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,r=this.length,i=0;i<r;i++)t=this._views[i],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}class $r{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new pn(this),this.settings=gt(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),gt(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=Vo(),this.stage=new au({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new ou(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(t){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(ye.MANAGERS.ORIENTATION_CHANGE,t)}.bind(this),500)}onResized(e){this.resize()}resize(e,t,r){let i=this.stage.size(e,t);if(this.winBounds=qr(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(ye.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,t){return new this.View(e,gt(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,r){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return r.call(this,i)}}display(e,t){var r=new qe,i=r.promise;(t===e.href||at(t))&&(t=void 0);var n=this.views.find(e);if(n&&e&&this.layout.name!=="pre-paginated"){let o=n.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let u=n.width();this.scrollTo(o.left+u,o.top,!0)}if(t){let u=n.locationOf(t),f=n.width();this.moveTo(u,f)}return r.resolve(),i}this.clear();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.add(e,s).then(function(o){if(t){let u=o.locationOf(t),f=o.width();this.moveTo(u,f)}}.bind(this),o=>{r.reject(o)}).then(function(){return this.handleNextPrePaginated(s,e,this.add)}.bind(this)).then(function(){this.views.show(),r.resolve()}.bind(this)),i}afterDisplayed(e){this.emit(ye.MANAGERS.ADDED,e)}afterResized(e){this.emit(ye.MANAGERS.RESIZE,e.section)}moveTo(e,t){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),i=Math.floor(e.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-t),this.scrollTo(r,i,!0)}add(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}append(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}prepend(e,t){var r=this.createView(e,t);return r.on(ye.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(i=!0),this.append(e,i).then(function(){return this.handleNextPrePaginated(i,e,this.append)}.bind(this),n=>n).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(i=!0),this.prepend(e,i).then(function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=e.prev(),n))return this.prepend(n)}.bind(this),n=>n).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let s=0,o=0;return this.settings.fullsize&&(s=n?window.scrollY:window.scrollX),e.map(f=>{let{index:d,href:p}=f.section,b=f.position(),y=f.width(),S=f.height(),_,h,v,m;n?(_=s+t.top-b.top+o,h=_+r-o,m=this.layout.count(S,r).pages,v=r):(_=s+t.left-b.left+o,h=_+i-o,m=this.layout.count(y,i).pages,v=i);let D=Math.ceil(_/v),O=[],E=Math.ceil(h/v);if(this.settings.direction==="rtl"&&!n){let B=D;D=m-E,E=m-B}O=[];for(var k=D;k<=E;k++){let B=k+1;O.push(B)}let N=this.mapping.page(f.contents,f.section.cfiBase,_,h);return{index:d,href:p,pages:O,totalPages:m,mapping:N}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=0,i=0;return this.settings.fullsize&&(r=window.scrollX),e.map(s=>{let{index:o,href:u}=s.section,f,d=s.position(),p=s.width(),b,y,S;this.settings.direction==="rtl"?(f=t.right-r,S=Math.min(Math.abs(f-d.left),this.layout.width)-i,y=d.width-(d.right-f)-i,b=y-S):(f=t.left+r,S=Math.min(d.right-f,this.layout.width)-i,b=f-d.left+i,y=b+S),i+=S;let _=this.mapping.page(s.contents,s.section.cfiBase,b,y),h=this.layout.count(p).pages,v=Math.floor(b/this.layout.pageWidth),m=[],D=Math.floor(y/this.layout.pageWidth);if(v<0&&(v=0,D=D+1),this.settings.direction==="rtl"){let E=v;v=h-D,D=h-E}for(var O=v+1;O<=D;O++){let E=O;m.push(E)}return{index:o,href:u,pages:m,totalPages:h,mapping:_}})}isVisible(e,t,r,i){var n=e.position(),s=i||this.bounds();return this.settings.axis==="horizontal"&&n.right>s.left-t&&n.left<s.right+r?!0:this.settings.axis==="vertical"&&n.bottom>s.top-t&&n.top<s.bottom+r}visible(){for(var e=this.bounds(),t=this.views.displayed(),r=t.length,i=[],n,s,o=0;o<r;o++)s=t[o],n=this.isVisible(s,0,0,e),n===!0&&i.push(s);return i}scrollBy(e,t,r){let i=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(ye.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(ye.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Vr(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Vr(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const r=t&&t.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}Ut($r.prototype);const uu={easeInCubic:function(a){return Math.pow(a,3)}};class nn{constructor(e,t){this.settings=gt({duration:80,minVelocity:.2,minDistance:10,easing:uu.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(ye.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(ye.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{t.on(r,i=>this.triggerViewEvent(i,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:r}=e.touches[0],i=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,r=Math.abs(t),i=this.endTime-this.startTime,n=t/i,s=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(n>s)return-1;if(n<-s)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/r)*r;return e&&(i+=e*r),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new qe,r=this.scrollLeft,i=this.now(),n=this.settings.duration,s=this.settings.easing;this.snapping=!0;function o(){const u=this.now(),f=Math.min(1,(u-i)/n);if(s(f),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}f<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(r+(e-r)*f,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}Ut(nn.prototype);var lu=ha();const cu=hr(lu);class hu extends $r{constructor(e){super(e),this.name="continuous",this.settings=gt(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),gt(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return $r.prototype.display.call(this,e,t).then(function(){return this.fill()}.bind(this))}fill(e){var t=e||new qe;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,r=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(t>0||r>0)&&this.scrollBy(t,r,!0)}afterResized(e){this.emit(ye.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(ye.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(ye.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ye.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(ye.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(ye.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ye.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(ye.VIEWS.RESIZED,r=>{this.counter(r),t.expanded=!0}),t.on(ye.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ye.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),r=this.views.all(),i=r.length,n=typeof e<"u"?e:this.settings.offset||0,s,o,u=new qe,f=[],d=0;d<i;d++)if(o=r[d],s=this.isVisible(o,n,n,t),s===!0)if(o.displayed)o.show();else{let p=o.display(this.request).then(function(b){b.show()},b=>{o.hide()});f.push(p)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return f.length?Promise.all(f).catch(p=>{u.reject(p)}):(u.resolve(),u.promise)}check(e,t){var r=new qe,i=[],n=this.settings.axis==="horizontal",s=this.settings.offset||0;e&&n&&(s=e),t&&!n&&(s=t);var o=this._bounds;let u=n?this.scrollLeft:this.scrollTop,f=n?Math.floor(o.width):o.height,d=n?this.container.scrollWidth:this.container.scrollHeight,p=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",b=this.settings.rtlScrollType,y=this.settings.direction==="rtl";this.settings.fullsize?(n&&y&&b==="negative"||!n&&y&&b==="default")&&(u=u*-1):(y&&b==="default"&&p==="horizontal"&&(u=d-f-u),y&&b==="negative"&&p==="horizontal"&&(u=u*-1));let S=()=>{let D=this.views.first(),O=D&&D.section.prev();O&&i.push(this.prepend(O))},_=()=>{let D=this.views.last(),O=D&&D.section.next();O&&i.push(this.append(O))},h=u+f+s,v=u-s;h>=d&&_(),v<0&&S();let m=i.map(D=>D.display(this.request));return i.length?Promise.all(m).then(()=>this.check()).then(()=>this.update(s),D=>D):(this.q.enqueue(function(){this.update()}.bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new qe,t=this.views.displayed(),r=t[0],i=t[t.length-1],n=this.views.indexOf(r),s=this.views.indexOf(i),o=this.views.slice(0,n),u=this.views.slice(s+1),f=0;f<o.length-1;f++)this.erase(o[f],o);for(var d=1;d<u.length;d++)this.erase(u[d]);return e.resolve(),e.promise}erase(e,t){var r,i;this.settings.fullsize?(r=window.scrollY,i=window.scrollX):(r=this.container.scrollTop,i=this.container.scrollLeft);var n=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,r-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(n.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(n.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(t){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new nn(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=hn;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=cu(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,t=window.scrollX*r):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(ye.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(ye.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new nn(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class mn{constructor(e,t){this.settings=gt(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),gt(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new Lt(this),this.hooks.serialize=new Lt(this),this.hooks.content=new Lt(this),this.hooks.unloaded=new Lt(this),this.hooks.layout=new Lt(this),this.hooks.render=new Lt(this),this.hooks.show=new Lt(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new zo(this),this.annotations=new qo(this),this.epubcfi=new je,this.q=new pn(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new qe,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=$r:typeof e=="string"&&e==="continuous"?t=hu:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=ua:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(ye.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(ye.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(ye.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(ye.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(ye.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(ye.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(ye.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new qe,r=t.promise,i;return this.displaying=t,this.book.locations.length()&&Zs(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),i=this.book.spine.get(e),i?(this.manager.display(i,e).then(()=>{t.resolve(i),this.displaying=void 0,this.emit(ye.RENDITION.DISPLAYED,i),this.reportLocation()},n=>{this.emit(ye.RENDITION.DISPLAY_ERROR,n)}),r):(t.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(ye.VIEWS.MARK_CLICKED,(t,r)=>this.triggerMarkEvent(t,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(ye.RENDITION.RENDERED,e.section,e)}):this.emit(ye.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(ye.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(ye.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(ye.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,r){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,r=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",n=this.settings.orientation||e.orientation||"auto",s=this.settings.flow||e.flow||"auto",o=e.viewport||"",u=this.settings.minSpreadWidth||e.minSpreadWidth||800,f=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:r,spread:i,orientation:n,flow:s,viewport:o,minSpreadWidth:u,direction:f},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new sa(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(ye.LAYOUT.UPDATED,(t,r)=>{this.emit(ye.RENDITION.LAYOUT,t,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then(function(i){let n=this.located(i);!n||!n.start||!n.end||(this.location=n,this.emit(ye.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(ye.RENDITION.RELOCATED,this.location))}.bind(this));else if(r){let i=this.located(r);if(!i||!i.start||!i.end)return;this.location=i,this.emit(ye.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(ye.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(t){return this.located(t)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],r=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},n=this.book.locations.locationFromCfi(t.mapping.start),s=this.book.locations.locationFromCfi(r.mapping.end);n!=null&&(i.start.location=n,i.start.percentage=this.book.locations.percentageFromLocation(n)),s!=null&&(i.end.location=s,i.end.percentage=this.book.locations.percentageFromLocation(s));let o=this.book.pageList.pageFromCfi(t.mapping.start),u=this.book.pageList.pageFromCfi(r.mapping.end);return o!=-1&&(i.start.page=o),u!=-1&&(i.end.page=u),r.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Lr.forEach(t=>{e.on(t,r=>this.triggerViewEvent(r,e))}),e.on(ye.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(ye.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,r){this.emit(ye.RENDITION.MARK_CLICKED,e,t,r)}getRange(e,t){var r=new je(e),i=this.manager.visible().filter(function(n){if(r.spinePos===n.index)return!0});if(i.length)return i[0].contents.range(r,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let t=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,s){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(ye.CONTENTS.LINK_CLICKED,t=>{let r=this.book.path.relative(t);this.display(r)})}injectStylesheet(e,t){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,t){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,t){let r=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),r&&i.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(i)}}Ut(mn.prototype);var Gi={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var xs;function fu(){return xs||(xs=1,(function(a,e){(function(t){a.exports=t()})(function(){return(function t(r,i,n){function s(f,d){if(!i[f]){if(!r[f]){var p=typeof $t=="function"&&$t;if(!d&&p)return p(f,!0);if(o)return o(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var y=i[f]={exports:{}};r[f][0].call(y.exports,function(S){var _=r[f][1][S];return s(_||S)},y,y.exports,t,r,i,n)}return i[f].exports}for(var o=typeof $t=="function"&&$t,u=0;u<n.length;u++)s(n[u]);return s})({1:[function(t,r,i){var n=t("./utils"),s=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var f=[],d,p,b,y,S,_,h,v=0,m=u.length,D=m,O=n.getTypeOf(u)!=="string";v<u.length;)D=m-v,O?(d=u[v++],p=v<m?u[v++]:0,b=v<m?u[v++]:0):(d=u.charCodeAt(v++),p=v<m?u.charCodeAt(v++):0,b=v<m?u.charCodeAt(v++):0),y=d>>2,S=(d&3)<<4|p>>4,_=D>1?(p&15)<<2|b>>6:64,h=D>2?b&63:64,f.push(o.charAt(y)+o.charAt(S)+o.charAt(_)+o.charAt(h));return f.join("")},i.decode=function(u){var f,d,p,b,y,S,_,h=0,v=0,m="data:";if(u.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");u=u.replace(/[^A-Za-z0-9+/=]/g,"");var D=u.length*3/4;if(u.charAt(u.length-1)===o.charAt(64)&&D--,u.charAt(u.length-2)===o.charAt(64)&&D--,D%1!==0)throw new Error("Invalid base64 input, bad content length.");var O;for(s.uint8array?O=new Uint8Array(D|0):O=new Array(D|0);h<u.length;)b=o.indexOf(u.charAt(h++)),y=o.indexOf(u.charAt(h++)),S=o.indexOf(u.charAt(h++)),_=o.indexOf(u.charAt(h++)),f=b<<2|y>>4,d=(y&15)<<4|S>>2,p=(S&3)<<6|_,O[v++]=f,S!==64&&(O[v++]=d),_!==64&&(O[v++]=p);return O}},{"./support":30,"./utils":32}],2:[function(t,r,i){var n=t("./external"),s=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function f(d,p,b,y,S){this.compressedSize=d,this.uncompressedSize=p,this.crc32=b,this.compression=y,this.compressedContent=S}f.prototype={getContentWorker:function(){var d=new s(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,b){return d.pipe(new o).pipe(new u("uncompressedSize")).pipe(p.compressWorker(b)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var n=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var n=t("./utils");function s(){for(var d,p=[],b=0;b<256;b++){d=b;for(var y=0;y<8;y++)d=d&1?3988292384^d>>>1:d>>>1;p[b]=d}return p}var o=s();function u(d,p,b,y){var S=o,_=y+b;d=d^-1;for(var h=y;h<_;h++)d=d>>>8^S[(d^p[h])&255];return d^-1}function f(d,p,b,y){var S=o,_=y+b;d=d^-1;for(var h=y;h<_;h++)d=d>>>8^S[(d^p.charCodeAt(h))&255];return d^-1}r.exports=function(p,b){if(typeof p>"u"||!p.length)return 0;var y=n.getTypeOf(p)!=="string";return y?u(b|0,p,p.length,0):f(b|0,p,p.length,0)}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var n=null;typeof Promise<"u"?n=Promise:n=t("lie"),r.exports={Promise:n}},{lie:37}],7:[function(t,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),o=t("./utils"),u=t("./stream/GenericWorker"),f=n?"uint8array":"array";i.magic="\b\0";function d(p,b){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=b,this.meta={}}o.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(b){p.push({data:b,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){var n=t("../utils"),s=t("../stream/GenericWorker"),o=t("../utf8"),u=t("../crc32"),f=t("../signature"),d=function(v,m){var D="",O;for(O=0;O<m;O++)D+=String.fromCharCode(v&255),v=v>>>8;return D},p=function(v,m){var D=v;return v||(D=m?16893:33204),(D&65535)<<16},b=function(v){return(v||0)&63},y=function(v,m,D,O,E,k){var N=v.file,B=v.compression,I=k!==o.utf8encode,L=n.transformTo("string",k(N.name)),K=n.transformTo("string",o.utf8encode(N.name)),$=N.comment,J=n.transformTo("string",k($)),ne=n.transformTo("string",o.utf8encode($)),ae=K.length!==N.name.length,le=ne.length!==$.length,se,ie,pe="",Ee="",ue="",ve=N.dir,Te=N.date,we={crc32:0,compressedSize:0,uncompressedSize:0};(!m||D)&&(we.crc32=v.crc32,we.compressedSize=v.compressedSize,we.uncompressedSize=v.uncompressedSize);var Ne=0;m&&(Ne|=8),!I&&(ae||le)&&(Ne|=2048);var Ge=0,Ve=0;ve&&(Ge|=16),E==="UNIX"?(Ve=798,Ge|=p(N.unixPermissions,ve)):(Ve=20,Ge|=b(N.dosPermissions)),se=Te.getUTCHours(),se=se<<6,se=se|Te.getUTCMinutes(),se=se<<5,se=se|Te.getUTCSeconds()/2,ie=Te.getUTCFullYear()-1980,ie=ie<<4,ie=ie|Te.getUTCMonth()+1,ie=ie<<5,ie=ie|Te.getUTCDate(),ae&&(Ee=d(1,1)+d(u(L),4)+K,pe+="up"+d(Ee.length,2)+Ee),le&&(ue=d(1,1)+d(u(J),4)+ne,pe+="uc"+d(ue.length,2)+ue);var _e="";_e+=`
\0`,_e+=d(Ne,2),_e+=B.magic,_e+=d(se,2),_e+=d(ie,2),_e+=d(we.crc32,4),_e+=d(we.compressedSize,4),_e+=d(we.uncompressedSize,4),_e+=d(L.length,2),_e+=d(pe.length,2);var We=f.LOCAL_FILE_HEADER+_e+L+pe,Ie=f.CENTRAL_FILE_HEADER+d(Ve,2)+_e+d(J.length,2)+"\0\0\0\0"+d(Ge,4)+d(O,4)+L+pe+J;return{fileRecord:We,dirRecord:Ie}},S=function(v,m,D,O,E){var k="",N=n.transformTo("string",E(O));return k=f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(v,2)+d(v,2)+d(m,4)+d(D,4)+d(N.length,2)+N,k},_=function(v){var m="";return m=f.DATA_DESCRIPTOR+d(v.crc32,4)+d(v.compressedSize,4)+d(v.uncompressedSize,4),m};function h(v,m,D,O){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=D,this.encodeFileName=O,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(h,s),h.prototype.push=function(v){var m=v.meta.percent||0,D=this.entriesCount,O=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,s.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:D?(m+100*(D-O-1))/D:100}}))},h.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var m=this.streamFiles&&!v.file.dir;if(m){var D=y(v,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:D.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(v){this.accumulate=!1;var m=this.streamFiles&&!v.file.dir,D=y(v,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(D.dirRecord),m)this.push({data:_(v),meta:{percent:100}});else for(this.push({data:D.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var v=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var D=this.bytesWritten-v,O=S(this.dirRecords.length,D,v,this.zipComment,this.encodeFileName);this.push({data:O,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(v){this._sources.push(v);var m=this;return v.on("data",function(D){m.processChunk(D)}),v.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),v.on("error",function(D){m.error(D)}),this},h.prototype.resume=function(){if(!s.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},h.prototype.error=function(v){var m=this._sources;if(!s.prototype.error.call(this,v))return!1;for(var D=0;D<m.length;D++)try{m[D].error(v)}catch{}return!0},h.prototype.lock=function(){s.prototype.lock.call(this);for(var v=this._sources,m=0;m<v.length;m++)v[m].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var n=t("../compressions"),s=t("./ZipFileWorker"),o=function(u,f){var d=u||f,p=n[d];if(!p)throw new Error(d+" is not a valid compression method !");return p};i.generateWorker=function(u,f,d){var p=new s(f.streamFiles,d,f.platform,f.encodeFileName),b=0;try{u.forEach(function(y,S){b++;var _=o(S.options.compression,f.compression),h=S.options.compressionOptions||f.compressionOptions||{},v=S.dir,m=S.date;S._compressWorker(_,h).withStreamInfo("file",{name:y,dir:v,date:m,comment:S.comment||"",unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions}).pipe(p)}),p.entriesCount=b}catch(y){p.error(y)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new n;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}n.prototype=t("./object"),n.prototype.loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(s,o){return new n().loadAsync(s,o)},n.external=t("./external"),r.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var n=t("./utils"),s=t("./external"),o=t("./utf8"),u=t("./zipEntries"),f=t("./stream/Crc32Probe"),d=t("./nodejsUtils");function p(b){return new s.Promise(function(y,S){var _=b.decompressed.getContentWorker().pipe(new f);_.on("error",function(h){S(h)}).on("end",function(){_.streamInfo.crc32!==b.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}r.exports=function(b,y){var S=this;return y=n.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(b)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",b,!0,y.optimizedBinaryString,y.base64).then(function(_){var h=new u(y);return h.load(_),h}).then(function(h){var v=[s.Promise.resolve(h)],m=h.files;if(y.checkCRC32)for(var D=0;D<m.length;D++)v.push(p(m[D]));return s.Promise.all(v)}).then(function(h){for(var v=h.shift(),m=v.files,D=0;D<m.length;D++){var O=m[D],E=O.fileNameStr,k=n.resolve(O.fileNameStr);S.file(k,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:y.createFolders}),O.dir||(S.file(k).unsafeOriginalName=E)}return v.zipComment.length&&(S.comment=v.zipComment),S})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var n=t("../utils"),s=t("../stream/GenericWorker");function o(u,f){s.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}n.inherits(o,s),o.prototype._bindStream=function(u){var f=this;this._stream=u,u.pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},o.prototype.pause=function(){return s.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return s.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var n=t("readable-stream").Readable,s=t("../utils");s.inherits(o,n);function o(u,f,d){n.call(this,f),this._helper=u;var p=this;u.on("data",function(b,y){p.push(b)||p._helper.pause(),d&&d(y)}).on("error",function(b){p.emit("error",b)}).on("end",function(){p.push(null)})}o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,s);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,s)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var s=new Buffer(n);return s.fill(0),s},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,r,i){var n=t("./utf8"),s=t("./utils"),o=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),f=t("./defaults"),d=t("./compressedObject"),p=t("./zipObject"),b=t("./generate"),y=t("./nodejsUtils"),S=t("./nodejs/NodejsStreamInputAdapter"),_=function(E,k,N){var B=s.getTypeOf(k),I,L=s.extend(N||{},f);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(E=v(E)),L.createFolders&&(I=h(E))&&m.call(this,I,!0);var K=B==="string"&&L.binary===!1&&L.base64===!1;(!N||typeof N.binary>"u")&&(L.binary=!K);var $=k instanceof d&&k.uncompressedSize===0;($||L.dir||!k||k.length===0)&&(L.base64=!1,L.binary=!0,k="",L.compression="STORE",B="string");var J=null;k instanceof d||k instanceof o?J=k:y.isNode&&y.isStream(k)?J=new S(E,k):J=s.prepareContent(E,k,L.binary,L.optimizedBinaryString,L.base64);var ne=new p(E,J,L);this.files[E]=ne},h=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var k=E.lastIndexOf("/");return k>0?E.substring(0,k):""},v=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},m=function(E,k){return k=typeof k<"u"?k:f.createFolders,E=v(E),this.files[E]||_.call(this,E,null,{dir:!0,createFolders:k}),this.files[E]};function D(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var O={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var k,N,B;for(k in this.files)B=this.files[k],N=k.slice(this.root.length,k.length),N&&k.slice(0,this.root.length)===this.root&&E(N,B)},filter:function(E){var k=[];return this.forEach(function(N,B){E(N,B)&&k.push(B)}),k},file:function(E,k,N){if(arguments.length===1)if(D(E)){var B=E;return this.filter(function(L,K){return!K.dir&&B.test(L)})}else{var I=this.files[this.root+E];return I&&!I.dir?I:null}else E=this.root+E,_.call(this,E,k,N);return this},folder:function(E){if(!E)return this;if(D(E))return this.filter(function(I,L){return L.dir&&E.test(I)});var k=this.root+E,N=m.call(this,k),B=this.clone();return B.root=N.name,B},remove:function(E){E=this.root+E;var k=this.files[E];if(k||(E.slice(-1)!=="/"&&(E+="/"),k=this.files[E]),k&&!k.dir)delete this.files[E];else for(var N=this.filter(function(I,L){return L.name.slice(0,E.length)===E}),B=0;B<N.length;B++)delete this.files[N[B].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var k,N={};try{if(N=s.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),N.type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");s.checkSupport(N.type),(N.platform==="darwin"||N.platform==="freebsd"||N.platform==="linux"||N.platform==="sunos")&&(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var B=N.comment||this.comment||"";k=b.generateWorker(this,N,B)}catch(I){k=new o("error"),k.error(I)}return new u(k,N.type||"string",N.mimeType)},generateAsync:function(E,k){return this.generateInternalStream(E).accumulate(k)},generateNodeStream:function(E,k){return E=E||{},E.type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(k)}};r.exports=O},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var n=t("./DataReader"),s=t("../utils");function o(u){n.call(this,u);for(var f=0;f<this.data.length;f++)u[f]=u[f]&255}s.inherits(o,n),o.prototype.byteAt=function(u){return this.data[this.zero+u]},o.prototype.lastIndexOfSignature=function(u){for(var f=u.charCodeAt(0),d=u.charCodeAt(1),p=u.charCodeAt(2),b=u.charCodeAt(3),y=this.length-4;y>=0;--y)if(this.data[y]===f&&this.data[y+1]===d&&this.data[y+2]===p&&this.data[y+3]===b)return y-this.zero;return-1},o.prototype.readAndCheckSignature=function(u){var f=u.charCodeAt(0),d=u.charCodeAt(1),p=u.charCodeAt(2),b=u.charCodeAt(3),y=this.readData(4);return f===y[0]&&d===y[1]&&p===y[2]&&b===y[3]},o.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,f},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var n=t("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var u=0,f;for(this.checkOffset(o),f=this.index+o-1;f>=this.index;f--)u=(u<<8)+this.byteAt(f);return this.index+=o,u},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},r.exports=s},{"../utils":32}],19:[function(t,r,i){var n=t("./Uint8ArrayReader"),s=t("../utils");function o(u){n.call(this,u)}s.inherits(o,n),o.prototype.readData=function(u){this.checkOffset(u);var f=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,f},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var n=t("./DataReader"),s=t("../utils");function o(u){n.call(this,u)}s.inherits(o,n),o.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},o.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},o.prototype.readAndCheckSignature=function(u){var f=this.readData(4);return u===f},o.prototype.readData=function(u){this.checkOffset(u);var f=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,f},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var n=t("./ArrayReader"),s=t("../utils");function o(u){n.call(this,u)}s.inherits(o,n),o.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,f},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var n=t("../utils"),s=t("../support"),o=t("./ArrayReader"),u=t("./StringReader"),f=t("./NodeBufferReader"),d=t("./Uint8ArrayReader");r.exports=function(p){var b=n.getTypeOf(p);return n.checkSupport(b),b==="string"&&!s.uint8array?new u(p):b==="nodebuffer"?new f(p):s.uint8array?new d(n.transformTo("uint8array",p)):new o(n.transformTo("array",p))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var n=t("./GenericWorker"),s=t("../utils");function o(u){n.call(this,"ConvertWorker to "+u),this.destType=u}s.inherits(o,n),o.prototype.processChunk=function(u){this.push({data:s.transformTo(this.destType,u.data),meta:u.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var n=t("./GenericWorker"),s=t("../crc32"),o=t("../utils");function u(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(u,n),u.prototype.processChunk=function(f){this.streamInfo.crc32=s(f.data,this.streamInfo.crc32||0),this.push(f)},r.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var n=t("../utils"),s=t("./GenericWorker");function o(u){s.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}n.inherits(o,s),o.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}s.prototype.processChunk.call(this,u)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var n=t("../utils"),s=t("./GenericWorker"),o=16*1024;function u(f){s.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(p){d.dataIsReady=!0,d.data=p,d.max=p&&p.length||0,d.type=n.getTypeOf(p),d.isPaused||d._tickAndRepeat()},function(p){d.error(p)})}n.inherits(u,s),u.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return s.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=o,d=null,p=Math.min(this.max,this.index+f);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,p);break;case"uint8array":d=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":d=this.data.slice(this.index,p);break}return this.index=p,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function n(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return this.isFinished?!1:(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var u=0;u<this._listeners[s].length;u++)this._listeners[s][u].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(u){o.processChunk(u)}),s.on("end",function(){o.end()}),s.on("error",function(u){o.error(u)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var s=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=n},{}],29:[function(t,r,i){var n=t("../utils"),s=t("./ConvertWorker"),o=t("./GenericWorker"),u=t("../base64"),f=t("../support"),d=t("../external"),p=null;if(f.nodestream)try{p=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(h,v,m){switch(h){case"blob":return n.newBlob(n.transformTo("arraybuffer",v),m);case"base64":return u.encode(v);default:return n.transformTo(h,v)}}function y(h,v){var m,D=0,O=null,E=0;for(m=0;m<v.length;m++)E+=v[m].length;switch(h){case"string":return v.join("");case"array":return Array.prototype.concat.apply([],v);case"uint8array":for(O=new Uint8Array(E),m=0;m<v.length;m++)O.set(v[m],D),D+=v[m].length;return O;case"nodebuffer":return Buffer.concat(v);default:throw new Error("concat : unsupported type '"+h+"'")}}function S(h,v){return new d.Promise(function(m,D){var O=[],E=h._internalType,k=h._outputType,N=h._mimeType;h.on("data",function(B,I){O.push(B),v&&v(I)}).on("error",function(B){O=[],D(B)}).on("end",function(){try{var B=b(k,y(E,O),N);m(B)}catch(I){D(I)}O=[]}).resume()})}function _(h,v,m){var D=v;switch(v){case"blob":case"arraybuffer":D="uint8array";break;case"base64":D="string";break}try{this._internalType=D,this._outputType=v,this._mimeType=m,n.checkSupport(D),this._worker=h.pipe(new s(D)),h.lock()}catch(O){this._worker=new o("error"),this._worker.error(O)}}_.prototype={accumulate:function(h){return S(this,h)},on:function(h,v){var m=this;return h==="data"?this._worker.on(h,function(D){v.call(m,D.data,D.meta)}):this._worker.on(h,function(){n.delay(v,arguments,m)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},h)}},r.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var s=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new s;o.append(n),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var n=t("./utils"),s=t("./support"),o=t("./nodejsUtils"),u=t("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;f[254]=f[254]=1;var p=function(h){var v,m,D,O,E,k=h.length,N=0;for(O=0;O<k;O++)m=h.charCodeAt(O),(m&64512)===55296&&O+1<k&&(D=h.charCodeAt(O+1),(D&64512)===56320&&(m=65536+(m-55296<<10)+(D-56320),O++)),N+=m<128?1:m<2048?2:m<65536?3:4;for(s.uint8array?v=new Uint8Array(N):v=new Array(N),E=0,O=0;E<N;O++)m=h.charCodeAt(O),(m&64512)===55296&&O+1<k&&(D=h.charCodeAt(O+1),(D&64512)===56320&&(m=65536+(m-55296<<10)+(D-56320),O++)),m<128?v[E++]=m:m<2048?(v[E++]=192|m>>>6,v[E++]=128|m&63):m<65536?(v[E++]=224|m>>>12,v[E++]=128|m>>>6&63,v[E++]=128|m&63):(v[E++]=240|m>>>18,v[E++]=128|m>>>12&63,v[E++]=128|m>>>6&63,v[E++]=128|m&63);return v},b=function(h,v){var m;for(v=v||h.length,v>h.length&&(v=h.length),m=v-1;m>=0&&(h[m]&192)===128;)m--;return m<0||m===0?v:m+f[h[m]]>v?m:v},y=function(h){var v,m,D,O,E=h.length,k=new Array(E*2);for(m=0,v=0;v<E;){if(D=h[v++],D<128){k[m++]=D;continue}if(O=f[D],O>4){k[m++]=65533,v+=O-1;continue}for(D&=O===2?31:O===3?15:7;O>1&&v<E;)D=D<<6|h[v++]&63,O--;if(O>1){k[m++]=65533;continue}D<65536?k[m++]=D:(D-=65536,k[m++]=55296|D>>10&1023,k[m++]=56320|D&1023)}return k.length!==m&&(k.subarray?k=k.subarray(0,m):k.length=m),n.applyFromCharCode(k)};i.utf8encode=function(v){return s.nodebuffer?o.newBufferFrom(v,"utf-8"):p(v)},i.utf8decode=function(v){return s.nodebuffer?n.transformTo("nodebuffer",v).toString("utf-8"):(v=n.transformTo(s.uint8array?"uint8array":"array",v),y(v))};function S(){u.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(S,u),S.prototype.processChunk=function(h){var v=n.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var m=v;v=new Uint8Array(m.length+this.leftOver.length),v.set(this.leftOver,0),v.set(m,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var D=b(v),O=v;D!==v.length&&(s.uint8array?(O=v.subarray(0,D),this.leftOver=v.subarray(D,v.length)):(O=v.slice(0,D),this.leftOver=v.slice(D,v.length))),this.push({data:i.utf8decode(O),meta:h.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=S;function _(){u.call(this,"utf-8 encode")}n.inherits(_,u),_.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var n=t("./support"),s=t("./base64"),o=t("./nodejsUtils"),u=t("./external");t("setimmediate");function f(h){var v=null;return n.uint8array?v=new Uint8Array(h.length):v=new Array(h.length),p(h,v)}i.newBlob=function(h,v){i.checkSupport("blob");try{return new Blob([h],{type:v})}catch{try{var m=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,D=new m;return D.append(h),D.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};function d(h){return h}function p(h,v){for(var m=0;m<h.length;++m)v[m]=h.charCodeAt(m)&255;return v}var b={stringifyByChunk:function(h,v,m){var D=[],O=0,E=h.length;if(E<=m)return String.fromCharCode.apply(null,h);for(;O<E;)v==="array"||v==="nodebuffer"?D.push(String.fromCharCode.apply(null,h.slice(O,Math.min(O+m,E)))):D.push(String.fromCharCode.apply(null,h.subarray(O,Math.min(O+m,E)))),O+=m;return D.join("")},stringifyByChar:function(h){for(var v="",m=0;m<h.length;m++)v+=String.fromCharCode(h[m]);return v},applyCanBeUsed:{uint8array:(function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function y(h){var v=65536,m=i.getTypeOf(h),D=!0;if(m==="uint8array"?D=b.applyCanBeUsed.uint8array:m==="nodebuffer"&&(D=b.applyCanBeUsed.nodebuffer),D)for(;v>1;)try{return b.stringifyByChunk(h,m,v)}catch{v=Math.floor(v/2)}return b.stringifyByChar(h)}i.applyFromCharCode=y;function S(h,v){for(var m=0;m<h.length;m++)v[m]=h[m];return v}var _={};_.string={string:d,array:function(h){return p(h,new Array(h.length))},arraybuffer:function(h){return _.string.uint8array(h).buffer},uint8array:function(h){return p(h,new Uint8Array(h.length))},nodebuffer:function(h){return p(h,o.allocBuffer(h.length))}},_.array={string:y,array:d,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(h)}},_.arraybuffer={string:function(h){return y(new Uint8Array(h))},array:function(h){return S(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:d,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return o.newBufferFrom(new Uint8Array(h))}},_.uint8array={string:y,array:function(h){return S(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:d,nodebuffer:function(h){return o.newBufferFrom(h)}},_.nodebuffer={string:y,array:function(h){return S(h,new Array(h.length))},arraybuffer:function(h){return _.nodebuffer.uint8array(h).buffer},uint8array:function(h){return S(h,new Uint8Array(h.length))},nodebuffer:d},i.transformTo=function(h,v){if(v||(v=""),!h)return v;i.checkSupport(h);var m=i.getTypeOf(v),D=_[m][h](v);return D},i.resolve=function(h){for(var v=h.split("/"),m=[],D=0;D<v.length;D++){var O=v[D];O==="."||O===""&&D!==0&&D!==v.length-1||(O===".."?m.pop():m.push(O))}return m.join("/")},i.getTypeOf=function(h){if(typeof h=="string")return"string";if(Object.prototype.toString.call(h)==="[object Array]")return"array";if(n.nodebuffer&&o.isBuffer(h))return"nodebuffer";if(n.uint8array&&h instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&h instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(h){var v=n[h.toLowerCase()];if(!v)throw new Error(h+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(h){var v="",m,D;for(D=0;D<(h||"").length;D++)m=h.charCodeAt(D),v+="\\x"+(m<16?"0":"")+m.toString(16).toUpperCase();return v},i.delay=function(h,v,m){setImmediate(function(){h.apply(m||null,v||[])})},i.inherits=function(h,v){var m=function(){};m.prototype=v.prototype,h.prototype=new m},i.extend=function(){var h={},v,m;for(v=0;v<arguments.length;v++)for(m in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],m)&&typeof h[m]>"u"&&(h[m]=arguments[v][m]);return h},i.prepareContent=function(h,v,m,D,O){var E=u.Promise.resolve(v).then(function(k){var N=n.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1);return N&&typeof FileReader<"u"?new u.Promise(function(B,I){var L=new FileReader;L.onload=function(K){B(K.target.result)},L.onerror=function(K){I(K.target.error)},L.readAsArrayBuffer(k)}):k});return E.then(function(k){var N=i.getTypeOf(k);return N?(N==="arraybuffer"?k=i.transformTo("uint8array",k):N==="string"&&(O?k=s.decode(k):m&&D!==!0&&(k=f(k))),k):u.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var n=t("./reader/readerFor"),s=t("./utils"),o=t("./signature"),u=t("./zipEntry"),f=t("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(b)+", expected "+s.pretty(p)+")")}},isSignature:function(p,b){var y=this.reader.index;this.reader.setIndex(p);var S=this.reader.readString(4),_=S===b;return this.reader.setIndex(y),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),b=f.uint8array?"uint8array":"array",y=s.transformTo(b,p);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p=this.zip64EndOfCentralSize-44,b=0,y,S,_;b<p;)y=this.reader.readInt(2),S=this.reader.readInt(4),_=this.reader.readData(S),this.zip64ExtensibleData[y]={id:y,length:S,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,b;for(p=0;p<this.files.length;p++)b=this.files[p],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)p=new u({zip64:this.zip64},this.loadOptions),p.readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0){var b=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw b?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(p);var y=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),p<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var S=this.centralDirOffset+this.centralDirSize;this.zip64&&(S+=20,S+=12+this.zip64EndOfCentralSize);var _=y-S;if(_>0)this.isSignature(y,o.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(p){this.reader=n(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var n=t("./reader/readerFor"),s=t("./utils"),o=t("./compressedObject"),u=t("./crc32"),f=t("./utf8"),d=t("./compressions"),p=t("./support"),b=0,y=3,S=function(h){for(var v in d)if(Object.prototype.hasOwnProperty.call(d,v)&&d[v].magic===h)return d[v];return null};function _(h,v){this.options=h,this.loadOptions=v}_.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(h){var v,m;if(h.skip(22),this.fileNameLength=h.readInt(2),m=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(v=S(this.compressionMethod),v===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var v=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(v),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),h===b&&(this.dosPermissions=this.externalFileAttributes&63),h===y&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var v=h.index+this.extraFieldsLength,m,D,O;for(this.extraFields||(this.extraFields={});h.index+4<v;)m=h.readInt(2),D=h.readInt(2),O=h.readData(D),this.extraFields[m]={id:m,length:D,value:O};h.setIndex(v)},handleUTF8:function(){var h=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var m=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var D=this.findExtraFieldUnicodeComment();if(D!==null)this.fileCommentStr=D;else{var O=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(O)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var v=n(h.value);return v.readInt(1)!==1||u(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var v=n(h.value);return v.readInt(1)!==1||u(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null}},r.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),o=t("./utf8"),u=t("./compressedObject"),f=t("./stream/GenericWorker"),d=function(S,_,h){this.name=S,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=_,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}};d.prototype={internalStream:function(S){var _=null,h="string";try{if(!S)throw new Error("No output type specified.");h=S.toLowerCase();var v=h==="string"||h==="text";(h==="binarystring"||h==="text")&&(h="string"),_=this._decompressWorker();var m=!this._dataBinary;m&&!v&&(_=_.pipe(new o.Utf8EncodeWorker)),!m&&v&&(_=_.pipe(new o.Utf8DecodeWorker))}catch(D){_=new f("error"),_.error(D)}return new n(_,h,"")},async:function(S,_){return this.internalStream(S).accumulate(_)},nodeStream:function(S,_){return this.internalStream(S||"nodebuffer").toNodejsStream(_)},_compressWorker:function(S,_){if(this._data instanceof u&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new o.Utf8EncodeWorker)),u.createWorkerFrom(h,S,_)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof f?this._data:new s(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<p.length;y++)d.prototype[p[y]]=b;r.exports=d},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,o;if(s){var u=0,f=new s(S),d=n.document.createTextNode("");f.observe(d,{characterData:!0}),o=function(){d.data=u=++u%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var p=new n.MessageChannel;p.port1.onmessage=S,o=function(){p.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var h=n.document.createElement("script");h.onreadystatechange=function(){S(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:o=function(){setTimeout(S,0)};var b,y=[];function S(){b=!0;for(var h,v,m=y.length;m;){for(v=y,y=[],h=-1;++h<m;)v[h]();m=y.length}b=!1}r.exports=_;function _(h){y.push(h)===1&&!b&&o()}}).call(this,typeof kt<"u"?kt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var n=t("immediate");function s(){}var o={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];r.exports=p;function p(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,E!==s&&_(this,E)}p.prototype.finally=function(E){if(typeof E!="function")return this;var k=this.constructor;return this.then(N,B);function N(I){function L(){return I}return k.resolve(E()).then(L)}function B(I){function L(){throw I}return k.resolve(E()).then(L)}},p.prototype.catch=function(E){return this.then(null,E)},p.prototype.then=function(E,k){if(typeof E!="function"&&this.state===f||typeof k!="function"&&this.state===u)return this;var N=new this.constructor(s);if(this.state!==d){var B=this.state===f?E:k;y(N,B,this.outcome)}else this.queue.push(new b(N,E,k));return N};function b(E,k,N){this.promise=E,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(E){o.resolve(this.promise,E)},b.prototype.otherCallFulfilled=function(E){y(this.promise,this.onFulfilled,E)},b.prototype.callRejected=function(E){o.reject(this.promise,E)},b.prototype.otherCallRejected=function(E){y(this.promise,this.onRejected,E)};function y(E,k,N){n(function(){var B;try{B=k(N)}catch(I){return o.reject(E,I)}B===E?o.reject(E,new TypeError("Cannot resolve promise with itself")):o.resolve(E,B)})}o.resolve=function(E,k){var N=h(S,k);if(N.status==="error")return o.reject(E,N.value);var B=N.value;if(B)_(E,B);else{E.state=f,E.outcome=k;for(var I=-1,L=E.queue.length;++I<L;)E.queue[I].callFulfilled(k)}return E},o.reject=function(E,k){E.state=u,E.outcome=k;for(var N=-1,B=E.queue.length;++N<B;)E.queue[N].callRejected(k);return E};function S(E){var k=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof k=="function")return function(){k.apply(E,arguments)}}function _(E,k){var N=!1;function B($){N||(N=!0,o.reject(E,$))}function I($){N||(N=!0,o.resolve(E,$))}function L(){k(I,B)}var K=h(L);K.status==="error"&&B(K.value)}function h(E,k){var N={};try{N.value=E(k),N.status="success"}catch(B){N.status="error",N.value=B}return N}p.resolve=v;function v(E){return E instanceof this?E:o.resolve(new this(s),E)}p.reject=m;function m(E){var k=new this(s);return o.reject(k,E)}p.all=D;function D(E){var k=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,B=!1;if(!N)return this.resolve([]);for(var I=new Array(N),L=0,K=-1,$=new this(s);++K<N;)J(E[K],K);return $;function J(ne,ae){k.resolve(ne).then(le,function(se){B||(B=!0,o.reject($,se))});function le(se){I[ae]=se,++L===N&&!B&&(B=!0,o.resolve($,I))}}}p.race=O;function O(E){var k=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,B=!1;if(!N)return this.resolve([]);for(var I=-1,L=new this(s);++I<N;)K(E[I]);return L;function K($){k.resolve($).then(function(J){B||(B=!0,o.resolve(L,J))},function(J){B||(B=!0,o.reject(L,J))})}}},{immediate:36}],38:[function(t,r,i){var n=t("./lib/utils/common").assign,s=t("./lib/deflate"),o=t("./lib/inflate"),u=t("./lib/zlib/constants"),f={};n(f,s,o,u),r.exports=f},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var n=t("./zlib/deflate"),s=t("./utils/common"),o=t("./utils/strings"),u=t("./zlib/messages"),f=t("./zlib/zstream"),d=Object.prototype.toString,p=0,b=4,y=0,S=1,_=2,h=-1,v=0,m=8;function D(N){if(!(this instanceof D))return new D(N);this.options=s.assign({level:h,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},N||{});var B=this.options;B.raw&&B.windowBits>0?B.windowBits=-B.windowBits:B.gzip&&B.windowBits>0&&B.windowBits<16&&(B.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var I=n.deflateInit2(this.strm,B.level,B.method,B.windowBits,B.memLevel,B.strategy);if(I!==y)throw new Error(u[I]);if(B.header&&n.deflateSetHeader(this.strm,B.header),B.dictionary){var L;if(typeof B.dictionary=="string"?L=o.string2buf(B.dictionary):d.call(B.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(B.dictionary):L=B.dictionary,I=n.deflateSetDictionary(this.strm,L),I!==y)throw new Error(u[I]);this._dict_set=!0}}D.prototype.push=function(N,B){var I=this.strm,L=this.options.chunkSize,K,$;if(this.ended)return!1;$=B===~~B?B:B===!0?b:p,typeof N=="string"?I.input=o.string2buf(N):d.call(N)==="[object ArrayBuffer]"?I.input=new Uint8Array(N):I.input=N,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new s.Buf8(L),I.next_out=0,I.avail_out=L),K=n.deflate(I,$),K!==S&&K!==y)return this.onEnd(K),this.ended=!0,!1;(I.avail_out===0||I.avail_in===0&&($===b||$===_))&&(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(I.output,I.next_out))):this.onData(s.shrinkBuf(I.output,I.next_out)))}while((I.avail_in>0||I.avail_out===0)&&K!==S);return $===b?(K=n.deflateEnd(this.strm),this.onEnd(K),this.ended=!0,K===y):($===_&&(this.onEnd(y),I.avail_out=0),!0)},D.prototype.onData=function(N){this.chunks.push(N)},D.prototype.onEnd=function(N){N===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg};function O(N,B){var I=new D(B);if(I.push(N,!0),I.err)throw I.msg||u[I.err];return I.result}function E(N,B){return B=B||{},B.raw=!0,O(N,B)}function k(N,B){return B=B||{},B.gzip=!0,O(N,B)}i.Deflate=D,i.deflate=O,i.deflateRaw=E,i.gzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var n=t("./zlib/inflate"),s=t("./utils/common"),o=t("./utils/strings"),u=t("./zlib/constants"),f=t("./zlib/messages"),d=t("./zlib/zstream"),p=t("./zlib/gzheader"),b=Object.prototype.toString;function y(h){if(!(this instanceof y))return new y(h);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},h||{});var v=this.options;v.raw&&v.windowBits>=0&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),v.windowBits>=0&&v.windowBits<16&&!(h&&h.windowBits)&&(v.windowBits+=32),v.windowBits>15&&v.windowBits<48&&(v.windowBits&15)===0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var m=n.inflateInit2(this.strm,v.windowBits);if(m!==u.Z_OK)throw new Error(f[m]);this.header=new p,n.inflateGetHeader(this.strm,this.header)}y.prototype.push=function(h,v){var m=this.strm,D=this.options.chunkSize,O=this.options.dictionary,E,k,N,B,I,L,K=!1;if(this.ended)return!1;k=v===~~v?v:v===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof h=="string"?m.input=o.binstring2buf(h):b.call(h)==="[object ArrayBuffer]"?m.input=new Uint8Array(h):m.input=h,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new s.Buf8(D),m.next_out=0,m.avail_out=D),E=n.inflate(m,u.Z_NO_FLUSH),E===u.Z_NEED_DICT&&O&&(typeof O=="string"?L=o.string2buf(O):b.call(O)==="[object ArrayBuffer]"?L=new Uint8Array(O):L=O,E=n.inflateSetDictionary(this.strm,L)),E===u.Z_BUF_ERROR&&K===!0&&(E=u.Z_OK,K=!1),E!==u.Z_STREAM_END&&E!==u.Z_OK)return this.onEnd(E),this.ended=!0,!1;m.next_out&&(m.avail_out===0||E===u.Z_STREAM_END||m.avail_in===0&&(k===u.Z_FINISH||k===u.Z_SYNC_FLUSH))&&(this.options.to==="string"?(N=o.utf8border(m.output,m.next_out),B=m.next_out-N,I=o.buf2string(m.output,N),m.next_out=B,m.avail_out=D-B,B&&s.arraySet(m.output,m.output,N,B,0),this.onData(I)):this.onData(s.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(K=!0)}while((m.avail_in>0||m.avail_out===0)&&E!==u.Z_STREAM_END);return E===u.Z_STREAM_END&&(k=u.Z_FINISH),k===u.Z_FINISH?(E=n.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===u.Z_OK):(k===u.Z_SYNC_FLUSH&&(this.onEnd(u.Z_OK),m.avail_out=0),!0)},y.prototype.onData=function(h){this.chunks.push(h)},y.prototype.onEnd=function(h){h===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function S(h,v){var m=new y(v);if(m.push(h,!0),m.err)throw m.msg||f[m.err];return m.result}function _(h,v){return v=v||{},v.raw=!0,S(h,v)}i.Inflate=y,i.inflate=S,i.inflateRaw=_,i.ungzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},i.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var s={arraySet:function(u,f,d,p,b){if(f.subarray&&u.subarray){u.set(f.subarray(d,d+p),b);return}for(var y=0;y<p;y++)u[b+y]=f[d+y]},flattenChunks:function(u){var f,d,p,b,y,S;for(p=0,f=0,d=u.length;f<d;f++)p+=u[f].length;for(S=new Uint8Array(p),b=0,f=0,d=u.length;f<d;f++)y=u[f],S.set(y,b),b+=y.length;return S}},o={arraySet:function(u,f,d,p,b){for(var y=0;y<p;y++)u[b+y]=f[d+y]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(n)},{}],42:[function(t,r,i){var n=t("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var u=new n.Buf8(256),f=0;f<256;f++)u[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;u[254]=u[254]=1,i.string2buf=function(p){var b,y,S,_,h,v=p.length,m=0;for(_=0;_<v;_++)y=p.charCodeAt(_),(y&64512)===55296&&_+1<v&&(S=p.charCodeAt(_+1),(S&64512)===56320&&(y=65536+(y-55296<<10)+(S-56320),_++)),m+=y<128?1:y<2048?2:y<65536?3:4;for(b=new n.Buf8(m),h=0,_=0;h<m;_++)y=p.charCodeAt(_),(y&64512)===55296&&_+1<v&&(S=p.charCodeAt(_+1),(S&64512)===56320&&(y=65536+(y-55296<<10)+(S-56320),_++)),y<128?b[h++]=y:y<2048?(b[h++]=192|y>>>6,b[h++]=128|y&63):y<65536?(b[h++]=224|y>>>12,b[h++]=128|y>>>6&63,b[h++]=128|y&63):(b[h++]=240|y>>>18,b[h++]=128|y>>>12&63,b[h++]=128|y>>>6&63,b[h++]=128|y&63);return b};function d(p,b){if(b<65537&&(p.subarray&&o||!p.subarray&&s))return String.fromCharCode.apply(null,n.shrinkBuf(p,b));for(var y="",S=0;S<b;S++)y+=String.fromCharCode(p[S]);return y}i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var b=new n.Buf8(p.length),y=0,S=b.length;y<S;y++)b[y]=p.charCodeAt(y);return b},i.buf2string=function(p,b){var y,S,_,h,v=b||p.length,m=new Array(v*2);for(S=0,y=0;y<v;){if(_=p[y++],_<128){m[S++]=_;continue}if(h=u[_],h>4){m[S++]=65533,y+=h-1;continue}for(_&=h===2?31:h===3?15:7;h>1&&y<v;)_=_<<6|p[y++]&63,h--;if(h>1){m[S++]=65533;continue}_<65536?m[S++]=_:(_-=65536,m[S++]=55296|_>>10&1023,m[S++]=56320|_&1023)}return d(m,S)},i.utf8border=function(p,b){var y;for(b=b||p.length,b>p.length&&(b=p.length),y=b-1;y>=0&&(p[y]&192)===128;)y--;return y<0||y===0?b:y+u[p[y]]>b?y:b}},{"./common":41}],43:[function(t,r,i){function n(s,o,u,f){for(var d=s&65535|0,p=s>>>16&65535|0,b=0;u!==0;){b=u>2e3?2e3:u,u-=b;do d=d+o[f++]|0,p=p+d|0;while(--b);d%=65521,p%=65521}return d|p<<16|0}r.exports=n},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){function n(){for(var u,f=[],d=0;d<256;d++){u=d;for(var p=0;p<8;p++)u=u&1?3988292384^u>>>1:u>>>1;f[d]=u}return f}var s=n();function o(u,f,d,p){var b=s,y=p+d;u^=-1;for(var S=p;S<y;S++)u=u>>>8^b[(u^f[S])&255];return u^-1}r.exports=o},{}],46:[function(t,r,i){var n=t("../utils/common"),s=t("./trees"),o=t("./adler32"),u=t("./crc32"),f=t("./messages"),d=0,p=1,b=3,y=4,S=5,_=0,h=1,v=-2,m=-3,D=-5,O=-1,E=1,k=2,N=3,B=4,I=0,L=2,K=8,$=9,J=15,ne=8,ae=29,le=256,se=le+1+ae,ie=30,pe=19,Ee=2*se+1,ue=15,ve=3,Te=258,we=Te+ve+1,Ne=32,Ge=42,Ve=69,_e=73,We=91,Ie=103,ke=113,Be=666,Ae=1,ze=2,Ue=3,He=4,Le=3;function Je(c,q){return c.msg=f[q],q}function rt(c){return(c<<1)-(c>4?9:0)}function et(c){for(var q=c.length;--q>=0;)c[q]=0}function De(c){var q=c.state,W=q.pending;W>c.avail_out&&(W=c.avail_out),W!==0&&(n.arraySet(c.output,q.pending_buf,q.pending_out,W,c.next_out),c.next_out+=W,q.pending_out+=W,c.total_out+=W,c.avail_out-=W,q.pending-=W,q.pending===0&&(q.pending_out=0))}function Se(c,q){s._tr_flush_block(c,c.block_start>=0?c.block_start:-1,c.strstart-c.block_start,q),c.block_start=c.strstart,De(c.strm)}function xe(c,q){c.pending_buf[c.pending++]=q}function it(c,q){c.pending_buf[c.pending++]=q>>>8&255,c.pending_buf[c.pending++]=q&255}function mt(c,q,W,x){var F=c.avail_in;return F>x&&(F=x),F===0?0:(c.avail_in-=F,n.arraySet(q,c.input,c.next_in,F,W),c.state.wrap===1?c.adler=o(c.adler,q,F,W):c.state.wrap===2&&(c.adler=u(c.adler,q,F,W)),c.next_in+=F,c.total_in+=F,F)}function dt(c,q){var W=c.max_chain_length,x=c.strstart,F,X,me=c.prev_length,fe=c.nice_match,ge=c.strstart>c.w_size-we?c.strstart-(c.w_size-we):0,Re=c.window,nt=c.w_mask,$e=c.prev,Oe=c.strstart+Te,Fe=Re[x+me-1],ot=Re[x+me];c.prev_length>=c.good_match&&(W>>=2),fe>c.lookahead&&(fe=c.lookahead);do if(F=q,!(Re[F+me]!==ot||Re[F+me-1]!==Fe||Re[F]!==Re[x]||Re[++F]!==Re[x+1])){x+=2,F++;do;while(Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&Re[++x]===Re[++F]&&x<Oe);if(X=Te-(Oe-x),x=Oe-Te,X>me){if(c.match_start=q,me=X,X>=fe)break;Fe=Re[x+me-1],ot=Re[x+me]}}while((q=$e[q&nt])>ge&&--W!==0);return me<=c.lookahead?me:c.lookahead}function Qe(c){var q=c.w_size,W,x,F,X,me;do{if(X=c.window_size-c.lookahead-c.strstart,c.strstart>=q+(q-we)){n.arraySet(c.window,c.window,q,q,0),c.match_start-=q,c.strstart-=q,c.block_start-=q,x=c.hash_size,W=x;do F=c.head[--W],c.head[W]=F>=q?F-q:0;while(--x);x=q,W=x;do F=c.prev[--W],c.prev[W]=F>=q?F-q:0;while(--x);X+=q}if(c.strm.avail_in===0)break;if(x=mt(c.strm,c.window,c.strstart+c.lookahead,X),c.lookahead+=x,c.lookahead+c.insert>=ve)for(me=c.strstart-c.insert,c.ins_h=c.window[me],c.ins_h=(c.ins_h<<c.hash_shift^c.window[me+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[me+ve-1])&c.hash_mask,c.prev[me&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=me,me++,c.insert--,!(c.lookahead+c.insert<ve)););}while(c.lookahead<we&&c.strm.avail_in!==0)}function yt(c,q){var W=65535;for(W>c.pending_buf_size-5&&(W=c.pending_buf_size-5);;){if(c.lookahead<=1){if(Qe(c),c.lookahead===0&&q===d)return Ae;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var x=c.block_start+W;if((c.strstart===0||c.strstart>=x)&&(c.lookahead=c.strstart-x,c.strstart=x,Se(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-we&&(Se(c,!1),c.strm.avail_out===0))return Ae}return c.insert=0,q===y?(Se(c,!0),c.strm.avail_out===0?Ue:He):(c.strstart>c.block_start&&(Se(c,!1),c.strm.avail_out===0),Ae)}function wt(c,q){for(var W,x;;){if(c.lookahead<we){if(Qe(c),c.lookahead<we&&q===d)return Ae;if(c.lookahead===0)break}if(W=0,c.lookahead>=ve&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+ve-1])&c.hash_mask,W=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),W!==0&&c.strstart-W<=c.w_size-we&&(c.match_length=dt(c,W)),c.match_length>=ve)if(x=s._tr_tally(c,c.strstart-c.match_start,c.match_length-ve),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=ve){c.match_length--;do c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+ve-1])&c.hash_mask,W=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart;while(--c.match_length!==0);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else x=s._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(x&&(Se(c,!1),c.strm.avail_out===0))return Ae}return c.insert=c.strstart<ve-1?c.strstart:ve-1,q===y?(Se(c,!0),c.strm.avail_out===0?Ue:He):c.last_lit&&(Se(c,!1),c.strm.avail_out===0)?Ae:ze}function ht(c,q){for(var W,x,F;;){if(c.lookahead<we){if(Qe(c),c.lookahead<we&&q===d)return Ae;if(c.lookahead===0)break}if(W=0,c.lookahead>=ve&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+ve-1])&c.hash_mask,W=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=ve-1,W!==0&&c.prev_length<c.max_lazy_match&&c.strstart-W<=c.w_size-we&&(c.match_length=dt(c,W),c.match_length<=5&&(c.strategy===E||c.match_length===ve&&c.strstart-c.match_start>4096)&&(c.match_length=ve-1)),c.prev_length>=ve&&c.match_length<=c.prev_length){F=c.strstart+c.lookahead-ve,x=s._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-ve),c.lookahead-=c.prev_length-1,c.prev_length-=2;do++c.strstart<=F&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+ve-1])&c.hash_mask,W=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart);while(--c.prev_length!==0);if(c.match_available=0,c.match_length=ve-1,c.strstart++,x&&(Se(c,!1),c.strm.avail_out===0))return Ae}else if(c.match_available){if(x=s._tr_tally(c,0,c.window[c.strstart-1]),x&&Se(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return Ae}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(x=s._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<ve-1?c.strstart:ve-1,q===y?(Se(c,!0),c.strm.avail_out===0?Ue:He):c.last_lit&&(Se(c,!1),c.strm.avail_out===0)?Ae:ze}function bt(c,q){for(var W,x,F,X,me=c.window;;){if(c.lookahead<=Te){if(Qe(c),c.lookahead<=Te&&q===d)return Ae;if(c.lookahead===0)break}if(c.match_length=0,c.lookahead>=ve&&c.strstart>0&&(F=c.strstart-1,x=me[F],x===me[++F]&&x===me[++F]&&x===me[++F])){X=c.strstart+Te;do;while(x===me[++F]&&x===me[++F]&&x===me[++F]&&x===me[++F]&&x===me[++F]&&x===me[++F]&&x===me[++F]&&x===me[++F]&&F<X);c.match_length=Te-(X-F),c.match_length>c.lookahead&&(c.match_length=c.lookahead)}if(c.match_length>=ve?(W=s._tr_tally(c,1,c.match_length-ve),c.lookahead-=c.match_length,c.strstart+=c.match_length,c.match_length=0):(W=s._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++),W&&(Se(c,!1),c.strm.avail_out===0))return Ae}return c.insert=0,q===y?(Se(c,!0),c.strm.avail_out===0?Ue:He):c.last_lit&&(Se(c,!1),c.strm.avail_out===0)?Ae:ze}function P(c,q){for(var W;;){if(c.lookahead===0&&(Qe(c),c.lookahead===0)){if(q===d)return Ae;break}if(c.match_length=0,W=s._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++,W&&(Se(c,!1),c.strm.avail_out===0))return Ae}return c.insert=0,q===y?(Se(c,!0),c.strm.avail_out===0?Ue:He):c.last_lit&&(Se(c,!1),c.strm.avail_out===0)?Ae:ze}function z(c,q,W,x,F){this.good_length=c,this.max_lazy=q,this.nice_length=W,this.max_chain=x,this.func=F}var V;V=[new z(0,0,0,0,yt),new z(4,4,8,4,wt),new z(4,5,16,8,wt),new z(4,6,32,32,wt),new z(4,4,16,16,ht),new z(8,16,32,32,ht),new z(8,16,128,128,ht),new z(8,32,128,256,ht),new z(32,128,258,1024,ht),new z(32,258,258,4096,ht)];function Q(c){c.window_size=2*c.w_size,et(c.head),c.max_lazy_match=V[c.level].max_lazy,c.good_match=V[c.level].good_length,c.nice_match=V[c.level].nice_length,c.max_chain_length=V[c.level].max_chain,c.strstart=0,c.block_start=0,c.lookahead=0,c.insert=0,c.match_length=c.prev_length=ve-1,c.match_available=0,c.ins_h=0}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=K,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(Ee*2),this.dyn_dtree=new n.Buf16((2*ie+1)*2),this.bl_tree=new n.Buf16((2*pe+1)*2),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(ue+1),this.heap=new n.Buf16(2*se+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*se+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z(c){var q;return!c||!c.state?Je(c,v):(c.total_in=c.total_out=0,c.data_type=L,q=c.state,q.pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?Ge:ke,c.adler=q.wrap===2?0:1,q.last_flush=d,s._tr_init(q),_)}function Y(c){var q=Z(c);return q===_&&Q(c.state),q}function te(c,q){return!c||!c.state||c.state.wrap!==2?v:(c.state.gzhead=q,_)}function T(c,q,W,x,F,X){if(!c)return v;var me=1;if(q===O&&(q=6),x<0?(me=0,x=-x):x>15&&(me=2,x-=16),F<1||F>$||W!==K||x<8||x>15||q<0||q>9||X<0||X>B)return Je(c,v);x===8&&(x=9);var fe=new w;return c.state=fe,fe.strm=c,fe.wrap=me,fe.gzhead=null,fe.w_bits=x,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=F+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+ve-1)/ve),fe.window=new n.Buf8(fe.w_size*2),fe.head=new n.Buf16(fe.hash_size),fe.prev=new n.Buf16(fe.w_size),fe.lit_bufsize=1<<F+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new n.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=q,fe.strategy=X,fe.method=W,Y(c)}function g(c,q){return T(c,q,K,J,ne,I)}function l(c,q){var W,x,F,X;if(!c||!c.state||q>S||q<0)return c?Je(c,v):v;if(x=c.state,!c.output||!c.input&&c.avail_in!==0||x.status===Be&&q!==y)return Je(c,c.avail_out===0?D:v);if(x.strm=c,W=x.last_flush,x.last_flush=q,x.status===Ge)if(x.wrap===2)c.adler=0,xe(x,31),xe(x,139),xe(x,8),x.gzhead?(xe(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),xe(x,x.gzhead.time&255),xe(x,x.gzhead.time>>8&255),xe(x,x.gzhead.time>>16&255),xe(x,x.gzhead.time>>24&255),xe(x,x.level===9?2:x.strategy>=k||x.level<2?4:0),xe(x,x.gzhead.os&255),x.gzhead.extra&&x.gzhead.extra.length&&(xe(x,x.gzhead.extra.length&255),xe(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(c.adler=u(c.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=Ve):(xe(x,0),xe(x,0),xe(x,0),xe(x,0),xe(x,0),xe(x,x.level===9?2:x.strategy>=k||x.level<2?4:0),xe(x,Le),x.status=ke);else{var me=K+(x.w_bits-8<<4)<<8,fe=-1;x.strategy>=k||x.level<2?fe=0:x.level<6?fe=1:x.level===6?fe=2:fe=3,me|=fe<<6,x.strstart!==0&&(me|=Ne),me+=31-me%31,x.status=ke,it(x,me),x.strstart!==0&&(it(x,c.adler>>>16),it(x,c.adler&65535)),c.adler=1}if(x.status===Ve)if(x.gzhead.extra){for(F=x.pending;x.gzindex<(x.gzhead.extra.length&65535)&&!(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),De(c),F=x.pending,x.pending===x.pending_buf_size));)xe(x,x.gzhead.extra[x.gzindex]&255),x.gzindex++;x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=_e)}else x.status=_e;if(x.status===_e)if(x.gzhead.name){F=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),De(c),F=x.pending,x.pending===x.pending_buf_size)){X=1;break}x.gzindex<x.gzhead.name.length?X=x.gzhead.name.charCodeAt(x.gzindex++)&255:X=0,xe(x,X)}while(X!==0);x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),X===0&&(x.gzindex=0,x.status=We)}else x.status=We;if(x.status===We)if(x.gzhead.comment){F=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),De(c),F=x.pending,x.pending===x.pending_buf_size)){X=1;break}x.gzindex<x.gzhead.comment.length?X=x.gzhead.comment.charCodeAt(x.gzindex++)&255:X=0,xe(x,X)}while(X!==0);x.gzhead.hcrc&&x.pending>F&&(c.adler=u(c.adler,x.pending_buf,x.pending-F,F)),X===0&&(x.status=Ie)}else x.status=Ie;if(x.status===Ie&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&De(c),x.pending+2<=x.pending_buf_size&&(xe(x,c.adler&255),xe(x,c.adler>>8&255),c.adler=0,x.status=ke)):x.status=ke),x.pending!==0){if(De(c),c.avail_out===0)return x.last_flush=-1,_}else if(c.avail_in===0&&rt(q)<=rt(W)&&q!==y)return Je(c,D);if(x.status===Be&&c.avail_in!==0)return Je(c,D);if(c.avail_in!==0||x.lookahead!==0||q!==d&&x.status!==Be){var ge=x.strategy===k?P(x,q):x.strategy===N?bt(x,q):V[x.level].func(x,q);if((ge===Ue||ge===He)&&(x.status=Be),ge===Ae||ge===Ue)return c.avail_out===0&&(x.last_flush=-1),_;if(ge===ze&&(q===p?s._tr_align(x):q!==S&&(s._tr_stored_block(x,0,0,!1),q===b&&(et(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),De(c),c.avail_out===0))return x.last_flush=-1,_}return q!==y?_:x.wrap<=0?h:(x.wrap===2?(xe(x,c.adler&255),xe(x,c.adler>>8&255),xe(x,c.adler>>16&255),xe(x,c.adler>>24&255),xe(x,c.total_in&255),xe(x,c.total_in>>8&255),xe(x,c.total_in>>16&255),xe(x,c.total_in>>24&255)):(it(x,c.adler>>>16),it(x,c.adler&65535)),De(c),x.wrap>0&&(x.wrap=-x.wrap),x.pending!==0?_:h)}function A(c){var q;return!c||!c.state?v:(q=c.state.status,q!==Ge&&q!==Ve&&q!==_e&&q!==We&&q!==Ie&&q!==ke&&q!==Be?Je(c,v):(c.state=null,q===ke?Je(c,m):_))}function M(c,q){var W=q.length,x,F,X,me,fe,ge,Re,nt;if(!c||!c.state||(x=c.state,me=x.wrap,me===2||me===1&&x.status!==Ge||x.lookahead))return v;for(me===1&&(c.adler=o(c.adler,q,W,0)),x.wrap=0,W>=x.w_size&&(me===0&&(et(x.head),x.strstart=0,x.block_start=0,x.insert=0),nt=new n.Buf8(x.w_size),n.arraySet(nt,q,W-x.w_size,x.w_size,0),q=nt,W=x.w_size),fe=c.avail_in,ge=c.next_in,Re=c.input,c.avail_in=W,c.next_in=0,c.input=q,Qe(x);x.lookahead>=ve;){F=x.strstart,X=x.lookahead-(ve-1);do x.ins_h=(x.ins_h<<x.hash_shift^x.window[F+ve-1])&x.hash_mask,x.prev[F&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=F,F++;while(--X);x.strstart=F,x.lookahead=ve-1,Qe(x)}return x.strstart+=x.lookahead,x.block_start=x.strstart,x.insert=x.lookahead,x.lookahead=0,x.match_length=x.prev_length=ve-1,x.match_available=0,c.next_in=ge,c.input=Re,c.avail_in=fe,x.wrap=me,_}i.deflateInit=g,i.deflateInit2=T,i.deflateReset=Y,i.deflateResetKeep=Z,i.deflateSetHeader=te,i.deflate=l,i.deflateEnd=A,i.deflateSetDictionary=M,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=n},{}],48:[function(t,r,i){var n=30,s=12;r.exports=function(u,f){var d,p,b,y,S,_,h,v,m,D,O,E,k,N,B,I,L,K,$,J,ne,ae,le,se,ie;d=u.state,p=u.next_in,se=u.input,b=p+(u.avail_in-5),y=u.next_out,ie=u.output,S=y-(f-u.avail_out),_=y+(u.avail_out-257),h=d.dmax,v=d.wsize,m=d.whave,D=d.wnext,O=d.window,E=d.hold,k=d.bits,N=d.lencode,B=d.distcode,I=(1<<d.lenbits)-1,L=(1<<d.distbits)-1;e:do{k<15&&(E+=se[p++]<<k,k+=8,E+=se[p++]<<k,k+=8),K=N[E&I];t:for(;;){if($=K>>>24,E>>>=$,k-=$,$=K>>>16&255,$===0)ie[y++]=K&65535;else if($&16){J=K&65535,$&=15,$&&(k<$&&(E+=se[p++]<<k,k+=8),J+=E&(1<<$)-1,E>>>=$,k-=$),k<15&&(E+=se[p++]<<k,k+=8,E+=se[p++]<<k,k+=8),K=B[E&L];r:for(;;){if($=K>>>24,E>>>=$,k-=$,$=K>>>16&255,$&16){if(ne=K&65535,$&=15,k<$&&(E+=se[p++]<<k,k+=8,k<$&&(E+=se[p++]<<k,k+=8)),ne+=E&(1<<$)-1,ne>h){u.msg="invalid distance too far back",d.mode=n;break e}if(E>>>=$,k-=$,$=y-S,ne>$){if($=ne-$,$>m&&d.sane){u.msg="invalid distance too far back",d.mode=n;break e}if(ae=0,le=O,D===0){if(ae+=v-$,$<J){J-=$;do ie[y++]=O[ae++];while(--$);ae=y-ne,le=ie}}else if(D<$){if(ae+=v+D-$,$-=D,$<J){J-=$;do ie[y++]=O[ae++];while(--$);if(ae=0,D<J){$=D,J-=$;do ie[y++]=O[ae++];while(--$);ae=y-ne,le=ie}}}else if(ae+=D-$,$<J){J-=$;do ie[y++]=O[ae++];while(--$);ae=y-ne,le=ie}for(;J>2;)ie[y++]=le[ae++],ie[y++]=le[ae++],ie[y++]=le[ae++],J-=3;J&&(ie[y++]=le[ae++],J>1&&(ie[y++]=le[ae++]))}else{ae=y-ne;do ie[y++]=ie[ae++],ie[y++]=ie[ae++],ie[y++]=ie[ae++],J-=3;while(J>2);J&&(ie[y++]=ie[ae++],J>1&&(ie[y++]=ie[ae++]))}}else if(($&64)===0){K=B[(K&65535)+(E&(1<<$)-1)];continue r}else{u.msg="invalid distance code",d.mode=n;break e}break}}else if(($&64)===0){K=N[(K&65535)+(E&(1<<$)-1)];continue t}else if($&32){d.mode=s;break e}else{u.msg="invalid literal/length code",d.mode=n;break e}break}}while(p<b&&y<_);J=k>>3,p-=J,k-=J<<3,E&=(1<<k)-1,u.next_in=p,u.next_out=y,u.avail_in=p<b?5+(b-p):5-(p-b),u.avail_out=y<_?257+(_-y):257-(y-_),d.hold=E,d.bits=k}},{}],49:[function(t,r,i){var n=t("../utils/common"),s=t("./adler32"),o=t("./crc32"),u=t("./inffast"),f=t("./inftrees"),d=0,p=1,b=2,y=4,S=5,_=6,h=0,v=1,m=2,D=-2,O=-3,E=-4,k=-5,N=8,B=1,I=2,L=3,K=4,$=5,J=6,ne=7,ae=8,le=9,se=10,ie=11,pe=12,Ee=13,ue=14,ve=15,Te=16,we=17,Ne=18,Ge=19,Ve=20,_e=21,We=22,Ie=23,ke=24,Be=25,Ae=26,ze=27,Ue=28,He=29,Le=30,Je=31,rt=32,et=852,De=592,Se=15,xe=Se;function it(T){return(T>>>24&255)+(T>>>8&65280)+((T&65280)<<8)+((T&255)<<24)}function mt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function dt(T){var g;return!T||!T.state?D:(g=T.state,T.total_in=T.total_out=g.total=0,T.msg="",g.wrap&&(T.adler=g.wrap&1),g.mode=B,g.last=0,g.havedict=0,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new n.Buf32(et),g.distcode=g.distdyn=new n.Buf32(De),g.sane=1,g.back=-1,h)}function Qe(T){var g;return!T||!T.state?D:(g=T.state,g.wsize=0,g.whave=0,g.wnext=0,dt(T))}function yt(T,g){var l,A;return!T||!T.state||(A=T.state,g<0?(l=0,g=-g):(l=(g>>4)+1,g<48&&(g&=15)),g&&(g<8||g>15))?D:(A.window!==null&&A.wbits!==g&&(A.window=null),A.wrap=l,A.wbits=g,Qe(T))}function wt(T,g){var l,A;return T?(A=new mt,T.state=A,A.window=null,l=yt(T,g),l!==h&&(T.state=null),l):D}function ht(T){return wt(T,xe)}var bt=!0,P,z;function V(T){if(bt){var g;for(P=new n.Buf32(512),z=new n.Buf32(32),g=0;g<144;)T.lens[g++]=8;for(;g<256;)T.lens[g++]=9;for(;g<280;)T.lens[g++]=7;for(;g<288;)T.lens[g++]=8;for(f(p,T.lens,0,288,P,0,T.work,{bits:9}),g=0;g<32;)T.lens[g++]=5;f(b,T.lens,0,32,z,0,T.work,{bits:5}),bt=!1}T.lencode=P,T.lenbits=9,T.distcode=z,T.distbits=5}function Q(T,g,l,A){var M,c=T.state;return c.window===null&&(c.wsize=1<<c.wbits,c.wnext=0,c.whave=0,c.window=new n.Buf8(c.wsize)),A>=c.wsize?(n.arraySet(c.window,g,l-c.wsize,c.wsize,0),c.wnext=0,c.whave=c.wsize):(M=c.wsize-c.wnext,M>A&&(M=A),n.arraySet(c.window,g,l-A,M,c.wnext),A-=M,A?(n.arraySet(c.window,g,l-A,A,0),c.wnext=A,c.whave=c.wsize):(c.wnext+=M,c.wnext===c.wsize&&(c.wnext=0),c.whave<c.wsize&&(c.whave+=M))),0}function w(T,g){var l,A,M,c,q,W,x,F,X,me,fe,ge,Re,nt,$e=0,Oe,Fe,ot,tt,Mt,Kt,st,_t,ft=new n.Buf8(4),Rt,Dt,Tr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return D;l=T.state,l.mode===pe&&(l.mode=Ee),q=T.next_out,M=T.output,x=T.avail_out,c=T.next_in,A=T.input,W=T.avail_in,F=l.hold,X=l.bits,me=W,fe=x,_t=h;e:for(;;)switch(l.mode){case B:if(l.wrap===0){l.mode=Ee;break}for(;X<16;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(l.wrap&2&&F===35615){l.check=0,ft[0]=F&255,ft[1]=F>>>8&255,l.check=o(l.check,ft,2,0),F=0,X=0,l.mode=I;break}if(l.flags=0,l.head&&(l.head.done=!1),!(l.wrap&1)||(((F&255)<<8)+(F>>8))%31){T.msg="incorrect header check",l.mode=Le;break}if((F&15)!==N){T.msg="unknown compression method",l.mode=Le;break}if(F>>>=4,X-=4,st=(F&15)+8,l.wbits===0)l.wbits=st;else if(st>l.wbits){T.msg="invalid window size",l.mode=Le;break}l.dmax=1<<st,T.adler=l.check=1,l.mode=F&512?se:pe,F=0,X=0;break;case I:for(;X<16;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(l.flags=F,(l.flags&255)!==N){T.msg="unknown compression method",l.mode=Le;break}if(l.flags&57344){T.msg="unknown header flags set",l.mode=Le;break}l.head&&(l.head.text=F>>8&1),l.flags&512&&(ft[0]=F&255,ft[1]=F>>>8&255,l.check=o(l.check,ft,2,0)),F=0,X=0,l.mode=L;case L:for(;X<32;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.head&&(l.head.time=F),l.flags&512&&(ft[0]=F&255,ft[1]=F>>>8&255,ft[2]=F>>>16&255,ft[3]=F>>>24&255,l.check=o(l.check,ft,4,0)),F=0,X=0,l.mode=K;case K:for(;X<16;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.head&&(l.head.xflags=F&255,l.head.os=F>>8),l.flags&512&&(ft[0]=F&255,ft[1]=F>>>8&255,l.check=o(l.check,ft,2,0)),F=0,X=0,l.mode=$;case $:if(l.flags&1024){for(;X<16;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.length=F,l.head&&(l.head.extra_len=F),l.flags&512&&(ft[0]=F&255,ft[1]=F>>>8&255,l.check=o(l.check,ft,2,0)),F=0,X=0}else l.head&&(l.head.extra=null);l.mode=J;case J:if(l.flags&1024&&(ge=l.length,ge>W&&(ge=W),ge&&(l.head&&(st=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),n.arraySet(l.head.extra,A,c,ge,st)),l.flags&512&&(l.check=o(l.check,A,ge,c)),W-=ge,c+=ge,l.length-=ge),l.length))break e;l.length=0,l.mode=ne;case ne:if(l.flags&2048){if(W===0)break e;ge=0;do st=A[c+ge++],l.head&&st&&l.length<65536&&(l.head.name+=String.fromCharCode(st));while(st&&ge<W);if(l.flags&512&&(l.check=o(l.check,A,ge,c)),W-=ge,c+=ge,st)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=ae;case ae:if(l.flags&4096){if(W===0)break e;ge=0;do st=A[c+ge++],l.head&&st&&l.length<65536&&(l.head.comment+=String.fromCharCode(st));while(st&&ge<W);if(l.flags&512&&(l.check=o(l.check,A,ge,c)),W-=ge,c+=ge,st)break e}else l.head&&(l.head.comment=null);l.mode=le;case le:if(l.flags&512){for(;X<16;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(F!==(l.check&65535)){T.msg="header crc mismatch",l.mode=Le;break}F=0,X=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),T.adler=l.check=0,l.mode=pe;break;case se:for(;X<32;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}T.adler=l.check=it(F),F=0,X=0,l.mode=ie;case ie:if(l.havedict===0)return T.next_out=q,T.avail_out=x,T.next_in=c,T.avail_in=W,l.hold=F,l.bits=X,m;T.adler=l.check=1,l.mode=pe;case pe:if(g===S||g===_)break e;case Ee:if(l.last){F>>>=X&7,X-=X&7,l.mode=ze;break}for(;X<3;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}switch(l.last=F&1,F>>>=1,X-=1,F&3){case 0:l.mode=ue;break;case 1:if(V(l),l.mode=Ve,g===_){F>>>=2,X-=2;break e}break;case 2:l.mode=we;break;case 3:T.msg="invalid block type",l.mode=Le}F>>>=2,X-=2;break;case ue:for(F>>>=X&7,X-=X&7;X<32;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if((F&65535)!==(F>>>16^65535)){T.msg="invalid stored block lengths",l.mode=Le;break}if(l.length=F&65535,F=0,X=0,l.mode=ve,g===_)break e;case ve:l.mode=Te;case Te:if(ge=l.length,ge){if(ge>W&&(ge=W),ge>x&&(ge=x),ge===0)break e;n.arraySet(M,A,c,ge,q),W-=ge,c+=ge,x-=ge,q+=ge,l.length-=ge;break}l.mode=pe;break;case we:for(;X<14;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(l.nlen=(F&31)+257,F>>>=5,X-=5,l.ndist=(F&31)+1,F>>>=5,X-=5,l.ncode=(F&15)+4,F>>>=4,X-=4,l.nlen>286||l.ndist>30){T.msg="too many length or distance symbols",l.mode=Le;break}l.have=0,l.mode=Ne;case Ne:for(;l.have<l.ncode;){for(;X<3;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.lens[Tr[l.have++]]=F&7,F>>>=3,X-=3}for(;l.have<19;)l.lens[Tr[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,Rt={bits:l.lenbits},_t=f(d,l.lens,0,19,l.lencode,0,l.work,Rt),l.lenbits=Rt.bits,_t){T.msg="invalid code lengths set",l.mode=Le;break}l.have=0,l.mode=Ge;case Ge:for(;l.have<l.nlen+l.ndist;){for(;$e=l.lencode[F&(1<<l.lenbits)-1],Oe=$e>>>24,Fe=$e>>>16&255,ot=$e&65535,!(Oe<=X);){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(ot<16)F>>>=Oe,X-=Oe,l.lens[l.have++]=ot;else{if(ot===16){for(Dt=Oe+2;X<Dt;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(F>>>=Oe,X-=Oe,l.have===0){T.msg="invalid bit length repeat",l.mode=Le;break}st=l.lens[l.have-1],ge=3+(F&3),F>>>=2,X-=2}else if(ot===17){for(Dt=Oe+3;X<Dt;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}F>>>=Oe,X-=Oe,st=0,ge=3+(F&7),F>>>=3,X-=3}else{for(Dt=Oe+7;X<Dt;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}F>>>=Oe,X-=Oe,st=0,ge=11+(F&127),F>>>=7,X-=7}if(l.have+ge>l.nlen+l.ndist){T.msg="invalid bit length repeat",l.mode=Le;break}for(;ge--;)l.lens[l.have++]=st}}if(l.mode===Le)break;if(l.lens[256]===0){T.msg="invalid code -- missing end-of-block",l.mode=Le;break}if(l.lenbits=9,Rt={bits:l.lenbits},_t=f(p,l.lens,0,l.nlen,l.lencode,0,l.work,Rt),l.lenbits=Rt.bits,_t){T.msg="invalid literal/lengths set",l.mode=Le;break}if(l.distbits=6,l.distcode=l.distdyn,Rt={bits:l.distbits},_t=f(b,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,Rt),l.distbits=Rt.bits,_t){T.msg="invalid distances set",l.mode=Le;break}if(l.mode=Ve,g===_)break e;case Ve:l.mode=_e;case _e:if(W>=6&&x>=258){T.next_out=q,T.avail_out=x,T.next_in=c,T.avail_in=W,l.hold=F,l.bits=X,u(T,fe),q=T.next_out,M=T.output,x=T.avail_out,c=T.next_in,A=T.input,W=T.avail_in,F=l.hold,X=l.bits,l.mode===pe&&(l.back=-1);break}for(l.back=0;$e=l.lencode[F&(1<<l.lenbits)-1],Oe=$e>>>24,Fe=$e>>>16&255,ot=$e&65535,!(Oe<=X);){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(Fe&&(Fe&240)===0){for(tt=Oe,Mt=Fe,Kt=ot;$e=l.lencode[Kt+((F&(1<<tt+Mt)-1)>>tt)],Oe=$e>>>24,Fe=$e>>>16&255,ot=$e&65535,!(tt+Oe<=X);){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}F>>>=tt,X-=tt,l.back+=tt}if(F>>>=Oe,X-=Oe,l.back+=Oe,l.length=ot,Fe===0){l.mode=Ae;break}if(Fe&32){l.back=-1,l.mode=pe;break}if(Fe&64){T.msg="invalid literal/length code",l.mode=Le;break}l.extra=Fe&15,l.mode=We;case We:if(l.extra){for(Dt=l.extra;X<Dt;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.length+=F&(1<<l.extra)-1,F>>>=l.extra,X-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=Ie;case Ie:for(;$e=l.distcode[F&(1<<l.distbits)-1],Oe=$e>>>24,Fe=$e>>>16&255,ot=$e&65535,!(Oe<=X);){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if((Fe&240)===0){for(tt=Oe,Mt=Fe,Kt=ot;$e=l.distcode[Kt+((F&(1<<tt+Mt)-1)>>tt)],Oe=$e>>>24,Fe=$e>>>16&255,ot=$e&65535,!(tt+Oe<=X);){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}F>>>=tt,X-=tt,l.back+=tt}if(F>>>=Oe,X-=Oe,l.back+=Oe,Fe&64){T.msg="invalid distance code",l.mode=Le;break}l.offset=ot,l.extra=Fe&15,l.mode=ke;case ke:if(l.extra){for(Dt=l.extra;X<Dt;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}l.offset+=F&(1<<l.extra)-1,F>>>=l.extra,X-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){T.msg="invalid distance too far back",l.mode=Le;break}l.mode=Be;case Be:if(x===0)break e;if(ge=fe-x,l.offset>ge){if(ge=l.offset-ge,ge>l.whave&&l.sane){T.msg="invalid distance too far back",l.mode=Le;break}ge>l.wnext?(ge-=l.wnext,Re=l.wsize-ge):Re=l.wnext-ge,ge>l.length&&(ge=l.length),nt=l.window}else nt=M,Re=q-l.offset,ge=l.length;ge>x&&(ge=x),x-=ge,l.length-=ge;do M[q++]=nt[Re++];while(--ge);l.length===0&&(l.mode=_e);break;case Ae:if(x===0)break e;M[q++]=l.length,x--,l.mode=_e;break;case ze:if(l.wrap){for(;X<32;){if(W===0)break e;W--,F|=A[c++]<<X,X+=8}if(fe-=x,T.total_out+=fe,l.total+=fe,fe&&(T.adler=l.check=l.flags?o(l.check,M,fe,q-fe):s(l.check,M,fe,q-fe)),fe=x,(l.flags?F:it(F))!==l.check){T.msg="incorrect data check",l.mode=Le;break}F=0,X=0}l.mode=Ue;case Ue:if(l.wrap&&l.flags){for(;X<32;){if(W===0)break e;W--,F+=A[c++]<<X,X+=8}if(F!==(l.total&4294967295)){T.msg="incorrect length check",l.mode=Le;break}F=0,X=0}l.mode=He;case He:_t=v;break e;case Le:_t=O;break e;case Je:return E;case rt:default:return D}return T.next_out=q,T.avail_out=x,T.next_in=c,T.avail_in=W,l.hold=F,l.bits=X,(l.wsize||fe!==T.avail_out&&l.mode<Le&&(l.mode<ze||g!==y))&&Q(T,T.output,T.next_out,fe-T.avail_out),me-=T.avail_in,fe-=T.avail_out,T.total_in+=me,T.total_out+=fe,l.total+=fe,l.wrap&&fe&&(T.adler=l.check=l.flags?o(l.check,M,fe,T.next_out-fe):s(l.check,M,fe,T.next_out-fe)),T.data_type=l.bits+(l.last?64:0)+(l.mode===pe?128:0)+(l.mode===Ve||l.mode===ve?256:0),(me===0&&fe===0||g===y)&&_t===h&&(_t=k),_t}function Z(T){if(!T||!T.state)return D;var g=T.state;return g.window&&(g.window=null),T.state=null,h}function Y(T,g){var l;return!T||!T.state||(l=T.state,(l.wrap&2)===0)?D:(l.head=g,g.done=!1,h)}function te(T,g){var l=g.length,A,M,c;return!T||!T.state||(A=T.state,A.wrap!==0&&A.mode!==ie)?D:A.mode===ie&&(M=1,M=s(M,g,l,0),M!==A.check)?O:(c=Q(T,g,l,l),c?(A.mode=Je,E):(A.havedict=1,h))}i.inflateReset=Qe,i.inflateReset2=yt,i.inflateResetKeep=dt,i.inflateInit=ht,i.inflateInit2=wt,i.inflate=w,i.inflateEnd=Z,i.inflateGetHeader=Y,i.inflateSetDictionary=te,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var n=t("../utils/common"),s=15,o=852,u=592,f=0,d=1,p=2,b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(v,m,D,O,E,k,N,B){var I=B.bits,L=0,K=0,$=0,J=0,ne=0,ae=0,le=0,se=0,ie=0,pe=0,Ee,ue,ve,Te,we,Ne=null,Ge=0,Ve,_e=new n.Buf16(s+1),We=new n.Buf16(s+1),Ie=null,ke=0,Be,Ae,ze;for(L=0;L<=s;L++)_e[L]=0;for(K=0;K<O;K++)_e[m[D+K]]++;for(ne=I,J=s;J>=1&&_e[J]===0;J--);if(ne>J&&(ne=J),J===0)return E[k++]=1<<24|64<<16|0,E[k++]=1<<24|64<<16|0,B.bits=1,0;for($=1;$<J&&_e[$]===0;$++);for(ne<$&&(ne=$),se=1,L=1;L<=s;L++)if(se<<=1,se-=_e[L],se<0)return-1;if(se>0&&(v===f||J!==1))return-1;for(We[1]=0,L=1;L<s;L++)We[L+1]=We[L]+_e[L];for(K=0;K<O;K++)m[D+K]!==0&&(N[We[m[D+K]]++]=K);if(v===f?(Ne=Ie=N,Ve=19):v===d?(Ne=b,Ge-=257,Ie=y,ke-=257,Ve=256):(Ne=S,Ie=_,Ve=-1),pe=0,K=0,L=$,we=k,ae=ne,le=0,ve=-1,ie=1<<ne,Te=ie-1,v===d&&ie>o||v===p&&ie>u)return 1;for(;;){Be=L-le,N[K]<Ve?(Ae=0,ze=N[K]):N[K]>Ve?(Ae=Ie[ke+N[K]],ze=Ne[Ge+N[K]]):(Ae=96,ze=0),Ee=1<<L-le,ue=1<<ae,$=ue;do ue-=Ee,E[we+(pe>>le)+ue]=Be<<24|Ae<<16|ze|0;while(ue!==0);for(Ee=1<<L-1;pe&Ee;)Ee>>=1;if(Ee!==0?(pe&=Ee-1,pe+=Ee):pe=0,K++,--_e[L]===0){if(L===J)break;L=m[D+N[K]]}if(L>ne&&(pe&Te)!==ve){for(le===0&&(le=ne),we+=$,ae=L-le,se=1<<ae;ae+le<J&&(se-=_e[ae+le],!(se<=0));)ae++,se<<=1;if(ie+=1<<ae,v===d&&ie>o||v===p&&ie>u)return 1;ve=pe&Te,E[ve]=ne<<24|ae<<16|we-k|0}}return pe!==0&&(E[we+pe]=L-le<<24|64<<16|0),B.bits=ne,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var n=t("../utils/common"),s=4,o=0,u=1,f=2;function d(w){for(var Z=w.length;--Z>=0;)w[Z]=0}var p=0,b=1,y=2,S=3,_=258,h=29,v=256,m=v+1+h,D=30,O=19,E=2*m+1,k=15,N=16,B=7,I=256,L=16,K=17,$=18,J=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ne=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=512,ie=new Array((m+2)*2);d(ie);var pe=new Array(D*2);d(pe);var Ee=new Array(se);d(Ee);var ue=new Array(_-S+1);d(ue);var ve=new Array(h);d(ve);var Te=new Array(D);d(Te);function we(w,Z,Y,te,T){this.static_tree=w,this.extra_bits=Z,this.extra_base=Y,this.elems=te,this.max_length=T,this.has_stree=w&&w.length}var Ne,Ge,Ve;function _e(w,Z){this.dyn_tree=w,this.max_code=0,this.stat_desc=Z}function We(w){return w<256?Ee[w]:Ee[256+(w>>>7)]}function Ie(w,Z){w.pending_buf[w.pending++]=Z&255,w.pending_buf[w.pending++]=Z>>>8&255}function ke(w,Z,Y){w.bi_valid>N-Y?(w.bi_buf|=Z<<w.bi_valid&65535,Ie(w,w.bi_buf),w.bi_buf=Z>>N-w.bi_valid,w.bi_valid+=Y-N):(w.bi_buf|=Z<<w.bi_valid&65535,w.bi_valid+=Y)}function Be(w,Z,Y){ke(w,Y[Z*2],Y[Z*2+1])}function Ae(w,Z){var Y=0;do Y|=w&1,w>>>=1,Y<<=1;while(--Z>0);return Y>>>1}function ze(w){w.bi_valid===16?(Ie(w,w.bi_buf),w.bi_buf=0,w.bi_valid=0):w.bi_valid>=8&&(w.pending_buf[w.pending++]=w.bi_buf&255,w.bi_buf>>=8,w.bi_valid-=8)}function Ue(w,Z){var Y=Z.dyn_tree,te=Z.max_code,T=Z.stat_desc.static_tree,g=Z.stat_desc.has_stree,l=Z.stat_desc.extra_bits,A=Z.stat_desc.extra_base,M=Z.stat_desc.max_length,c,q,W,x,F,X,me=0;for(x=0;x<=k;x++)w.bl_count[x]=0;for(Y[w.heap[w.heap_max]*2+1]=0,c=w.heap_max+1;c<E;c++)q=w.heap[c],x=Y[Y[q*2+1]*2+1]+1,x>M&&(x=M,me++),Y[q*2+1]=x,!(q>te)&&(w.bl_count[x]++,F=0,q>=A&&(F=l[q-A]),X=Y[q*2],w.opt_len+=X*(x+F),g&&(w.static_len+=X*(T[q*2+1]+F)));if(me!==0){do{for(x=M-1;w.bl_count[x]===0;)x--;w.bl_count[x]--,w.bl_count[x+1]+=2,w.bl_count[M]--,me-=2}while(me>0);for(x=M;x!==0;x--)for(q=w.bl_count[x];q!==0;)W=w.heap[--c],!(W>te)&&(Y[W*2+1]!==x&&(w.opt_len+=(x-Y[W*2+1])*Y[W*2],Y[W*2+1]=x),q--)}}function He(w,Z,Y){var te=new Array(k+1),T=0,g,l;for(g=1;g<=k;g++)te[g]=T=T+Y[g-1]<<1;for(l=0;l<=Z;l++){var A=w[l*2+1];A!==0&&(w[l*2]=Ae(te[A]++,A))}}function Le(){var w,Z,Y,te,T,g=new Array(k+1);for(Y=0,te=0;te<h-1;te++)for(ve[te]=Y,w=0;w<1<<J[te];w++)ue[Y++]=te;for(ue[Y-1]=te,T=0,te=0;te<16;te++)for(Te[te]=T,w=0;w<1<<ne[te];w++)Ee[T++]=te;for(T>>=7;te<D;te++)for(Te[te]=T<<7,w=0;w<1<<ne[te]-7;w++)Ee[256+T++]=te;for(Z=0;Z<=k;Z++)g[Z]=0;for(w=0;w<=143;)ie[w*2+1]=8,w++,g[8]++;for(;w<=255;)ie[w*2+1]=9,w++,g[9]++;for(;w<=279;)ie[w*2+1]=7,w++,g[7]++;for(;w<=287;)ie[w*2+1]=8,w++,g[8]++;for(He(ie,m+1,g),w=0;w<D;w++)pe[w*2+1]=5,pe[w*2]=Ae(w,5);Ne=new we(ie,J,v+1,m,k),Ge=new we(pe,ne,0,D,k),Ve=new we(new Array(0),ae,0,O,B)}function Je(w){var Z;for(Z=0;Z<m;Z++)w.dyn_ltree[Z*2]=0;for(Z=0;Z<D;Z++)w.dyn_dtree[Z*2]=0;for(Z=0;Z<O;Z++)w.bl_tree[Z*2]=0;w.dyn_ltree[I*2]=1,w.opt_len=w.static_len=0,w.last_lit=w.matches=0}function rt(w){w.bi_valid>8?Ie(w,w.bi_buf):w.bi_valid>0&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0}function et(w,Z,Y,te){rt(w),Ie(w,Y),Ie(w,~Y),n.arraySet(w.pending_buf,w.window,Z,Y,w.pending),w.pending+=Y}function De(w,Z,Y,te){var T=Z*2,g=Y*2;return w[T]<w[g]||w[T]===w[g]&&te[Z]<=te[Y]}function Se(w,Z,Y){for(var te=w.heap[Y],T=Y<<1;T<=w.heap_len&&(T<w.heap_len&&De(Z,w.heap[T+1],w.heap[T],w.depth)&&T++,!De(Z,te,w.heap[T],w.depth));)w.heap[Y]=w.heap[T],Y=T,T<<=1;w.heap[Y]=te}function xe(w,Z,Y){var te,T,g=0,l,A;if(w.last_lit!==0)do te=w.pending_buf[w.d_buf+g*2]<<8|w.pending_buf[w.d_buf+g*2+1],T=w.pending_buf[w.l_buf+g],g++,te===0?Be(w,T,Z):(l=ue[T],Be(w,l+v+1,Z),A=J[l],A!==0&&(T-=ve[l],ke(w,T,A)),te--,l=We(te),Be(w,l,Y),A=ne[l],A!==0&&(te-=Te[l],ke(w,te,A)));while(g<w.last_lit);Be(w,I,Z)}function it(w,Z){var Y=Z.dyn_tree,te=Z.stat_desc.static_tree,T=Z.stat_desc.has_stree,g=Z.stat_desc.elems,l,A,M=-1,c;for(w.heap_len=0,w.heap_max=E,l=0;l<g;l++)Y[l*2]!==0?(w.heap[++w.heap_len]=M=l,w.depth[l]=0):Y[l*2+1]=0;for(;w.heap_len<2;)c=w.heap[++w.heap_len]=M<2?++M:0,Y[c*2]=1,w.depth[c]=0,w.opt_len--,T&&(w.static_len-=te[c*2+1]);for(Z.max_code=M,l=w.heap_len>>1;l>=1;l--)Se(w,Y,l);c=g;do l=w.heap[1],w.heap[1]=w.heap[w.heap_len--],Se(w,Y,1),A=w.heap[1],w.heap[--w.heap_max]=l,w.heap[--w.heap_max]=A,Y[c*2]=Y[l*2]+Y[A*2],w.depth[c]=(w.depth[l]>=w.depth[A]?w.depth[l]:w.depth[A])+1,Y[l*2+1]=Y[A*2+1]=c,w.heap[1]=c++,Se(w,Y,1);while(w.heap_len>=2);w.heap[--w.heap_max]=w.heap[1],Ue(w,Z),He(Y,M,w.bl_count)}function mt(w,Z,Y){var te,T=-1,g,l=Z[1],A=0,M=7,c=4;for(l===0&&(M=138,c=3),Z[(Y+1)*2+1]=65535,te=0;te<=Y;te++)g=l,l=Z[(te+1)*2+1],!(++A<M&&g===l)&&(A<c?w.bl_tree[g*2]+=A:g!==0?(g!==T&&w.bl_tree[g*2]++,w.bl_tree[L*2]++):A<=10?w.bl_tree[K*2]++:w.bl_tree[$*2]++,A=0,T=g,l===0?(M=138,c=3):g===l?(M=6,c=3):(M=7,c=4))}function dt(w,Z,Y){var te,T=-1,g,l=Z[1],A=0,M=7,c=4;for(l===0&&(M=138,c=3),te=0;te<=Y;te++)if(g=l,l=Z[(te+1)*2+1],!(++A<M&&g===l)){if(A<c)do Be(w,g,w.bl_tree);while(--A!==0);else g!==0?(g!==T&&(Be(w,g,w.bl_tree),A--),Be(w,L,w.bl_tree),ke(w,A-3,2)):A<=10?(Be(w,K,w.bl_tree),ke(w,A-3,3)):(Be(w,$,w.bl_tree),ke(w,A-11,7));A=0,T=g,l===0?(M=138,c=3):g===l?(M=6,c=3):(M=7,c=4)}}function Qe(w){var Z;for(mt(w,w.dyn_ltree,w.l_desc.max_code),mt(w,w.dyn_dtree,w.d_desc.max_code),it(w,w.bl_desc),Z=O-1;Z>=3&&w.bl_tree[le[Z]*2+1]===0;Z--);return w.opt_len+=3*(Z+1)+5+5+4,Z}function yt(w,Z,Y,te){var T;for(ke(w,Z-257,5),ke(w,Y-1,5),ke(w,te-4,4),T=0;T<te;T++)ke(w,w.bl_tree[le[T]*2+1],3);dt(w,w.dyn_ltree,Z-1),dt(w,w.dyn_dtree,Y-1)}function wt(w){var Z=4093624447,Y;for(Y=0;Y<=31;Y++,Z>>>=1)if(Z&1&&w.dyn_ltree[Y*2]!==0)return o;if(w.dyn_ltree[18]!==0||w.dyn_ltree[20]!==0||w.dyn_ltree[26]!==0)return u;for(Y=32;Y<v;Y++)if(w.dyn_ltree[Y*2]!==0)return u;return o}var ht=!1;function bt(w){ht||(Le(),ht=!0),w.l_desc=new _e(w.dyn_ltree,Ne),w.d_desc=new _e(w.dyn_dtree,Ge),w.bl_desc=new _e(w.bl_tree,Ve),w.bi_buf=0,w.bi_valid=0,Je(w)}function P(w,Z,Y,te){ke(w,(p<<1)+(te?1:0),3),et(w,Z,Y)}function z(w){ke(w,b<<1,3),Be(w,I,ie),ze(w)}function V(w,Z,Y,te){var T,g,l=0;w.level>0?(w.strm.data_type===f&&(w.strm.data_type=wt(w)),it(w,w.l_desc),it(w,w.d_desc),l=Qe(w),T=w.opt_len+3+7>>>3,g=w.static_len+3+7>>>3,g<=T&&(T=g)):T=g=Y+5,Y+4<=T&&Z!==-1?P(w,Z,Y,te):w.strategy===s||g===T?(ke(w,(b<<1)+(te?1:0),3),xe(w,ie,pe)):(ke(w,(y<<1)+(te?1:0),3),yt(w,w.l_desc.max_code+1,w.d_desc.max_code+1,l+1),xe(w,w.dyn_ltree,w.dyn_dtree)),Je(w),te&&rt(w)}function Q(w,Z,Y){return w.pending_buf[w.d_buf+w.last_lit*2]=Z>>>8&255,w.pending_buf[w.d_buf+w.last_lit*2+1]=Z&255,w.pending_buf[w.l_buf+w.last_lit]=Y&255,w.last_lit++,Z===0?w.dyn_ltree[Y*2]++:(w.matches++,Z--,w.dyn_ltree[(ue[Y]+v+1)*2]++,w.dyn_dtree[We(Z)*2]++),w.last_lit===w.lit_bufsize-1}i._tr_init=bt,i._tr_stored_block=P,i._tr_flush_block=V,i._tr_tally=Q,i._tr_align=z},{"../utils/common":41}],53:[function(t,r,i){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=n},{}],54:[function(t,r,i){(function(n){(function(s,o){if(s.setImmediate)return;var u=1,f={},d=!1,p=s.document,b;function y(B){typeof B!="function"&&(B=new Function(""+B));for(var I=new Array(arguments.length-1),L=0;L<I.length;L++)I[L]=arguments[L+1];var K={callback:B,args:I};return f[u]=K,b(u),u++}function S(B){delete f[B]}function _(B){var I=B.callback,L=B.args;switch(L.length){case 0:I();break;case 1:I(L[0]);break;case 2:I(L[0],L[1]);break;case 3:I(L[0],L[1],L[2]);break;default:I.apply(o,L);break}}function h(B){if(d)setTimeout(h,0,B);else{var I=f[B];if(I){d=!0;try{_(I)}finally{S(B),d=!1}}}}function v(){b=function(B){process.nextTick(function(){h(B)})}}function m(){if(s.postMessage&&!s.importScripts){var B=!0,I=s.onmessage;return s.onmessage=function(){B=!1},s.postMessage("","*"),s.onmessage=I,B}}function D(){var B="setImmediate$"+Math.random()+"$",I=function(L){L.source===s&&typeof L.data=="string"&&L.data.indexOf(B)===0&&h(+L.data.slice(B.length))};s.addEventListener?s.addEventListener("message",I,!1):s.attachEvent("onmessage",I),b=function(L){s.postMessage(B+L,"*")}}function O(){var B=new MessageChannel;B.port1.onmessage=function(I){var L=I.data;h(L)},b=function(I){B.port2.postMessage(I)}}function E(){var B=p.documentElement;b=function(I){var L=p.createElement("script");L.onreadystatechange=function(){h(I),L.onreadystatechange=null,B.removeChild(L),L=null},B.appendChild(L)}}function k(){b=function(B){setTimeout(h,0,B)}}var N=Object.getPrototypeOf&&Object.getPrototypeOf(s);N=N&&N.setTimeout?N:s,{}.toString.call(s.process)==="[object process]"?v():m()?D():s.MessageChannel?O():p&&"onreadystatechange"in p.createElement("script")?E():k(),N.setImmediate=y,N.clearImmediate=S})(typeof self>"u"?typeof n>"u"?this:n:self)}).call(this,typeof kt<"u"?kt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Gi)),Gi.exports}var du=fu();const pu=hr(du);class gu{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new pu}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return Er(e,"binary").then(function(r){return this.zip.loadAsync(r,{base64:t})}.bind(this))}request(e,t){var r=new qe,i,n=new Vt(e);return t||(t=n.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i?i.then(function(s){let o=this.handleResponse(s,t);r.resolve(o)}.bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):_r(t)?r=zt(e,"text/xml"):t=="xhtml"?r=zt(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=zt(e,"text/html"):r=e,r}getBlob(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||ur.lookup(i.name),i.async("uint8array").then(function(n){return new Blob([n],{type:t})})}getText(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return i.async("string").then(function(n){return n})}getBase64(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||ur.lookup(i.name),i.async("base64").then(function(n){return"data:"+t+";base64,"+n})}createUrl(e,t){var r=new qe,i=window.URL||window.webkitURL||window.mozURL,n,s,o=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(o?(s=this.getBase64(e),s&&s.then(function(u){this.urlCache[e]=u,r.resolve(u)}.bind(this))):(s=this.getBlob(e),s&&s.then(function(u){n=i.createObjectURL(u),this.urlCache[e]=n,r.resolve(n)}.bind(this))),s||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}class fa{constructor(e,t,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||Er,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Me>"u"&&(e=Me),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let r=e.resources.map(i=>{let{href:n}=i,s=this.resolver(n),o=window.encodeURIComponent(s);return this.storage.getItem(o).then(u=>!u||t?this.requester(s,"binary").then(f=>this.storage.setItem(o,f)):u)});return Promise.all(r)}put(e,t,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(n=>n||this.requester(e,"binary",t,r).then(s=>this.storage.setItem(i,s)))}request(e,t,r,i){return this.online?this.requester(e,t,r,i).then(n=>(this.put(e),n)):this.retrieve(e,t)}retrieve(e,t){new qe;var r,i=new Vt(e);return t||(t=i.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(n=>{var s=new qe,o;return n?(o=this.handleResponse(n,t),s.resolve(o)):s.reject({message:"File not found in storage: "+e,stack:new Error().stack}),s.promise})}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):_r(t)?r=zt(e,"text/xml"):t=="xhtml"?r=zt(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=zt(e,"text/html"):r=e,r}getBlob(e,t){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(i){if(i)return t=t||ur.lookup(e),new Blob([i],{type:t})})}getText(e,t){let r=window.encodeURIComponent(e);return t=t||ur.lookup(e),this.storage.getItem(r).then(function(i){var n=new qe,s=new FileReader,o;if(i)return o=new Blob([i],{type:t}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsText(o,t),n.promise})}getBase64(e,t){let r=window.encodeURIComponent(e);return t=t||ur.lookup(e),this.storage.getItem(r).then(i=>{var n=new qe,s=new FileReader,o;if(i)return o=new Blob([i],{type:t}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsDataURL(o,t),n.promise})}createUrl(e,t){var r=new qe,i=window.URL||window.webkitURL||window.mozURL,n,s,o=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(o?(s=this.getBase64(e),s&&s.then(function(u){this.urlCache[e]=u,r.resolve(u)}.bind(this))):(s=this.getBlob(e),s&&s.then(function(u){n=i.createObjectURL(u),this.urlCache[e]=n,r.resolve(n)}.bind(this))),s||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}Ut(fa.prototype);class Zi{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=Ke(e,"display_options");return t?(Ht(t,"option").forEach(i=>{let n="";switch(i.childNodes.length&&(n=i.childNodes[0].nodeValue),i.attributes.name.value){case"interactive":this.interactive=n;break;case"fixed-layout":this.fixedLayout=n;break;case"open-to-spread":this.openToSpread=n;break;case"orientation-lock":this.orientationLock=n;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const As="META-INF/container.xml",vu="META-INF/com.apple.ibooks.display-options.xml",It={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class yn{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=gt(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),gt(this.settings,t),this.opening=new qe,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new qe,spine:new qe,metadata:new qe,cover:new qe,navigation:new qe,pageList:new qe,resources:new qe,displayOptions:new qe},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||Er,this.spine=new Io,this.locations=new na(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var i=new Error("Cannot load book at "+e);this.emit(ye.BOOK.OPEN_FAILED,i)})}open(e,t){var r,i=t||this.determineType(e);return i===It.BINARY?(this.archived=!0,this.url=new Bt("/",""),r=this.openEpub(e)):i===It.BASE64?(this.archived=!0,this.url=new Bt("/",""),r=this.openEpub(e,i)):i===It.EPUB?(this.archived=!0,this.url=new Bt("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==It.OPF?(this.url=new Bt(e),r=this.openPackaging(this.url.Path.toString())):i==It.MANIFEST?(this.url=new Bt(e),r=this.openManifest(this.url.Path.toString())):(this.url=new Bt(e),r=this.openContainer(As).then(this.openPackaging.bind(this))),r}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(As)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(t=>(this.container=new Oo(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Vt(e),this.load(e).then(t=>(this.packaging=new is(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new Vt(e),this.load(e).then(t=>(this.packaging=new is,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var r=e,i=e.indexOf("://")>-1;return i?e:(this.path&&(r=this.path.resolve(e)),t!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,r,i;if(this.settings.encoding==="base64")return It.BASE64;if(typeof e!="string")return It.BINARY;if(t=new Bt(e),r=t.path(),i=r.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return It.DIRECTORY;if(i==="epub")return It.EPUB;if(i==="opf")return It.OPF;if(i==="json")return It.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(vu)).then(t=>{this.displayOptions=new Zi(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new Zi,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Zi,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new Po(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((i,n)=>{this.navigation=new Ri(r),e.pageList&&(this.pageList=new Ni(e.pageList)),i(this.navigation)}):t?this.load(t,"xml").then(i=>(this.navigation=new Ri(i),this.pageList=new Ni(i),this.navigation)):new Promise((i,n)=>{this.navigation=new Ri,this.pageList=new Ni,i(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new mn(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new gu,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,i=this.settings.requestMethod||Er.bind(this);return this.storage=new fa(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(s,o)=>{o.output=this.resources.substitute(s,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Bt("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new je(e),r=this.spine.get(t.spinePos),i=this.load.bind(this);return r?r.load(i).then(function(n){var s=t.toRange(r.document);return s}):new Promise((n,s)=>{s("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${Yr}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}Ut(yn.prototype);function Wt(a,e){return new yn(a,e)}Wt.VERSION=Yr;typeof global<"u"&&(global.EPUBJS_VERSION=Yr);Wt.Book=yn;Wt.Rendition=mn;Wt.Contents=gn;Wt.CFI=je;Wt.utils=Ao;const pt=[];for(let a=0;a<256;++a)pt.push((a+256).toString(16).slice(1));function mu(a,e=0){return(pt[a[e+0]]+pt[a[e+1]]+pt[a[e+2]]+pt[a[e+3]]+"-"+pt[a[e+4]]+pt[a[e+5]]+"-"+pt[a[e+6]]+pt[a[e+7]]+"-"+pt[a[e+8]]+pt[a[e+9]]+"-"+pt[a[e+10]]+pt[a[e+11]]+pt[a[e+12]]+pt[a[e+13]]+pt[a[e+14]]+pt[a[e+15]]).toLowerCase()}let Xi;const yu=new Uint8Array(16);function wu(){if(!Xi){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Xi=crypto.getRandomValues.bind(crypto)}return Xi(yu)}const bu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ds={randomUUID:bu};function yr(a,e,t){if(Ds.randomUUID&&!a)return Ds.randomUUID();a=a||{};const r=a.random??a.rng?.()??wu();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,mu(r)}function da(a,e){return function(){return a.apply(e,arguments)}}const{toString:_u}=Object.prototype,{getPrototypeOf:wn}=Object,{iterator:Kr,toStringTag:pa}=Symbol,Jr=(a=>e=>{const t=_u.call(e);return a[t]||(a[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ft=a=>(a=a.toLowerCase(),e=>Jr(e)===a),Qr=a=>e=>typeof e===a,{isArray:fr}=Array,cr=Qr("undefined");function xr(a){return a!==null&&!cr(a)&&a.constructor!==null&&!cr(a.constructor)&&Et(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const ga=Ft("ArrayBuffer");function Eu(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&ga(a.buffer),e}const xu=Qr("string"),Et=Qr("function"),va=Qr("number"),Ar=a=>a!==null&&typeof a=="object",Au=a=>a===!0||a===!1,Fr=a=>{if(Jr(a)!=="object")return!1;const e=wn(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(pa in a)&&!(Kr in a)},Du=a=>{if(!Ar(a)||xr(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},Cu=Ft("Date"),Su=Ft("File"),Tu=Ft("Blob"),ku=Ft("FileList"),Ru=a=>Ar(a)&&Et(a.pipe),Nu=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||Et(a.append)&&((e=Jr(a))==="formdata"||e==="object"&&Et(a.toString)&&a.toString()==="[object FormData]"))},Iu=Ft("URLSearchParams"),[Ou,Bu,Lu,Fu]=["ReadableStream","Request","Response","Headers"].map(Ft),Pu=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Dr(a,e,{allOwnKeys:t=!1}={}){if(a===null||typeof a>"u")return;let r,i;if(typeof a!="object"&&(a=[a]),fr(a))for(r=0,i=a.length;r<i;r++)e.call(null,a[r],r,a);else{if(xr(a))return;const n=t?Object.getOwnPropertyNames(a):Object.keys(a),s=n.length;let o;for(r=0;r<s;r++)o=n[r],e.call(null,a[o],o,a)}}function ma(a,e){if(xr(a))return null;e=e.toLowerCase();const t=Object.keys(a);let r=t.length,i;for(;r-- >0;)if(i=t[r],e===i.toLowerCase())return i;return null}const Zt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ya=a=>!cr(a)&&a!==Zt;function sn(){const{caseless:a,skipUndefined:e}=ya(this)&&this||{},t={},r=(i,n)=>{if(n==="__proto__"||n==="constructor"||n==="prototype")return;const s=a&&ma(t,n)||n;Fr(t[s])&&Fr(i)?t[s]=sn(t[s],i):Fr(i)?t[s]=sn({},i):fr(i)?t[s]=i.slice():(!e||!cr(i))&&(t[s]=i)};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&Dr(arguments[i],r);return t}const zu=(a,e,t,{allOwnKeys:r}={})=>(Dr(e,(i,n)=>{t&&Et(i)?Object.defineProperty(a,n,{value:da(i,t),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(a,n,{value:i,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),a),Uu=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),Mu=(a,e,t,r)=>{a.prototype=Object.create(e.prototype,r),Object.defineProperty(a.prototype,"constructor",{value:a,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(a,"super",{value:e.prototype}),t&&Object.assign(a.prototype,t)},qu=(a,e,t,r)=>{let i,n,s;const o={};if(e=e||{},a==null)return e;do{for(i=Object.getOwnPropertyNames(a),n=i.length;n-- >0;)s=i[n],(!r||r(s,a,e))&&!o[s]&&(e[s]=a[s],o[s]=!0);a=t!==!1&&wn(a)}while(a&&(!t||t(a,e))&&a!==Object.prototype);return e},ju=(a,e,t)=>{a=String(a),(t===void 0||t>a.length)&&(t=a.length),t-=e.length;const r=a.indexOf(e,t);return r!==-1&&r===t},Wu=a=>{if(!a)return null;if(fr(a))return a;let e=a.length;if(!va(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=a[e];return t},Hu=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&wn(Uint8Array)),Vu=(a,e)=>{const r=(a&&a[Kr]).call(a);let i;for(;(i=r.next())&&!i.done;){const n=i.value;e.call(a,n[0],n[1])}},$u=(a,e)=>{let t;const r=[];for(;(t=a.exec(e))!==null;)r.push(t);return r},Gu=Ft("HTMLFormElement"),Zu=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),Cs=(({hasOwnProperty:a})=>(e,t)=>a.call(e,t))(Object.prototype),Xu=Ft("RegExp"),wa=(a,e)=>{const t=Object.getOwnPropertyDescriptors(a),r={};Dr(t,(i,n)=>{let s;(s=e(i,n,a))!==!1&&(r[n]=s||i)}),Object.defineProperties(a,r)},Yu=a=>{wa(a,(e,t)=>{if(Et(a)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=a[t];if(Et(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Ku=(a,e)=>{const t={},r=i=>{i.forEach(n=>{t[n]=!0})};return fr(a)?r(a):r(String(a).split(e)),t},Ju=()=>{},Qu=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function el(a){return!!(a&&Et(a.append)&&a[pa]==="FormData"&&a[Kr])}const tl=a=>{const e=new Array(10),t=(r,i)=>{if(Ar(r)){if(e.indexOf(r)>=0)return;if(xr(r))return r;if(!("toJSON"in r)){e[i]=r;const n=fr(r)?[]:{};return Dr(r,(s,o)=>{const u=t(s,i+1);!cr(u)&&(n[o]=u)}),e[i]=void 0,n}}return r};return t(a,0)},rl=Ft("AsyncFunction"),il=a=>a&&(Ar(a)||Et(a))&&Et(a.then)&&Et(a.catch),ba=((a,e)=>a?setImmediate:e?((t,r)=>(Zt.addEventListener("message",({source:i,data:n})=>{i===Zt&&n===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Zt.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Et(Zt.postMessage)),nl=typeof queueMicrotask<"u"?queueMicrotask.bind(Zt):typeof process<"u"&&process.nextTick||ba,sl=a=>a!=null&&Et(a[Kr]),ee={isArray:fr,isArrayBuffer:ga,isBuffer:xr,isFormData:Nu,isArrayBufferView:Eu,isString:xu,isNumber:va,isBoolean:Au,isObject:Ar,isPlainObject:Fr,isEmptyObject:Du,isReadableStream:Ou,isRequest:Bu,isResponse:Lu,isHeaders:Fu,isUndefined:cr,isDate:Cu,isFile:Su,isBlob:Tu,isRegExp:Xu,isFunction:Et,isStream:Ru,isURLSearchParams:Iu,isTypedArray:Hu,isFileList:ku,forEach:Dr,merge:sn,extend:zu,trim:Pu,stripBOM:Uu,inherits:Mu,toFlatObject:qu,kindOf:Jr,kindOfTest:Ft,endsWith:ju,toArray:Wu,forEachEntry:Vu,matchAll:$u,isHTMLForm:Gu,hasOwnProperty:Cs,hasOwnProp:Cs,reduceDescriptors:wa,freezeMethods:Yu,toObjectSet:Ku,toCamelCase:Zu,noop:Ju,toFiniteNumber:Qu,findKey:ma,global:Zt,isContextDefined:ya,isSpecCompliantForm:el,toJSONObject:tl,isAsyncFn:rl,isThenable:il,setImmediate:ba,asap:nl,isIterable:sl};let Ce=class _a extends Error{static from(e,t,r,i,n,s){const o=new _a(e.message,t||e.code,r,i,n);return o.cause=e,o.name=e.name,s&&Object.assign(o,s),o}constructor(e,t,r,i,n){super(e),this.name="AxiosError",this.isAxiosError=!0,t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n,this.status=n.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ee.toJSONObject(this.config),code:this.code,status:this.status}}};Ce.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";Ce.ERR_BAD_OPTION="ERR_BAD_OPTION";Ce.ECONNABORTED="ECONNABORTED";Ce.ETIMEDOUT="ETIMEDOUT";Ce.ERR_NETWORK="ERR_NETWORK";Ce.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";Ce.ERR_DEPRECATED="ERR_DEPRECATED";Ce.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";Ce.ERR_BAD_REQUEST="ERR_BAD_REQUEST";Ce.ERR_CANCELED="ERR_CANCELED";Ce.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";Ce.ERR_INVALID_URL="ERR_INVALID_URL";const al=null;function an(a){return ee.isPlainObject(a)||ee.isArray(a)}function Ea(a){return ee.endsWith(a,"[]")?a.slice(0,-2):a}function Ss(a,e,t){return a?a.concat(e).map(function(i,n){return i=Ea(i),!t&&n?"["+i+"]":i}).join(t?".":""):e}function ol(a){return ee.isArray(a)&&!a.some(an)}const ul=ee.toFlatObject(ee,{},null,function(e){return/^is[A-Z]/.test(e)});function ei(a,e,t){if(!ee.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,t=ee.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,h){return!ee.isUndefined(h[_])});const r=t.metaTokens,i=t.visitor||d,n=t.dots,s=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&ee.isSpecCompliantForm(e);if(!ee.isFunction(i))throw new TypeError("visitor must be a function");function f(S){if(S===null)return"";if(ee.isDate(S))return S.toISOString();if(ee.isBoolean(S))return S.toString();if(!u&&ee.isBlob(S))throw new Ce("Blob is not supported. Use a Buffer instead.");return ee.isArrayBuffer(S)||ee.isTypedArray(S)?u&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function d(S,_,h){let v=S;if(S&&!h&&typeof S=="object"){if(ee.endsWith(_,"{}"))_=r?_:_.slice(0,-2),S=JSON.stringify(S);else if(ee.isArray(S)&&ol(S)||(ee.isFileList(S)||ee.endsWith(_,"[]"))&&(v=ee.toArray(S)))return _=Ea(_),v.forEach(function(D,O){!(ee.isUndefined(D)||D===null)&&e.append(s===!0?Ss([_],O,n):s===null?_:_+"[]",f(D))}),!1}return an(S)?!0:(e.append(Ss(h,_,n),f(S)),!1)}const p=[],b=Object.assign(ul,{defaultVisitor:d,convertValue:f,isVisitable:an});function y(S,_){if(!ee.isUndefined(S)){if(p.indexOf(S)!==-1)throw Error("Circular reference detected in "+_.join("."));p.push(S),ee.forEach(S,function(v,m){(!(ee.isUndefined(v)||v===null)&&i.call(e,v,ee.isString(m)?m.trim():m,_,b))===!0&&y(v,_?_.concat(m):[m])}),p.pop()}}if(!ee.isObject(a))throw new TypeError("data must be an object");return y(a),e}function Ts(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function bn(a,e){this._pairs=[],a&&ei(a,this,e)}const xa=bn.prototype;xa.append=function(e,t){this._pairs.push([e,t])};xa.toString=function(e){const t=e?function(r){return e.call(this,r,Ts)}:Ts;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function ll(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Aa(a,e,t){if(!e)return a;const r=t&&t.encode||ll,i=ee.isFunction(t)?{serialize:t}:t,n=i&&i.serialize;let s;if(n?s=n(e,i):s=ee.isURLSearchParams(e)?e.toString():new bn(e,i).toString(r),s){const o=a.indexOf("#");o!==-1&&(a=a.slice(0,o)),a+=(a.indexOf("?")===-1?"?":"&")+s}return a}class ks{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ee.forEach(this.handlers,function(r){r!==null&&e(r)})}}const _n={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},cl=typeof URLSearchParams<"u"?URLSearchParams:bn,hl=typeof FormData<"u"?FormData:null,fl=typeof Blob<"u"?Blob:null,dl={isBrowser:!0,classes:{URLSearchParams:cl,FormData:hl,Blob:fl},protocols:["http","https","file","blob","url","data"]},En=typeof window<"u"&&typeof document<"u",on=typeof navigator=="object"&&navigator||void 0,pl=En&&(!on||["ReactNative","NativeScript","NS"].indexOf(on.product)<0),gl=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vl=En&&window.location.href||"http://localhost",ml=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:En,hasStandardBrowserEnv:pl,hasStandardBrowserWebWorkerEnv:gl,navigator:on,origin:vl},Symbol.toStringTag,{value:"Module"})),vt={...ml,...dl};function yl(a,e){return ei(a,new vt.classes.URLSearchParams,{visitor:function(t,r,i,n){return vt.isNode&&ee.isBuffer(t)?(this.append(r,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...e})}function wl(a){return ee.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function bl(a){const e={},t=Object.keys(a);let r;const i=t.length;let n;for(r=0;r<i;r++)n=t[r],e[n]=a[n];return e}function Da(a){function e(t,r,i,n){let s=t[n++];if(s==="__proto__")return!0;const o=Number.isFinite(+s),u=n>=t.length;return s=!s&&ee.isArray(i)?i.length:s,u?(ee.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!o):((!i[s]||!ee.isObject(i[s]))&&(i[s]=[]),e(t,r,i[s],n)&&ee.isArray(i[s])&&(i[s]=bl(i[s])),!o)}if(ee.isFormData(a)&&ee.isFunction(a.entries)){const t={};return ee.forEachEntry(a,(r,i)=>{e(wl(r),i,t,0)}),t}return null}function _l(a,e,t){if(ee.isString(a))try{return(e||JSON.parse)(a),ee.trim(a)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(a)}const Cr={transitional:_n,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,n=ee.isObject(e);if(n&&ee.isHTMLForm(e)&&(e=new FormData(e)),ee.isFormData(e))return i?JSON.stringify(Da(e)):e;if(ee.isArrayBuffer(e)||ee.isBuffer(e)||ee.isStream(e)||ee.isFile(e)||ee.isBlob(e)||ee.isReadableStream(e))return e;if(ee.isArrayBufferView(e))return e.buffer;if(ee.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return yl(e,this.formSerializer).toString();if((o=ee.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ei(o?{"files[]":e}:e,u&&new u,this.formSerializer)}}return n||i?(t.setContentType("application/json",!1),_l(e)):e}],transformResponse:[function(e){const t=this.transitional||Cr.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(ee.isResponse(e)||ee.isReadableStream(e))return e;if(e&&ee.isString(e)&&(r&&!this.responseType||i)){const s=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(o){if(s)throw o.name==="SyntaxError"?Ce.from(o,Ce.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vt.classes.FormData,Blob:vt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ee.forEach(["delete","get","head","post","put","patch"],a=>{Cr.headers[a]={}});const El=ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xl=a=>{const e={};let t,r,i;return a&&a.split(`
`).forEach(function(s){i=s.indexOf(":"),t=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!t||e[t]&&El[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},Rs=Symbol("internals");function wr(a){return a&&String(a).trim().toLowerCase()}function Pr(a){return a===!1||a==null?a:ee.isArray(a)?a.map(Pr):String(a)}function Al(a){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(a);)e[r[1]]=r[2];return e}const Dl=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Yi(a,e,t,r,i){if(ee.isFunction(r))return r.call(this,e,t);if(i&&(e=t),!!ee.isString(e)){if(ee.isString(r))return e.indexOf(r)!==-1;if(ee.isRegExp(r))return r.test(e)}}function Cl(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Sl(a,e){const t=ee.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(a,r+t,{value:function(i,n,s){return this[r].call(this,e,i,n,s)},configurable:!0})})}let xt=class{constructor(e){e&&this.set(e)}set(e,t,r){const i=this;function n(o,u,f){const d=wr(u);if(!d)throw new Error("header name must be a non-empty string");const p=ee.findKey(i,d);(!p||i[p]===void 0||f===!0||f===void 0&&i[p]!==!1)&&(i[p||u]=Pr(o))}const s=(o,u)=>ee.forEach(o,(f,d)=>n(f,d,u));if(ee.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(ee.isString(e)&&(e=e.trim())&&!Dl(e))s(xl(e),t);else if(ee.isObject(e)&&ee.isIterable(e)){let o={},u,f;for(const d of e){if(!ee.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[f=d[0]]=(u=o[f])?ee.isArray(u)?[...u,d[1]]:[u,d[1]]:d[1]}s(o,t)}else e!=null&&n(t,e,r);return this}get(e,t){if(e=wr(e),e){const r=ee.findKey(this,e);if(r){const i=this[r];if(!t)return i;if(t===!0)return Al(i);if(ee.isFunction(t))return t.call(this,i,r);if(ee.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=wr(e),e){const r=ee.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Yi(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let i=!1;function n(s){if(s=wr(s),s){const o=ee.findKey(r,s);o&&(!t||Yi(r,r[o],o,t))&&(delete r[o],i=!0)}}return ee.isArray(e)?e.forEach(n):n(e),i}clear(e){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const n=t[r];(!e||Yi(this,this[n],n,e,!0))&&(delete this[n],i=!0)}return i}normalize(e){const t=this,r={};return ee.forEach(this,(i,n)=>{const s=ee.findKey(r,n);if(s){t[s]=Pr(i),delete t[n];return}const o=e?Cl(n):String(n).trim();o!==n&&delete t[n],t[o]=Pr(i),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ee.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=e&&ee.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[Rs]=this[Rs]={accessors:{}}).accessors,i=this.prototype;function n(s){const o=wr(s);r[o]||(Sl(i,s),r[o]=!0)}return ee.isArray(e)?e.forEach(n):n(e),this}};xt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ee.reduceDescriptors(xt.prototype,({value:a},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(r){this[t]=r}}});ee.freezeMethods(xt);function Ki(a,e){const t=this||Cr,r=e||t,i=xt.from(r.headers);let n=r.data;return ee.forEach(a,function(o){n=o.call(t,n,i.normalize(),e?e.status:void 0)}),i.normalize(),n}function Ca(a){return!!(a&&a.__CANCEL__)}let Sr=class extends Ce{constructor(e,t,r){super(e??"canceled",Ce.ERR_CANCELED,t,r),this.name="CanceledError",this.__CANCEL__=!0}};function Sa(a,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?a(t):e(new Ce("Request failed with status code "+t.status,[Ce.ERR_BAD_REQUEST,Ce.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Tl(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function kl(a,e){a=a||10;const t=new Array(a),r=new Array(a);let i=0,n=0,s;return e=e!==void 0?e:1e3,function(u){const f=Date.now(),d=r[n];s||(s=f),t[i]=u,r[i]=f;let p=n,b=0;for(;p!==i;)b+=t[p++],p=p%a;if(i=(i+1)%a,i===n&&(n=(n+1)%a),f-s<e)return;const y=d&&f-d;return y?Math.round(b*1e3/y):void 0}}function Rl(a,e){let t=0,r=1e3/e,i,n;const s=(f,d=Date.now())=>{t=d,i=null,n&&(clearTimeout(n),n=null),a(...f)};return[(...f)=>{const d=Date.now(),p=d-t;p>=r?s(f,d):(i=f,n||(n=setTimeout(()=>{n=null,s(i)},r-p)))},()=>i&&s(i)]}const Gr=(a,e,t=3)=>{let r=0;const i=kl(50,250);return Rl(n=>{const s=n.loaded,o=n.lengthComputable?n.total:void 0,u=s-r,f=i(u),d=s<=o;r=s;const p={loaded:s,total:o,progress:o?s/o:void 0,bytes:u,rate:f||void 0,estimated:f&&o&&d?(o-s)/f:void 0,event:n,lengthComputable:o!=null,[e?"download":"upload"]:!0};a(p)},t)},Ns=(a,e)=>{const t=a!=null;return[r=>e[0]({lengthComputable:t,total:a,loaded:r}),e[1]]},Is=a=>(...e)=>ee.asap(()=>a(...e)),Nl=vt.hasStandardBrowserEnv?((a,e)=>t=>(t=new URL(t,vt.origin),a.protocol===t.protocol&&a.host===t.host&&(e||a.port===t.port)))(new URL(vt.origin),vt.navigator&&/(msie|trident)/i.test(vt.navigator.userAgent)):()=>!0,Il=vt.hasStandardBrowserEnv?{write(a,e,t,r,i,n,s){if(typeof document>"u")return;const o=[`${a}=${encodeURIComponent(e)}`];ee.isNumber(t)&&o.push(`expires=${new Date(t).toUTCString()}`),ee.isString(r)&&o.push(`path=${r}`),ee.isString(i)&&o.push(`domain=${i}`),n===!0&&o.push("secure"),ee.isString(s)&&o.push(`SameSite=${s}`),document.cookie=o.join("; ")},read(a){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+a+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(a){this.write(a,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Ol(a){return typeof a!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function Bl(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function Ta(a,e,t){let r=!Ol(e);return a&&(r||t==!1)?Bl(a,e):e}const Os=a=>a instanceof xt?{...a}:a;function Yt(a,e){e=e||{};const t={};function r(f,d,p,b){return ee.isPlainObject(f)&&ee.isPlainObject(d)?ee.merge.call({caseless:b},f,d):ee.isPlainObject(d)?ee.merge({},d):ee.isArray(d)?d.slice():d}function i(f,d,p,b){if(ee.isUndefined(d)){if(!ee.isUndefined(f))return r(void 0,f,p,b)}else return r(f,d,p,b)}function n(f,d){if(!ee.isUndefined(d))return r(void 0,d)}function s(f,d){if(ee.isUndefined(d)){if(!ee.isUndefined(f))return r(void 0,f)}else return r(void 0,d)}function o(f,d,p){if(p in e)return r(f,d);if(p in a)return r(void 0,f)}const u={url:n,method:n,data:n,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(f,d,p)=>i(Os(f),Os(d),p,!0)};return ee.forEach(Object.keys({...a,...e}),function(d){if(d==="__proto__"||d==="constructor"||d==="prototype")return;const p=ee.hasOwnProp(u,d)?u[d]:i,b=p(a[d],e[d],d);ee.isUndefined(b)&&p!==o||(t[d]=b)}),t}const ka=a=>{const e=Yt({},a);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:n,headers:s,auth:o}=e;if(e.headers=s=xt.from(s),e.url=Aa(Ta(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),o&&s.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ee.isFormData(t)){if(vt.hasStandardBrowserEnv||vt.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(ee.isFunction(t.getHeaders)){const u=t.getHeaders(),f=["content-type","content-length"];Object.entries(u).forEach(([d,p])=>{f.includes(d.toLowerCase())&&s.set(d,p)})}}if(vt.hasStandardBrowserEnv&&(r&&ee.isFunction(r)&&(r=r(e)),r||r!==!1&&Nl(e.url))){const u=i&&n&&Il.read(n);u&&s.set(i,u)}return e},Ll=typeof XMLHttpRequest<"u",Fl=Ll&&function(a){return new Promise(function(t,r){const i=ka(a);let n=i.data;const s=xt.from(i.headers).normalize();let{responseType:o,onUploadProgress:u,onDownloadProgress:f}=i,d,p,b,y,S;function _(){y&&y(),S&&S(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let h=new XMLHttpRequest;h.open(i.method.toUpperCase(),i.url,!0),h.timeout=i.timeout;function v(){if(!h)return;const D=xt.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),E={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:D,config:a,request:h};Sa(function(N){t(N),_()},function(N){r(N),_()},E),h=null}"onloadend"in h?h.onloadend=v:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(v)},h.onabort=function(){h&&(r(new Ce("Request aborted",Ce.ECONNABORTED,a,h)),h=null)},h.onerror=function(O){const E=O&&O.message?O.message:"Network Error",k=new Ce(E,Ce.ERR_NETWORK,a,h);k.event=O||null,r(k),h=null},h.ontimeout=function(){let O=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const E=i.transitional||_n;i.timeoutErrorMessage&&(O=i.timeoutErrorMessage),r(new Ce(O,E.clarifyTimeoutError?Ce.ETIMEDOUT:Ce.ECONNABORTED,a,h)),h=null},n===void 0&&s.setContentType(null),"setRequestHeader"in h&&ee.forEach(s.toJSON(),function(O,E){h.setRequestHeader(E,O)}),ee.isUndefined(i.withCredentials)||(h.withCredentials=!!i.withCredentials),o&&o!=="json"&&(h.responseType=i.responseType),f&&([b,S]=Gr(f,!0),h.addEventListener("progress",b)),u&&h.upload&&([p,y]=Gr(u),h.upload.addEventListener("progress",p),h.upload.addEventListener("loadend",y)),(i.cancelToken||i.signal)&&(d=D=>{h&&(r(!D||D.type?new Sr(null,a,h):D),h.abort(),h=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const m=Tl(i.url);if(m&&vt.protocols.indexOf(m)===-1){r(new Ce("Unsupported protocol "+m+":",Ce.ERR_BAD_REQUEST,a));return}h.send(n||null)})},Pl=(a,e)=>{const{length:t}=a=a?a.filter(Boolean):[];if(e||t){let r=new AbortController,i;const n=function(f){if(!i){i=!0,o();const d=f instanceof Error?f:this.reason;r.abort(d instanceof Ce?d:new Sr(d instanceof Error?d.message:d))}};let s=e&&setTimeout(()=>{s=null,n(new Ce(`timeout of ${e}ms exceeded`,Ce.ETIMEDOUT))},e);const o=()=>{a&&(s&&clearTimeout(s),s=null,a.forEach(f=>{f.unsubscribe?f.unsubscribe(n):f.removeEventListener("abort",n)}),a=null)};a.forEach(f=>f.addEventListener("abort",n));const{signal:u}=r;return u.unsubscribe=()=>ee.asap(o),u}},zl=function*(a,e){let t=a.byteLength;if(t<e){yield a;return}let r=0,i;for(;r<t;)i=r+e,yield a.slice(r,i),r=i},Ul=async function*(a,e){for await(const t of Ml(a))yield*zl(t,e)},Ml=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},Bs=(a,e,t,r)=>{const i=Ul(a,e);let n=0,s,o=u=>{s||(s=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:f,value:d}=await i.next();if(f){o(),u.close();return}let p=d.byteLength;if(t){let b=n+=p;t(b)}u.enqueue(new Uint8Array(d))}catch(f){throw o(f),f}},cancel(u){return o(u),i.return()}},{highWaterMark:2})},Ls=64*1024,{isFunction:Or}=ee,ql=(({Request:a,Response:e})=>({Request:a,Response:e}))(ee.global),{ReadableStream:Fs,TextEncoder:Ps}=ee.global,zs=(a,...e)=>{try{return!!a(...e)}catch{return!1}},jl=a=>{a=ee.merge.call({skipUndefined:!0},ql,a);const{fetch:e,Request:t,Response:r}=a,i=e?Or(e):typeof fetch=="function",n=Or(t),s=Or(r);if(!i)return!1;const o=i&&Or(Fs),u=i&&(typeof Ps=="function"?(S=>_=>S.encode(_))(new Ps):async S=>new Uint8Array(await new t(S).arrayBuffer())),f=n&&o&&zs(()=>{let S=!1;const _=new t(vt.origin,{body:new Fs,method:"POST",get duplex(){return S=!0,"half"}}).headers.has("Content-Type");return S&&!_}),d=s&&o&&zs(()=>ee.isReadableStream(new r("").body)),p={stream:d&&(S=>S.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!p[S]&&(p[S]=(_,h)=>{let v=_&&_[S];if(v)return v.call(_);throw new Ce(`Response type '${S}' is not supported`,Ce.ERR_NOT_SUPPORT,h)})});const b=async S=>{if(S==null)return 0;if(ee.isBlob(S))return S.size;if(ee.isSpecCompliantForm(S))return(await new t(vt.origin,{method:"POST",body:S}).arrayBuffer()).byteLength;if(ee.isArrayBufferView(S)||ee.isArrayBuffer(S))return S.byteLength;if(ee.isURLSearchParams(S)&&(S=S+""),ee.isString(S))return(await u(S)).byteLength},y=async(S,_)=>{const h=ee.toFiniteNumber(S.getContentLength());return h??b(_)};return async S=>{let{url:_,method:h,data:v,signal:m,cancelToken:D,timeout:O,onDownloadProgress:E,onUploadProgress:k,responseType:N,headers:B,withCredentials:I="same-origin",fetchOptions:L}=ka(S),K=e||fetch;N=N?(N+"").toLowerCase():"text";let $=Pl([m,D&&D.toAbortSignal()],O),J=null;const ne=$&&$.unsubscribe&&(()=>{$.unsubscribe()});let ae;try{if(k&&f&&h!=="get"&&h!=="head"&&(ae=await y(B,v))!==0){let ue=new t(_,{method:"POST",body:v,duplex:"half"}),ve;if(ee.isFormData(v)&&(ve=ue.headers.get("content-type"))&&B.setContentType(ve),ue.body){const[Te,we]=Ns(ae,Gr(Is(k)));v=Bs(ue.body,Ls,Te,we)}}ee.isString(I)||(I=I?"include":"omit");const le=n&&"credentials"in t.prototype,se={...L,signal:$,method:h.toUpperCase(),headers:B.normalize().toJSON(),body:v,duplex:"half",credentials:le?I:void 0};J=n&&new t(_,se);let ie=await(n?K(J,L):K(_,se));const pe=d&&(N==="stream"||N==="response");if(d&&(E||pe&&ne)){const ue={};["status","statusText","headers"].forEach(Ne=>{ue[Ne]=ie[Ne]});const ve=ee.toFiniteNumber(ie.headers.get("content-length")),[Te,we]=E&&Ns(ve,Gr(Is(E),!0))||[];ie=new r(Bs(ie.body,Ls,Te,()=>{we&&we(),ne&&ne()}),ue)}N=N||"text";let Ee=await p[ee.findKey(p,N)||"text"](ie,S);return!pe&&ne&&ne(),await new Promise((ue,ve)=>{Sa(ue,ve,{data:Ee,headers:xt.from(ie.headers),status:ie.status,statusText:ie.statusText,config:S,request:J})})}catch(le){throw ne&&ne(),le&&le.name==="TypeError"&&/Load failed|fetch/i.test(le.message)?Object.assign(new Ce("Network Error",Ce.ERR_NETWORK,S,J,le&&le.response),{cause:le.cause||le}):Ce.from(le,le&&le.code,S,J,le&&le.response)}}},Wl=new Map,Ra=a=>{let e=a&&a.env||{};const{fetch:t,Request:r,Response:i}=e,n=[r,i,t];let s=n.length,o=s,u,f,d=Wl;for(;o--;)u=n[o],f=d.get(u),f===void 0&&d.set(u,f=o?new Map:jl(e)),d=f;return f};Ra();const xn={http:al,xhr:Fl,fetch:{get:Ra}};ee.forEach(xn,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const Us=a=>`- ${a}`,Hl=a=>ee.isFunction(a)||a===null||a===!1;function Vl(a,e){a=ee.isArray(a)?a:[a];const{length:t}=a;let r,i;const n={};for(let s=0;s<t;s++){r=a[s];let o;if(i=r,!Hl(r)&&(i=xn[(o=String(r)).toLowerCase()],i===void 0))throw new Ce(`Unknown adapter '${o}'`);if(i&&(ee.isFunction(i)||(i=i.get(e))))break;n[o||"#"+s]=i}if(!i){const s=Object.entries(n).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=t?s.length>1?`since :
`+s.map(Us).join(`
`):" "+Us(s[0]):"as no adapter specified";throw new Ce("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i}const Na={getAdapter:Vl,adapters:xn};function Ji(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Sr(null,a)}function Ms(a){return Ji(a),a.headers=xt.from(a.headers),a.data=Ki.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),Na.getAdapter(a.adapter||Cr.adapter,a)(a).then(function(r){return Ji(a),r.data=Ki.call(a,a.transformResponse,r),r.headers=xt.from(r.headers),r},function(r){return Ca(r)||(Ji(a),r&&r.response&&(r.response.data=Ki.call(a,a.transformResponse,r.response),r.response.headers=xt.from(r.response.headers))),Promise.reject(r)})}const Ia="1.13.5",ti={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{ti[a]=function(r){return typeof r===a||"a"+(e<1?"n ":" ")+a}});const qs={};ti.transitional=function(e,t,r){function i(n,s){return"[Axios v"+Ia+"] Transitional option '"+n+"'"+s+(r?". "+r:"")}return(n,s,o)=>{if(e===!1)throw new Ce(i(s," has been removed"+(t?" in "+t:"")),Ce.ERR_DEPRECATED);return t&&!qs[s]&&(qs[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(n,s,o):!0}};ti.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function $l(a,e,t){if(typeof a!="object")throw new Ce("options must be an object",Ce.ERR_BAD_OPTION_VALUE);const r=Object.keys(a);let i=r.length;for(;i-- >0;){const n=r[i],s=e[n];if(s){const o=a[n],u=o===void 0||s(o,n,a);if(u!==!0)throw new Ce("option "+n+" must be "+u,Ce.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ce("Unknown option "+n,Ce.ERR_BAD_OPTION)}}const zr={assertOptions:$l,validators:ti},Tt=zr.validators;let Xt=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ks,response:new ks}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?n&&!String(r.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+n):r.stack=n}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Yt(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:n}=t;r!==void 0&&zr.assertOptions(r,{silentJSONParsing:Tt.transitional(Tt.boolean),forcedJSONParsing:Tt.transitional(Tt.boolean),clarifyTimeoutError:Tt.transitional(Tt.boolean),legacyInterceptorReqResOrdering:Tt.transitional(Tt.boolean)},!1),i!=null&&(ee.isFunction(i)?t.paramsSerializer={serialize:i}:zr.assertOptions(i,{encode:Tt.function,serialize:Tt.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),zr.assertOptions(t,{baseUrl:Tt.spelling("baseURL"),withXsrfToken:Tt.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=n&&ee.merge(n.common,n[t.method]);n&&ee.forEach(["delete","get","head","post","put","patch","common"],S=>{delete n[S]}),t.headers=xt.concat(s,n);const o=[];let u=!0;this.interceptors.request.forEach(function(_){if(typeof _.runWhen=="function"&&_.runWhen(t)===!1)return;u=u&&_.synchronous;const h=t.transitional||_n;h&&h.legacyInterceptorReqResOrdering?o.unshift(_.fulfilled,_.rejected):o.push(_.fulfilled,_.rejected)});const f=[];this.interceptors.response.forEach(function(_){f.push(_.fulfilled,_.rejected)});let d,p=0,b;if(!u){const S=[Ms.bind(this),void 0];for(S.unshift(...o),S.push(...f),b=S.length,d=Promise.resolve(t);p<b;)d=d.then(S[p++],S[p++]);return d}b=o.length;let y=t;for(;p<b;){const S=o[p++],_=o[p++];try{y=S(y)}catch(h){_.call(this,h);break}}try{d=Ms.call(this,y)}catch(S){return Promise.reject(S)}for(p=0,b=f.length;p<b;)d=d.then(f[p++],f[p++]);return d}getUri(e){e=Yt(this.defaults,e);const t=Ta(e.baseURL,e.url,e.allowAbsoluteUrls);return Aa(t,e.params,e.paramsSerializer)}};ee.forEach(["delete","get","head","options"],function(e){Xt.prototype[e]=function(t,r){return this.request(Yt(r||{},{method:e,url:t,data:(r||{}).data}))}});ee.forEach(["post","put","patch"],function(e){function t(r){return function(n,s,o){return this.request(Yt(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:n,data:s}))}}Xt.prototype[e]=t(),Xt.prototype[e+"Form"]=t(!0)});let Gl=class Oa{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(n){t=n});const r=this;this.promise.then(i=>{if(!r._listeners)return;let n=r._listeners.length;for(;n-- >0;)r._listeners[n](i);r._listeners=null}),this.promise.then=i=>{let n;const s=new Promise(o=>{r.subscribe(o),n=o}).then(i);return s.cancel=function(){r.unsubscribe(n)},s},e(function(n,s,o){r.reason||(r.reason=new Sr(n,s,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Oa(function(i){e=i}),cancel:e}}};function Zl(a){return function(t){return a.apply(null,t)}}function Xl(a){return ee.isObject(a)&&a.isAxiosError===!0}const un={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(un).forEach(([a,e])=>{un[e]=a});function Ba(a){const e=new Xt(a),t=da(Xt.prototype.request,e);return ee.extend(t,Xt.prototype,e,{allOwnKeys:!0}),ee.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return Ba(Yt(a,i))},t}const lt=Ba(Cr);lt.Axios=Xt;lt.CanceledError=Sr;lt.CancelToken=Gl;lt.isCancel=Ca;lt.VERSION=Ia;lt.toFormData=ei;lt.AxiosError=Ce;lt.Cancel=lt.CanceledError;lt.all=function(e){return Promise.all(e)};lt.spread=Zl;lt.isAxiosError=Xl;lt.mergeConfig=Yt;lt.AxiosHeaders=xt;lt.formToJSON=a=>Da(ee.isHTMLForm(a)?new FormData(a):a);lt.getAdapter=Na.getAdapter;lt.HttpStatusCode=un;lt.default=lt;const{Axios:Ac,AxiosError:Dc,CanceledError:Cc,isCancel:Sc,CancelToken:Tc,VERSION:kc,all:Rc,Cancel:Nc,isAxiosError:Ic,spread:Oc,toFormData:Bc,AxiosHeaders:Lc,HttpStatusCode:Fc,formToJSON:Pc,getAdapter:zc,mergeConfig:Uc}=lt,Yl="http://localhost:3001/api",Ot=lt.create({baseURL:Yl,timeout:3e4});Ot.interceptors.response.use(a=>a.data,a=>{throw a.response?console.error("API :",a.response.status,a.response.data):a.request?console.error("API : ",a.message):console.error("API :",a.message),a});const Pt={async getToken(a,e,t,r){return Ot.post("/baidu/token",{code:a,clientId:e,clientSecret:t,redirectUri:r})},async refreshToken(a,e,t){return Ot.post("/baidu/refresh",{refreshToken:a,clientId:e,clientSecret:t})},async verifyToken(a){return Ot.get("/baidu/verify",{params:{accessToken:a}})},async getFileList(a,e,t=1,r=100,i="name",n="list",s=0){return Ot.get("/baidu/files",{params:{accessToken:a,dir:e,pageNum:t,pageSize:r,order:i,method:n,recursion:s}})},async searchFiles(a,e,t,r="search",i=1){return Ot.get("/baidu/search",{params:{accessToken:a,key:e,dir:t,method:r,recursion:i}})},async getFileInfo(a,e){return Ot.get("/baidu/fileinfo",{params:{accessToken:a,fsids:e}})},async downloadFile(a,e){return Ot.get("/baidu/download",{params:{dlink:a,accessToken:e}})},async uploadFile(a,e,t){return Ot.post("/baidu/upload",{fileName:a,fileData:e,accessToken:t})},async createDirectory(a,e){return Ot.post("/baidu/mkdir",{accessToken:a,dir:e})},async deleteFile(a,e){return Ot.post("/baidu/delete",{accessToken:a,filePaths:e})}},ar=()=>typeof window<"u"&&window.electron!==void 0;var Kl=Object.defineProperty,Jl=(a,e)=>{for(var t in e)Kl(a,t,{get:e[t],enumerable:!0})},Ql={};Jl(Ql,{convertFileSrc:()=>tc,invoke:()=>Ze,transformCallback:()=>ln});function ec(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function ln(a,e=!1){let t=ec(),r=`_${t}`;return Object.defineProperty(window,r,{value:i=>(e&&Reflect.deleteProperty(window,r),a?.(i)),writable:!1,configurable:!0}),t}async function Ze(a,e={}){return new Promise((t,r)=>{let i=ln(s=>{t(s),Reflect.deleteProperty(window,`_${n}`)},!0),n=ln(s=>{r(s),Reflect.deleteProperty(window,`_${i}`)},!0);window.__TAURI_IPC__({cmd:a,callback:i,error:n,...e})})}function tc(a,e="asset"){return window.__TAURI__.convertFileSrc(a,e)}async function rc(){try{return await Ze("open_directory")}catch(a){throw console.error("Failed to open directory:",a),new Error(`Failed to open directory: ${a}`)}}async function ic(a){try{return await Ze("read_file",{path:a})}catch(e){throw console.error("Failed to read file:",e),new Error(`Failed to read file: ${e}`)}}async function nc(a,e){try{await Ze("write_file",{path:a,data:e})}catch(t){throw console.error("Failed to write file:",t),new Error(`Failed to write file: ${t}`)}}async function js(a){try{const e=a?.map(r=>[r.name,r.extensions]);return await Ze("open_file",{filters:e})}catch(e){throw console.error("Failed to open file:",e),new Error(`Failed to open file: ${e}`)}}async function sc(a,e,t,r){try{return await Ze("baidu_get_token",{code:a,clientId:e,clientSecret:t,redirectUri:r})}catch(i){throw console.error("Failed to get Baidu token:",i),new Error(`Failed to get Baidu token: ${i}`)}}async function ac(a,e,t){try{return await Ze("baidu_refresh_token",{refreshToken:a,clientId:e,clientSecret:t})}catch(r){throw console.error("Failed to refresh Baidu token:",r),new Error(`Failed to refresh Baidu token: ${r}`)}}async function oc(a){try{return await Ze("baidu_verify_token",{accessToken:a})}catch(e){throw console.error("Failed to verify Baidu token:",e),new Error(`Failed to verify Baidu token: ${e}`)}}async function uc(a,e="/",t=1,r=100,i="name",n=0){try{return await Ze("baidu_list_files",{accessToken:a,dir:e,pageNum:t,pageSize:r,order:i,recursion:n})}catch(s){throw console.error("Failed to list Baidu files:",s),new Error(`Failed to list Baidu files: ${s}`)}}async function lc(a,e,t,r=1){try{return await Ze("baidu_search_files",{accessToken:a,key:e,dir:t,recursion:r})}catch(i){throw console.error("Failed to search Baidu files:",i),new Error(`Failed to search Baidu files: ${i}`)}}async function cc(a,e,t){try{return await Ze("baidu_upload_file",{accessToken:a,fileName:e,fileData:t})}catch(r){throw console.error("Failed to upload file to Baidu:",r),new Error(`Failed to upload file to Baidu: ${r}`)}}async function hc(a,e){try{return await Ze("baidu_download_file",{dlink:a,accessToken:e})}catch(t){throw console.error("Failed to download file from Baidu:",t),new Error(`Failed to download file from Baidu: ${t}`)}}async function fc(a,e){try{return await Ze("baidu_get_fileinfo",{accessToken:a,fsids:e})}catch(t){throw console.error("Failed to get Baidu file info:",t),new Error(`Failed to get Baidu file info: ${t}`)}}async function dc(a,e,t,r){try{return await Ze("qwen_chat",{accessToken:a,messages:e,model:t,resourceUrl:r})}catch(i){throw console.error("Failed to chat with Qwen:",i),new Error(`Failed to chat with Qwen: ${i}`)}}async function pc(a,e){try{return await Ze("qwen_list_models",{accessToken:a,resourceUrl:e})}catch(t){throw console.error("Failed to list Qwen models:",t),new Error(`Failed to list Qwen models: ${t}`)}}async function gc(a){try{return await Ze("tts_synthesize",{request:a})}catch(e){throw console.error("Failed to synthesize speech:",e),new Error(`Failed to synthesize speech: ${e}`)}}async function vc(){try{return await Ze("tts_list_voices")}catch(a){throw console.error("Failed to list TTS voices:",a),new Error(`Failed to list TTS voices: ${a}`)}}async function mc(a){try{return await Ze("open_auth_window",{authUrl:a})}catch(e){throw console.error("Failed to open auth window:",e),new Error(`Failed to open auth window: ${e}`)}}async function yc(a){try{return await Ze("open_external",{url:a})}catch(e){throw console.error("Failed to open external URL:",e),new Error(`Failed to open external URL: ${e}`)}}const or=()=>typeof window<"u"&&"__TAURI__"in window,br={openDirectory:rc,readFile:ic,writeFile:nc,openFile:js,async getTokenViaCode(a,e,t,r){return sc(a,e,t,r)},async refreshToken(a,e,t){return ac(a,e,t)},async verifyToken(a){return oc(a)},async getFileList(a,e="/",t=1,r=100,i="name",n="list",s=0){return uc(a,e,t,r,i,s)},async searchFiles(a,e,t,r="search",i=1){return lc(a,e,t,i)},async getFileInfo(a,e){return fc(a,e)},async downloadFile(a,e){return hc(a,e)},async uploadFile(a,e,t){return cc(t,a,e)},async selectFile(){return js([{name:"",extensions:["epub","pdf","txt"]}])},async qwenChat(a,e,t,r){return dc(a,e,t,r)},async qwenListModels(a,e){return pc(a,e)},async ttsSynthesize(a){return gc(a)},async ttsListVoices(){return vc()},async openAuthWindow(a){return mc(a)},async openExternal(a){return yc(a)},async saveBaiduToken(a){return Ze("save_baidu_token",{accessToken:a.access_token,refreshToken:a.refresh_token,expiresIn:a.expires_in,scope:a.scope,clientId:a.client_id,clientSecret:a.client_secret,redirectUri:a.redirect_uri})},async getBaiduToken(){return Ze("get_baidu_token")},async deleteBaiduToken(){return Ze("delete_baidu_token")},async isBaiduTokenExpired(){return Ze("is_baidu_token_expired")},async saveQwenToken(a){return Ze("save_qwen_token",{accessToken:a.access_token,refreshToken:a.refresh_token,expiresIn:a.expires_in,apiKey:a.api_key})},async getQwenToken(){return Ze("get_qwen_token")},async deleteQwenToken(){return Ze("delete_qwen_token")},async isQwenTokenExpired(){return Ze("is_qwen_token_expired")},async saveUserSettings(a){return Ze("save_user_settings",{theme:a.theme,fontSize:a.font_size,lineHeight:a.line_height,language:a.language,extra:a.extra})},async getUserSettings(){return Ze("get_user_settings")},async deleteUserSettings(){return Ze("delete_user_settings")},async clearAllStorage(){return Ze("clear_all_storage")}},Mc=()=>or()?"tauri":ar()?"electron":"web",At={async getTokenViaCode(a,e,t,r){return await Pt.getToken(a,e,t,r)},async refreshToken(a,e,t){return await Pt.refreshToken(a,e,t)},async verifyToken(a){return await Pt.verifyToken(a)},async getFileList(a,e="/",t=1,r=100,i="name",n="list",s=0){return await Pt.getFileList(a,e,t,r,i,n,s)},async searchFiles(a,e,t,r="search",i=1){return await Pt.searchFiles(a,e,t,r,i)},async getFileInfo(a,e){return await Pt.getFileInfo(a,e)},async downloadFile(a,e){return await Pt.downloadFile(a,e)},async uploadFile(a,e,t){return await Pt.uploadFile(a,e,t)},async createDirectory(a,e){return await Pt.createDirectory(a,e)},async deleteFile(a,e){return await Pt.deleteFile(a,e)},async openDirectory(){if(or())return await br.openDirectory()||"";if(ar())return window.electron.openDirectory();throw new Error("Platform API not available")},async readFile(a){if(or())return await br.readFile(a);if(ar())return window.electron.readFile(a);throw new Error("Platform API not available")},async selectFile(){if(or())return await br.selectFile()||"";if(ar())return window.electron.openFile([{name:"",extensions:["epub","pdf","txt"]}]);throw new Error("Platform API not available")},async openAuthWindow(a){if(or())return await br.openAuthWindow(a);if(ar())return window.electron.openAuthWindow(a);throw new Error("Platform API not available")},async openExternal(a){if(or())return await br.openExternal(a);if(ar())return window.electron.openExternal(a);throw new Error("Platform API not available")}};Me.config({name:"NeatReader",storeName:"ebookStore",description:"Neat Reader"});const qc=Ha("ebook",()=>{const a=qt([]),e=qt([]),t=qt(null),r=qt(null),i=qt(null),n=qt(null),s=qt(new Map),o=qt({storage:{default:"local",localPath:"",autoSync:!0,syncInterval:15,baidupan:null},reader:{fontSize:18,fontFamily:"system",theme:"light",pageMode:"page",brightness:100,lineSpacing:1.5,lineHeight:1.5,paragraphSpacing:8,autoSaveInterval:10},ui:{viewMode:"grid",language:"zh-CN"}}),u=qt({id:"device-1",name:"",type:"desktop",platform:"windows",lastSync:Date.now()}),f=ai(()=>a.value.filter(P=>P.storageType==="local")),d=ai(()=>a.value.filter(P=>P.storageType==="baidupan")),p=ai(()=>[...a.value].sort((P,z)=>z.lastRead-P.lastRead).slice(0,10)),b=P=>a.value.filter(z=>z.categoryId===P),y=P=>e.value.find(z=>z.id===P)||null,S=P=>new Promise((z,V)=>{try{const Q=new Image;Q.crossOrigin="anonymous",Q.onload=()=>{try{const w=document.createElement("canvas");w.width=Q.naturalWidth||Q.width,w.height=Q.naturalHeight||Q.height;const Z=w.getContext("2d");if(!Z){V(new Error("Failed to get 2d context"));return}Z.drawImage(Q,0,0);const Y=w.toDataURL("image/png");z(Y)}catch(w){V(w)}},Q.onerror=()=>{V(new Error("Failed to load blob image"))},Q.src=P}catch(Q){V(Q)}}),_=async()=>{try{console.log("...");const P=await Me.getItem("books");P?(console.log(":",P.length),a.value=P,await Promise.all(a.value.map(async z=>{if(z.cover&&z.cover.startsWith("blob:")&&(console.log(" blob :",z.id),z.cover=""),z.format==="epub"&&!z.cover)try{const V=await Me.getItem(`ebook_content_${z.id}`);if(V){const Q=Wt(V);await new Promise((Z,Y)=>{Q.ready.then(Z).catch(Y)});const w=await Q.coverUrl();if(w)if(w.startsWith("blob:"))try{console.log(" Base64"),z.cover=await S(w),console.log(":",z.id),URL.revokeObjectURL(w)}catch(Z){console.warn(" Base64 :",Z)}else z.cover=w,console.log(":",z.id)}}catch(V){console.warn(":",z.id,V)}}))):(console.log(""),a.value=[])}catch(P){console.error(":",P),P instanceof Error&&(console.error(":",P.message),console.error(":",P.stack)),a.value=[]}},h=async(P=!0)=>{try{const z=a.value.map(V=>({id:V.id,title:V.title,author:V.author,cover:V.cover||"",path:V.path,format:V.format,size:V.size,lastRead:V.lastRead,totalChapters:V.totalChapters,readingProgress:V.readingProgress,storageType:V.storageType,baidupanPath:V.baidupanPath,categoryId:V.categoryId,addedAt:V.addedAt}));await Me.setItem("books",z),P&&E()}catch(z){console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack))}},v=async()=>{try{const P=await Me.getItem("categories");if(P&&Array.isArray(P)&&P.length>0)e.value=P.map(z=>({id:z.id||`category_${Date.now()}_${Math.random()}`,name:z.name||"",color:z.color||"#999999",bookIds:Array.isArray(z.bookIds)?[...z.bookIds]:[],createdAt:z.createdAt||Date.now(),updatedAt:z.updatedAt||Date.now()}));else{console.log(""),e.value=[];const z={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};e.value.push(z),await Me.setItem("categories",[z]),console.log("")}}catch(P){console.error(":",P),e.value=[];const z={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};e.value.push(z);try{await Me.setItem("categories",[z])}catch(V){console.error(":",V)}}},m=async()=>{try{console.log(":",e.value.length);const P=e.value.map(V=>({id:V.id,name:V.name,color:V.color,bookIds:Array.isArray(V.bookIds)?[...V.bookIds]:[],createdAt:V.createdAt,updatedAt:V.updatedAt}));await Me.setItem("categories",P),k();const z=await Me.getItem("categories");z&&(e.value=[...z])}catch(P){throw console.error(" :",P),P}};let D=null,O=null;const E=(P=800)=>{D&&window.clearTimeout(D),D=window.setTimeout(()=>{D=null,N()},P)},k=(P=800)=>{O&&window.clearTimeout(O),O=window.setTimeout(()=>{O=null,B()},P)},N=async()=>{try{if(!await Ie()||!o.value.storage.baidupan)return;const P=a.value.filter(Q=>Q.storageType==="synced"||Q.storageType==="baidupan"),z={books:P,lastSync:Date.now(),deviceId:u.value?.id||"unknown",deviceName:u.value?.name||"unknown"},V=new File([JSON.stringify(z)],"books.json",{type:"application/json"});await Ae(V,""),console.log(` [Cloud Sync] books.json  (${P.length}/${a.value.length} )`)}catch(P){console.warn(" [Cloud Sync] books.json :",P)}},B=async()=>{try{if(!await Ie()||!o.value.storage.baidupan)return;const P={categories:e.value.map(V=>({id:V.id,name:V.name,color:V.color,bookIds:Array.isArray(V.bookIds)?[...V.bookIds]:[],createdAt:V.createdAt,updatedAt:V.updatedAt})),lastSync:Date.now(),deviceId:u.value?.id||"unknown",deviceName:u.value?.name||"unknown"},z=new File([JSON.stringify(P)],"categories.json",{type:"application/json"});await Ae(z,""),console.log(" [Cloud Sync] categories.json ")}catch(P){console.warn(" [Cloud Sync] categories.json :",P)}},I=()=>{const P=new Map;for(const V of e.value)if(Array.isArray(V.bookIds))for(const Q of V.bookIds)P.has(Q)||P.set(Q,V.id);let z=0;for(const V of a.value){const Q=P.get(V.id);V.categoryId!==Q&&(V.categoryId=Q,z++)}z>0&&(a.value=[...a.value])},L=async(P,z)=>{try{console.log(":",P,z);const V={id:`category_${yr()}`,name:P,color:z,bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};return console.log(":",V),e.value.push(V),console.log(":",e.value.length),console.log("..."),await m(),console.log(":",V.name),V}catch(V){throw console.error(":",V),V instanceof Error&&(console.error(":",V.message),console.error(":",V.stack)),V}},K=async(P,z)=>{try{const V=e.value.findIndex(Q=>Q.id===P);return V!==-1?(e.value[V]={...e.value[V],...z,updatedAt:Date.now()},await m(),console.log(":",e.value[V].name),!0):!1}catch(V){return console.error(":",V),!1}},$=async P=>{try{const z=e.value.findIndex(V=>V.id===P);if(z!==-1){const V=e.value[z].name,Q=e.value.find(w=>w.name==="");if(Q){const w=Array.isArray(e.value[z].bookIds)?[...e.value[z].bookIds]:[];Array.isArray(Q.bookIds)||(Q.bookIds=[]);for(const Z of w){Q.bookIds.includes(Z)||Q.bookIds.push(Z);const Y=a.value.findIndex(te=>te.id===Z);Y!==-1&&(a.value[Y].categoryId=Q.id)}Q.updatedAt=Date.now(),await h()}else{const w=Array.isArray(e.value[z].bookIds)?e.value[z].bookIds:[];for(const Z of w){const Y=a.value.findIndex(te=>te.id===Z);Y!==-1&&(a.value[Y].categoryId=void 0)}await h()}return e.value.splice(z,1),await m(),console.log(":",V),!0}return!1}catch(z){return console.error(":",z),!1}},J=async(P,z)=>{try{const V=a.value.findIndex(Q=>Q.id===P);if(V!==-1){for(const w of e.value)Array.isArray(w.bookIds)&&w.bookIds.includes(P)&&(w.bookIds=w.bookIds.filter(Z=>Z!==P),w.updatedAt=Date.now());const Q=e.value.findIndex(w=>w.id===z);return Q!==-1&&(Array.isArray(e.value[Q].bookIds)||(e.value[Q].bookIds=[]),e.value[Q].bookIds.includes(P)||e.value[Q].bookIds.push(P),e.value[Q].updatedAt=Date.now()),a.value[V].categoryId=z,await h(),await m(),console.log(":",P,"->",z),!0}return!1}catch(V){return console.error(":",V),!1}},ne=async P=>{try{const z=a.value.findIndex(Q=>Q.id===P);if(z===-1)return!1;let V=!1;for(const Q of e.value)Array.isArray(Q.bookIds)&&Q.bookIds.includes(P)&&(Q.bookIds=Q.bookIds.filter(w=>w!==P),Q.updatedAt=Date.now(),V=!0);return a.value[z].categoryId=void 0,await h(),V&&await m(),console.log(":",P),!0}catch(z){return console.error(":",z),!1}},ae=async P=>{try{console.log(":",P);const z=a.value.filter(Q=>Q.title.toLowerCase().includes(P.toLowerCase())||Q.author.toLowerCase().includes(P.toLowerCase()));console.log(":",z.length);const V=await Ie();if(console.log(":",V),V&&o.value.storage.baidupan){const{accessToken:Q,rootPath:w}=o.value.storage.baidupan,Z=w||`/apps/${Ge}`;console.log(":",Z);try{const te=await At.searchFiles(Q,P,Z,"search",1);if(console.log(":",te),te.list&&Array.isArray(te.list)&&te.list.length>0)for(const T of te.list){if(!T.server_filename)continue;const g=T.server_filename.split(".").pop()?.toLowerCase();if(["epub","pdf","txt"].includes(g||"")&&!a.value.find(A=>A.baidupanPath===T.path)){const A={id:`baidupan_${T.fs_id||Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:T.server_filename.replace(`.${g}`,""),author:"",cover:"",path:T.path||"",format:g||"txt",size:T.size||0,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"baidupan",baidupanPath:T.path||"",addedAt:Date.now()};z.push(A),console.log(":",A.title)}}else console.log("")}catch(Y){console.warn(":",Y)}}else console.log("");return console.log(":",z.length),z}catch(z){return console.error(":",z),[]}},le=async P=>{try{console.log(":",P.title),a.value.push(P),await h(),console.log("")}catch(z){throw console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),z}},se=async(P,z)=>{const V=a.value.findIndex(Q=>Q.id===P);V!==-1?(console.log("updateBook - :",{id:a.value[V].id,storageType:a.value[V].storageType,uploading:a.value[V].uploading}),console.log("updateBook - :",z),Object.assign(a.value[V],z),z.storageType==="synced"&&(a.value[V].uploading=!1),console.log("updateBook - :",{id:a.value[V].id,storageType:a.value[V].storageType,uploading:a.value[V].uploading}),await h()):console.error("updateBook - :",P)},ie=async(P,z,V=!0)=>{try{const Q=a.value.findIndex(T=>T.id===P);if(Q===-1)return!1;const w=a.value[Q],Z=z||w.storageType;a.value.splice(Q,1);let Y=!1;for(const T of e.value){if(!Array.isArray(T.bookIds))continue;const g=T.bookIds.length;T.bookIds=T.bookIds.filter(l=>l!==P),T.bookIds.length!==g&&(T.updatedAt=Date.now(),Y=!0)}return Promise.all([h(!1),Y?Me.setItem("categories",e.value.map(T=>({id:T.id,name:T.name,color:T.color,bookIds:Array.isArray(T.bookIds)?[...T.bookIds]:[],createdAt:T.createdAt,updatedAt:T.updatedAt}))):Promise.resolve(),Z==="local"?Promise.all([Me.removeItem(`ebook_content_${P}`),Me.removeItem(`ebook_cover_${P}`)]):Promise.resolve()]).catch(T=>console.error(":",T)),(Z==="baidupan"||Z==="synced")&&w.baidupanPath&&V?(async()=>{try{if(!await Ie()){console.warn("");return}const T=[];w.baidupanPath&&T.push(w.baidupanPath),T.push(`/apps/Neat Reader/sync/progress/${w.id}.json`),await At.deleteFile(o.value.storage.baidupan.accessToken,T),console.log(" [] :",T),await N(),Y&&await B()}catch(T){console.error(" [] :",T)}})():Y&&k(),console.log(" UI "),!0}catch(Q){return console.error(":",Q),Q instanceof Error&&(console.error(":",Q.message),console.error(":",Q.stack)),!1}},pe=P=>a.value.find(z=>z.id===P)||null,Ee=P=>{t.value=P},ue=async P=>{try{const z=await Me.getItem(`progress_${P}`);return r.value=z||null,z}catch(z){return console.error(":",z),null}},ve=async P=>{try{r.value=P,await Me.setItem(`progress_${P.ebookId}`,P),await se(P.ebookId,{lastRead:P.timestamp,readingProgress:Math.round(P.position*100)})}catch(z){console.error(":",z)}},Te=async()=>{try{const P=await Me.getItem("userConfig");P&&(P.storage.baidupan&&P.storage.baidupan.rootPath==="/NeatReader"&&(P.storage.baidupan.rootPath=""),o.value=P);const z=await Me.getItem("baidupanUserInfoCache");if(z){const V=Date.now()-z.timestamp,Q=300*1e3;V<Q&&(console.log(""),i.value=z.data,n.value=z)}}catch(P){console.error(":",P)}},we=async()=>{try{const P=JSON.parse(JSON.stringify(o.value));await Me.setItem("userConfig",P),await Me.setItem("userConfigTimestamp",Date.now())}catch(P){console.error(":",P)}},Ne=async(P,z=!1)=>{if(o.value={...o.value,...P},await we(),!z){if(!Ae){console.log(" Wails ");return}try{if(await Ie()){const V=JSON.stringify({config:o.value,timestamp:Date.now()}),Q=new File([V],"config.json",{type:"application/json"});await Ae(Q,"/sync"),console.log("")}}catch(V){console.warn(":",V)}}},Ge="Neat Reader",Ve={clientId:"hq9yQ9w9kR4YHj1kyYafLygVocobh7Sf",clientSecret:"YH2VpZcFJHYNnV6vLfHQXDBhcE7ZChyE",redirectUri:"http://localhost:8080/callback"},_e=async()=>{try{if(!o.value.storage.baidupan)return!1;const{refreshToken:P}=o.value.storage.baidupan;if(!P)return!1;const V=await At.refreshToken(P,Ve.clientId,Ve.clientSecret);return V.error?(console.error(":",V.error),!1):(console.log(":",{access_token:V.access_token?"***":null,refresh_token:V.refresh_token?"***":null,expires_in:V.expires_in}),V.access_token&&o.value.storage.baidupan?(await Ne({storage:{...o.value.storage,baidupan:{...o.value.storage.baidupan,accessToken:V.access_token,refreshToken:V.refresh_token,expiration:Date.now()+V.expires_in*1e3,rootPath:o.value.storage.baidupan.rootPath||"",userId:o.value.storage.baidupan.userId||"",namingStrategy:o.value.storage.baidupan.namingStrategy||"1"}}}),!0):!1)}catch(P){return console.error(":",P),!1}},We=()=>{const P=o.value.storage.baidupan;if(!P)return!1;const{accessToken:z,expiration:V}=P,Q=3600*1e3;return!!z&&V-Date.now()>Q},Ie=async()=>We()?!0:await _e(),ke=async(P=!1)=>{if(!o.value.storage.baidupan?.accessToken){i.value=null;return}const z=300*1e3;if(!P&&n.value&&Date.now()-n.value.timestamp<z){console.log(""),i.value=n.value.data;return}try{const Q=await At.verifyToken(o.value.storage.baidupan.accessToken);if(console.log("verifyToken :",Q),Q.errno===0||!Q.error){const w={baidu_name:Q.baidu_name||Q.netdisk_name||Q.name||"",avatar_url:Q.avatar_url||"",vip_type:Q.vip_type||0};i.value=w;const Z={data:w,timestamp:Date.now()};n.value=Z,await Me.setItem("baidupanUserInfoCache",JSON.parse(JSON.stringify(Z)))}else console.log("verifyToken :",Q),i.value=null,n.value=null,await Me.removeItem("baidupanUserInfoCache")}catch(V){console.error("verifyToken :",V),i.value=null,n.value=null,await Me.removeItem("baidupanUserInfoCache")}},Be=P=>P>4294967296?(console.error(` ${(4294967296/(1024*1024*1024)).toFixed(1)}GB`),!1):!0,Ae=async(P,z)=>{try{if(!await Ie()||!o.value.storage.baidupan)return console.error(""),!1;if(!Be(P.size))return console.error(""),!1;const{accessToken:V}=o.value.storage.baidupan,Q=await P.arrayBuffer(),w=Array.from(new Uint8Array(Q)),Y=await At.uploadFile(P.name,w,V);return Y.error_code===31061?(console.log(":",P.name),!0):Y.error?(console.error(":",Y.error),!1):Y.path||Y.fs_id?!0:(console.error("ID:",Y),!1)}catch(V){return console.error(":",V),V instanceof Error&&(console.error(":",V.message),console.error(":",V.stack)),!1}},ze=async P=>{try{if(console.log(":",P.title),!await Ie())throw console.error(""),new Error("");console.log(" IndexedDB :",`ebook_content_${P.id}`);const z=await Me.getItem(`ebook_content_${P.id}`);if(!z)throw console.error(""),new Error("");console.log(":",z.byteLength);const Q=`${(te=>{let T=te.replace(/[<>:"|?*\/\\]/g,"").replace(/\s+/g,"_").trim();return T.length>200&&(T=T.substring(0,200)),T})(P.title)}.${P.format}`;console.log(":",Q);const w=new File([z],Q,{type:`application/${P.format==="epub"?"epub+zip":P.format}`});console.log(" File :",Q,":",w.type);let Z="";if(o.value.storage.baidupan&&(Z=o.value.storage.baidupan.rootPath||""),(!Z||Z==="/")&&(Z=""),await Ae(w,Z)){console.log("");const te=a.value.findIndex(T=>T.id===P.id);if(te!==-1){const T=a.value[te].cover||P.cover;a.value[te].storageType="synced",a.value[te].baidupanPath=`${Z}/${Q}`,a.value[te].uploading=!1,a.value[te].cover=T,console.log(":",{id:a.value[te].id,storageType:a.value[te].storageType,uploading:a.value[te].uploading,hasCover:!!a.value[te].cover})}return await se(P.id,{storageType:"synced",baidupanPath:`${Z}/${Q}`,cover:a.value[te]?.cover||P.cover,uploading:!1}),console.log(":",P.title),!0}throw console.error("uploadToBaidupan  false"),new Error("")}catch(z){throw console.error(":",z),z instanceof Error?(console.error(":",z.message),console.error(":",z.stack),z):new Error("")}},Ue=async P=>{try{if(console.log(` [Cloud Sync] : ${P}`),!await Ie()||!o.value.storage.baidupan)return console.warn(" [Cloud Sync] "),null;const{accessToken:z}=o.value.storage.baidupan,V=`/apps/${Ge}/${P.replace(/^\/+/,"")}`,Q=V.substring(0,V.lastIndexOf("/")),w=V.substring(V.lastIndexOf("/")+1);console.log(` [Cloud Sync] : ${Q}, : ${w}`);const Y=await At.getFileList(z,Q,1,1e3,"name","list",1);if(Y.error||!Y.list)return console.warn(` [Cloud Sync] : ${Q}`,Y),null;const te=w.toLowerCase().trim(),T=Y.list.find(c=>(c.server_filename||"").toLowerCase().trim()===te&&!c.isdir);if(!T)return console.log(` [Cloud Sync] : ${w}`),null;console.log(` [Cloud Sync] fs_id: ${T.fs_id}, : ${T.size}`);const g=await At.getFileInfo(z,T.fs_id.toString());if(!g.info||!g.info[0]?.dlink)return console.error(" [Cloud Sync] :",g),null;const l=g.info[0].dlink,A=await At.downloadFile(l,z);if(!A.success||!A.data)return console.error(" [Cloud Sync] "),null;const M=new Blob([new Uint8Array(A.data)]);return console.log(` [Cloud Sync] : ${M.size} `),M}catch(z){return console.error(" [Cloud Sync] :",z),null}},He=async P=>{try{if(!await Ie()||!o.value.storage.baidupan)return!1;const{accessToken:z}=o.value.storage.baidupan,V=P.split("/").filter(F=>F).pop()||"";console.log(" - :",P,":",V);const Q=`/apps/${Ge}`;console.log(":",Q);const w=await At.getFileList(z,Q,1,1e3,"name","list",1);if(console.log(":",w),w.error_code)return console.error(":",w),!1;if(!w.list||w.list.length===0)return console.error(":",w),!1;console.log(":",w.list.map(F=>F.server_filename));const Z=V.toLowerCase().trim(),Y=w.list.find(F=>(F.server_filename||"").toLowerCase().trim()===Z);if(!Y)return console.error(":",V),console.error(":",Z),console.error(":",w.list.map(F=>({name:F.server_filename,normalized:(F.server_filename||"").toLowerCase().trim()}))),!1;const te=Y.fs_id;console.log(" fsid:",te);const T=await At.getFileInfo(z,te.toString());if(console.log(":",T),T.error_code||T.errno)return console.error(":",T),!1;if(!T.info||!Array.isArray(T.info)||T.info.length===0)return console.error(":",JSON.stringify(T,null,2)),!1;const g=T.info[0].dlink;if(!g)return console.error(":",JSON.stringify(T,null,2)),!1;console.log(" dlink:",g);const l=await At.downloadFile(g,z);if(console.log(":",l),!l.success||!l.data||l.data.length===0)return console.error(":",l.error||""),!1;const A=new Uint8Array(l.data).buffer,M=V.split(".").pop()?.toLowerCase()||"epub",c=V.replace(`.${M}`,""),q=a.value.find(F=>F.baidupanPath===P||F.title===c);let W;q?(W=q.id,console.log(":",c,"ID:",W)):(W=`downloaded_${yr()}`,console.log(":",c,"ID:",W)),await Me.setItem(`ebook_content_${W}`,A);const x={id:W,title:c,author:"",cover:q?.cover||"",path:W,format:M,size:A.byteLength,lastRead:Date.now(),totalChapters:0,readingProgress:q?.readingProgress||0,storageType:"synced",baidupanPath:P,addedAt:q?.addedAt||Date.now()};if(q?await se(W,x):await le(x),M==="epub")try{const F=Wt(A);await new Promise((fe,ge)=>{F.ready.then(fe).catch(ge)});const X=await F.coverUrl();if(X)if(X.startsWith("blob:"))try{x.cover=await S(X),URL.revokeObjectURL(X)}catch(fe){console.warn(" Base64 :",fe)}else x.cover=X;const me=await F.loaded.metadata;me&&(me.creator&&(x.author=Array.isArray(me.creator)?me.creator.join(", "):me.creator),console.log("EPUB :",me)),await se(W,{cover:x.cover,author:x.author})}catch(F){console.warn("EPUB :",F)}return console.log(":",V),!0}catch(z){return console.error(":",z),!1}},Le=async()=>{try{if(!await Ie()||!o.value.storage.baidupan){console.log("");return}const{accessToken:P,rootPath:z}=o.value.storage.baidupan,V=z||`/apps/${Ge}`;console.log(":",V);try{console.log(" [Cloud Sync]  categories.json...");const Z=await Ue("categories.json");if(Z){const Y=await Z.text(),T=JSON.parse(Y).categories;T&&Array.isArray(T)&&(e.value=T,await Me.setItem("categories",T),e.value=[...e.value],console.log(" [Cloud Sync] categories.json"))}else console.log(" [Cloud Sync]  categories.json")}catch(Z){console.warn(" [Cloud Sync]  categories.json :",Z)}try{console.log(" [Cloud Sync]  books.json...");const Z=await Ue("books.json");if(Z){const Y=await Z.text(),T=JSON.parse(Y).books;if(T&&Array.isArray(T)){const g=a.value.filter(A=>A.storageType==="local"),l=[...g,...T];a.value=l,await Me.setItem("books",l),a.value=[...a.value],console.log(` [Cloud Sync]  (: ${g.length}, : ${T.length}, : ${l.length})`)}}else console.log(" [Cloud Sync]  books.json")}catch(Z){console.warn(" [Cloud Sync]  books.json :",Z)}I();const w=await At.getFileList(P,V,1,1e3,"name","list",1);if(w.list&&Array.isArray(w.list)){const Z=new Set;if(w.list.length>0)for(const te of w.list){if(te.isdir||!te.server_filename)continue;const T=te.server_filename.split(".").pop()?.toLowerCase();if(!["epub","pdf","txt"].includes(T||""))continue;const g=te.server_filename.replace(`.${T}`,""),l=te.path||"";Z.add(l);const A=W=>W.toLowerCase().replace(/[_\s\-]+/g,"").replace(/[^\w\u4e00-\u9fa5]/g,"").trim(),M=A(g);let q=a.value.find(W=>W.baidupanPath===l);if(q||(q=a.value.find(W=>A(W.title)===M&&(W.storageType==="synced"||W.storageType==="local"))),!q){const W={id:`baidupan_${te.fs_id||Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:te.server_filename.replace(`.${T}`,""),author:"",cover:"",path:te.path||"",format:T||"txt",size:te.size||0,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"baidupan",baidupanPath:te.path||"",addedAt:Date.now()};a.value.push(W),console.log(":",W.title)}}const Y=[];for(const te of a.value)te.storageType==="baidupan"&&te.baidupanPath&&(Z.has(te.baidupanPath)||(Y.push(te.id),console.log(":",te.title,":",te.baidupanPath)));Y.length>0&&(a.value=a.value.filter(te=>!Y.includes(te.id)),console.log(` ${Y.length} `)),await h(!1),console.log(":",a.value.length)}}catch(P){console.error(":",P)}},Je=async P=>{try{if(!await Ie()||!o.value.storage.baidupan)return[];const{accessToken:z}=o.value.storage.baidupan,Q=await At.getFileList(z,P,1,100,"name","list",0);return console.log(":",Q),Q.error?(console.error(":",Q),[]):Q.list||[]}catch(z){return console.error(":",z),[]}},rt=async()=>{try{if(!await Ie())return console.error(""),!1;console.log(":",a.value.length);const P={ebooks:a.value,timestamp:Date.now(),deviceId:u.value?.id||"unknown",deviceName:u.value?.name||"unknown"},z=new File([JSON.stringify(P)],"books.json",{type:"application/json"});await Ae(z,"");const V={categories:e.value,timestamp:Date.now(),deviceId:u.value?.id||"unknown"},Q=new File([JSON.stringify(V)],"categories.json",{type:"application/json"});await Ae(Q,""),console.log("");let w=0;const Z=10;for(let Y=0;Y<a.value.length;Y+=Z){const T=a.value.slice(Y,Y+Z).map(async g=>{try{const l=await Me.getItem(`progress_${g.id}`);if(l){const A=new File([JSON.stringify(l)],`${g.id}.json`,{type:"application/json"});await Ae(A,"/sync/progress"),w++}}catch(l){console.error(`: ${g.id}`,l)}});await Promise.all(T)}return console.log(` ${w} `),!0}catch(P){return console.error(":",P),!1}},et=P=>{console.log(":",P),(async()=>{try{const z=await Me.getItem(`progress_${P}`);if(z){const V=new File([JSON.stringify(z)],`${P}.json`,{type:"application/json"});await Ae(V,"/sync/progress"),console.log(":",P)}}catch(z){console.warn(":",z)}})()},De=async()=>{try{if(!await Ie())return console.error(""),!1;console.log("");const P=await Ue("/sync/books.json");if(P){const Q=await P.text(),w=JSON.parse(Q);w.ebooks&&(a.value=w.ebooks,await h(),console.log(":",a.value.length))}const z=await Ue("/sync/categories.json");if(z){const Q=await z.text(),w=JSON.parse(Q);w.categories&&(e.value=w.categories,await m(),console.log(":",e.value.length))}let V=0;for(const Q of a.value)try{const w=await Ue(`/sync/progress/${Q.id}.json`);if(w){const Z=await w.text(),Y=JSON.parse(Z);await Me.setItem(`progress_${Q.id}`,Y),Q.id===r.value?.ebookId&&(r.value=Y),V++}}catch(w){console.error(`: ${Q.id}`,w)}return console.log(` ${V} `),!0}catch(P){return console.error(":",P),!1}},Se=async P=>{try{console.log(" EPUB :",P.name);const z=`epub_${yr()}`,V=await P.arrayBuffer();console.log(" IndexedDB:",`ebook_content_${z}`),await Me.setItem(`ebook_content_${z}`,V);let Q="",w="",Z=P.name.replace(".epub","");try{const te=Wt(V);await new Promise((l,A)=>{te.ready.then(l).catch(A)});const T=await te.loaded.metadata;console.log("EPUB :",T),T.creator&&(Array.isArray(T.creator)?w=T.creator.join(", "):w=T.creator),T.title&&(Z=T.title);const g=await te.coverUrl();if(console.log(" URL:",g),g)if(typeof g=="string"&&g.startsWith("blob:"))try{console.log(" Blob URL  Base64"),Q=await S(g),console.log("Base64 :",Q.length),URL.revokeObjectURL(g)}catch(l){console.warn(" Base64 :",l),Q=""}else Q=g}catch(te){console.warn(":",te)}const Y={id:z,title:Z,author:w,cover:Q,path:z,format:"epub",size:P.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return console.log(":",{id:Y.id,title:Y.title,author:Y.author,cover:Y.cover,storageType:Y.storageType}),await le(Y),console.log("EPUB "),Y}catch(z){return console.error(" EPUB :",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),null}},xe=async P=>{try{const z=`pdf_${yr()}`,V=await P.arrayBuffer();await Me.setItem(`ebook_content_${z}`,V);const Q={id:z,title:P.name.replace(".pdf",""),author:"",cover:"",path:z,format:"pdf",size:P.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return await le(Q),Q}catch(z){return console.error(" PDF :",z),null}},it=async P=>{try{const z=`txt_${yr()}`,V=await P.arrayBuffer();await Me.setItem(`ebook_content_${z}`,V);const Q={id:z,title:P.name.replace(".txt",""),author:"",cover:"",path:z,format:"txt",size:P.size,lastRead:Date.now(),totalChapters:1,readingProgress:0,storageType:"local",addedAt:Date.now()};return await le(Q),Q}catch(z){return console.error(" TXT :",z),null}},mt=async P=>{try{const z=P.name.split(".").pop()?.toLowerCase();if(!z)throw console.error(""),new Error("");switch(z){case"epub":return await Se(P);case"pdf":return await xe(P);case"txt":return await it(P);default:throw console.error(":",z),new Error(`: ${z}`)}}catch(z){return console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),null}},dt=async()=>{try{const P=await Me.getItem("aiConversations");P&&(s.value=new Map(Object.entries(P)),console.log("  AI :",s.value.size))}catch(P){console.error("  AI :",P)}},Qe=async()=>{try{const P={};s.value.forEach((z,V)=>{P[V]={bookId:z.bookId,messages:z.messages.map(Q=>({role:Q.role,content:Q.content,timestamp:Q.timestamp,selectedText:Q.selectedText})),lastUpdated:z.lastUpdated}}),await Me.setItem("aiConversations",P)}catch(P){console.error("  AI :",P)}},yt=P=>(s.value.has(P)||s.value.set(P,{bookId:P,messages:[],lastUpdated:Date.now()}),s.value.get(P));return{books:a,categories:e,currentBook:t,readingProgress:r,userConfig:o,deviceInfo:u,baidupanUser:i,aiConversations:s,localBooks:f,baidupanBooks:d,recentBooks:p,getBooksByCategory:b,getCategoryById:y,loadBooks:_,saveBooks:h,addBook:le,updateBook:se,removeBook:ie,getBookById:pe,setCurrentBook:Ee,loadReadingProgress:ue,saveReadingProgress:ve,loadUserConfig:Te,saveUserConfig:we,updateUserConfig:Ne,loadCategories:v,saveCategories:m,addCategory:L,updateCategory:K,deleteCategory:$,addBookToCategory:J,removeBookFromCategory:ne,searchBooks:ae,syncReadingProgress:rt,syncReadingProgressFromBaidupan:De,importEpubFile:Se,importPdfFile:xe,importTxtFile:it,importEbookFile:mt,uploadLocalBookToBaidupan:ze,downloadBlobFromBaidupan:Ue,downloadFromBaidupan:He,listBaidupanFiles:Je,isBaidupanTokenValid:We,syncCurrentBookProgress:et,loadBaidupanBooks:Le,fetchBaidupanUserInfo:ke,uploadToBaidupanNew:Ae,getAIConversation:yt,addAIMessage:async(P,z)=>{const V=yt(P);V.messages.push(z),V.lastUpdated=Date.now(),await Qe()},clearAIConversation:async P=>{s.value.delete(P),await Qe()},saveAIConversations:Qe,initialize:async()=>{await Promise.all([_(),Te(),v(),dt()])}}});export{At as a,lt as b,Mc as d,hr as g,Me as l,qc as u,yr as v};
