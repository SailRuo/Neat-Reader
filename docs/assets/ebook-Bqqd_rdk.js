import{D as hs,j as Pt,k as $t}from"./index-x1s78wZn.js";var bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zt(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}function It(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ar={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var Ri;function fs(){return Ri||(Ri=1,(function(m,e){(function(t){m.exports=t()})(function(){return(function t(r,i,n){function s(f,p){if(!i[f]){if(!r[f]){var c=typeof It=="function"&&It;if(!p&&c)return c(f,!0);if(a)return a(f,!0);var _=new Error("Cannot find module '"+f+"'");throw _.code="MODULE_NOT_FOUND",_}var y=i[f]={exports:{}};r[f][0].call(y.exports,function(O){var E=r[f][1][O];return s(E||O)},y,y.exports,t,r,i,n)}return i[f].exports}for(var a=typeof It=="function"&&It,l=0;l<n.length;l++)s(n[l]);return s})({1:[function(t,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,a;if(s){var l=0,f=new s(O),p=n.document.createTextNode("");f.observe(p,{characterData:!0}),a=function(){p.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var c=new n.MessageChannel;c.port1.onmessage=O,a=function(){c.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?a=function(){var h=n.document.createElement("script");h.onreadystatechange=function(){O(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:a=function(){setTimeout(O,0)};var _,y=[];function O(){_=!0;for(var h,v,g=y.length;g;){for(v=y,y=[],h=-1;++h<g;)v[h]();g=y.length}_=!1}r.exports=E;function E(h){y.push(h)===1&&!_&&a()}}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,i){var n=t(1);function s(){}var a={},l=["REJECTED"],f=["FULFILLED"],p=["PENDING"];r.exports=c;function c(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,b!==s&&E(this,b)}c.prototype.catch=function(b){return this.then(null,b)},c.prototype.then=function(b,T){if(typeof b!="function"&&this.state===f||typeof T!="function"&&this.state===l)return this;var N=new this.constructor(s);if(this.state!==p){var R=this.state===f?b:T;y(N,R,this.outcome)}else this.queue.push(new _(N,b,T));return N};function _(b,T,N){this.promise=b,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}_.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},_.prototype.otherCallFulfilled=function(b){y(this.promise,this.onFulfilled,b)},_.prototype.callRejected=function(b){a.reject(this.promise,b)},_.prototype.otherCallRejected=function(b){y(this.promise,this.onRejected,b)};function y(b,T,N){n(function(){var R;try{R=T(N)}catch(k){return a.reject(b,k)}R===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,R)})}a.resolve=function(b,T){var N=h(O,T);if(N.status==="error")return a.reject(b,N.value);var R=N.value;if(R)E(b,R);else{b.state=f,b.outcome=T;for(var k=-1,I=b.queue.length;++k<I;)b.queue[k].callFulfilled(T)}return b},a.reject=function(b,T){b.state=l,b.outcome=T;for(var N=-1,R=b.queue.length;++N<R;)b.queue[N].callRejected(T);return b};function O(b){var T=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof T=="function")return function(){T.apply(b,arguments)}}function E(b,T){var N=!1;function R(H){N||(N=!0,a.reject(b,H))}function k(H){N||(N=!0,a.resolve(b,H))}function I(){T(k,R)}var X=h(I);X.status==="error"&&R(X.value)}function h(b,T){var N={};try{N.value=b(T),N.status="success"}catch(R){N.status="error",N.value=R}return N}c.resolve=v;function v(b){return b instanceof this?b:a.resolve(new this(s),b)}c.reject=g;function g(b){var T=new this(s);return a.reject(T,b)}c.all=C;function C(b){var T=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=b.length,R=!1;if(!N)return this.resolve([]);for(var k=new Array(N),I=0,X=-1,H=new this(s);++X<N;)$(b[X],X);return H;function $(se,re){T.resolve(se).then(ge,function(ee){R||(R=!0,a.reject(H,ee))});function ge(ee){k[re]=ee,++I===N&&!R&&(R=!0,a.resolve(H,k))}}}c.race=B;function B(b){var T=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=b.length,R=!1;if(!N)return this.resolve([]);for(var k=-1,I=new this(s);++k<N;)X(b[k]);return I;function X(H){T.resolve(H).then(function($){R||(R=!0,a.resolve(I,$))},function($){R||(R=!0,a.reject(I,$))})}}},{1:1}],3:[function(t,r,i){(function(n){typeof n.Promise!="function"&&(n.Promise=t(2))}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,i){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D};function s(D,F){if(!(D instanceof F))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=a();function f(){try{if(!l||!l.open)return!1;var D=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),F=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!D||F)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function p(D,F){D=D||[],F=F||{};try{return new Blob(D,F)}catch(j){if(j.name!=="TypeError")throw j;for(var S=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,W=new S,V=0;V<D.length;V+=1)W.append(D[V]);return W.getBlob(F.type)}}typeof Promise>"u"&&t(3);var c=Promise;function _(D,F){F&&D.then(function(S){F(null,S)},function(S){F(S)})}function y(D,F,S){typeof F=="function"&&D.then(F),typeof S=="function"&&D.catch(S)}function O(D){return typeof D!="string"&&(console.warn(D+" used as a key, but it is not a string."),D=String(D)),D}function E(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",v=void 0,g={},C=Object.prototype.toString,B="readonly",b="readwrite";function T(D){for(var F=D.length,S=new ArrayBuffer(F),W=new Uint8Array(S),V=0;V<F;V++)W[V]=D.charCodeAt(V);return S}function N(D){return new c(function(F){var S=D.transaction(h,b),W=p([""]);S.objectStore(h).put(W,"key"),S.onabort=function(V){V.preventDefault(),V.stopPropagation(),F(!1)},S.oncomplete=function(){var V=navigator.userAgent.match(/Chrome\/(\d+)/),j=navigator.userAgent.match(/Edge\//);F(j||!V||parseInt(V[1],10)>=43)}}).catch(function(){return!1})}function R(D){return typeof v=="boolean"?c.resolve(v):N(D).then(function(F){return v=F,v})}function k(D){var F=g[D.name],S={};S.promise=new c(function(W,V){S.resolve=W,S.reject=V}),F.deferredOperations.push(S),F.dbReady?F.dbReady=F.dbReady.then(function(){return S.promise}):F.dbReady=S.promise}function I(D){var F=g[D.name],S=F.deferredOperations.pop();if(S)return S.resolve(),S.promise}function X(D,F){var S=g[D.name],W=S.deferredOperations.pop();if(W)return W.reject(F),W.promise}function H(D,F){return new c(function(S,W){if(g[D.name]=g[D.name]||pe(),D.db)if(F)k(D),D.db.close();else return S(D.db);var V=[D.name];F&&V.push(D.version);var j=l.open.apply(l,V);F&&(j.onupgradeneeded=function(K){var ne=j.result;try{ne.createObjectStore(D.storeName),K.oldVersion<=1&&ne.createObjectStore(h)}catch(oe){if(oe.name==="ConstraintError")console.warn('The database "'+D.name+'" has been upgraded from version '+K.oldVersion+" to version "+K.newVersion+', but the storage "'+D.storeName+'" already exists.');else throw oe}}),j.onerror=function(K){K.preventDefault(),W(j.error)},j.onsuccess=function(){var K=j.result;K.onversionchange=function(ne){ne.target.close()},S(K),I(D)}})}function $(D){return H(D,!1)}function se(D){return H(D,!0)}function re(D,F){if(!D.db)return!0;var S=!D.db.objectStoreNames.contains(D.storeName),W=D.version<D.db.version,V=D.version>D.db.version;if(W&&(D.version!==F&&console.warn('The database "'+D.name+`" can't be downgraded from version `+D.db.version+" to version "+D.version+"."),D.version=D.db.version),V||S){if(S){var j=D.db.version+1;j>D.version&&(D.version=j)}return!0}return!1}function ge(D){return new c(function(F,S){var W=new FileReader;W.onerror=S,W.onloadend=function(V){var j=btoa(V.target.result||"");F({__local_forage_encoded_blob:!0,data:j,type:D.type})},W.readAsBinaryString(D)})}function ee(D){var F=T(atob(D.data));return p([F],{type:D.type})}function Q(D){return D&&D.__local_forage_encoded_blob}function fe(D){var F=this,S=F._initReady().then(function(){var W=g[F._dbInfo.name];if(W&&W.dbReady)return W.dbReady});return y(S,D,D),S}function Ae(D){k(D);for(var F=g[D.name],S=F.forages,W=0;W<S.length;W++){var V=S[W];V._dbInfo.db&&(V._dbInfo.db.close(),V._dbInfo.db=null)}return D.db=null,$(D).then(function(j){return D.db=j,re(D)?se(D):j}).then(function(j){D.db=F.db=j;for(var K=0;K<S.length;K++)S[K]._dbInfo.db=j}).catch(function(j){throw X(D,j),j})}function le(D,F,S,W){W===void 0&&(W=1);try{var V=D.db.transaction(D.storeName,F);S(null,V)}catch(j){if(W>0&&(!D.db||j.name==="InvalidStateError"||j.name==="NotFoundError"))return c.resolve().then(function(){if(!D.db||j.name==="NotFoundError"&&!D.db.objectStoreNames.contains(D.storeName)&&D.version<=D.db.version)return D.db&&(D.version=D.db.version+1),se(D)}).then(function(){return Ae(D).then(function(){le(D,F,S,W-1)})}).catch(S);S(j)}}function pe(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ne(D){var F=this,S={db:null};if(D)for(var W in D)S[W]=D[W];var V=g[S.name];V||(V=pe(),g[S.name]=V),V.forages.push(F),F._initReady||(F._initReady=F.ready,F.ready=fe);var j=[];function K(){return c.resolve()}for(var ne=0;ne<V.forages.length;ne++){var oe=V.forages[ne];oe!==F&&j.push(oe._initReady().catch(K))}var ue=V.forages.slice(0);return c.all(j).then(function(){return S.db=V.db,$(S)}).then(function(he){return S.db=he,re(S,F._defaultConfig.version)?se(S):he}).then(function(he){S.db=V.db=he,F._dbInfo=S;for(var xe=0;xe<ue.length;xe++){var Fe=ue[xe];Fe!==F&&(Fe._dbInfo.db=S.db,Fe._dbInfo.version=S.version)}})}function De(D,F){var S=this;D=O(D);var W=new c(function(V,j){S.ready().then(function(){le(S._dbInfo,B,function(K,ne){if(K)return j(K);try{var oe=ne.objectStore(S._dbInfo.storeName),ue=oe.get(D);ue.onsuccess=function(){var he=ue.result;he===void 0&&(he=null),Q(he)&&(he=ee(he)),V(he)},ue.onerror=function(){j(ue.error)}}catch(he){j(he)}})}).catch(j)});return _(W,F),W}function Oe(D,F){var S=this,W=new c(function(V,j){S.ready().then(function(){le(S._dbInfo,B,function(K,ne){if(K)return j(K);try{var oe=ne.objectStore(S._dbInfo.storeName),ue=oe.openCursor(),he=1;ue.onsuccess=function(){var xe=ue.result;if(xe){var Fe=xe.value;Q(Fe)&&(Fe=ee(Fe));var He=D(Fe,xe.key,he++);He!==void 0?V(He):xe.continue()}else V()},ue.onerror=function(){j(ue.error)}}catch(xe){j(xe)}})}).catch(j)});return _(W,F),W}function Ge(D,F,S){var W=this;D=O(D);var V=new c(function(j,K){var ne;W.ready().then(function(){return ne=W._dbInfo,C.call(F)==="[object Blob]"?R(ne.db).then(function(oe){return oe?F:ge(F)}):F}).then(function(oe){le(W._dbInfo,b,function(ue,he){if(ue)return K(ue);try{var xe=he.objectStore(W._dbInfo.storeName);oe===null&&(oe=void 0);var Fe=xe.put(oe,D);he.oncomplete=function(){oe===void 0&&(oe=null),j(oe)},he.onabort=he.onerror=function(){var He=Fe.error?Fe.error:Fe.transaction.error;K(He)}}catch(He){K(He)}})}).catch(K)});return _(V,S),V}function qe(D,F){var S=this;D=O(D);var W=new c(function(V,j){S.ready().then(function(){le(S._dbInfo,b,function(K,ne){if(K)return j(K);try{var oe=ne.objectStore(S._dbInfo.storeName),ue=oe.delete(D);ne.oncomplete=function(){V()},ne.onerror=function(){j(ue.error)},ne.onabort=function(){var he=ue.error?ue.error:ue.transaction.error;j(he)}}catch(he){j(he)}})}).catch(j)});return _(W,F),W}function Ce(D){var F=this,S=new c(function(W,V){F.ready().then(function(){le(F._dbInfo,b,function(j,K){if(j)return V(j);try{var ne=K.objectStore(F._dbInfo.storeName),oe=ne.clear();K.oncomplete=function(){W()},K.onabort=K.onerror=function(){var ue=oe.error?oe.error:oe.transaction.error;V(ue)}}catch(ue){V(ue)}})}).catch(V)});return _(S,D),S}function Ue(D){var F=this,S=new c(function(W,V){F.ready().then(function(){le(F._dbInfo,B,function(j,K){if(j)return V(j);try{var ne=K.objectStore(F._dbInfo.storeName),oe=ne.count();oe.onsuccess=function(){W(oe.result)},oe.onerror=function(){V(oe.error)}}catch(ue){V(ue)}})}).catch(V)});return _(S,D),S}function We(D,F){var S=this,W=new c(function(V,j){if(D<0){V(null);return}S.ready().then(function(){le(S._dbInfo,B,function(K,ne){if(K)return j(K);try{var oe=ne.objectStore(S._dbInfo.storeName),ue=!1,he=oe.openKeyCursor();he.onsuccess=function(){var xe=he.result;if(!xe){V(null);return}D===0||ue?V(xe.key):(ue=!0,xe.advance(D))},he.onerror=function(){j(he.error)}}catch(xe){j(xe)}})}).catch(j)});return _(W,F),W}function Te(D){var F=this,S=new c(function(W,V){F.ready().then(function(){le(F._dbInfo,B,function(j,K){if(j)return V(j);try{var ne=K.objectStore(F._dbInfo.storeName),oe=ne.openKeyCursor(),ue=[];oe.onsuccess=function(){var he=oe.result;if(!he){W(ue);return}ue.push(he.key),he.continue()},oe.onerror=function(){V(oe.error)}}catch(he){V(he)}})}).catch(V)});return _(S,D),S}function Be(D,F){F=E.apply(this,arguments);var S=this.config();D=typeof D!="function"&&D||{},D.name||(D.name=D.name||S.name,D.storeName=D.storeName||S.storeName);var W=this,V;if(!D.name)V=c.reject("Invalid arguments");else{var j=D.name===S.name&&W._dbInfo.db,K=j?c.resolve(W._dbInfo.db):$(D).then(function(ne){var oe=g[D.name],ue=oe.forages;oe.db=ne;for(var he=0;he<ue.length;he++)ue[he]._dbInfo.db=ne;return ne});D.storeName?V=K.then(function(ne){if(ne.objectStoreNames.contains(D.storeName)){var oe=ne.version+1;k(D);var ue=g[D.name],he=ue.forages;ne.close();for(var xe=0;xe<he.length;xe++){var Fe=he[xe];Fe._dbInfo.db=null,Fe._dbInfo.version=oe}var He=new c(function(Ve,nt){var it=l.open(D.name,oe);it.onerror=function(mt){var Yt=it.result;Yt.close(),nt(mt)},it.onupgradeneeded=function(){var mt=it.result;mt.deleteObjectStore(D.storeName)},it.onsuccess=function(){var mt=it.result;mt.close(),Ve(mt)}});return He.then(function(Ve){ue.db=Ve;for(var nt=0;nt<he.length;nt++){var it=he[nt];it._dbInfo.db=Ve,I(it._dbInfo)}}).catch(function(Ve){throw(X(D,Ve)||c.resolve()).catch(function(){}),Ve})}}):V=K.then(function(ne){k(D);var oe=g[D.name],ue=oe.forages;ne.close();for(var he=0;he<ue.length;he++){var xe=ue[he];xe._dbInfo.db=null}var Fe=new c(function(He,Ve){var nt=l.deleteDatabase(D.name);nt.onerror=function(){var it=nt.result;it&&it.close(),Ve(nt.error)},nt.onblocked=function(){console.warn('dropInstance blocked for database "'+D.name+'" until all open connections are closed')},nt.onsuccess=function(){var it=nt.result;it&&it.close(),He(it)}});return Fe.then(function(He){oe.db=He;for(var Ve=0;Ve<ue.length;Ve++){var nt=ue[Ve];I(nt._dbInfo)}}).catch(function(He){throw(X(D,He)||c.resolve()).catch(function(){}),He})})}return _(V,F),V}var Ie={_driver:"asyncStorage",_initStorage:Ne,_support:f(),iterate:Oe,getItem:De,setItem:Ge,removeItem:qe,clear:Ce,length:Ue,key:We,keys:Te,dropInstance:Be};function z(){return typeof openDatabase=="function"}var M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="~~local_forage_type~",te=/^~~local_forage_type~([^~]+)~/,ie="__lfsc__:",me=ie.length,Se="arbf",we="blob",Ee="si08",_e="ui08",Me="uic8",Xe="si16",st="si32",tt="ur16",ut="ui32",dt="fl32",ot="fl64",pt=me+Se.length,ct=Object.prototype.toString;function Ke(D){var F=D.length*.75,S=D.length,W,V=0,j,K,ne,oe;D[D.length-1]==="="&&(F--,D[D.length-2]==="="&&F--);var ue=new ArrayBuffer(F),he=new Uint8Array(ue);for(W=0;W<S;W+=4)j=M.indexOf(D[W]),K=M.indexOf(D[W+1]),ne=M.indexOf(D[W+2]),oe=M.indexOf(D[W+3]),he[V++]=j<<2|K>>4,he[V++]=(K&15)<<4|ne>>2,he[V++]=(ne&3)<<6|oe&63;return ue}function lt(D){var F=new Uint8Array(D),S="",W;for(W=0;W<F.length;W+=3)S+=M[F[W]>>2],S+=M[(F[W]&3)<<4|F[W+1]>>4],S+=M[(F[W+1]&15)<<2|F[W+2]>>6],S+=M[F[W+2]&63];return F.length%3===2?S=S.substring(0,S.length-1)+"=":F.length%3===1&&(S=S.substring(0,S.length-2)+"=="),S}function wt(D,F){var S="";if(D&&(S=ct.call(D)),D&&(S==="[object ArrayBuffer]"||D.buffer&&ct.call(D.buffer)==="[object ArrayBuffer]")){var W,V=ie;D instanceof ArrayBuffer?(W=D,V+=Se):(W=D.buffer,S==="[object Int8Array]"?V+=Ee:S==="[object Uint8Array]"?V+=_e:S==="[object Uint8ClampedArray]"?V+=Me:S==="[object Int16Array]"?V+=Xe:S==="[object Uint16Array]"?V+=tt:S==="[object Int32Array]"?V+=st:S==="[object Uint32Array]"?V+=ut:S==="[object Float32Array]"?V+=dt:S==="[object Float64Array]"?V+=ot:F(new Error("Failed to get type for BinaryArray"))),F(V+lt(W))}else if(S==="[object Blob]"){var j=new FileReader;j.onload=function(){var K=Y+D.type+"~"+lt(this.result);F(ie+we+K)},j.readAsArrayBuffer(D)}else try{F(JSON.stringify(D))}catch(K){console.error("Couldn't convert value into a JSON string: ",D),F(null,K)}}function A(D){if(D.substring(0,me)!==ie)return JSON.parse(D);var F=D.substring(pt),S=D.substring(me,pt),W;if(S===we&&te.test(F)){var V=F.match(te);W=V[1],F=F.substring(V[0].length)}var j=Ke(F);switch(S){case Se:return j;case we:return p([j],{type:W});case Ee:return new Int8Array(j);case _e:return new Uint8Array(j);case Me:return new Uint8ClampedArray(j);case Xe:return new Int16Array(j);case tt:return new Uint16Array(j);case st:return new Int32Array(j);case ut:return new Uint32Array(j);case dt:return new Float32Array(j);case ot:return new Float64Array(j);default:throw new Error("Unkown type: "+S)}}var J={serialize:wt,deserialize:A,stringToBuffer:Ke,bufferToString:lt};function ae(D,F,S,W){D.executeSql("CREATE TABLE IF NOT EXISTS "+F.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],S,W)}function ye(D){var F=this,S={db:null};if(D)for(var W in D)S[W]=typeof D[W]!="string"?D[W].toString():D[W];var V=new c(function(j,K){try{S.db=openDatabase(S.name,String(S.version),S.description,S.size)}catch(ne){return K(ne)}S.db.transaction(function(ne){ae(ne,S,function(){F._dbInfo=S,j()},function(oe,ue){K(ue)})},K)});return S.serializer=J,V}function P(D,F,S,W,V,j){D.executeSql(S,W,V,function(K,ne){ne.code===ne.SYNTAX_ERR?K.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[F.storeName],function(oe,ue){ue.rows.length?j(oe,ne):ae(oe,F,function(){oe.executeSql(S,W,V,j)},j)},j):j(K,ne)},j)}function d(D,F){var S=this;D=O(D);var W=new c(function(V,j){S.ready().then(function(){var K=S._dbInfo;K.db.transaction(function(ne){P(ne,K,"SELECT * FROM "+K.storeName+" WHERE key = ? LIMIT 1",[D],function(oe,ue){var he=ue.rows.length?ue.rows.item(0).value:null;he&&(he=K.serializer.deserialize(he)),V(he)},function(oe,ue){j(ue)})})}).catch(j)});return _(W,F),W}function o(D,F){var S=this,W=new c(function(V,j){S.ready().then(function(){var K=S._dbInfo;K.db.transaction(function(ne){P(ne,K,"SELECT * FROM "+K.storeName,[],function(oe,ue){for(var he=ue.rows,xe=he.length,Fe=0;Fe<xe;Fe++){var He=he.item(Fe),Ve=He.value;if(Ve&&(Ve=K.serializer.deserialize(Ve)),Ve=D(Ve,He.key,Fe+1),Ve!==void 0){V(Ve);return}}V()},function(oe,ue){j(ue)})})}).catch(j)});return _(W,F),W}function x(D,F,S,W){var V=this;D=O(D);var j=new c(function(K,ne){V.ready().then(function(){F===void 0&&(F=null);var oe=F,ue=V._dbInfo;ue.serializer.serialize(F,function(he,xe){xe?ne(xe):ue.db.transaction(function(Fe){P(Fe,ue,"INSERT OR REPLACE INTO "+ue.storeName+" (key, value) VALUES (?, ?)",[D,he],function(){K(oe)},function(He,Ve){ne(Ve)})},function(Fe){if(Fe.code===Fe.QUOTA_ERR){if(W>0){K(x.apply(V,[D,oe,S,W-1]));return}ne(Fe)}})})}).catch(ne)});return _(j,S),j}function U(D,F,S){return x.apply(this,[D,F,S,1])}function u(D,F){var S=this;D=O(D);var W=new c(function(V,j){S.ready().then(function(){var K=S._dbInfo;K.db.transaction(function(ne){P(ne,K,"DELETE FROM "+K.storeName+" WHERE key = ?",[D],function(){V()},function(oe,ue){j(ue)})})}).catch(j)});return _(W,F),W}function q(D){var F=this,S=new c(function(W,V){F.ready().then(function(){var j=F._dbInfo;j.db.transaction(function(K){P(K,j,"DELETE FROM "+j.storeName,[],function(){W()},function(ne,oe){V(oe)})})}).catch(V)});return _(S,D),S}function G(D){var F=this,S=new c(function(W,V){F.ready().then(function(){var j=F._dbInfo;j.db.transaction(function(K){P(K,j,"SELECT COUNT(key) as c FROM "+j.storeName,[],function(ne,oe){var ue=oe.rows.item(0).c;W(ue)},function(ne,oe){V(oe)})})}).catch(V)});return _(S,D),S}function w(D,F){var S=this,W=new c(function(V,j){S.ready().then(function(){var K=S._dbInfo;K.db.transaction(function(ne){P(ne,K,"SELECT key FROM "+K.storeName+" WHERE id = ? LIMIT 1",[D+1],function(oe,ue){var he=ue.rows.length?ue.rows.item(0).key:null;V(he)},function(oe,ue){j(ue)})})}).catch(j)});return _(W,F),W}function L(D){var F=this,S=new c(function(W,V){F.ready().then(function(){var j=F._dbInfo;j.db.transaction(function(K){P(K,j,"SELECT key FROM "+j.storeName,[],function(ne,oe){for(var ue=[],he=0;he<oe.rows.length;he++)ue.push(oe.rows.item(he).key);W(ue)},function(ne,oe){V(oe)})})}).catch(V)});return _(S,D),S}function Z(D){return new c(function(F,S){D.transaction(function(W){W.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(V,j){for(var K=[],ne=0;ne<j.rows.length;ne++)K.push(j.rows.item(ne).name);F({db:D,storeNames:K})},function(V,j){S(j)})},function(W){S(W)})})}function be(D,F){F=E.apply(this,arguments);var S=this.config();D=typeof D!="function"&&D||{},D.name||(D.name=D.name||S.name,D.storeName=D.storeName||S.storeName);var W=this,V;return D.name?V=new c(function(j){var K;D.name===S.name?K=W._dbInfo.db:K=openDatabase(D.name,"","",0),D.storeName?j({db:K,storeNames:[D.storeName]}):j(Z(K))}).then(function(j){return new c(function(K,ne){j.db.transaction(function(oe){function ue(He){return new c(function(Ve,nt){oe.executeSql("DROP TABLE IF EXISTS "+He,[],function(){Ve()},function(it,mt){nt(mt)})})}for(var he=[],xe=0,Fe=j.storeNames.length;xe<Fe;xe++)he.push(ue(j.storeNames[xe]));c.all(he).then(function(){K()}).catch(function(He){ne(He)})},function(oe){ne(oe)})})}):V=c.reject("Invalid arguments"),_(V,F),V}var ce={_driver:"webSQLStorage",_initStorage:ye,_support:z(),iterate:o,getItem:d,setItem:U,removeItem:u,clear:q,length:G,key:w,keys:L,dropInstance:be};function de(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ke(D,F){var S=D.name+"/";return D.storeName!==F.storeName&&(S+=D.storeName+"/"),S}function Je(){var D="_localforage_support_test";try{return localStorage.setItem(D,!0),localStorage.removeItem(D),!1}catch{return!0}}function je(){return!Je()||localStorage.length>0}function Re(D){var F=this,S={};if(D)for(var W in D)S[W]=D[W];return S.keyPrefix=ke(D,F._defaultConfig),je()?(F._dbInfo=S,S.serializer=J,c.resolve()):c.reject()}function Le(D){var F=this,S=F.ready().then(function(){for(var W=F._dbInfo.keyPrefix,V=localStorage.length-1;V>=0;V--){var j=localStorage.key(V);j.indexOf(W)===0&&localStorage.removeItem(j)}});return _(S,D),S}function rt(D,F){var S=this;D=O(D);var W=S.ready().then(function(){var V=S._dbInfo,j=localStorage.getItem(V.keyPrefix+D);return j&&(j=V.serializer.deserialize(j)),j});return _(W,F),W}function $e(D,F){var S=this,W=S.ready().then(function(){for(var V=S._dbInfo,j=V.keyPrefix,K=j.length,ne=localStorage.length,oe=1,ue=0;ue<ne;ue++){var he=localStorage.key(ue);if(he.indexOf(j)===0){var xe=localStorage.getItem(he);if(xe&&(xe=V.serializer.deserialize(xe)),xe=D(xe,he.substring(K),oe++),xe!==void 0)return xe}}});return _(W,F),W}function Tt(D,F){var S=this,W=S.ready().then(function(){var V=S._dbInfo,j;try{j=localStorage.key(D)}catch{j=null}return j&&(j=j.substring(V.keyPrefix.length)),j});return _(W,F),W}function Lt(D){var F=this,S=F.ready().then(function(){for(var W=F._dbInfo,V=localStorage.length,j=[],K=0;K<V;K++){var ne=localStorage.key(K);ne.indexOf(W.keyPrefix)===0&&j.push(ne.substring(W.keyPrefix.length))}return j});return _(S,D),S}function Qe(D){var F=this,S=F.keys().then(function(W){return W.length});return _(S,D),S}function vt(D,F){var S=this;D=O(D);var W=S.ready().then(function(){var V=S._dbInfo;localStorage.removeItem(V.keyPrefix+D)});return _(W,F),W}function at(D,F,S){var W=this;D=O(D);var V=W.ready().then(function(){F===void 0&&(F=null);var j=F;return new c(function(K,ne){var oe=W._dbInfo;oe.serializer.serialize(F,function(ue,he){if(he)ne(he);else try{localStorage.setItem(oe.keyPrefix+D,ue),K(j)}catch(xe){(xe.name==="QuotaExceededError"||xe.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ne(xe),ne(xe)}})})});return _(V,S),V}function _t(D,F){if(F=E.apply(this,arguments),D=typeof D!="function"&&D||{},!D.name){var S=this.config();D.name=D.name||S.name,D.storeName=D.storeName||S.storeName}var W=this,V;return D.name?V=new c(function(j){D.storeName?j(ke(D,W._defaultConfig)):j(D.name+"/")}).then(function(j){for(var K=localStorage.length-1;K>=0;K--){var ne=localStorage.key(K);ne.indexOf(j)===0&&localStorage.removeItem(ne)}}):V=c.reject("Invalid arguments"),_(V,F),V}var gt={_driver:"localStorageWrapper",_initStorage:Re,_support:de(),iterate:$e,getItem:rt,setItem:at,removeItem:vt,clear:Le,length:Qe,key:Tt,keys:Lt,dropInstance:_t},rr=function(F,S){return F===S||typeof F=="number"&&typeof S=="number"&&isNaN(F)&&isNaN(S)},ts=function(F,S){for(var W=F.length,V=0;V<W;){if(rr(F[V],S))return!0;V++}return!1},Ti=Array.isArray||function(D){return Object.prototype.toString.call(D)==="[object Array]"},Xt={},ki={},Ft={INDEXEDDB:Ie,WEBSQL:ce,LOCALSTORAGE:gt},rs=[Ft.INDEXEDDB._driver,Ft.WEBSQL._driver,Ft.LOCALSTORAGE._driver],ir=["dropInstance"],_r=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ir),is={description:"",driver:rs.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ns(D,F){D[F]=function(){var S=arguments;return D.ready().then(function(){return D[F].apply(D,S)})}}function Er(){for(var D=1;D<arguments.length;D++){var F=arguments[D];if(F)for(var S in F)F.hasOwnProperty(S)&&(Ti(F[S])?arguments[0][S]=F[S].slice():arguments[0][S]=F[S])}return arguments[0]}var ss=(function(){function D(F){s(this,D);for(var S in Ft)if(Ft.hasOwnProperty(S)){var W=Ft[S],V=W._driver;this[S]=V,Xt[V]||this.defineDriver(W)}this._defaultConfig=Er({},is),this._config=Er({},this._defaultConfig,F),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return D.prototype.config=function(S){if((typeof S>"u"?"undefined":n(S))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var W in S){if(W==="storeName"&&(S[W]=S[W].replace(/\W/g,"_")),W==="version"&&typeof S[W]!="number")return new Error("Database version must be a number.");this._config[W]=S[W]}return"driver"in S&&S.driver?this.setDriver(this._config.driver):!0}else return typeof S=="string"?this._config[S]:this._config},D.prototype.defineDriver=function(S,W,V){var j=new c(function(K,ne){try{var oe=S._driver,ue=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!S._driver){ne(ue);return}for(var he=_r.concat("_initStorage"),xe=0,Fe=he.length;xe<Fe;xe++){var He=he[xe],Ve=!ts(ir,He);if((Ve||S[He])&&typeof S[He]!="function"){ne(ue);return}}var nt=function(){for(var Yt=function(us){return function(){var ls=new Error("Method "+us+" is not implemented by the current driver"),Ni=c.reject(ls);return _(Ni,arguments[arguments.length-1]),Ni}},xr=0,os=ir.length;xr<os;xr++){var Dr=ir[xr];S[Dr]||(S[Dr]=Yt(Dr))}};nt();var it=function(Yt){Xt[oe]&&console.info("Redefining LocalForage driver: "+oe),Xt[oe]=S,ki[oe]=Yt,K()};"_support"in S?S._support&&typeof S._support=="function"?S._support().then(it,ne):it(!!S._support):it(!0)}catch(mt){ne(mt)}});return y(j,W,V),j},D.prototype.driver=function(){return this._driver||null},D.prototype.getDriver=function(S,W,V){var j=Xt[S]?c.resolve(Xt[S]):c.reject(new Error("Driver not found."));return y(j,W,V),j},D.prototype.getSerializer=function(S){var W=c.resolve(J);return y(W,S),W},D.prototype.ready=function(S){var W=this,V=W._driverSet.then(function(){return W._ready===null&&(W._ready=W._initDriver()),W._ready});return y(V,S,S),V},D.prototype.setDriver=function(S,W,V){var j=this;Ti(S)||(S=[S]);var K=this._getSupportedDrivers(S);function ne(){j._config.driver=j.driver()}function oe(xe){return j._extend(xe),ne(),j._ready=j._initStorage(j._config),j._ready}function ue(xe){return function(){var Fe=0;function He(){for(;Fe<xe.length;){var Ve=xe[Fe];return Fe++,j._dbInfo=null,j._ready=null,j.getDriver(Ve).then(oe).catch(He)}ne();var nt=new Error("No available storage method found.");return j._driverSet=c.reject(nt),j._driverSet}return He()}}var he=this._driverSet!==null?this._driverSet.catch(function(){return c.resolve()}):c.resolve();return this._driverSet=he.then(function(){var xe=K[0];return j._dbInfo=null,j._ready=null,j.getDriver(xe).then(function(Fe){j._driver=Fe._driver,ne(),j._wrapLibraryMethodsWithReady(),j._initDriver=ue(K)})}).catch(function(){ne();var xe=new Error("No available storage method found.");return j._driverSet=c.reject(xe),j._driverSet}),y(this._driverSet,W,V),this._driverSet},D.prototype.supports=function(S){return!!ki[S]},D.prototype._extend=function(S){Er(this,S)},D.prototype._getSupportedDrivers=function(S){for(var W=[],V=0,j=S.length;V<j;V++){var K=S[V];this.supports(K)&&W.push(K)}return W},D.prototype._wrapLibraryMethodsWithReady=function(){for(var S=0,W=_r.length;S<W;S++)ns(this,_r[S])},D.prototype.createInstance=function(S){return new D(S)},D})(),as=new ss;r.exports=as},{3:3}]},{},[4])(4)})})(Ar)),Ar.exports}var cs=fs();const Ye=Zt(cs);var nr={exports:{}},Cr={exports:{}},Sr,Ii;function Rn(){if(Ii)return Sr;Ii=1;var m=void 0;return Sr=function(e){return e!==m&&e!==null},Sr}var Tr,Oi;function ds(){if(Oi)return Tr;Oi=1;var m=Rn(),e={object:!0,function:!0,undefined:!0};return Tr=function(t){return m(t)?hasOwnProperty.call(e,typeof t):!1},Tr}var kr,Bi;function ps(){if(Bi)return kr;Bi=1;var m=ds();return kr=function(e){if(!m(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},kr}var Nr,Li;function vs(){if(Li)return Nr;Li=1;var m=ps();return Nr=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!m(e)},Nr}var Rr,Fi;function gs(){if(Fi)return Rr;Fi=1;var m=vs(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return Rr=function(r){return!(!m(r)||e.test(t.call(r)))},Rr}var Ir,Pi;function ms(){return Pi||(Pi=1,Ir=function(){var m=Object.assign,e;return typeof m!="function"?!1:(e={foo:"raz"},m(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),Ir}var Or,zi;function ys(){return zi||(zi=1,Or=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Or}var Br,Ui;function bs(){return Ui||(Ui=1,Br=function(){}),Br}var Lr,Mi;function bi(){if(Mi)return Lr;Mi=1;var m=bs()();return Lr=function(e){return e!==m&&e!==null},Lr}var Fr,qi;function ws(){if(qi)return Fr;qi=1;var m=bi(),e=Object.keys;return Fr=function(t){return e(m(t)?Object(t):t)},Fr}var Pr,ji;function _s(){return ji||(ji=1,Pr=ys()()?Object.keys:ws()),Pr}var zr,Wi;function Es(){if(Wi)return zr;Wi=1;var m=bi();return zr=function(e){if(!m(e))throw new TypeError("Cannot use null or undefined");return e},zr}var Ur,Hi;function xs(){if(Hi)return Ur;Hi=1;var m=_s(),e=Es(),t=Math.max;return Ur=function(r,i){var n,s,a=t(arguments.length,2),l;for(r=Object(e(r)),l=function(f){try{r[f]=i[f]}catch(p){n||(n=p)}},s=1;s<a;++s)i=arguments[s],m(i).forEach(l);if(n!==void 0)throw n;return r},Ur}var Mr,Vi;function Ds(){return Vi||(Vi=1,Mr=ms()()?Object.assign:xs()),Mr}var qr,Gi;function As(){if(Gi)return qr;Gi=1;var m=bi(),e=Array.prototype.forEach,t=Object.create,r=function(i,n){var s;for(s in i)n[s]=i[s]};return qr=function(i){var n=t(null);return e.call(arguments,function(s){m(s)&&r(Object(s),n)}),n},qr}var jr,Zi;function Cs(){if(Zi)return jr;Zi=1;var m="razdwatrzy";return jr=function(){return typeof m.contains!="function"?!1:m.contains("dwa")===!0&&m.contains("foo")===!1},jr}var Wr,Xi;function Ss(){if(Xi)return Wr;Xi=1;var m=String.prototype.indexOf;return Wr=function(e){return m.call(this,e,arguments[1])>-1},Wr}var Hr,Yi;function Ts(){return Yi||(Yi=1,Hr=Cs()()?String.prototype.contains:Ss()),Hr}var $i;function ks(){if($i)return Cr.exports;$i=1;var m=Rn(),e=gs(),t=Ds(),r=As(),i=Ts(),n=Cr.exports=function(s,a){var l,f,p,c,_;return arguments.length<2||typeof s!="string"?(c=a,a=s,s=null):c=arguments[2],m(s)?(l=i.call(s,"c"),f=i.call(s,"e"),p=i.call(s,"w")):(l=p=!0,f=!1),_={value:a,configurable:l,enumerable:f,writable:p},c?t(r(c),_):_};return n.gs=function(s,a,l){var f,p,c,_;return typeof s!="string"?(c=l,l=a,a=s,s=null):c=arguments[3],m(a)?e(a)?m(l)?e(l)||(c=l,l=void 0):l=void 0:(c=a,a=l=void 0):a=void 0,m(s)?(f=i.call(s,"c"),p=i.call(s,"e")):(f=!0,p=!1),_={get:a,set:l,configurable:f,enumerable:p},c?t(r(c),_):_},Cr.exports}var Vr,Ki;function Ns(){return Ki||(Ki=1,Vr=function(m){if(typeof m!="function")throw new TypeError(m+" is not a function");return m}),Vr}var Ji;function Rs(){return Ji||(Ji=1,(function(m,e){var t=ks(),r=Ns(),i=Function.prototype.apply,n=Function.prototype.call,s=Object.create,a=Object.defineProperty,l=Object.defineProperties,f=Object.prototype.hasOwnProperty,p={configurable:!0,enumerable:!1,writable:!0},c,_,y,O,E,h,v;c=function(g,C){var B;return r(C),f.call(this,"__ee__")?B=this.__ee__:(B=p.value=s(null),a(this,"__ee__",p),p.value=null),B[g]?typeof B[g]=="object"?B[g].push(C):B[g]=[B[g],C]:B[g]=C,this},_=function(g,C){var B,b;return r(C),b=this,c.call(this,g,B=function(){y.call(b,g,B),i.call(C,this,arguments)}),B.__eeOnceListener__=C,this},y=function(g,C){var B,b,T,N;if(r(C),!f.call(this,"__ee__"))return this;if(B=this.__ee__,!B[g])return this;if(b=B[g],typeof b=="object")for(N=0;T=b[N];++N)(T===C||T.__eeOnceListener__===C)&&(b.length===2?B[g]=b[N?0:1]:b.splice(N,1));else(b===C||b.__eeOnceListener__===C)&&delete B[g];return this},O=function(g){var C,B,b,T,N;if(f.call(this,"__ee__")&&(T=this.__ee__[g],!!T))if(typeof T=="object"){for(B=arguments.length,N=new Array(B-1),C=1;C<B;++C)N[C-1]=arguments[C];for(T=T.slice(),C=0;b=T[C];++C)i.call(b,this,N)}else switch(arguments.length){case 1:n.call(T,this);break;case 2:n.call(T,this,arguments[1]);break;case 3:n.call(T,this,arguments[1],arguments[2]);break;default:for(B=arguments.length,N=new Array(B-1),C=1;C<B;++C)N[C-1]=arguments[C];i.call(T,this,N)}},E={on:c,once:_,off:y,emit:O},h={on:t(c),once:t(_),off:t(y),emit:t(O)},v=l({},h),m.exports=e=function(g){return g==null?s(v):l(Object(g),h)},e.methods=E})(nr,nr.exports)),nr.exports}var Is=Rs();const St=Zt(Is);var Kt={},kt={},zt={},Qi;function yr(){if(Qi)return zt;Qi=1;function m(i,n,s){if(s===void 0&&(s=Array.prototype),i&&typeof s.find=="function")return s.find.call(i,n);for(var a=0;a<i.length;a++)if(Object.prototype.hasOwnProperty.call(i,a)){var l=i[a];if(n.call(void 0,l,a,i))return l}}function e(i,n){return n===void 0&&(n=Object),n&&typeof n.freeze=="function"?n.freeze(i):i}var t=e({HTML:"text/html",isHTML:function(i){return i===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return zt.find=m,zt.freeze=e,zt.MIME_TYPE=t,zt.NAMESPACE=r,zt}var en;function In(){if(en)return kt;en=1;var m=yr(),e=m.find,t=m.NAMESPACE;function r(d){return d!==""}function i(d){return d?d.split(/[\t\n\f\r ]+/).filter(r):[]}function n(d,o){return d.hasOwnProperty(o)||(d[o]=!0),d}function s(d){if(!d)return[];var o=i(d);return Object.keys(o.reduce(n,{}))}function a(d){return function(o){return d&&d.indexOf(o)!==-1}}function l(d,o){for(var x in d)Object.prototype.hasOwnProperty.call(d,x)&&(o[x]=d[x])}function f(d,o){var x=d.prototype;if(!(x instanceof o)){let U=function(){};U.prototype=o.prototype,U=new U,l(x,U),d.prototype=x=U}x.constructor!=d&&(typeof d!="function"&&console.error("unknown Class:"+d),x.constructor=d)}var p={},c=p.ELEMENT_NODE=1,_=p.ATTRIBUTE_NODE=2,y=p.TEXT_NODE=3,O=p.CDATA_SECTION_NODE=4,E=p.ENTITY_REFERENCE_NODE=5,h=p.ENTITY_NODE=6,v=p.PROCESSING_INSTRUCTION_NODE=7,g=p.COMMENT_NODE=8,C=p.DOCUMENT_NODE=9,B=p.DOCUMENT_TYPE_NODE=10,b=p.DOCUMENT_FRAGMENT_NODE=11,T=p.NOTATION_NODE=12,N={},R={};N.INDEX_SIZE_ERR=(R[1]="Index size error",1),N.DOMSTRING_SIZE_ERR=(R[2]="DOMString size error",2);var k=N.HIERARCHY_REQUEST_ERR=(R[3]="Hierarchy request error",3);N.WRONG_DOCUMENT_ERR=(R[4]="Wrong document",4),N.INVALID_CHARACTER_ERR=(R[5]="Invalid character",5),N.NO_DATA_ALLOWED_ERR=(R[6]="No data allowed",6),N.NO_MODIFICATION_ALLOWED_ERR=(R[7]="No modification allowed",7);var I=N.NOT_FOUND_ERR=(R[8]="Not found",8);N.NOT_SUPPORTED_ERR=(R[9]="Not supported",9);var X=N.INUSE_ATTRIBUTE_ERR=(R[10]="Attribute in use",10);N.INVALID_STATE_ERR=(R[11]="Invalid state",11),N.SYNTAX_ERR=(R[12]="Syntax error",12),N.INVALID_MODIFICATION_ERR=(R[13]="Invalid modification",13),N.NAMESPACE_ERR=(R[14]="Invalid namespace",14),N.INVALID_ACCESS_ERR=(R[15]="Invalid access",15);function H(d,o){if(o instanceof Error)var x=o;else x=this,Error.call(this,R[d]),this.message=R[d],Error.captureStackTrace&&Error.captureStackTrace(this,H);return x.code=d,o&&(this.message=this.message+": "+o),x}H.prototype=Error.prototype,l(N,H);function $(){}$.prototype={length:0,item:function(d){return d>=0&&d<this.length?this[d]:null},toString:function(d,o){for(var x=[],U=0;U<this.length;U++)J(this[U],x,d,o);return x.join("")},filter:function(d){return Array.prototype.filter.call(this,d)},indexOf:function(d){return Array.prototype.indexOf.call(this,d)}};function se(d,o){this._node=d,this._refresh=o,re(this)}function re(d){var o=d._node._inc||d._node.ownerDocument._inc;if(d._inc!==o){var x=d._refresh(d._node);if(P(d,"length",x.length),!d.$$length||x.length<d.$$length)for(var U=x.length;U in d;U++)Object.prototype.hasOwnProperty.call(d,U)&&delete d[U];l(x,d),d._inc=o}}se.prototype.item=function(d){return re(this),this[d]||null},f(se,$);function ge(){}function ee(d,o){for(var x=d.length;x--;)if(d[x]===o)return x}function Q(d,o,x,U){if(U?o[ee(o,U)]=x:o[o.length++]=x,d){x.ownerElement=d;var u=d.ownerDocument;u&&(U&&Ge(u,d,U),Oe(u,d,x))}}function fe(d,o,x){var U=ee(o,x);if(U>=0){for(var u=o.length-1;U<u;)o[U]=o[++U];if(o.length=u,d){var q=d.ownerDocument;q&&(Ge(q,d,x),x.ownerElement=null)}}else throw new H(I,new Error(d.tagName+"@"+x))}ge.prototype={length:0,item:$.prototype.item,getNamedItem:function(d){for(var o=this.length;o--;){var x=this[o];if(x.nodeName==d)return x}},setNamedItem:function(d){var o=d.ownerElement;if(o&&o!=this._ownerElement)throw new H(X);var x=this.getNamedItem(d.nodeName);return Q(this._ownerElement,this,d,x),x},setNamedItemNS:function(d){var o=d.ownerElement,x;if(o&&o!=this._ownerElement)throw new H(X);return x=this.getNamedItemNS(d.namespaceURI,d.localName),Q(this._ownerElement,this,d,x),x},removeNamedItem:function(d){var o=this.getNamedItem(d);return fe(this._ownerElement,this,o),o},removeNamedItemNS:function(d,o){var x=this.getNamedItemNS(d,o);return fe(this._ownerElement,this,x),x},getNamedItemNS:function(d,o){for(var x=this.length;x--;){var U=this[x];if(U.localName==o&&U.namespaceURI==d)return U}return null}};function Ae(){}Ae.prototype={hasFeature:function(d,o){return!0},createDocument:function(d,o,x){var U=new De;if(U.implementation=this,U.childNodes=new $,U.doctype=x||null,x&&U.appendChild(x),o){var u=U.createElementNS(d,o);U.appendChild(u)}return U},createDocumentType:function(d,o,x){var U=new tt;return U.name=d,U.nodeName=d,U.publicId=o||"",U.systemId=x||"",U}};function le(){}le.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(d,o){return me(this,d,o)},replaceChild:function(d,o){me(this,d,o,ie),o&&this.removeChild(o)},removeChild:function(d){return Ce(this,d)},appendChild:function(d){return this.insertBefore(d,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(d){return ye(this.ownerDocument||this,this,d)},normalize:function(){for(var d=this.firstChild;d;){var o=d.nextSibling;o&&o.nodeType==y&&d.nodeType==y?(this.removeChild(o),d.appendData(o.data)):(d.normalize(),d=o)}},isSupported:function(d,o){return this.ownerDocument.implementation.hasFeature(d,o)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(d){for(var o=this;o;){var x=o._nsMap;if(x){for(var U in x)if(Object.prototype.hasOwnProperty.call(x,U)&&x[U]===d)return U}o=o.nodeType==_?o.ownerDocument:o.parentNode}return null},lookupNamespaceURI:function(d){for(var o=this;o;){var x=o._nsMap;if(x&&d in x&&Object.prototype.hasOwnProperty.call(x,d))return x[d];o=o.nodeType==_?o.ownerDocument:o.parentNode}return null},isDefaultNamespace:function(d){var o=this.lookupPrefix(d);return o==null}};function pe(d){return d=="<"&&"&lt;"||d==">"&&"&gt;"||d=="&"&&"&amp;"||d=='"'&&"&quot;"||"&#"+d.charCodeAt()+";"}l(p,le),l(p,le.prototype);function Ne(d,o){if(o(d))return!0;if(d=d.firstChild)do if(Ne(d,o))return!0;while(d=d.nextSibling)}function De(){this.ownerDocument=this}function Oe(d,o,x){d&&d._inc++;var U=x.namespaceURI;U===t.XMLNS&&(o._nsMap[x.prefix?x.localName:""]=x.value)}function Ge(d,o,x,U){d&&d._inc++;var u=x.namespaceURI;u===t.XMLNS&&delete o._nsMap[x.prefix?x.localName:""]}function qe(d,o,x){if(d&&d._inc){d._inc++;var U=o.childNodes;if(x)U[U.length++]=x;else{for(var u=o.firstChild,q=0;u;)U[q++]=u,u=u.nextSibling;U.length=q,delete U[U.length]}}}function Ce(d,o){var x=o.previousSibling,U=o.nextSibling;return x?x.nextSibling=U:d.firstChild=U,U?U.previousSibling=x:d.lastChild=x,o.parentNode=null,o.previousSibling=null,o.nextSibling=null,qe(d.ownerDocument,d),o}function Ue(d){return d&&(d.nodeType===le.DOCUMENT_NODE||d.nodeType===le.DOCUMENT_FRAGMENT_NODE||d.nodeType===le.ELEMENT_NODE)}function We(d){return d&&(Be(d)||Ie(d)||Te(d)||d.nodeType===le.DOCUMENT_FRAGMENT_NODE||d.nodeType===le.COMMENT_NODE||d.nodeType===le.PROCESSING_INSTRUCTION_NODE)}function Te(d){return d&&d.nodeType===le.DOCUMENT_TYPE_NODE}function Be(d){return d&&d.nodeType===le.ELEMENT_NODE}function Ie(d){return d&&d.nodeType===le.TEXT_NODE}function z(d,o){var x=d.childNodes||[];if(e(x,Be)||Te(o))return!1;var U=e(x,Te);return!(o&&U&&x.indexOf(U)>x.indexOf(o))}function M(d,o){var x=d.childNodes||[];function U(q){return Be(q)&&q!==o}if(e(x,U))return!1;var u=e(x,Te);return!(o&&u&&x.indexOf(u)>x.indexOf(o))}function Y(d,o,x){if(!Ue(d))throw new H(k,"Unexpected parent node type "+d.nodeType);if(x&&x.parentNode!==d)throw new H(I,"child not in parent");if(!We(o)||Te(o)&&d.nodeType!==le.DOCUMENT_NODE)throw new H(k,"Unexpected node type "+o.nodeType+" for parent node type "+d.nodeType)}function te(d,o,x){var U=d.childNodes||[],u=o.childNodes||[];if(o.nodeType===le.DOCUMENT_FRAGMENT_NODE){var q=u.filter(Be);if(q.length>1||e(u,Ie))throw new H(k,"More than one element or text in fragment");if(q.length===1&&!z(d,x))throw new H(k,"Element in fragment can not be inserted before doctype")}if(Be(o)&&!z(d,x))throw new H(k,"Only one element can be added and only after doctype");if(Te(o)){if(e(U,Te))throw new H(k,"Only one doctype is allowed");var G=e(U,Be);if(x&&U.indexOf(G)<U.indexOf(x))throw new H(k,"Doctype can only be inserted before an element");if(!x&&G)throw new H(k,"Doctype can not be appended since element is present")}}function ie(d,o,x){var U=d.childNodes||[],u=o.childNodes||[];if(o.nodeType===le.DOCUMENT_FRAGMENT_NODE){var q=u.filter(Be);if(q.length>1||e(u,Ie))throw new H(k,"More than one element or text in fragment");if(q.length===1&&!M(d,x))throw new H(k,"Element in fragment can not be inserted before doctype")}if(Be(o)&&!M(d,x))throw new H(k,"Only one element can be added and only after doctype");if(Te(o)){if(e(U,function(L){return Te(L)&&L!==x}))throw new H(k,"Only one doctype is allowed");var G=e(U,Be);if(x&&U.indexOf(G)<U.indexOf(x))throw new H(k,"Doctype can only be inserted before an element")}}function me(d,o,x,U){Y(d,o,x),d.nodeType===le.DOCUMENT_NODE&&(U||te)(d,o,x);var u=o.parentNode;if(u&&u.removeChild(o),o.nodeType===b){var q=o.firstChild;if(q==null)return o;var G=o.lastChild}else q=G=o;var w=x?x.previousSibling:d.lastChild;q.previousSibling=w,G.nextSibling=x,w?w.nextSibling=q:d.firstChild=q,x==null?d.lastChild=G:x.previousSibling=G;do q.parentNode=d;while(q!==G&&(q=q.nextSibling));return qe(d.ownerDocument||d,d),o.nodeType==b&&(o.firstChild=o.lastChild=null),o}function Se(d,o){return o.parentNode&&o.parentNode.removeChild(o),o.parentNode=d,o.previousSibling=d.lastChild,o.nextSibling=null,o.previousSibling?o.previousSibling.nextSibling=o:d.firstChild=o,d.lastChild=o,qe(d.ownerDocument,d,o),o}De.prototype={nodeName:"#document",nodeType:C,doctype:null,documentElement:null,_inc:1,insertBefore:function(d,o){if(d.nodeType==b){for(var x=d.firstChild;x;){var U=x.nextSibling;this.insertBefore(x,o),x=U}return d}return me(this,d,o),d.ownerDocument=this,this.documentElement===null&&d.nodeType===c&&(this.documentElement=d),d},removeChild:function(d){return this.documentElement==d&&(this.documentElement=null),Ce(this,d)},replaceChild:function(d,o){me(this,d,o,ie),d.ownerDocument=this,o&&this.removeChild(o),Be(d)&&(this.documentElement=d)},importNode:function(d,o){return ae(this,d,o)},getElementById:function(d){var o=null;return Ne(this.documentElement,function(x){if(x.nodeType==c&&x.getAttribute("id")==d)return o=x,!0}),o},getElementsByClassName:function(d){var o=s(d);return new se(this,function(x){var U=[];return o.length>0&&Ne(x.documentElement,function(u){if(u!==x&&u.nodeType===c){var q=u.getAttribute("class");if(q){var G=d===q;if(!G){var w=s(q);G=o.every(a(w))}G&&U.push(u)}}}),U})},createElement:function(d){var o=new we;o.ownerDocument=this,o.nodeName=d,o.tagName=d,o.localName=d,o.childNodes=new $;var x=o.attributes=new ge;return x._ownerElement=o,o},createDocumentFragment:function(){var d=new pt;return d.ownerDocument=this,d.childNodes=new $,d},createTextNode:function(d){var o=new Me;return o.ownerDocument=this,o.appendData(d),o},createComment:function(d){var o=new Xe;return o.ownerDocument=this,o.appendData(d),o},createCDATASection:function(d){var o=new st;return o.ownerDocument=this,o.appendData(d),o},createProcessingInstruction:function(d,o){var x=new ct;return x.ownerDocument=this,x.tagName=x.nodeName=x.target=d,x.nodeValue=x.data=o,x},createAttribute:function(d){var o=new Ee;return o.ownerDocument=this,o.name=d,o.nodeName=d,o.localName=d,o.specified=!0,o},createEntityReference:function(d){var o=new ot;return o.ownerDocument=this,o.nodeName=d,o},createElementNS:function(d,o){var x=new we,U=o.split(":"),u=x.attributes=new ge;return x.childNodes=new $,x.ownerDocument=this,x.nodeName=o,x.tagName=o,x.namespaceURI=d,U.length==2?(x.prefix=U[0],x.localName=U[1]):x.localName=o,u._ownerElement=x,x},createAttributeNS:function(d,o){var x=new Ee,U=o.split(":");return x.ownerDocument=this,x.nodeName=o,x.name=o,x.namespaceURI=d,x.specified=!0,U.length==2?(x.prefix=U[0],x.localName=U[1]):x.localName=o,x}},f(De,le);function we(){this._nsMap={}}we.prototype={nodeType:c,hasAttribute:function(d){return this.getAttributeNode(d)!=null},getAttribute:function(d){var o=this.getAttributeNode(d);return o&&o.value||""},getAttributeNode:function(d){return this.attributes.getNamedItem(d)},setAttribute:function(d,o){var x=this.ownerDocument.createAttribute(d);x.value=x.nodeValue=""+o,this.setAttributeNode(x)},removeAttribute:function(d){var o=this.getAttributeNode(d);o&&this.removeAttributeNode(o)},appendChild:function(d){return d.nodeType===b?this.insertBefore(d,null):Se(this,d)},setAttributeNode:function(d){return this.attributes.setNamedItem(d)},setAttributeNodeNS:function(d){return this.attributes.setNamedItemNS(d)},removeAttributeNode:function(d){return this.attributes.removeNamedItem(d.nodeName)},removeAttributeNS:function(d,o){var x=this.getAttributeNodeNS(d,o);x&&this.removeAttributeNode(x)},hasAttributeNS:function(d,o){return this.getAttributeNodeNS(d,o)!=null},getAttributeNS:function(d,o){var x=this.getAttributeNodeNS(d,o);return x&&x.value||""},setAttributeNS:function(d,o,x){var U=this.ownerDocument.createAttributeNS(d,o);U.value=U.nodeValue=""+x,this.setAttributeNode(U)},getAttributeNodeNS:function(d,o){return this.attributes.getNamedItemNS(d,o)},getElementsByTagName:function(d){return new se(this,function(o){var x=[];return Ne(o,function(U){U!==o&&U.nodeType==c&&(d==="*"||U.tagName==d)&&x.push(U)}),x})},getElementsByTagNameNS:function(d,o){return new se(this,function(x){var U=[];return Ne(x,function(u){u!==x&&u.nodeType===c&&(d==="*"||u.namespaceURI===d)&&(o==="*"||u.localName==o)&&U.push(u)}),U})}},De.prototype.getElementsByTagName=we.prototype.getElementsByTagName,De.prototype.getElementsByTagNameNS=we.prototype.getElementsByTagNameNS,f(we,le);function Ee(){}Ee.prototype.nodeType=_,f(Ee,le);function _e(){}_e.prototype={data:"",substringData:function(d,o){return this.data.substring(d,d+o)},appendData:function(d){d=this.data+d,this.nodeValue=this.data=d,this.length=d.length},insertData:function(d,o){this.replaceData(d,0,o)},appendChild:function(d){throw new Error(R[k])},deleteData:function(d,o){this.replaceData(d,o,"")},replaceData:function(d,o,x){var U=this.data.substring(0,d),u=this.data.substring(d+o);x=U+x+u,this.nodeValue=this.data=x,this.length=x.length}},f(_e,le);function Me(){}Me.prototype={nodeName:"#text",nodeType:y,splitText:function(d){var o=this.data,x=o.substring(d);o=o.substring(0,d),this.data=this.nodeValue=o,this.length=o.length;var U=this.ownerDocument.createTextNode(x);return this.parentNode&&this.parentNode.insertBefore(U,this.nextSibling),U}},f(Me,_e);function Xe(){}Xe.prototype={nodeName:"#comment",nodeType:g},f(Xe,_e);function st(){}st.prototype={nodeName:"#cdata-section",nodeType:O},f(st,_e);function tt(){}tt.prototype.nodeType=B,f(tt,le);function ut(){}ut.prototype.nodeType=T,f(ut,le);function dt(){}dt.prototype.nodeType=h,f(dt,le);function ot(){}ot.prototype.nodeType=E,f(ot,le);function pt(){}pt.prototype.nodeName="#document-fragment",pt.prototype.nodeType=b,f(pt,le);function ct(){}ct.prototype.nodeType=v,f(ct,le);function Ke(){}Ke.prototype.serializeToString=function(d,o,x){return lt.call(d,o,x)},le.prototype.toString=lt;function lt(d,o){var x=[],U=this.nodeType==9&&this.documentElement||this,u=U.prefix,q=U.namespaceURI;if(q&&u==null){var u=U.lookupPrefix(q);if(u==null)var G=[{namespace:q,prefix:null}]}return J(this,x,d,o,G),x.join("")}function wt(d,o,x){var U=d.prefix||"",u=d.namespaceURI;if(!u||U==="xml"&&u===t.XML||u===t.XMLNS)return!1;for(var q=x.length;q--;){var G=x[q];if(G.prefix===U)return G.namespace!==u}return!0}function A(d,o,x){d.push(" ",o,'="',x.replace(/[<&"]/g,pe),'"')}function J(d,o,x,U,u){if(u||(u=[]),U)if(d=U(d),d){if(typeof d=="string"){o.push(d);return}}else return;switch(d.nodeType){case c:var q=d.attributes,G=q.length,Le=d.firstChild,w=d.tagName;x=t.isHTML(d.namespaceURI)||x;var L=w;if(!x&&!d.prefix&&d.namespaceURI){for(var Z,be=0;be<q.length;be++)if(q.item(be).name==="xmlns"){Z=q.item(be).value;break}if(!Z)for(var ce=u.length-1;ce>=0;ce--){var de=u[ce];if(de.prefix===""&&de.namespace===d.namespaceURI){Z=de.namespace;break}}if(Z!==d.namespaceURI)for(var ce=u.length-1;ce>=0;ce--){var de=u[ce];if(de.namespace===d.namespaceURI){de.prefix&&(L=de.prefix+":"+w);break}}}o.push("<",L);for(var ke=0;ke<G;ke++){var Je=q.item(ke);Je.prefix=="xmlns"?u.push({prefix:Je.localName,namespace:Je.value}):Je.nodeName=="xmlns"&&u.push({prefix:"",namespace:Je.value})}for(var ke=0;ke<G;ke++){var Je=q.item(ke);if(wt(Je,x,u)){var je=Je.prefix||"",Re=Je.namespaceURI;A(o,je?"xmlns:"+je:"xmlns",Re),u.push({prefix:je,namespace:Re})}J(Je,o,x,U,u)}if(w===L&&wt(d,x,u)){var je=d.prefix||"",Re=d.namespaceURI;A(o,je?"xmlns:"+je:"xmlns",Re),u.push({prefix:je,namespace:Re})}if(Le||x&&!/^(?:meta|link|img|br|hr|input)$/i.test(w)){if(o.push(">"),x&&/^script$/i.test(w))for(;Le;)Le.data?o.push(Le.data):J(Le,o,x,U,u.slice()),Le=Le.nextSibling;else for(;Le;)J(Le,o,x,U,u.slice()),Le=Le.nextSibling;o.push("</",L,">")}else o.push("/>");return;case C:case b:for(var Le=d.firstChild;Le;)J(Le,o,x,U,u.slice()),Le=Le.nextSibling;return;case _:return A(o,d.name,d.value);case y:return o.push(d.data.replace(/[<&]/g,pe).replace(/]]>/g,"]]&gt;"));case O:return o.push("<![CDATA[",d.data,"]]>");case g:return o.push("<!--",d.data,"-->");case B:var rt=d.publicId,$e=d.systemId;if(o.push("<!DOCTYPE ",d.name),rt)o.push(" PUBLIC ",rt),$e&&$e!="."&&o.push(" ",$e),o.push(">");else if($e&&$e!=".")o.push(" SYSTEM ",$e,">");else{var Tt=d.internalSubset;Tt&&o.push(" [",Tt,"]"),o.push(">")}return;case v:return o.push("<?",d.target," ",d.data,"?>");case E:return o.push("&",d.nodeName,";");default:o.push("??",d.nodeName)}}function ae(d,o,x){var U;switch(o.nodeType){case c:U=o.cloneNode(!1),U.ownerDocument=d;case b:break;case _:x=!0;break}if(U||(U=o.cloneNode(!1)),U.ownerDocument=d,U.parentNode=null,x)for(var u=o.firstChild;u;)U.appendChild(ae(d,u,x)),u=u.nextSibling;return U}function ye(d,o,x){var U=new o.constructor;for(var u in o)if(Object.prototype.hasOwnProperty.call(o,u)){var q=o[u];typeof q!="object"&&q!=U[u]&&(U[u]=q)}switch(o.childNodes&&(U.childNodes=new $),U.ownerDocument=d,U.nodeType){case c:var G=o.attributes,w=U.attributes=new ge,L=G.length;w._ownerElement=U;for(var Z=0;Z<L;Z++)U.setAttributeNode(ye(d,G.item(Z),!0));break;case _:x=!0}if(x)for(var be=o.firstChild;be;)U.appendChild(ye(d,be,x)),be=be.nextSibling;return U}function P(d,o,x){d[o]=x}try{if(Object.defineProperty){let d=function(o){switch(o.nodeType){case c:case b:var x=[];for(o=o.firstChild;o;)o.nodeType!==7&&o.nodeType!==8&&x.push(d(o)),o=o.nextSibling;return x.join("");default:return o.nodeValue}};Object.defineProperty(se.prototype,"length",{get:function(){return re(this),this.$$length}}),Object.defineProperty(le.prototype,"textContent",{get:function(){return d(this)},set:function(o){switch(this.nodeType){case c:case b:for(;this.firstChild;)this.removeChild(this.firstChild);(o||String(o))&&this.appendChild(this.ownerDocument.createTextNode(o));break;default:this.data=o,this.value=o,this.nodeValue=o}}}),P=function(o,x,U){o["$$"+x]=U}}}catch{}return kt.DocumentType=tt,kt.DOMException=H,kt.DOMImplementation=Ae,kt.Element=we,kt.Node=le,kt.NodeList=$,kt.XMLSerializer=Ke,kt}var Ut={},Gr={},tn;function Os(){return tn||(tn=1,(function(m){var e=yr().freeze;m.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),m.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),m.entityMap=m.HTML_ENTITIES})(Gr)),Gr}var sr={},rn;function Bs(){if(rn)return sr;rn=1;var m=yr().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),i=0,n=1,s=2,a=3,l=4,f=5,p=6,c=7;function _(k,I){this.message=k,this.locator=I,Error.captureStackTrace&&Error.captureStackTrace(this,_)}_.prototype=new Error,_.prototype.name=_.name;function y(){}y.prototype={parse:function(k,I,X){var H=this.domBuilder;H.startDocument(),B(I,I={}),O(k,I,X,H,this.errorHandler),H.endDocument()}};function O(k,I,X,H,$){function se(we){if(we>65535){we-=65536;var Ee=55296+(we>>10),_e=56320+(we&1023);return String.fromCharCode(Ee,_e)}else return String.fromCharCode(we)}function re(we){var Ee=we.slice(1,-1);return Ee in X?X[Ee]:Ee.charAt(0)==="#"?se(parseInt(Ee.substr(1).replace("x","0x"))):($.error("entity not found:"+we),we)}function ge(we){if(we>De){var Ee=k.substring(De,we).replace(/&#?\w+;/g,re);le&&ee(De),H.characters(Ee,0,we-De),De=we}}function ee(we,Ee){for(;we>=fe&&(Ee=Ae.exec(k));)Q=Ee.index,fe=Q+Ee[0].length,le.lineNumber++;le.columnNumber=we-Q+1}for(var Q=0,fe=0,Ae=/.*(?:\r\n?|\n)|.*$/g,le=H.locator,pe=[{currentNSMap:I}],Ne={},De=0;;){try{var Oe=k.indexOf("<",De);if(Oe<0){if(!k.substr(De).match(/^\s*$/)){var Ge=H.doc,qe=Ge.createTextNode(k.substr(De));Ge.appendChild(qe),H.currentElement=qe}return}switch(Oe>De&&ge(Oe),k.charAt(Oe+1)){case"/":var Y=k.indexOf(">",Oe+3),Ce=k.substring(Oe+2,Y).replace(/[ \t\n\r]+$/g,""),Ue=pe.pop();Y<0?(Ce=k.substring(Oe+2).replace(/[\s<].*/,""),$.error("end tag name: "+Ce+" is not complete:"+Ue.tagName),Y=Oe+1+Ce.length):Ce.match(/\s</)&&(Ce=Ce.replace(/[\s<].*/,""),$.error("end tag name: "+Ce+" maybe not complete"),Y=Oe+1+Ce.length);var We=Ue.localNSMap,Te=Ue.tagName==Ce,Be=Te||Ue.tagName&&Ue.tagName.toLowerCase()==Ce.toLowerCase();if(Be){if(H.endElement(Ue.uri,Ue.localName,Ce),We)for(var Ie in We)Object.prototype.hasOwnProperty.call(We,Ie)&&H.endPrefixMapping(Ie);Te||$.fatalError("end tag name: "+Ce+" is not match the current start tagName:"+Ue.tagName)}else pe.push(Ue);Y++;break;case"?":le&&ee(Oe),Y=T(k,Oe,H);break;case"!":le&&ee(Oe),Y=b(k,Oe,H,$);break;default:le&&ee(Oe);var z=new N,M=pe[pe.length-1].currentNSMap,Y=h(k,Oe,z,M,re,$),te=z.length;if(!z.closed&&C(k,Y,z.tagName,Ne)&&(z.closed=!0,X.nbsp||$.warning("unclosed xml attribute")),le&&te){for(var ie=E(le,{}),me=0;me<te;me++){var Se=z[me];ee(Se.offset),Se.locator=E(le,{})}H.locator=ie,v(z,H,M)&&pe.push(z),H.locator=le}else v(z,H,M)&&pe.push(z);m.isHTML(z.uri)&&!z.closed?Y=g(k,Y,z.tagName,re,H):Y++}}catch(we){if(we instanceof _)throw we;$.error("element parse error: "+we),Y=-1}Y>De?De=Y:ge(Math.max(Oe,De)+1)}}function E(k,I){return I.lineNumber=k.lineNumber,I.columnNumber=k.columnNumber,I}function h(k,I,X,H,$,se){function re(le,pe,Ne){X.attributeNames.hasOwnProperty(le)&&se.fatalError("Attribute "+le+" redefined"),X.addValue(le,pe,Ne)}for(var ge,ee,Q=++I,fe=i;;){var Ae=k.charAt(Q);switch(Ae){case"=":if(fe===n)ge=k.slice(I,Q),fe=a;else if(fe===s)fe=a;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(fe===a||fe===n)if(fe===n&&(se.warning('attribute value must after "="'),ge=k.slice(I,Q)),I=Q+1,Q=k.indexOf(Ae,I),Q>0)ee=k.slice(I,Q).replace(/&#?\w+;/g,$),re(ge,ee,I-1),fe=f;else throw new Error("attribute value no end '"+Ae+"' match");else if(fe==l)ee=k.slice(I,Q).replace(/&#?\w+;/g,$),re(ge,ee,I),se.warning('attribute "'+ge+'" missed start quot('+Ae+")!!"),I=Q+1,fe=f;else throw new Error('attribute value must after "="');break;case"/":switch(fe){case i:X.setTagName(k.slice(I,Q));case f:case p:case c:fe=c,X.closed=!0;case l:case n:break;case s:X.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return se.error("unexpected end of input"),fe==i&&X.setTagName(k.slice(I,Q)),Q;case">":switch(fe){case i:X.setTagName(k.slice(I,Q));case f:case p:case c:break;case l:case n:ee=k.slice(I,Q),ee.slice(-1)==="/"&&(X.closed=!0,ee=ee.slice(0,-1));case s:fe===s&&(ee=ge),fe==l?(se.warning('attribute "'+ee+'" missed quot(")!'),re(ge,ee.replace(/&#?\w+;/g,$),I)):((!m.isHTML(H[""])||!ee.match(/^(?:disabled|checked|selected)$/i))&&se.warning('attribute "'+ee+'" missed value!! "'+ee+'" instead!!'),re(ee,ee,I));break;case a:throw new Error("attribute value missed!!")}return Q;case"":Ae=" ";default:if(Ae<=" ")switch(fe){case i:X.setTagName(k.slice(I,Q)),fe=p;break;case n:ge=k.slice(I,Q),fe=s;break;case l:var ee=k.slice(I,Q).replace(/&#?\w+;/g,$);se.warning('attribute "'+ee+'" missed quot(")!!'),re(ge,ee,I);case f:fe=p;break}else switch(fe){case s:X.tagName,(!m.isHTML(H[""])||!ge.match(/^(?:disabled|checked|selected)$/i))&&se.warning('attribute "'+ge+'" missed value!! "'+ge+'" instead2!!'),re(ge,ge,I),I=Q,fe=n;break;case f:se.warning('attribute space is required"'+ge+'"!!');case p:fe=n,I=Q;break;case a:fe=l,I=Q;break;case c:throw new Error("elements closed character '/' and '>' must be connected to")}}Q++}}function v(k,I,X){for(var H=k.tagName,$=null,Ae=k.length;Ae--;){var se=k[Ae],re=se.qName,ge=se.value,le=re.indexOf(":");if(le>0)var ee=se.prefix=re.slice(0,le),Q=re.slice(le+1),fe=ee==="xmlns"&&Q;else Q=re,ee=null,fe=re==="xmlns"&&"";se.localName=Q,fe!==!1&&($==null&&($={},B(X,X={})),X[fe]=$[fe]=ge,se.uri=m.XMLNS,I.startPrefixMapping(fe,ge))}for(var Ae=k.length;Ae--;){se=k[Ae];var ee=se.prefix;ee&&(ee==="xml"&&(se.uri=m.XML),ee!=="xmlns"&&(se.uri=X[ee||""]))}var le=H.indexOf(":");le>0?(ee=k.prefix=H.slice(0,le),Q=k.localName=H.slice(le+1)):(ee=null,Q=k.localName=H);var pe=k.uri=X[ee||""];if(I.startElement(pe,Q,H,k),k.closed){if(I.endElement(pe,Q,H),$)for(ee in $)Object.prototype.hasOwnProperty.call($,ee)&&I.endPrefixMapping(ee)}else return k.currentNSMap=X,k.localNSMap=$,!0}function g(k,I,X,H,$){if(/^(?:script|textarea)$/i.test(X)){var se=k.indexOf("</"+X+">",I),re=k.substring(I+1,se);if(/[&<]/.test(re))return/^script$/i.test(X)?($.characters(re,0,re.length),se):(re=re.replace(/&#?\w+;/g,H),$.characters(re,0,re.length),se)}return I+1}function C(k,I,X,H){var $=H[X];return $==null&&($=k.lastIndexOf("</"+X+">"),$<I&&($=k.lastIndexOf("</"+X)),H[X]=$),$<I}function B(k,I){for(var X in k)Object.prototype.hasOwnProperty.call(k,X)&&(I[X]=k[X])}function b(k,I,X,H){var $=k.charAt(I+2);switch($){case"-":if(k.charAt(I+3)==="-"){var se=k.indexOf("-->",I+4);return se>I?(X.comment(k,I+4,se-I-4),se+3):(H.error("Unclosed comment"),-1)}else return-1;default:if(k.substr(I+3,6)=="CDATA["){var se=k.indexOf("]]>",I+9);return X.startCDATA(),X.characters(k,I+9,se-I-9),X.endCDATA(),se+3}var re=R(k,I),ge=re.length;if(ge>1&&/!doctype/i.test(re[0][0])){var ee=re[1][0],Q=!1,fe=!1;ge>3&&(/^public$/i.test(re[2][0])?(Q=re[3][0],fe=ge>4&&re[4][0]):/^system$/i.test(re[2][0])&&(fe=re[3][0]));var Ae=re[ge-1];return X.startDTD(ee,Q,fe),X.endDTD(),Ae.index+Ae[0].length}}return-1}function T(k,I,X){var H=k.indexOf("?>",I);if(H){var $=k.substring(I,H).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return $?($[0].length,X.processingInstruction($[1],$[2]),H+2):-1}return-1}function N(){this.attributeNames={}}N.prototype={setTagName:function(k){if(!r.test(k))throw new Error("invalid tagName:"+k);this.tagName=k},addValue:function(k,I,X){if(!r.test(k))throw new Error("invalid attribute:"+k);this.attributeNames[k]=this.length,this[this.length++]={qName:k,value:I,offset:X}},length:0,getLocalName:function(k){return this[k].localName},getLocator:function(k){return this[k].locator},getQName:function(k){return this[k].qName},getURI:function(k){return this[k].uri},getValue:function(k){return this[k].value}};function R(k,I){var X,H=[],$=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for($.lastIndex=I,$.exec(k);X=$.exec(k);)if(H.push(X),X[1])return H}return sr.XMLReader=y,sr.ParseError=_,sr}var nn;function Ls(){if(nn)return Ut;nn=1;var m=yr(),e=In(),t=Os(),r=Bs(),i=e.DOMImplementation,n=m.NAMESPACE,s=r.ParseError,a=r.XMLReader;function l(E){this.options=E||{locator:{}}}l.prototype.parseFromString=function(E,h){var v=this.options,g=new a,C=v.domBuilder||new p,B=v.errorHandler,b=v.locator,T=v.xmlns||{},N=/\/x?html?$/.test(h),R=N?t.HTML_ENTITIES:t.XML_ENTITIES;return b&&C.setDocumentLocator(b),g.errorHandler=f(B,C,b),g.domBuilder=v.domBuilder||C,N&&(T[""]=n.HTML),T.xml=T.xml||n.XML,E&&typeof E=="string"?g.parse(E,T,R):g.errorHandler.error("invalid doc source"),C.doc};function f(E,h,v){if(!E){if(h instanceof p)return h;E=h}var g={},C=E instanceof Function;v=v||{};function B(b){var T=E[b];!T&&C&&(T=E.length==2?function(N){E(b,N)}:E),g[b]=T&&function(N){T("[xmldom "+b+"]	"+N+_(v))}||function(){}}return B("warning"),B("error"),B("fatalError"),g}function p(){this.cdata=!1}function c(E,h){h.lineNumber=E.lineNumber,h.columnNumber=E.columnNumber}p.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(E,h,v,g){var C=this.doc,B=C.createElementNS(E,v||h),b=g.length;O(this,B),this.currentElement=B,this.locator&&c(this.locator,B);for(var T=0;T<b;T++){var E=g.getURI(T),N=g.getValue(T),v=g.getQName(T),R=C.createAttributeNS(E,v);this.locator&&c(g.getLocator(T),R),R.value=R.nodeValue=N,B.setAttributeNode(R)}},endElement:function(E,h,v){var g=this.currentElement;g.tagName,this.currentElement=g.parentNode},startPrefixMapping:function(E,h){},endPrefixMapping:function(E){},processingInstruction:function(E,h){var v=this.doc.createProcessingInstruction(E,h);this.locator&&c(this.locator,v),O(this,v)},ignorableWhitespace:function(E,h,v){},characters:function(E,h,v){if(E=y.apply(this,arguments),E){if(this.cdata)var g=this.doc.createCDATASection(E);else var g=this.doc.createTextNode(E);this.currentElement?this.currentElement.appendChild(g):/^\s*$/.test(E)&&this.doc.appendChild(g),this.locator&&c(this.locator,g)}},skippedEntity:function(E){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(E){(this.locator=E)&&(E.lineNumber=0)},comment:function(E,h,v){E=y.apply(this,arguments);var g=this.doc.createComment(E);this.locator&&c(this.locator,g),O(this,g)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(E,h,v){var g=this.doc.implementation;if(g&&g.createDocumentType){var C=g.createDocumentType(E,h,v);this.locator&&c(this.locator,C),O(this,C),this.doc.doctype=C}},warning:function(E){console.warn("[xmldom warning]	"+E,_(this.locator))},error:function(E){console.error("[xmldom error]	"+E,_(this.locator))},fatalError:function(E){throw new s(E,this.locator)}};function _(E){if(E)return`
@`+(E.systemId||"")+"#[line:"+E.lineNumber+",col:"+E.columnNumber+"]"}function y(E,h,v){return typeof E=="string"?E.substr(h,v):E.length>=h+v||h?new java.lang.String(E,h,v)+"":E}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(E){p.prototype[E]=function(){return null}});function O(E,h){E.currentElement?E.currentElement.appendChild(h):E.doc.appendChild(h)}return Ut.__DOMHandler=p,Ut.DOMParser=l,Ut.DOMImplementation=e.DOMImplementation,Ut.XMLSerializer=e.XMLSerializer,Ut}var sn;function Fs(){if(sn)return Kt;sn=1;var m=In();return Kt.DOMImplementation=m.DOMImplementation,Kt.XMLSerializer=m.XMLSerializer,Kt.DOMParser=Ls().DOMParser,Kt}var On=Fs();const wi=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,Ps=1,zs=3,Bn=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function br(){var m=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(m+Math.random()*16)%16|0;return m=Math.floor(m/16),(t=="x"?r:r&7|8).toString(16)});return e}function Us(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function Ln(m){return!!(m&&m.nodeType==1)}function et(m){return!isNaN(parseFloat(m))&&isFinite(m)}function Fn(m){let e=parseFloat(m);return et(m)===!1?!1:typeof m=="string"&&m.indexOf(".")>-1?!0:Math.floor(e)!==e}function jt(m){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=m.toLowerCase(),i=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return m;for(var n=0;n<i;n++)if(typeof document.body.style[t[n]+r]<"u")return t[n]+r;return m}function Pn(m){for(var e=1,t=arguments.length;e<t;e++){var r=arguments[e];for(var i in r)m[i]===void 0&&(m[i]=r[i])}return m}function ft(m){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(m,r,Object.getOwnPropertyDescriptor(t,r))})}),m}function Ms(m,e,t){var r=Gt(m,e,t);return e.splice(r,0,m),r}function Gt(m,e,t,r,i){var n=r||0,s=i||e.length,a=parseInt(n+(s-n)/2),l;return t||(t=function(f,p){if(f>p)return 1;if(f<p)return-1;if(f==p)return 0}),s-n<=0?a:(l=t(e[a],m),s-n===1?l>=0?a:a+1:l===0?a:l===-1?Gt(m,e,t,a,s):Gt(m,e,t,n,a))}function hr(m,e,t,r,i){var n=r||0,s=i||e.length,a=parseInt(n+(s-n)/2),l;return t||(t=function(f,p){if(f>p)return 1;if(f<p)return-1;if(f==p)return 0}),s-n<=0?-1:(l=t(e[a],m),s-n===1?l===0?a:-1:l===0?a:l===-1?hr(m,e,t,a,s):hr(m,e,t,n,a))}function ur(m){var e=window.getComputedStyle(m),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return t.forEach(function(s){i+=parseFloat(e[s])||0}),r.forEach(function(s){n+=parseFloat(e[s])||0}),{height:n,width:i}}function fr(m){var e=window.getComputedStyle(m),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return t.forEach(function(s){i+=parseFloat(e[s])||0}),r.forEach(function(s){n+=parseFloat(e[s])||0}),{height:n,width:i}}function pi(m){let e,t=m.ownerDocument;if(m.nodeType==Node.TEXT_NODE){let r=t.createRange();r.selectNodeContents(m),e=r.getBoundingClientRect()}else e=m.getBoundingClientRect();return e}function cr(){var m=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:m,bottom:e,width:m,height:e}}function _i(m,e){for(var t=m.parentNode,r=t.childNodes,i,n=-1,s=0;s<r.length&&(i=r[s],i.nodeType===e&&n++,i!=m);s++);return n}function qs(m){return _i(m,zs)}function zn(m){return _i(m,Ps)}function er(m){return["xml","opf","ncx"].indexOf(m)>-1}function Un(m,e){return new Blob([m],{type:e})}function dr(m,e){var t,r=Un(m,e);return t=Bn.createObjectURL(r),t}function Mn(m){return Bn.revokeObjectURL(m)}function vi(m,e){var t,r;if(typeof m=="string")return t=btoa(m),r="data:"+e+";base64,"+t,r}function qn(m){return Object.prototype.toString.call(m).slice(8,-1)}function Ct(m,e,t){var r,i;return typeof DOMParser>"u"||t?i=On.DOMParser:i=DOMParser,m.charCodeAt(0)===65279&&(m=m.slice(1)),r=new i().parseFromString(m,e),r}function Ze(m,e){var t;if(!m)throw new Error("No Element Provided");if(typeof m.querySelector<"u")return m.querySelector(e);if(t=m.getElementsByTagName(e),t.length)return t[0]}function Nt(m,e){return typeof m.querySelector<"u"?m.querySelectorAll(e):m.getElementsByTagName(e)}function Wt(m,e,t){var r,i;if(typeof m.querySelector<"u"){e+="[";for(var n in t)e+=n+"~='"+t[n]+"'";return e+="]",m.querySelector(e)}else if(r=m.getElementsByTagName(e),i=Array.prototype.slice.call(r,0).filter(function(s){for(var a in t)if(s.getAttribute(a)===t[a])return!0;return!1}),i)return i[0]}function pr(m,e){var t=m.ownerDocument||m;typeof t.createTreeWalker<"u"?jn(m,e,NodeFilter.SHOW_TEXT):Ei(m,function(r){r&&r.nodeType===3&&e(r)})}function jn(m,e,t){var r=document.createTreeWalker(m,t,null,!1);let i;for(;i=r.nextNode();)e(i)}function Ei(m,e){if(e(m))return!0;if(m=m.firstChild,m)do{if(Ei(m,e))return!0;m=m.nextSibling}while(m)}function Wn(m){return new Promise(function(e,t){var r=new FileReader;r.readAsDataURL(m),r.onloadend=function(){e(r.result)}})}function Pe(){this.resolve=null,this.reject=null,this.id=br(),this.promise=new Promise((m,e)=>{this.resolve=m,this.reject=e}),Object.freeze(this)}function vr(m,e,t){var r;if(typeof m.querySelector<"u"&&(r=m.querySelector(`${e}[*|type="${t}"]`)),!r||r.length===0){r=Nt(m,e);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||r[i].getAttribute("epub:type")===t)return r[i]}else return r}function gi(m){for(var e=[],t=m.childNodes,r=0;r<t.length;r++){let i=t[r];i.nodeType===1&&e.push(i)}return e}function mi(m){for(var e=[m];m;m=m.parentNode)e.unshift(m);return e}function Ht(m,e,t){for(var r=[],i=m.childNodes,n=0;n<i.length;n++){let s=i[n];if(s.nodeType===1&&s.nodeName.toLowerCase()===e){if(t)return s;r.push(s)}}if(!t)return r}function js(m,e){let t;if(!(m===null||e===""))for(t=m.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class Hn{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,r=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,r),this.setEnd(t,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var r=mi(e||this.startContainer),i=mi(t||this.endContainer);if(r[0]==i[0]){for(var n=0;n<r.length;n++)if(r[n]!=i[n])return r[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const Ws=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:Hn,blob2base64:Wn,borders:fr,bounds:ur,createBase64Url:vi,createBlob:Un,createBlobUrl:dr,defaults:Pn,defer:Pe,documentHeight:Us,extend:ft,filterChildren:Ht,findChildren:gi,getParentByTagName:js,indexOfElementNode:zn,indexOfNode:_i,indexOfSorted:hr,indexOfTextNode:qs,insert:Ms,isElement:Ln,isFloat:Fn,isNumber:et,isXml:er,locationOf:Gt,nodeBounds:pi,parents:mi,parse:Ct,prefixed:jt,qs:Ze,qsa:Nt,qsp:Wt,querySelectorByType:vr,requestAnimationFrame:wi,revokeBlobUrl:Mn,sprint:pr,treeWalker:jn,type:qn,uuid:br,walk:Ei,windowBounds:cr},Symbol.toStringTag,{value:"Module"}));var Zr,an;function Hs(){if(an)return Zr;if(an=1,!m)var m={cwd:function(){return"/"}};function e(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function t(n,s){for(var a="",l=-1,f=0,p,c=0;c<=n.length;++c){if(c<n.length)p=n.charCodeAt(c);else{if(p===47)break;p=47}if(p===47){if(!(l===c-1||f===1))if(l!==c-1&&f===2){if(a.length<2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){for(var _=a.length-1,y=_;y>=0&&a.charCodeAt(y)!==47;--y);if(y!==_){y===-1?a="":a=a.slice(0,y),l=c,f=0;continue}}else if(a.length===2||a.length===1){a="",l=c,f=0;continue}}s&&(a.length>0?a+="/..":a="..")}else a.length>0?a+="/"+n.slice(l+1,c):a=n.slice(l+1,c);l=c,f=0}else p===46&&f!==-1?++f:f=-1}return a}function r(n,s){var a=s.dir||s.root,l=s.base||(s.name||"")+(s.ext||"");return a?a===s.root?a+l:a+n+l:l}var i={resolve:function(){for(var s="",a=!1,l,f=arguments.length-1;f>=-1&&!a;f--){var p;f>=0?p=arguments[f]:(l===void 0&&(l=m.cwd()),p=l),e(p),p.length!==0&&(s=p+"/"+s,a=p.charCodeAt(0)===47)}return s=t(s,!a),a?s.length>0?"/"+s:"/":s.length>0?s:"."},normalize:function(s){if(e(s),s.length===0)return".";var a=s.charCodeAt(0)===47,l=s.charCodeAt(s.length-1)===47;return s=t(s,!a),s.length===0&&!a&&(s="."),s.length>0&&l&&(s+="/"),a?"/"+s:s},isAbsolute:function(s){return e(s),s.length>0&&s.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var s,a=0;a<arguments.length;++a){var l=arguments[a];e(l),l.length>0&&(s===void 0?s=l:s+="/"+l)}return s===void 0?".":i.normalize(s)},relative:function(s,a){if(e(s),e(a),s===a||(s=i.resolve(s),a=i.resolve(a),s===a))return"";for(var l=1;l<s.length&&s.charCodeAt(l)===47;++l);for(var f=s.length,p=f-l,c=1;c<a.length&&a.charCodeAt(c)===47;++c);for(var _=a.length,y=_-c,O=p<y?p:y,E=-1,h=0;h<=O;++h){if(h===O){if(y>O){if(a.charCodeAt(c+h)===47)return a.slice(c+h+1);if(h===0)return a.slice(c+h)}else p>O&&(s.charCodeAt(l+h)===47?E=h:h===0&&(E=0));break}var v=s.charCodeAt(l+h),g=a.charCodeAt(c+h);if(v!==g)break;v===47&&(E=h)}var C="";for(h=l+E+1;h<=f;++h)(h===f||s.charCodeAt(h)===47)&&(C.length===0?C+="..":C+="/..");return C.length>0?C+a.slice(c+E):(c+=E,a.charCodeAt(c)===47&&++c,a.slice(c))},_makeLong:function(s){return s},dirname:function(s){if(e(s),s.length===0)return".";for(var a=s.charCodeAt(0),l=a===47,f=-1,p=!0,c=s.length-1;c>=1;--c)if(a=s.charCodeAt(c),a===47){if(!p){f=c;break}}else p=!1;return f===-1?l?"/":".":l&&f===1?"//":s.slice(0,f)},basename:function(s,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(s);var l=0,f=-1,p=!0,c;if(a!==void 0&&a.length>0&&a.length<=s.length){if(a.length===s.length&&a===s)return"";var _=a.length-1,y=-1;for(c=s.length-1;c>=0;--c){var O=s.charCodeAt(c);if(O===47){if(!p){l=c+1;break}}else y===-1&&(p=!1,y=c+1),_>=0&&(O===a.charCodeAt(_)?--_===-1&&(f=c):(_=-1,f=y))}return l===f?f=y:f===-1&&(f=s.length),s.slice(l,f)}else{for(c=s.length-1;c>=0;--c)if(s.charCodeAt(c)===47){if(!p){l=c+1;break}}else f===-1&&(p=!1,f=c+1);return f===-1?"":s.slice(l,f)}},extname:function(s){e(s);for(var a=-1,l=0,f=-1,p=!0,c=0,_=s.length-1;_>=0;--_){var y=s.charCodeAt(_);if(y===47){if(!p){l=_+1;break}continue}f===-1&&(p=!1,f=_+1),y===46?a===-1?a=_:c!==1&&(c=1):a!==-1&&(c=-1)}return a===-1||f===-1||c===0||c===1&&a===f-1&&a===l+1?"":s.slice(a,f)},format:function(s){if(s===null||typeof s!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof s);return r("/",s)},parse:function(s){e(s);var a={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return a;var l=s.charCodeAt(0),f=l===47,p;f?(a.root="/",p=1):p=0;for(var c=-1,_=0,y=-1,O=!0,E=s.length-1,h=0;E>=p;--E){if(l=s.charCodeAt(E),l===47){if(!O){_=E+1;break}continue}y===-1&&(O=!1,y=E+1),l===46?c===-1?c=E:h!==1&&(h=1):c!==-1&&(h=-1)}return c===-1||y===-1||h===0||h===1&&c===y-1&&c===_+1?y!==-1&&(_===0&&f?a.base=a.name=s.slice(1,y):a.base=a.name=s.slice(_,y)):(_===0&&f?(a.name=s.slice(1,c),a.base=s.slice(1,y)):(a.name=s.slice(_,c),a.base=s.slice(_,y)),a.ext=s.slice(c,y)),_>0?a.dir=s.slice(0,_-1):f&&(a.dir="/"),a},sep:"/",delimiter:":",posix:null};return Zr=i,Zr}var Vs=Hs();const Ot=Zt(Vs);class Rt{constructor(e){var t,r;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return Ot.parse(e)}isAbsolute(e){return Ot.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Ot.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Ot.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Dt{constructor(e,t){var r=e.indexOf("://")>-1,i=e,n;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!r&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(n=new Rt(this.base),i=n.resolve(i))}this.Path=new Rt(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,r;return t?e:(r=Ot.resolve(this.directory,e),this.origin+r)}relative(e){return Ot.relative(e,this.directory)}toString(){return this.href}}const Mt=1,yt=3,Gs=9;class ze{constructor(e,t,r){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof ze))return new ze(e,t,r);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),i=this.checkType(e),i==="string")return this.str=e,ft(this,this.parse(e));if(i==="range")return ft(this,this.fromRange(e,this.base,r));if(i==="node")return ft(this,this.fromNode(e,this.base,r));if(i==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(qn(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof ze?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,i,n;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(t.base=this.parseComponent(r),i=this.getPathComponent(e),t.path=this.parseComponent(i),n=this.getRange(e),n&&(t.range=!0,t.start=this.parseComponent(n[0]),t.end=this.parseComponent(n[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),i=r[0].split("/"),n;return r.length>1&&(n=r[1],t.terminal=this.parseTerminal(n)),i[0]===""&&i.shift(),t.steps=i.map((function(s){return this.parseStep(s)}).bind(this)),t}parseStep(e){var t,r,i,n,s;if(n=e.match(/\[(.*)\]/),n&&n[1]&&(s=n[1]),r=parseInt(e),!isNaN(r))return r%2===0?(t="element",i=r/2-1):(t="text",i=(r-1)/2),{type:t,index:i,id:s||null}}parseTerminal(e){var t,r,i=e.match(/\[(.*)\]/);return i&&i[1]?(t=parseInt(e.split("[")[0]),r=i[1]):t=parseInt(e),et(t)||(t=null),{offset:t,assertion:r}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var r="";return t.type==="element"&&(r+=(t.index+1)*2),t.type==="text"&&(r+=1+2*t.index),t.id&&(r+="["+t.id+"]"),r}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var r,i,n,s;if(typeof e=="string"&&(e=new ze(e)),typeof t=="string"&&(t=new ze(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),n=e.start.terminal):(r=e.path.steps,n=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),s=t.start.terminal):(i=t.path.steps,s=t.path.terminal);for(var a=0;a<r.length;a++){if(!r[a])return-1;if(!i[a]||r[a].index>i[a].index)return 1;if(r[a].index<i[a].index)return-1}return r.length<i.length?-1:n.offset>s.offset?1:n.offset<s.offset?-1:0}step(e){var t=e.nodeType===yt?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var r=this.filter(e,t),i;if(r)return i=r.nodeType===yt?"text":"element",{id:r.id,tagName:r.tagName,type:i,index:this.filteredPosition(r,t)}}pathTo(e,t,r){for(var i={steps:[],terminal:{offset:null,assertion:null}},n=e,s;n&&n.parentNode&&n.parentNode.nodeType!=Gs;)r?s=this.filteredStep(n,r):s=this.step(n),s&&i.steps.unshift(s),n=n.parentNode;return t!=null&&t>=0&&(i.terminal.offset=t,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null},n=e.startContainer,s=e.endContainer,a=e.startOffset,l=e.endOffset,f=!1;if(r&&(f=n.ownerDocument.querySelector("."+r)!=null),typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),e.collapsed)f&&(a=this.patchOffset(n,a,r)),i.path=this.pathTo(n,a,r);else{i.range=!0,f&&(a=this.patchOffset(n,a,r)),i.start=this.pathTo(n,a,r),f&&(l=this.patchOffset(s,l,r)),i.end=this.pathTo(s,l,r),i.path={steps:[],terminal:null};var p=i.start.steps.length,c;for(c=0;c<p&&this.equalStep(i.start.steps[c],i.end.steps[c]);c++)c===p-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[c]),i.range=!1):i.path.steps.push(i.start.steps[c]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),i.path=this.pathTo(e,null,r),i}filter(e,t){var r,i,n,s,a,l=!1;return e.nodeType===yt?(l=!0,n=e.parentNode,r=e.parentNode.classList.contains(t)):(l=!1,r=e.classList.contains(t)),r&&l?(s=n.previousSibling,a=n.nextSibling,s&&s.nodeType===yt?i=s:a&&a.nodeType===yt&&(i=a),i||e):r&&!l?!1:e}patchOffset(e,t,r){if(e.nodeType!=yt)throw new Error("Anchor must be a text node");var i=e,n=t;for(e.parentNode.classList.contains(r)&&(i=e.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===Mt)if(i.previousSibling.classList.contains(r))n+=i.previousSibling.textContent.length;else break;else n+=i.previousSibling.textContent.length;i=i.previousSibling}return n}normalizedMap(e,t,r){var i={},n=-1,s,a=e.length,l,f;for(s=0;s<a;s++)l=e[s].nodeType,l===Mt&&e[s].classList.contains(r)&&(l=yt),s>0&&l===yt&&f===yt?i[s]=n:t===l&&(n=n+1,i[s]=n),f=l;return i}position(e){var t,r;return e.nodeType===Mt?(t=e.parentNode.children,t||(t=gi(e.parentNode)),r=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),r=t.indexOf(e)),r}filteredPosition(e,t){var r,i,n;return e.nodeType===Mt?(r=e.parentNode.children,n=this.normalizedMap(r,Mt,t)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,r=e.parentNode.childNodes),n=this.normalizedMap(r,yt,t)),i=Array.prototype.indexOf.call(r,e),n[i]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("*[position()="+i+" and @id='"+r.id+"']"):r.type==="text"?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("#"+r.id):r.type==="text"||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===yt?!0:!!(t&&r.classList.contains(t))})}walkToNode(e,t,r){var i=t||document,n=i.documentElement,s,a,l=e.length,f;for(f=0;f<l&&(a=e[f],a.type==="element"?a.id?n=i.getElementById(a.id):(s=n.children||gi(n),n=s[a.index]):a.type==="text"&&(n=this.textNodes(n,r)[a.index]),!!n);f++);return n}findNode(e,t,r){var i=t||document,n,s;return!r&&typeof i.evaluate<"u"?(s=this.stepsToXpath(e),n=i.evaluate(s,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?n=this.walkToNode(e,i,r):n=this.walkToNode(e,i),n}fixMiss(e,t,r,i){var n=this.findNode(e.slice(0,-1),r,i),s=n.childNodes,a=this.normalizedMap(s,yt,i),l,f,p=e[e.length-1].index;for(let c in a){if(!a.hasOwnProperty(c))return;if(a[c]===p)if(l=s[c],f=l.textContent.length,t>f)t=t-f;else{l.nodeType===Mt?n=l.childNodes[0]:n=l;break}}return{container:n,offset:t}}toRange(e,t){var r=e||document,i,n,s,a,l,f=this,p,c,_=t?r.querySelector("."+t)!=null:!1,y;if(typeof r.createRange<"u"?i=r.createRange():i=new Hn,f.range?(n=f.start,p=f.path.steps.concat(n.steps),a=this.findNode(p,r,_?t:null),s=f.end,c=f.path.steps.concat(s.steps),l=this.findNode(c,r,_?t:null)):(n=f.path,p=f.path.steps,a=this.findNode(f.path.steps,r,_?t:null)),a)try{n.terminal.offset!=null?i.setStart(a,n.terminal.offset):i.setStart(a,0)}catch{y=this.fixMiss(p,n.terminal.offset,r,_?t:null),i.setStart(y.container,y.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{s.terminal.offset!=null?i.setEnd(l,s.terminal.offset):i.setEnd(l,0)}catch{y=this.fixMiss(c,f.end.terminal.offset,r,_?t:null),i.setEnd(y.container,y.offset)}return i}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,r){var i=parseInt(t),n=(e+1)*2,s="/"+n+"/";return s+=(i+1)*2,r&&(s+="["+r+"]"),s}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class At{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let r=0;r<this.hooks.length;r++)if(t=this.hooks[r],t===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,t=this.context,r=[];return this.hooks.forEach(function(i){try{var n=i.apply(t,e)}catch(s){console.log(s)}n&&typeof n.then=="function"&&r.push(n)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function Vn(m,e){var t,r,i=e.url,n=i.indexOf("://")>-1;m&&(r=Ze(m,"head"),t=Ze(r,"base"),t||(t=m.createElement("base"),r.insertBefore(t,r.firstChild)),!n&&window&&window.location&&(i=window.location.origin+i),t.setAttribute("href",i))}function Zs(m,e){var t,r,i=e.canonical;m&&(t=Ze(m,"head"),r=Ze(t,"link[rel='canonical']"),r?r.setAttribute("href",i):(r=m.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",i),t.appendChild(r)))}function Xs(m,e){var t,r,i=e.idref;m&&(t=Ze(m,"head"),r=Ze(t,"link[property='dc.identifier']"),r?r.setAttribute("content",i):(r=m.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",i),t.appendChild(r)))}function Ys(m,e){var t=m.querySelectorAll("a[href]");if(t.length)for(var r=Ze(m.ownerDocument,"base"),i=r?r.getAttribute("href"):void 0,n=(function(a){var l=a.getAttribute("href");if(l.indexOf("mailto:")!==0){var f=l.indexOf("://")>-1;if(f)a.setAttribute("target","_blank");else{var p;try{p=new Dt(l,i)}catch{}a.onclick=function(){return p&&p.hash?e(p.Path.path+p.hash):e(p?p.Path.path:l),!1}}}}).bind(this),s=0;s<t.length;s++)n(t[s])}function on(m,e,t){return e.forEach(function(r,i){r&&t[i]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),m=m.replace(new RegExp(r,"g"),t[i]))}),m}function tr(m,e,t,r){var i=typeof window<"u"?window.URL:!1,n=i?"blob":"arraybuffer",s=new Pe,a=new XMLHttpRequest,l=XMLHttpRequest.prototype,f;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(a.withCredentials=!0),a.onreadystatechange=c,a.onerror=p,a.open("GET",m,!0);for(f in r)a.setRequestHeader(f,r[f]);e=="json"&&a.setRequestHeader("Accept","application/json"),e||(e=new Rt(m).extension),e=="blob"&&(a.responseType=n),er(e)&&a.overrideMimeType("text/xml"),e=="binary"&&(a.responseType="arraybuffer"),a.send();function p(_){s.reject(_)}function c(){if(this.readyState===XMLHttpRequest.DONE){var _=!1;if((this.responseType===""||this.responseType==="document")&&(_=this.responseXML),this.status===200||this.status===0||_){var y;if(!this.response&&!_)return s.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),s.promise;if(this.status===403)return s.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),s.promise;_?y=this.responseXML:er(e)?y=Ct(this.response,"text/xml"):e=="xhtml"?y=Ct(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?y=Ct(this.response,"text/html"):e=="json"?y=JSON.parse(this.response):e=="blob"?i?y=this.response:y=new Blob([this.response]):y=this.response,s.resolve(y)}else s.reject({status:this.status,message:this.response,stack:new Error().stack})}}return s.promise}class $s{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new At(this),this.hooks.content=new At(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||tr,r=new Pe,i=r.promise;return this.contents?r.resolve(this.contents):t(this.url).then((function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(n){r.reject(n)}),i}base(){return Vn(this.document,this)}render(e){var t=new Pe,r=t.promise;return this.output,this.load(e).then((function(i){var n=typeof navigator<"u"&&navigator.userAgent||"",s=n.indexOf("Trident")>=0,a;typeof XMLSerializer>"u"||s?a=On.DOMParser:a=XMLSerializer;var l=new a;return this.output=l.serializeToString(i),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(i){t.reject(i)}),r}find(e){var t=this,r=[],i=e.toLowerCase(),n=function(s){for(var a=s.textContent.toLowerCase(),l=t.document.createRange(),f,p,c=-1,_,y=150;p!=-1;)p=a.indexOf(i,c+1),p!=-1&&(l=t.document.createRange(),l.setStart(s,p),l.setEnd(s,p+i.length),f=t.cfiFromRange(l),s.textContent.length<y?_=s.textContent:(_=s.textContent.substring(p-y/2,p+y/2),_="..."+_+"..."),r.push({cfi:f,excerpt:_})),c=p};return pr(t.document,function(s){n(s)}),r}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const i=150,n=this,s=e.toLowerCase(),a=function(c){const O=c.reduce((E,h)=>E+h.textContent,"").toLowerCase().indexOf(s);if(O!=-1){const h=O+s.length;let v=0,g=0;if(O<c[0].length){let C;for(;v<c.length-1&&(g+=c[v].length,!(h<=g));)v+=1;let B=c[0],b=c[v],T=n.document.createRange();T.setStart(B,O);let N=c.slice(0,v).reduce((k,I)=>k+I.textContent.length,0);T.setEnd(b,N>h?h:h-N),C=n.cfiFromRange(T);let R=c.slice(0,v+1).reduce((k,I)=>k+I.textContent,"");R.length>i&&(R=R.substring(O-i/2,O+i/2),R="..."+R+"..."),r.push({cfi:C,excerpt:R})}}},l=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let f,p=[];for(;f=l.nextNode();)p.push(f),p.length==t&&(a(p.slice(0,t)),p=p.slice(1,t));return p.length>0&&a(p),r}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var i=r.replace("rendition:",""),n=i.indexOf("-"),s,a;n!=-1&&(s=i.slice(0,n),a=i.slice(n+1),t[s]=a)}),t}cfiFromRange(e){return new ze(e,this.cfiBase).toString()}cfiFromElement(e){return new ze(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class Ks{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new At,this.hooks.content=new At,this.hooks.content.register(Vn),this.hooks.content.register(Zs),this.hooks.content.register(Xs),this.epubcfi=new ze,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((i,n)=>{var s=this.manifest[i.idref],a;i.index=n,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=t(i.href,!0),i.canonical=r(i.href)),s&&(i.href=s.href,i.url=t(i.href,!0),i.canonical=r(i.href),s.properties.length&&i.properties.push.apply(i.properties,s.properties)),i.linear==="yes"?(i.prev=(function(){let l=i.index;for(;l>0;){let f=this.get(l-1);if(f&&f.linear)return f;l-=1}}).bind(this),i.next=(function(){let l=i.index;for(;l<this.spineItems.length-1;){let f=this.get(l+1);if(f&&f.linear)return f;l+=1}}).bind(this)):(i.prev=function(){},i.next=function(){}),a=new $s(i,this.hooks),this.append(a)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let r=this.spineItems[t];if(r&&r.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new ze(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,r){t.index=r}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class xi{constructor(e){this._q=[],this.context=e,this.tick=wi,this.running=!1,this.paused=!1}enqueue(){var e,t,r,i=[].shift.call(arguments),n=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(e=new Pe,t=e.promise,r={task:i,args:n,deferred:e,promise:t}):r={promise:i},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,t,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return r=t.apply(this.context,e.args),r&&typeof r.then=="function"?r.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new Pe,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Pe),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const wr="0.3",lr=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],ve={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class Gn{constructor(e,t,r){this.spine=e,this.request=t,this.pause=r||100,this.q=new xi(this),this.epubcfi=new ze,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var r=new Pe,i=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(i),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(i),this.pause),r.promise}).bind(this))}parse(e,t,r){var i=[],n,s=e.ownerDocument,a=Ze(s,"body"),l=0,f,p=r||this.break,c=function(_){var y=_.length,O,E=0;if(_.textContent.trim().length===0)return!1;for(l==0&&(n=this.createRange(),n.startContainer=_,n.startOffset=0),O=p-l,O>y&&(l+=y,E=y);E<y;)if(O=p-l,l===0&&(E+=1,n=this.createRange(),n.startContainer=_,n.startOffset=E),E+O>=y)l+=y-E,E=y;else{E+=O,n.endContainer=_,n.endOffset=E;let h=new ze(n,t).toString();i.push(h),l=0}f=_};if(pr(a,c.bind(this)),n&&n.startContainer&&f){n.endContainer=f,n.endOffset=f.length;let _=new ze(n,t).toString();i.push(_),l=0}return i}generateFromWords(e,t,r){var i=e?new ze(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(n){n.linear&&(i?n.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),n,t,i,r):this.q.enqueue(this.processWords.bind(this),n,t,i,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,r,i){return i&&this._locationsWords.length>=i?Promise.resolve():e.load(this.request).then((function(n){var s=new Pe,a=this.parseWords(n,e,t,r),l=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=i?a.slice(0,l):a),e.unload(),this.processingTimeout=setTimeout(()=>s.resolve(a),this.pause),s.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,r,i){var n=t.cfiBase,s=[],a=e.ownerDocument,l=Ze(a,"body"),f=r,p=i?i.spinePos!==t.index:!0,c;i&&t.index===i.spinePos&&(c=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,e.ownerDocument));var _=function(y){if(!p)if(y===c)p=!0;else return!1;if(y.textContent.length<10&&y.textContent.trim().length===0)return!1;var O=this.countWords(y.textContent),E,h=0;if(O===0)return!1;for(E=f-this._wordCounter,E>O&&(this._wordCounter+=O,h=O);h<O;)if(E=f-this._wordCounter,h+E>=O)this._wordCounter+=O-h,h=O;else{h+=E;let v=new ze(y,n);s.push({cfi:v.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return pr(l,_.bind(this)),s}locationFromCfi(e){let t;return ze.prototype.isCfiString(e)&&(e=new ze(e)),this._locations.length===0?-1:(t=Gt(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new ze(this._locations[this.total]);return r.collapse(),r.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(ve.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}St(Gn.prototype);class Js{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=Ze(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Ot.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class un{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,r,i;if(!e)throw new Error("Package File Not Found");if(t=Ze(e,"metadata"),!t)throw new Error("No Metadata Found");if(r=Ze(e,"manifest"),!r)throw new Error("No Manifest Found");if(i=Ze(e,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,i),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=zn(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},r=Nt(e,"item"),i=Array.prototype.slice.call(r);return i.forEach(function(n){var s=n.getAttribute("id"),a=n.getAttribute("href")||"",l=n.getAttribute("media-type")||"",f=n.getAttribute("media-overlay")||"",p=n.getAttribute("properties")||"";t[s]={href:a,type:l,overlay:f,properties:p.length?p.split(" "):[]}}),t}parseSpine(e,t){var r=[],i=Nt(e,"itemref"),n=Array.prototype.slice.call(i);return n.forEach(function(s,a){var l=s.getAttribute("idref"),f=s.getAttribute("properties")||"",p=f.length?f.split(" "):[],c={id:s.getAttribute("id"),idref:l,linear:s.getAttribute("linear")||"yes",properties:p,index:a};r.push(c)}),r}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var r=e.getElementById(t);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Wt(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var r=Wt(e,"item",{"media-type":"application/x-dtbncx+xml"}),i;return r||(i=t.getAttribute("toc"),i&&(r=e.querySelector(`#${i}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var t=Ze(e,"package");t.getAttribute("version");var r=Wt(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var i=Wt(e,"meta",{name:"cover"});if(i){var n=i.getAttribute("content"),s=e.getElementById(n);return s?s.getAttribute("href"):""}else return!1}getElementText(e,t){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),i;return!r||r.length===0?"":(i=r[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(e,t){var r=Wt(e,"meta",{property:t});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((r,i)=>(r.index=i,r.linear=r.linear||"yes",r)),e.resources.forEach((r,i)=>{this.manifest[i]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,i)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Xr{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,r,i;t&&(r=Ze(e,"html"),i=Ze(e,"ncx")),t?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,r=0;r<e.length;r++)t=e[r],t.href&&(this.tocByHref[t.href]=r),t.id&&(this.tocById[t.id]=r),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,r){if(r.length===0)return;const i=r[t];if(i&&(e===i.id||e===i.href))return i;{let n;for(let s=0;s<r.length&&(n=this.getByIndex(e,t,r[s].subitems),!n);++s);return n}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=vr(e,"nav","toc"),r=[];if(!t)return r;let i=Ht(t,"ol",!0);return i&&(r=this.parseNavList(i)),r}parseNavList(e,t){const r=[];if(!e||!e.children)return r;for(let i=0;i<e.children.length;i++){const n=this.navItem(e.children[i],t);n&&r.push(n)}return r}navItem(e,t){let r=e.getAttribute("id")||void 0,i=Ht(e,"a",!0)||Ht(e,"span",!0);if(!i)return;let n=i.getAttribute("href")||"";r||(r=n);let s=i.textContent||"",a=[],l=Ht(e,"ol",!0);return l&&(a=this.parseNavList(l,r)),{id:r,href:n,label:s,subitems:a,parent:t}}parseLandmarks(e){var t=vr(e,"nav","landmarks"),r=t?Nt(t,"li"):[],i=r.length,n,s=[],a;if(!r||i===0)return s;for(n=0;n<i;++n)a=this.landmarkItem(r[n]),a&&(s.push(a),this.landmarksByType[a.type]=n);return s}landmarkItem(e){let t=Ht(e,"a",!0);if(!t)return;let r=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=t.getAttribute("href")||"",n=t.textContent||"";return{href:i,label:n,type:r}}parseNcx(e){var t=Nt(e,"navPoint"),r=t.length,i,n={},s=[],a,l;if(!t||r===0)return s;for(i=0;i<r;++i)a=this.ncxItem(t[i]),n[a.id]=a,a.parent?(l=n[a.parent],l.subitems.push(a)):s.push(a);return s}ncxItem(e){var t=e.getAttribute("id")||!1,r=Ze(e,"content"),i=r.getAttribute("src"),n=Ze(e,"navLabel"),s=n.textContent?n.textContent:"",a=[],l=e.parentNode,f;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(f=l.getAttribute("id")),{id:t,href:i,label:s,subitems:a,parent:f}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Jt={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},Qs=(function(){var m,e,t,r,i={};for(m in Jt)if(Jt.hasOwnProperty(m)){for(e in Jt[m])if(Jt[m].hasOwnProperty(e))if(t=Jt[m][e],typeof t=="string")i[t]=m+"/"+e;else for(r=0;r<t.length;r++)i[t[r]]=m+"/"+e}return i})(),ea="text/plain";function ta(m){return m&&Qs[m.split(".").pop().toLowerCase()]||ea}const Vt={lookup:ta};class ra{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Dt(e),r=Vt.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(i=>Wn(i)).then(i=>vi(i,r)):this.settings.request(e,"blob").then(i=>dr(i,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var r=this.settings.resolver(t);return this.createUrl(r).catch(i=>(console.error(i),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(r=>typeof r=="string"),t))}replaceCss(e,t){var r=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(i){var n=this.createCssFile(i,e,t).then((function(s){var a=this.urls.indexOf(i);a>-1&&(this.replacementUrls[a]=s)}).bind(this));r.push(n)}).bind(this)),Promise.all(r)}createCssFile(e){var t;if(Ot.isAbsolute(e))return new Promise(function(s){s()});var r=this.settings.resolver(e),i;this.settings.archive?i=this.settings.archive.getText(r):i=this.settings.request(r,"text");var n=this.urls.map(s=>{var a=this.settings.resolver(s),l=new Rt(r).relative(a);return l});return i?i.then(s=>(s=on(s,n,this.replacementUrls),this.settings.replacements==="base64"?t=vi(s,"text/css"):t=dr(s,"text/css"),t),s=>new Promise(function(a){a()})):new Promise(function(s){s()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(r){var i=t(r),n=new Rt(e).relative(i);return n}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(r,i){r(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var r;return t?r=this.relativeTo(t):r=this.urls,on(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Yr{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new ze,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=Ze(e,"html"),r=Ze(e,"ncx");if(t)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var t=vr(e,"nav","page-list"),r=t?Nt(t,"li"):[],i=r.length,n,s=[],a;if(!r||i===0)return s;for(n=0;n<i;++n)a=this.item(r[n]),s.push(a);return s}parseNcx(e){var t=[],r=0,i,n,s,a=0;if(n=Ze(e,"pageList"),!n||(s=Nt(n,"pageTarget"),a=s.length,!s||s.length===0))return t;for(r=0;r<a;++r)i=this.ncxItem(s[r]),t.push(i);return t}ncxItem(e){var t=Ze(e,"navLabel"),r=Ze(t,"text"),i=r.textContent,n=Ze(e,"content"),s=n.getAttribute("src"),a=parseInt(i,10);return{href:s,page:a}}item(e){var t=Ze(e,"a"),r=t.getAttribute("href")||"",i=t.textContent||"",n=parseInt(i),s=r.indexOf("epubcfi"),a,l,f;return s!=-1?(a=r.split("#"),l=a[0],f=a.length>1?a[1]:!1,{cfi:f,href:r,packageUrl:l,page:n}):{href:r,page:n}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var r=hr(e,this.locations,this.epubcfi.compare);return r!=-1?t=this.pages[r]:(r=Gt(e,this.locations,this.epubcfi.compare),t=r-1>=0?this.pages[r-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(t=this.locations[r]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),r=this.percentageFromPage(t);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class Zn{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,r){var i=1,n=r||0,s=e,a=t,l=Math.floor(s/12),f,p,c,_;this._spread&&s>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(n=l%2===0?l:l-1),this.name==="pre-paginated"&&(n=0),i>1?(f=s/i-n,c=f+n):(f=s,c=s),this.name==="pre-paginated"&&i>1&&(s=f),p=f*i+n,_=s,this.width=s,this.height=a,this.spreadWidth=p,this.pageWidth=c,this.delta=_,this.columnWidth=f,this.gap=n,this.divisor=i,this.update({width:s,height:a,spreadWidth:p,pageWidth:c,delta:_,columnWidth:f,gap:n,divisor:i})}format(e,t,r){var i;return this.name==="pre-paginated"?i=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?i=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?i=e.size(null,this.height):i=e.size(this.width,null),i}count(e,t){let r,i;return this.name==="pre-paginated"?(r=1,i=1):this._flow==="paginated"?(t=t||this.delta,r=Math.ceil(e/t),i=r*this.divisor):(t=t||this.height,r=Math.ceil(e/t),i=r),{spreads:r,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=ft(this.props,e);this.emit(ve.LAYOUT.UPDATED,t,e)}}}St(Zn.prototype);class ia{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var r=new Dt(t);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(r=>{this.add(e,r)})}inject(e){var t=[],r=this._themes,i;for(var n in r)r.hasOwnProperty(n)&&(n===this._current||n==="default")&&(i=r[n],(i.rules&&Object.keys(i.rules).length>0||i.url&&t.indexOf(i.url)===-1)&&this.add(n,e),this._injected.push(n));this._current!="default"&&e.addClass(this._current)}add(e,t){var r=this._themes[e];!r||!t||(r.url?t.addStylesheet(r.url):r.serialized?(t.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(t.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,t,r){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:r===!0},i.forEach(n=>{n.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(r=>{r.css(e)})}overrides(e){var t=this._overrides;for(var r in t)t.hasOwnProperty(r)&&e.css(r,t[r].value,t[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class gr{constructor(e,t,r,i=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,t);return r}page(e,t,r,i){var n=e&&e.document?e.document.body:!1,s;if(n){if(s=this.rangePairToCfiPair(t,{start:this.findStart(n,r,i),end:this.findEnd(n,r,i)}),this._dev===!0){let a=e.document,l=new ze(s.start).toRange(a),f=new ze(s.end).toRange(a),p=a.defaultView.getSelection(),c=a.createRange();p.removeAllRanges(),c.setStart(l.startContainer,l.startOffset),c.setEnd(f.endContainer,f.endOffset),p.addRange(c)}return s}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=r.acceptNode;i.acceptNode=r.acceptNode;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1),s,a;(s=n.nextNode())&&(a=t(s),!a););return a}}findRanges(e){for(var t=[],r=e.contents.scrollWidth(),i=Math.ceil(r/this.layout.spreadWidth),n=i*this.layout.divisor,s=this.layout.columnWidth,a=this.layout.gap,l,f,p=0;p<n.pages;p++)l=(s+a)*p,f=s*(p+1)+a*p,t.push({start:this.findStart(e.document.body,l,f),end:this.findEnd(e.document.body,l,f)});return t}findStart(e,t,r){for(var i=[e],n,s,a=e;i.length;)if(n=i.shift(),s=this.walk(n,l=>{var f,p,c,_,y;if(y=pi(l),this.horizontal&&this.direction==="ltr"){if(f=this.horizontal?y.left:y.top,p=this.horizontal?y.right:y.bottom,f>=t&&f<=r)return l;if(p>t)return l;a=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(f=y.left,p=y.right,p<=r&&p>=t)return l;if(f<r)return l;a=l,i.push(l)}else{if(c=y.top,_=y.bottom,c>=t&&c<=r)return l;if(_>t)return l;a=l,i.push(l)}}),s)return this.findTextStartRange(s,t,r);return this.findTextStartRange(a,t,r)}findEnd(e,t,r){for(var i=[e],n,s=e,a;i.length;)if(n=i.shift(),a=this.walk(n,l=>{var f,p,c,_,y;if(y=pi(l),this.horizontal&&this.direction==="ltr"){if(f=Math.round(y.left),p=Math.round(y.right),f>r&&s)return s;if(p>r)return l;s=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(f=Math.round(this.horizontal?y.left:y.top),p=Math.round(this.horizontal?y.right:y.bottom),p<t&&s)return s;if(f<t)return l;s=l,i.push(l)}else{if(c=Math.round(y.top),_=Math.round(y.bottom),c>r&&s)return s;if(_>r)return l;s=l,i.push(l)}}),a)return this.findTextEndRange(a,t,r);return this.findTextEndRange(s,t,r)}findTextStartRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),n,s,a,l,f,p=0;p<i.length;p++)if(n=i[p],s=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(a=s.left,a>=t)return n}else if(this.horizontal&&this.direction==="rtl"){if(f=s.right,f<=r)return n}else if(l=s.top,l>=t)return n;return i[0]}findTextEndRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),n,s,a,l,f,p,c,_=0;_<i.length;_++){if(s=i[_],a=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=a.left,f=a.right,l>r&&n)return n;if(f>r)return s}else if(this.horizontal&&this.direction==="rtl"){if(l=a.left,f=a.right,f<t&&n)return n;if(l<t)return s}else{if(p=a.top,c=a.bottom,p>r&&n)return n;if(c>r)return s}n=s}return i[i.length-1]}splitTextNodeIntoRanges(e,t){var r=[],i=e.textContent||"",n=i.trim(),s,a=e.ownerDocument,l=t||" ",f=n.indexOf(l);if(f===-1||e.nodeType!=Node.TEXT_NODE)return s=a.createRange(),s.selectNodeContents(e),[s];for(s=a.createRange(),s.setStart(e,0),s.setEnd(e,f),r.push(s),s=!1;f!=-1;)f=n.indexOf(l,f+1),f>0&&(s&&(s.setEnd(e,f),r.push(s)),s=a.createRange(),s.setStart(e,f+1));return s&&(s.setEnd(e,n.length),r.push(s)),r}rangePairToCfiPair(e,t){var r=t.start,i=t.end;r.collapse(!0),i.collapse(!1);let n=new ze(r,e).toString(),s=new ze(i,e).toString();return{start:n,end:s}}rangeListToCfiList(e,t){for(var r=[],i,n=0;n<t.length;n++)i=this.rangePairToCfiPair(e,t[n]),r.push(i);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const Xn=typeof navigator<"u",na=Xn&&/Chrome/.test(navigator.userAgent),ln=Xn&&!na&&/AppleWebKit/.test(navigator.userAgent),sa=1;class Di{constructor(e,t,r,i){this.epubcfi=new ze,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",wr),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return lr}width(e){var t=this.content;return e&&et(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&et(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&et(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&et(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,r=this.document.createRange(),i=this.content||this.document.body,n=fr(i);return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.width,n&&n.width&&(t+=n.width),Math.round(t)}textHeight(){let e,t,r=this.document.createRange(),i=this.content||this.document.body;return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,r){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,r?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],n={};if(t&&t.hasAttribute("content")){let s=t.getAttribute("content"),a=s.match(/width\s*=\s*([^,]*)/),l=s.match(/height\s*=\s*([^,]*)/),f=s.match(/initial-scale\s*=\s*([^,]*)/),p=s.match(/minimum-scale\s*=\s*([^,]*)/),c=s.match(/maximum-scale\s*=\s*([^,]*)/),_=s.match(/user-scalable\s*=\s*([^,]*)/);a&&a.length&&typeof a[1]<"u"&&(r.width=a[1]),l&&l.length&&typeof l[1]<"u"&&(r.height=l[1]),f&&f.length&&typeof f[1]<"u"&&(r.scale=f[1]),p&&p.length&&typeof p[1]<"u"&&(r.minimum=p[1]),c&&c.length&&typeof c[1]<"u"&&(r.maximum=c[1]),_&&_.length&&typeof _[1]<"u"&&(r.scalable=_[1])}return n=Pn(e||{},r),e&&(n.width&&i.push("width="+n.width),n.height&&i.push("height="+n.height),n.scale&&i.push("initial-scale="+n.scale),n.scalable==="no"?(i.push("minimum-scale="+n.scale),i.push("maximum-scale="+n.scale),i.push("user-scalable="+n.scalable)):(n.scalable&&i.push("user-scalable="+n.scalable),n.minimum&&i.push("minimum-scale="+n.minimum),n.maximum&&i.push("minimum-scale="+n.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(ve.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(ve.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(a){a.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<e.length;r+=1){var i;try{i=e[r].cssRules}catch{return}if(!i)return;for(var n=0;n<i.length;n+=1)if(i[n].media){var s=this.window.matchMedia(i[n].media.mediaText);s.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,r=0;r<e.length;r++)t=e[r],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var r,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let n=new ze(e).toRange(this.document,t);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let s=n.startContainer.textContent.indexOf(" ",n.startOffset);s==-1&&(s=n.startContainer.textContent.length),n.setEnd(n.startContainer,s)}}catch(s){console.error("setting end offset to start container length failed",s)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)r=n.startContainer.getBoundingClientRect(),i.left=r.left,i.top=r.top;else if(ln){let s=n.startContainer,a=new Range;try{s.nodeType===sa?r=s.getBoundingClientRect():n.startOffset+2<s.length?(a.setStart(s,n.startOffset),a.setEnd(s,n.startOffset+2),r=a.getBoundingClientRect()):n.startOffset-2>0?(a.setStart(s,n.startOffset-2),a.setEnd(s,n.startOffset),r=a.getBoundingClientRect()):r=s.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else r=n.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let n=e.substring(e.indexOf("#")+1),s=this.document.getElementById(n);if(s)if(ln){let a=new Range;a.selectNode(s),r=a.getBoundingClientRect()}else r=s.getBoundingClientRect()}return r&&(i.left=r.left,i.top=r.top),i}addStylesheet(e){return new Promise((function(t,r){var i,n=!1;if(!this.document){t(!1);return}if(i=this.document.querySelector("link[href='"+e+"']"),i){t(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(t),r.innerHTML=e,!0}addStylesheetRules(e,t){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var i=0,n=e.length;i<n;i++){var s=1,a=e[i],l=e[i][0],f="";Object.prototype.toString.call(a[1][0])==="[object Array]"&&(a=a[1],s=0);for(var p=a.length;s<p;s++){var c=a[s];f+=c[0]+":"+c[1]+(c[2]?" !important":"")+`;
`}r.insertRule(l+"{"+f+"}",r.cssRules.length)}else Object.keys(e).forEach(y=>{const O=e[y];if(Array.isArray(O))O.forEach(E=>{const v=Object.keys(E).map(g=>`${g}:${E[g]}`).join(";");r.insertRule(`${y}{${v}}`,r.cssRules.length)});else{const h=Object.keys(O).map(v=>`${v}:${O[v]}`).join(";");r.insertRule(`${y}{${h}}`,r.cssRules.length)}})}addScript(e){return new Promise((function(t,r){var i,n=!1;if(!this.document){t(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),lr.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(lr.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,r;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(r=new ze(t,this.cfiBase).toString(),this.emit(ve.CONTENTS.SELECTED,r),this.emit(ve.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var r=new ze(e);return r.toRange(this.document,t)}cfiFromRange(e,t){return new ze(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new ze(e,this.cfiBase,t).toString()}map(e){var t=new gr(e);return t.section()}size(e,t){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),r.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,t,r,i,n){let s=jt("column-axis"),a=jt("column-gap"),l=jt("column-width"),f=jt("column-fill"),c=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&c==="horizontal"&&this.direction(n),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),c==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(s,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(s,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(f,"auto"),this.css(a,i+"px"),this.css(l,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,r){var i="scale("+e+")",n="";this.css("transform-origin","top left"),(t>=0||r>=0)&&(n=" translate("+(t||0)+"px, "+(r||0)+"px )"),this.css("transform",i+n)}fit(e,t,r){var i=this.viewport(),n=parseInt(i.width),s=parseInt(i.height),a=e/n,l=t/s,f=a<l?a:l;if(this.layoutStyle("paginated"),this.width(n),this.height(s),this.overflow("hidden"),this.scaler(f,0,0),this.css("background-size",n*f+"px "+s*f+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var p=e-n*f;this.css("margin-left",p+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,r,i,n){var s=new gr(t,n);return s.page(this,e,r,i)}linksHandler(){Ys(this.content,e=>{this.emit(ve.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=jt("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}St(Di.prototype);class aa{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,r,i,n,s){let a=encodeURI(t+e),f=new ze(t).spinePos,p=new Yn({type:e,cfiRange:t,data:r,sectionIndex:f,cb:i,className:n,styles:s});return this._annotations[a]=p,f in this._annotationsBySectionIndex?this._annotationsBySectionIndex[f].push(a):this._annotationsBySectionIndex[f]=[a],this.rendition.views().forEach(_=>{p.sectionIndex===_.index&&p.attach(_)}),p}remove(e,t){let r=encodeURI(e+t);if(r in this._annotations){let i=this._annotations[r];if(t&&i.type!==t)return;this.rendition.views().forEach(s=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,r),i.sectionIndex===s.index&&i.detach(s)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,r,i,n){return this.add("highlight",e,t,r,i,n)}underline(e,t,r,i,n){return this.add("underline",e,t,r,i,n)}mark(e,t,r){return this.add("mark",e,t,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].detach(e)})}show(){}hide(){}}class Yn{constructor({type:e,cfiRange:t,data:r,sectionIndex:i,cb:n,className:s,styles:a}){this.type=e,this.cfiRange=t,this.data=r,this.sectionIndex=i,this.mark=void 0,this.cb=n,this.className=s,this.styles=a}update(e){this.data=e}attach(e){let{cfiRange:t,data:r,type:i,mark:n,cb:s,className:a,styles:l}=this,f;return i==="highlight"?f=e.highlight(t,r,s,a,l):i==="underline"?f=e.underline(t,r,s,a,l):i==="mark"&&(f=e.mark(t,r,s)),this.mark=f,this.emit(ve.ANNOTATION.ATTACH,f),f}detach(e){let{cfiRange:t,type:r}=this,i;return e&&(r==="highlight"?i=e.unhighlight(t):r==="underline"?i=e.ununderline(t):r==="mark"&&(i=e.unmark(t))),this.mark=void 0,this.emit(ve.ANNOTATION.DETACH,i),i}text(){}}St(Yn.prototype);var Et={},Qt={},hn;function oa(){if(hn)return Qt;hn=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.createElement=m;function m(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}return Qt.default={createElement:m},Qt}var qt={},fn;function ua(){if(fn)return qt;fn=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.proxyMouse=m,qt.clone=e,qt.default={proxyMouse:m};function m(r,i){function n(f){for(var p=i.length-1;p>=0;p--){var c=i[p],_=f.clientX,y=f.clientY;if(f.touches&&f.touches.length&&(_=f.touches[0].clientX,y=f.touches[0].clientY),!!t(c,r,_,y)){c.dispatchEvent(e(f));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var s=["mouseup","mousedown","click","touchstart"],a=0;a<s.length;a++){var l=s[a];this.target.addEventListener(l,function(f){return n(f)},!1)}}function e(r){var i=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,i)}catch{var n=document.createEvent("MouseEvents");return n.initMouseEvent(r.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),n}}function t(r,i,n,s){var a=i.getBoundingClientRect();function l(y,O,E){var h=y.top-a.top,v=y.left-a.left,g=h+y.height,C=v+y.width;return h<=E&&v<=O&&g>E&&C>O}var f=r.getBoundingClientRect();if(!l(f,n,s))return!1;for(var p=r.getClientRects(),c=0,_=p.length;c<_;c++)if(l(p[c],n,s))return!0;return!1}return qt}var cn;function la(){if(cn)return Et;cn=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.Underline=Et.Highlight=Et.Mark=Et.Pane=void 0;var m=function E(h,v,g){h===null&&(h=Function.prototype);var C=Object.getOwnPropertyDescriptor(h,v);if(C===void 0){var B=Object.getPrototypeOf(h);return B===null?void 0:E(B,v,g)}else{if("value"in C)return C.value;var b=C.get;return b===void 0?void 0:b.call(g)}},e=(function(){function E(h,v){for(var g=0;g<v.length;g++){var C=v[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}return function(h,v,g){return v&&E(h.prototype,v),g&&E(h,g),h}})(),t=oa(),r=s(t),i=ua(),n=s(i);function s(E){return E&&E.__esModule?E:{default:E}}function a(E,h){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:E}function l(E,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);E.prototype=Object.create(h&&h.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(E,h):E.__proto__=h)}function f(E,h){if(!(E instanceof h))throw new TypeError("Cannot call a class as a function")}Et.Pane=(function(){function E(h){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;f(this,E),this.target=h,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),n.default.proxyMouse(this.target,this.marks),this.container=v,this.container.appendChild(this.element),this.render()}return e(E,[{key:"addMark",value:function(v){var g=r.default.createElement("g");return this.element.appendChild(g),v.bind(g,this.container),this.marks.push(v),v.render(),v}},{key:"removeMark",value:function(v){var g=this.marks.indexOf(v);if(g!==-1){var C=v.unbind();this.element.removeChild(C),this.marks.splice(g,1)}}},{key:"render",value:function(){y(this.element,_(this.target,this.container));var v=!0,g=!1,C=void 0;try{for(var B=this.marks[Symbol.iterator](),b;!(v=(b=B.next()).done);v=!0){var T=b.value;T.render()}}catch(N){g=!0,C=N}finally{try{!v&&B.return&&B.return()}finally{if(g)throw C}}}}]),E})();var p=Et.Mark=(function(){function E(){f(this,E),this.element=null}return e(E,[{key:"bind",value:function(v,g){this.element=v,this.container=g}},{key:"unbind",value:function(){var v=this.element;return this.element=null,v}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(v){this.element&&this.element.dispatchEvent(v)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var v=[],g=this.element.firstChild;g;)v.push(g.getBoundingClientRect()),g=g.nextSibling;return v}},{key:"filteredRanges",value:function(){var v=Array.from(this.range.getClientRects());return v.filter(function(g){for(var C=0;C<v.length;C++){if(v[C]===g)return!0;var B=O(v[C],g);if(B)return!1}return!0})}}]),E})(),c=Et.Highlight=(function(E){l(h,E);function h(v,g,C,B){f(this,h);var b=a(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return b.range=v,b.className=g,b.data=C||{},b.attributes=B||{},b}return e(h,[{key:"bind",value:function(g,C){m(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"bind",this).call(this,g,C);for(var B in this.data)this.data.hasOwnProperty(B)&&(this.element.dataset[B]=this.data[B]);for(var B in this.attributes)this.attributes.hasOwnProperty(B)&&this.element.setAttribute(B,this.attributes[B]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),C=this.filteredRanges(),B=this.element.getBoundingClientRect(),b=this.container.getBoundingClientRect(),T=0,N=C.length;T<N;T++){var R=C[T],k=r.default.createElement("rect");k.setAttribute("x",R.left-B.left+b.left),k.setAttribute("y",R.top-B.top+b.top),k.setAttribute("height",R.height),k.setAttribute("width",R.width),g.appendChild(k)}this.element.appendChild(g)}}]),h})(p);Et.Underline=(function(E){l(h,E);function h(v,g,C,B){return f(this,h),a(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,v,g,C,B))}return e(h,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),C=this.filteredRanges(),B=this.element.getBoundingClientRect(),b=this.container.getBoundingClientRect(),T=0,N=C.length;T<N;T++){var R=C[T],k=r.default.createElement("rect");k.setAttribute("x",R.left-B.left+b.left),k.setAttribute("y",R.top-B.top+b.top),k.setAttribute("height",R.height),k.setAttribute("width",R.width),k.setAttribute("fill","none");var I=r.default.createElement("line");I.setAttribute("x1",R.left-B.left+b.left),I.setAttribute("x2",R.left-B.left+b.left+R.width),I.setAttribute("y1",R.top-B.top+b.top+R.height-1),I.setAttribute("y2",R.top-B.top+b.top+R.height-1),I.setAttribute("stroke-width",1),I.setAttribute("stroke","black"),I.setAttribute("stroke-linecap","square"),g.appendChild(k),g.appendChild(I)}this.element.appendChild(g)}}]),h})(c);function _(E,h){var v=h.getBoundingClientRect(),g=E.getBoundingClientRect();return{top:g.top-v.top,left:g.left-v.left,height:E.scrollHeight,width:E.scrollWidth}}function y(E,h){E.style.setProperty("top",h.top+"px","important"),E.style.setProperty("left",h.left+"px","important"),E.style.setProperty("height",h.height+"px","important"),E.style.setProperty("width",h.width+"px","important")}function O(E,h){return h.right<=E.right&&h.left>=E.left&&h.top>=E.top&&h.bottom<=E.bottom}return Et}var ar=la();class $n{constructor(e,t){this.settings=ft({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+br(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new ze,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=ur(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=r.indexOf("vertical")===0?"horizontal":"vertical":i=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(ve.VIEWS.AXIS,i),this.setWritingMode(r),this.emit(ve.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,s)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}).bind(this),(function(r){return this.emit(ve.VIEWS.LOAD_ERROR,r),new Promise((i,n)=>{n(r)})}).bind(this)).then((function(){this.emit(ve.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var r=e||this.settings.width,i=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,i):this.settings.axis==="horizontal"?this.lock("height",r,i):this.lock("width",r,i),this.settings.width=r,this.settings.height=i}lock(e,t,r){var i=fr(this.element),n;this.iframe?n=fr(this.iframe):n={width:0,height:0},e=="width"&&et(t)&&(this.lockedWidth=t-i.width-n.width),e=="height"&&et(r)&&(this.lockedHeight=r-i.height-n.height),e==="both"&&et(t)&&et(r)&&(this.lockedWidth=t-i.width-n.width,this.lockedHeight=r-i.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,r=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||r!=this._height)&&this.reframe(t,r),this._expanding=!1)}reframe(e,t){var r;et(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),et(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let i=this.prevBounds?e-this.prevBounds.width:e,n=this.prevBounds?t-this.prevBounds.height:t;r={width:e,height:t,widthDelta:i,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let s;for(let a in this.marks)this.marks.hasOwnProperty(a)&&(s=this.marks[a],this.placeMark(s.element,s.range))}),this.onResize(this,r),this.emit(ve.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=ur(this.element)}load(e){var t=new Pe,r=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(n){this.onLoad(n,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=dr(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new Di(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(ve.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(ve.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Pe;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(ve.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(r){t.reject(r,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(ve.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(ve.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=ur(this.element)),this.elementBounds}highlight(e,t={},r,i="epubjs-hl",n={}){if(!this.contents)return;const s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let a=this.contents.range(e),l=()=>{this.emit(ve.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new ar.Pane(this.iframe,this.element));let f=new ar.Highlight(a,i,t,s),p=this.pane.addMark(f);return this.highlights[e]={mark:p,element:p.element,listeners:[l,r]},p.element.setAttribute("ref",i),p.element.addEventListener("click",l),p.element.addEventListener("touchstart",l),r&&(p.element.addEventListener("click",r),p.element.addEventListener("touchstart",r)),p}underline(e,t={},r,i="epubjs-ul",n={}){if(!this.contents)return;const s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let a=this.contents.range(e),l=()=>{this.emit(ve.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new ar.Pane(this.iframe,this.element));let f=new ar.Underline(a,i,t,s),p=this.pane.addMark(f);return this.underlines[e]={mark:p,element:p.element,listeners:[l,r]},p.element.setAttribute("ref",i),p.element.addEventListener("click",l),p.element.addEventListener("touchstart",l),r&&(p.element.addEventListener("click",r),p.element.addEventListener("touchstart",r)),p}mark(e,t={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let n=i.commonAncestorContainer,s=n.nodeType===1?n:n.parentNode,a=f=>{this.emit(ve.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&n.nodeType===1?(i=new Range,i.selectNodeContents(n)):i.collapsed&&(i=new Range,i.selectNodeContents(s));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(f=>{l.dataset[f]=t[f]}),r&&(l.addEventListener("click",r),l.addEventListener("touchstart",r)),l.addEventListener("click",a),l.addEventListener("touchstart",a),this.placeMark(l,i),this.element.appendChild(l),this.marks[e]={element:l,range:i,listeners:[a,r]},s}placeMark(e,t){let r,i,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let a=t.getBoundingClientRect();r=a.top,i=a.right}else{let a=t.getClientRects(),l;for(var s=0;s!=a.length;s++)l=a[s],(!n||l.left<n)&&(n=l.left,i=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=l.top)}e.style.top=`${r}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&Mn(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}St($n.prototype);function ha(){var m="reverse",e=fa();return document.body.appendChild(e),e.scrollLeft>0?m="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(m="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(m="negative")),document.body.removeChild(e),m}function fa(){var m=document.createElement("div");m.dir="rtl",m.style.position="fixed",m.style.width="1px",m.style.height="1px",m.style.top="0px",m.style.left="0px",m.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(t),e.appendChild(r),m.appendChild(e),m}var $r,dn;function Ai(){if(dn)return $r;dn=1;function m(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return $r=m,$r}var Kr,pn;function ca(){if(pn)return Kr;pn=1;var m=typeof bt=="object"&&bt&&bt.Object===Object&&bt;return Kr=m,Kr}var Jr,vn;function Kn(){if(vn)return Jr;vn=1;var m=ca(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=m||e||Function("return this")();return Jr=t,Jr}var Qr,gn;function da(){if(gn)return Qr;gn=1;var m=Kn(),e=function(){return m.Date.now()};return Qr=e,Qr}var ei,mn;function pa(){if(mn)return ei;mn=1;var m=/\s/;function e(t){for(var r=t.length;r--&&m.test(t.charAt(r)););return r}return ei=e,ei}var ti,yn;function va(){if(yn)return ti;yn=1;var m=pa(),e=/^\s+/;function t(r){return r&&r.slice(0,m(r)+1).replace(e,"")}return ti=t,ti}var ri,bn;function Jn(){if(bn)return ri;bn=1;var m=Kn(),e=m.Symbol;return ri=e,ri}var ii,wn;function ga(){if(wn)return ii;wn=1;var m=Jn(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,i=m?m.toStringTag:void 0;function n(s){var a=t.call(s,i),l=s[i];try{s[i]=void 0;var f=!0}catch{}var p=r.call(s);return f&&(a?s[i]=l:delete s[i]),p}return ii=n,ii}var ni,_n;function ma(){if(_n)return ni;_n=1;var m=Object.prototype,e=m.toString;function t(r){return e.call(r)}return ni=t,ni}var si,En;function ya(){if(En)return si;En=1;var m=Jn(),e=ga(),t=ma(),r="[object Null]",i="[object Undefined]",n=m?m.toStringTag:void 0;function s(a){return a==null?a===void 0?i:r:n&&n in Object(a)?e(a):t(a)}return si=s,si}var ai,xn;function ba(){if(xn)return ai;xn=1;function m(e){return e!=null&&typeof e=="object"}return ai=m,ai}var oi,Dn;function wa(){if(Dn)return oi;Dn=1;var m=ya(),e=ba(),t="[object Symbol]";function r(i){return typeof i=="symbol"||e(i)&&m(i)==t}return oi=r,oi}var ui,An;function _a(){if(An)return ui;An=1;var m=va(),e=Ai(),t=wa(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt;function l(f){if(typeof f=="number")return f;if(t(f))return r;if(e(f)){var p=typeof f.valueOf=="function"?f.valueOf():f;f=e(p)?p+"":p}if(typeof f!="string")return f===0?f:+f;f=m(f);var c=n.test(f);return c||s.test(f)?a(f.slice(2),c?2:8):i.test(f)?r:+f}return ui=l,ui}var li,Cn;function Qn(){if(Cn)return li;Cn=1;var m=Ai(),e=da(),t=_a(),r="Expected a function",i=Math.max,n=Math.min;function s(a,l,f){var p,c,_,y,O,E,h=0,v=!1,g=!1,C=!0;if(typeof a!="function")throw new TypeError(r);l=t(l)||0,m(f)&&(v=!!f.leading,g="maxWait"in f,_=g?i(t(f.maxWait)||0,l):_,C="trailing"in f?!!f.trailing:C);function B($){var se=p,re=c;return p=c=void 0,h=$,y=a.apply(re,se),y}function b($){return h=$,O=setTimeout(R,l),v?B($):y}function T($){var se=$-E,re=$-h,ge=l-se;return g?n(ge,_-re):ge}function N($){var se=$-E,re=$-h;return E===void 0||se>=l||se<0||g&&re>=_}function R(){var $=e();if(N($))return k($);O=setTimeout(R,T($))}function k($){return O=void 0,C&&p?B($):(p=c=void 0,y)}function I(){O!==void 0&&clearTimeout(O),h=0,p=E=c=O=void 0}function X(){return O===void 0?y:k(e())}function H(){var $=e(),se=N($);if(p=arguments,c=this,E=$,se){if(O===void 0)return b(E);if(g)return clearTimeout(O),O=setTimeout(R,l),B(E)}return O===void 0&&(O=setTimeout(R,l)),y}return H.cancel=I,H.flush=X,H}return li=s,li}var hi,Sn;function Ea(){if(Sn)return hi;Sn=1;var m=Qn(),e=Ai(),t="Expected a function";function r(i,n,s){var a=!0,l=!0;if(typeof i!="function")throw new TypeError(t);return e(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),m(i,n,{leading:a,maxWait:n,trailing:l})}return hi=r,hi}var xa=Ea();const Da=Zt(xa);class Aa{constructor(e){this.settings=e||{},this.id="epubjs-container-"+br(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,r=e.width,i=e.overflow||!1,n=e.axis||"vertical",s=e.direction;ft(this.settings,e),e.height&&et(e.height)&&(t=e.height+"px"),e.width&&et(e.width)&&(r=e.width+"px");let a=document.createElement("div");return a.id=this.id,a.classList.add("epub-container"),a.style.wordSpacing="0",a.style.lineHeight="0",a.style.verticalAlign="top",a.style.position="relative",n==="horizontal"&&(a.style.display="flex",a.style.flexDirection="row",a.style.flexWrap="nowrap"),r&&(a.style.width=r),t&&(a.style.height=t),i&&(i==="scroll"&&n==="vertical"?(a.style["overflow-y"]=i,a.style["overflow-x"]="hidden"):i==="scroll"&&n==="horizontal"?(a.style["overflow-y"]="hidden",a.style["overflow-x"]=i):a.style.overflow=i),s&&(a.dir=s,a.style.direction=s),s&&this.settings.fullsize&&(document.body.style.direction=s),a}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(Ln(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),r;if(t)return this.settings.hidden?r=this.wrapper:r=this.container,t.appendChild(r),this.element=t,t}getContainer(){return this.container}onResize(e){(!et(this.settings.width)||!et(this.settings.height))&&(this.resizeFunc=Da(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var r;let i=e||this.settings.width,n=t||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):et(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(r=r||this.element.getBoundingClientRect(),r.height&&(t=r.height,this.container.style.height=t+"px")):et(t)?this.container.style.height=t+"px":this.container.style.height=t,et(e)||(e=this.container.clientWidth),et(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let s=cr(),a=window.getComputedStyle(document.body),l={left:parseFloat(a["padding-left"])||0,right:parseFloat(a["padding-right"])||0,top:parseFloat(a["padding-top"])||0,bottom:parseFloat(a["padding-bottom"])||0};return i||(e=s.width-l.left-l.right),(this.settings.fullsize&&!n||!n)&&(t=s.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?cr():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var r="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(n){for(var s in n)n.hasOwnProperty(s)&&(i+=s+":"+n[s]+";")}),this.sheet.insertRule(r+e+" {"+i+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class Ca{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var r=0;r<t;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,r=this.length,i=0;i<r;i++)if(t=this._views[i],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,r=this.length,i=0;i<r;i++)t=this._views[i],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}class mr{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new xi(this),this.settings=ft(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),ft(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=ha(),this.stage=new Aa({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new Ca(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(ve.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,r){let i=this.stage.size(e,t);if(this.winBounds=cr(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(ve.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,t){return new this.View(e,ft(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,r){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return r.call(this,i)}}display(e,t){var r=new Pe,i=r.promise;(t===e.href||et(t))&&(t=void 0);var n=this.views.find(e);if(n&&e&&this.layout.name!=="pre-paginated"){let a=n.offset();if(this.settings.direction==="ltr")this.scrollTo(a.left,a.top,!0);else{let l=n.width();this.scrollTo(a.left+l,a.top,!0)}if(t){let l=n.locationOf(t),f=n.width();this.moveTo(l,f)}return r.resolve(),i}this.clear();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.add(e,s).then((function(a){if(t){let l=a.locationOf(t),f=a.width();this.moveTo(l,f)}}).bind(this),a=>{r.reject(a)}).then((function(){return this.handleNextPrePaginated(s,e,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),i}afterDisplayed(e){this.emit(ve.MANAGERS.ADDED,e)}afterResized(e){this.emit(ve.MANAGERS.RESIZE,e.section)}moveTo(e,t){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),i=Math.floor(e.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-t),this.scrollTo(r,i,!0)}add(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ve.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ve.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}append(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ve.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ve.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}prepend(e,t){var r=this.createView(e,t);return r.on(ve.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ve.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(ve.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(i=!0),this.append(e,i).then((function(){return this.handleNextPrePaginated(i,e,this.append)}).bind(this),n=>n).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(i=!0),this.prepend(e,i).then((function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=e.prev(),n))return this.prepend(n)}).bind(this),n=>n).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let s=0,a=0;return this.settings.fullsize&&(s=n?window.scrollY:window.scrollX),e.map(f=>{let{index:p,href:c}=f.section,_=f.position(),y=f.width(),O=f.height(),E,h,v,g;n?(E=s+t.top-_.top+a,h=E+r-a,g=this.layout.count(O,r).pages,v=r):(E=s+t.left-_.left+a,h=E+i-a,g=this.layout.count(y,i).pages,v=i);let C=Math.ceil(E/v),B=[],b=Math.ceil(h/v);if(this.settings.direction==="rtl"&&!n){let R=C;C=g-b,b=g-R}B=[];for(var T=C;T<=b;T++){let R=T+1;B.push(R)}let N=this.mapping.page(f.contents,f.section.cfiBase,E,h);return{index:p,href:c,pages:B,totalPages:g,mapping:N}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=0,i=0;return this.settings.fullsize&&(r=window.scrollX),e.map(s=>{let{index:a,href:l}=s.section,f,p=s.position(),c=s.width(),_,y,O;this.settings.direction==="rtl"?(f=t.right-r,O=Math.min(Math.abs(f-p.left),this.layout.width)-i,y=p.width-(p.right-f)-i,_=y-O):(f=t.left+r,O=Math.min(p.right-f,this.layout.width)-i,_=f-p.left+i,y=_+O),i+=O;let E=this.mapping.page(s.contents,s.section.cfiBase,_,y),h=this.layout.count(c).pages,v=Math.floor(_/this.layout.pageWidth),g=[],C=Math.floor(y/this.layout.pageWidth);if(v<0&&(v=0,C=C+1),this.settings.direction==="rtl"){let b=v;v=h-C,C=h-b}for(var B=v+1;B<=C;B++){let b=B;g.push(b)}return{index:a,href:l,pages:g,totalPages:h,mapping:E}})}isVisible(e,t,r,i){var n=e.position(),s=i||this.bounds();return this.settings.axis==="horizontal"&&n.right>s.left-t&&n.left<s.right+r?!0:this.settings.axis==="vertical"&&n.bottom>s.top-t&&n.top<s.bottom+r}visible(){for(var e=this.bounds(),t=this.views.displayed(),r=t.length,i=[],n,s,a=0;a<r;a++)s=t[a],n=this.isVisible(s,0,0,e),n===!0&&i.push(s);return i}scrollBy(e,t,r){let i=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(ve.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(ve.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new gr(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new gr(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const r=t&&t.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}St(mr.prototype);const Sa={easeInCubic:function(m){return Math.pow(m,3)}};class yi{constructor(e,t){this.settings=ft({duration:80,minVelocity:.2,minDistance:10,easing:Sa.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(ve.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(ve.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{t.on(r,i=>this.triggerViewEvent(i,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:r}=e.touches[0],i=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,r=Math.abs(t),i=this.endTime-this.startTime,n=t/i,s=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(n>s)return-1;if(n<-s)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/r)*r;return e&&(i+=e*r),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new Pe,r=this.scrollLeft,i=this.now(),n=this.settings.duration,s=this.settings.easing;this.snapping=!0;function a(){const l=this.now(),f=Math.min(1,(l-i)/n);if(s(f),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}f<1?(window.requestAnimationFrame(a.bind(this)),this.scrollTo(r+(e-r)*f,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return a.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}St(yi.prototype);var Ta=Qn();const ka=Zt(Ta);class Na extends mr{constructor(e){super(e),this.name="continuous",this.settings=ft(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),ft(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return mr.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new Pe;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,r=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(t>0||r>0)&&this.scrollBy(t,r,!0)}afterResized(e){this.emit(ve.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(ve.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(ve.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ve.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(ve.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(ve.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ve.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(ve.VIEWS.RESIZED,r=>{this.counter(r),t.expanded=!0}),t.on(ve.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(ve.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),r=this.views.all(),i=r.length,n=typeof e<"u"?e:this.settings.offset||0,s,a,l=new Pe,f=[],p=0;p<i;p++)if(a=r[p],s=this.isVisible(a,n,n,t),s===!0)if(a.displayed)a.show();else{let c=a.display(this.request).then(function(_){_.show()},_=>{a.hide()});f.push(c)}else this.q.enqueue(a.destroy.bind(a)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return f.length?Promise.all(f).catch(c=>{l.reject(c)}):(l.resolve(),l.promise)}check(e,t){var r=new Pe,i=[],n=this.settings.axis==="horizontal",s=this.settings.offset||0;e&&n&&(s=e),t&&!n&&(s=t);var a=this._bounds;let l=n?this.scrollLeft:this.scrollTop,f=n?Math.floor(a.width):a.height,p=n?this.container.scrollWidth:this.container.scrollHeight,c=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",_=this.settings.rtlScrollType,y=this.settings.direction==="rtl";this.settings.fullsize?(n&&y&&_==="negative"||!n&&y&&_==="default")&&(l=l*-1):(y&&_==="default"&&c==="horizontal"&&(l=p-f-l),y&&_==="negative"&&c==="horizontal"&&(l=l*-1));let O=()=>{let C=this.views.first(),B=C&&C.section.prev();B&&i.push(this.prepend(B))},E=()=>{let C=this.views.last(),B=C&&C.section.next();B&&i.push(this.append(B))},h=l+f+s,v=l-s;h>=p&&E(),v<0&&O();let g=i.map(C=>C.display(this.request));return i.length?Promise.all(g).then(()=>this.check()).then(()=>this.update(s),C=>C):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new Pe,t=this.views.displayed(),r=t[0],i=t[t.length-1],n=this.views.indexOf(r),s=this.views.indexOf(i),a=this.views.slice(0,n),l=this.views.slice(s+1),f=0;f<a.length-1;f++)this.erase(a[f],a);for(var p=1;p<l.length;p++)this.erase(l[p]);return e.resolve(),e.promise}erase(e,t){var r,i;this.settings.fullsize?(r=window.scrollY,i=window.scrollX):(r=this.container.scrollTop,i=this.container.scrollLeft);var n=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,r-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(n.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(n.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new yi(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=wi;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=ka(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,t=window.scrollX*r):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(ve.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(ve.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new yi(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class Ci{constructor(e,t){this.settings=ft(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),ft(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new At(this),this.hooks.serialize=new At(this),this.hooks.content=new At(this),this.hooks.unloaded=new At(this),this.hooks.layout=new At(this),this.hooks.render=new At(this),this.hooks.show=new At(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new ia(this),this.annotations=new aa(this),this.epubcfi=new ze,this.q=new xi(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Pe,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=mr:typeof e=="string"&&e==="continuous"?t=Na:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=$n:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(ve.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(ve.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(ve.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(ve.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(ve.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(ve.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(ve.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Pe,r=t.promise,i;return this.displaying=t,this.book.locations.length()&&Fn(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),i=this.book.spine.get(e),i?(this.manager.display(i,e).then(()=>{t.resolve(i),this.displaying=void 0,this.emit(ve.RENDITION.DISPLAYED,i),this.reportLocation()},n=>{this.emit(ve.RENDITION.DISPLAY_ERROR,n)}),r):(t.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(ve.VIEWS.MARK_CLICKED,(t,r)=>this.triggerMarkEvent(t,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(ve.RENDITION.RENDERED,e.section,e)}):this.emit(ve.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(ve.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(ve.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(ve.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,r){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,r=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",n=this.settings.orientation||e.orientation||"auto",s=this.settings.flow||e.flow||"auto",a=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,f=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:r,spread:i,orientation:n,flow:s,viewport:a,minSpreadWidth:l,direction:f},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Zn(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(ve.LAYOUT.UPDATED,(t,r)=>{this.emit(ve.RENDITION.LAYOUT,t,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then((function(i){let n=this.located(i);!n||!n.start||!n.end||(this.location=n,this.emit(ve.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(ve.RENDITION.RELOCATED,this.location))}).bind(this));else if(r){let i=this.located(r);if(!i||!i.start||!i.end)return;this.location=i,this.emit(ve.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(ve.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],r=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},n=this.book.locations.locationFromCfi(t.mapping.start),s=this.book.locations.locationFromCfi(r.mapping.end);n!=null&&(i.start.location=n,i.start.percentage=this.book.locations.percentageFromLocation(n)),s!=null&&(i.end.location=s,i.end.percentage=this.book.locations.percentageFromLocation(s));let a=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(r.mapping.end);return a!=-1&&(i.start.page=a),l!=-1&&(i.end.page=l),r.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){lr.forEach(t=>{e.on(t,r=>this.triggerViewEvent(r,e))}),e.on(ve.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(ve.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,r){this.emit(ve.RENDITION.MARK_CLICKED,e,t,r)}getRange(e,t){var r=new ze(e),i=this.manager.visible().filter(function(n){if(r.spinePos===n.index)return!0});if(i.length)return i[0].contents.range(r,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let t=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,s){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(ve.CONTENTS.LINK_CLICKED,t=>{let r=this.book.path.relative(t);this.display(r)})}injectStylesheet(e,t){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,t){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,t){let r=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),r&&i.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(i)}}St(Ci.prototype);var fi={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Tn;function Ra(){return Tn||(Tn=1,(function(m,e){(function(t){m.exports=t()})(function(){return(function t(r,i,n){function s(f,p){if(!i[f]){if(!r[f]){var c=typeof It=="function"&&It;if(!p&&c)return c(f,!0);if(a)return a(f,!0);var _=new Error("Cannot find module '"+f+"'");throw _.code="MODULE_NOT_FOUND",_}var y=i[f]={exports:{}};r[f][0].call(y.exports,function(O){var E=r[f][1][O];return s(E||O)},y,y.exports,t,r,i,n)}return i[f].exports}for(var a=typeof It=="function"&&It,l=0;l<n.length;l++)s(n[l]);return s})({1:[function(t,r,i){var n=t("./utils"),s=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var f=[],p,c,_,y,O,E,h,v=0,g=l.length,C=g,B=n.getTypeOf(l)!=="string";v<l.length;)C=g-v,B?(p=l[v++],c=v<g?l[v++]:0,_=v<g?l[v++]:0):(p=l.charCodeAt(v++),c=v<g?l.charCodeAt(v++):0,_=v<g?l.charCodeAt(v++):0),y=p>>2,O=(p&3)<<4|c>>4,E=C>1?(c&15)<<2|_>>6:64,h=C>2?_&63:64,f.push(a.charAt(y)+a.charAt(O)+a.charAt(E)+a.charAt(h));return f.join("")},i.decode=function(l){var f,p,c,_,y,O,E,h=0,v=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var C=l.length*3/4;if(l.charAt(l.length-1)===a.charAt(64)&&C--,l.charAt(l.length-2)===a.charAt(64)&&C--,C%1!==0)throw new Error("Invalid base64 input, bad content length.");var B;for(s.uint8array?B=new Uint8Array(C|0):B=new Array(C|0);h<l.length;)_=a.indexOf(l.charAt(h++)),y=a.indexOf(l.charAt(h++)),O=a.indexOf(l.charAt(h++)),E=a.indexOf(l.charAt(h++)),f=_<<2|y>>4,p=(y&15)<<4|O>>2,c=(O&3)<<6|E,B[v++]=f,O!==64&&(B[v++]=p),E!==64&&(B[v++]=c);return B}},{"./support":30,"./utils":32}],2:[function(t,r,i){var n=t("./external"),s=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function f(p,c,_,y,O){this.compressedSize=p,this.uncompressedSize=c,this.crc32=_,this.compression=y,this.compressedContent=O}f.prototype={getContentWorker:function(){var p=new s(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),c=this;return p.on("end",function(){if(this.streamInfo.data_length!==c.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new s(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(p,c,_){return p.pipe(new a).pipe(new l("uncompressedSize")).pipe(c.compressWorker(_)).pipe(new l("compressedSize")).withStreamInfo("compression",c)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var n=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var n=t("./utils");function s(){for(var p,c=[],_=0;_<256;_++){p=_;for(var y=0;y<8;y++)p=p&1?3988292384^p>>>1:p>>>1;c[_]=p}return c}var a=s();function l(p,c,_,y){var O=a,E=y+_;p=p^-1;for(var h=y;h<E;h++)p=p>>>8^O[(p^c[h])&255];return p^-1}function f(p,c,_,y){var O=a,E=y+_;p=p^-1;for(var h=y;h<E;h++)p=p>>>8^O[(p^c.charCodeAt(h))&255];return p^-1}r.exports=function(c,_){if(typeof c>"u"||!c.length)return 0;var y=n.getTypeOf(c)!=="string";return y?l(_|0,c,c.length,0):f(_|0,c,c.length,0)}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var n=null;typeof Promise<"u"?n=Promise:n=t("lie"),r.exports={Promise:n}},{lie:37}],7:[function(t,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),f=n?"uint8array":"array";i.magic="\b\0";function p(c,_){l.call(this,"FlateWorker/"+c),this._pako=null,this._pakoAction=c,this._pakoOptions=_,this.meta={}}a.inherits(p,l),p.prototype.processChunk=function(c){this.meta=c.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(f,c.data),!1)},p.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var c=this;this._pako.onData=function(_){c.push({data:_,meta:c.meta})}},i.compressWorker=function(c){return new p("Deflate",c)},i.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){var n=t("../utils"),s=t("../stream/GenericWorker"),a=t("../utf8"),l=t("../crc32"),f=t("../signature"),p=function(v,g){var C="",B;for(B=0;B<g;B++)C+=String.fromCharCode(v&255),v=v>>>8;return C},c=function(v,g){var C=v;return v||(C=g?16893:33204),(C&65535)<<16},_=function(v){return(v||0)&63},y=function(v,g,C,B,b,T){var N=v.file,R=v.compression,k=T!==a.utf8encode,I=n.transformTo("string",T(N.name)),X=n.transformTo("string",a.utf8encode(N.name)),H=N.comment,$=n.transformTo("string",T(H)),se=n.transformTo("string",a.utf8encode(H)),re=X.length!==N.name.length,ge=se.length!==H.length,ee,Q,fe="",Ae="",le="",pe=N.dir,Ne=N.date,De={crc32:0,compressedSize:0,uncompressedSize:0};(!g||C)&&(De.crc32=v.crc32,De.compressedSize=v.compressedSize,De.uncompressedSize=v.uncompressedSize);var Oe=0;g&&(Oe|=8),!k&&(re||ge)&&(Oe|=2048);var Ge=0,qe=0;pe&&(Ge|=16),b==="UNIX"?(qe=798,Ge|=c(N.unixPermissions,pe)):(qe=20,Ge|=_(N.dosPermissions)),ee=Ne.getUTCHours(),ee=ee<<6,ee=ee|Ne.getUTCMinutes(),ee=ee<<5,ee=ee|Ne.getUTCSeconds()/2,Q=Ne.getUTCFullYear()-1980,Q=Q<<4,Q=Q|Ne.getUTCMonth()+1,Q=Q<<5,Q=Q|Ne.getUTCDate(),re&&(Ae=p(1,1)+p(l(I),4)+X,fe+="up"+p(Ae.length,2)+Ae),ge&&(le=p(1,1)+p(l($),4)+se,fe+="uc"+p(le.length,2)+le);var Ce="";Ce+=`
\0`,Ce+=p(Oe,2),Ce+=R.magic,Ce+=p(ee,2),Ce+=p(Q,2),Ce+=p(De.crc32,4),Ce+=p(De.compressedSize,4),Ce+=p(De.uncompressedSize,4),Ce+=p(I.length,2),Ce+=p(fe.length,2);var Ue=f.LOCAL_FILE_HEADER+Ce+I+fe,We=f.CENTRAL_FILE_HEADER+p(qe,2)+Ce+p($.length,2)+"\0\0\0\0"+p(Ge,4)+p(B,4)+I+fe+$;return{fileRecord:Ue,dirRecord:We}},O=function(v,g,C,B,b){var T="",N=n.transformTo("string",b(B));return T=f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(v,2)+p(v,2)+p(g,4)+p(C,4)+p(N.length,2)+N,T},E=function(v){var g="";return g=f.DATA_DESCRIPTOR+p(v.crc32,4)+p(v.compressedSize,4)+p(v.uncompressedSize,4),g};function h(v,g,C,B){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=C,this.encodeFileName=B,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(h,s),h.prototype.push=function(v){var g=v.meta.percent||0,C=this.entriesCount,B=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,s.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:C?(g+100*(C-B-1))/C:100}}))},h.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var g=this.streamFiles&&!v.file.dir;if(g){var C=y(v,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:C.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(v){this.accumulate=!1;var g=this.streamFiles&&!v.file.dir,C=y(v,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(C.dirRecord),g)this.push({data:E(v),meta:{percent:100}});else for(this.push({data:C.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var v=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var C=this.bytesWritten-v,B=O(this.dirRecords.length,C,v,this.zipComment,this.encodeFileName);this.push({data:B,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(v){this._sources.push(v);var g=this;return v.on("data",function(C){g.processChunk(C)}),v.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),v.on("error",function(C){g.error(C)}),this},h.prototype.resume=function(){if(!s.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},h.prototype.error=function(v){var g=this._sources;if(!s.prototype.error.call(this,v))return!1;for(var C=0;C<g.length;C++)try{g[C].error(v)}catch{}return!0},h.prototype.lock=function(){s.prototype.lock.call(this);for(var v=this._sources,g=0;g<v.length;g++)v[g].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var n=t("../compressions"),s=t("./ZipFileWorker"),a=function(l,f){var p=l||f,c=n[p];if(!c)throw new Error(p+" is not a valid compression method !");return c};i.generateWorker=function(l,f,p){var c=new s(f.streamFiles,p,f.platform,f.encodeFileName),_=0;try{l.forEach(function(y,O){_++;var E=a(O.options.compression,f.compression),h=O.options.compressionOptions||f.compressionOptions||{},v=O.dir,g=O.date;O._compressWorker(E,h).withStreamInfo("file",{name:y,dir:v,date:g,comment:O.comment||"",unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions}).pipe(c)}),c.entriesCount=_}catch(y){c.error(y)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new n;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}n.prototype=t("./object"),n.prototype.loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(s,a){return new n().loadAsync(s,a)},n.external=t("./external"),r.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var n=t("./utils"),s=t("./external"),a=t("./utf8"),l=t("./zipEntries"),f=t("./stream/Crc32Probe"),p=t("./nodejsUtils");function c(_){return new s.Promise(function(y,O){var E=_.decompressed.getContentWorker().pipe(new f);E.on("error",function(h){O(h)}).on("end",function(){E.streamInfo.crc32!==_.decompressed.crc32?O(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}r.exports=function(_,y){var O=this;return y=n.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),p.isNode&&p.isStream(_)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",_,!0,y.optimizedBinaryString,y.base64).then(function(E){var h=new l(y);return h.load(E),h}).then(function(h){var v=[s.Promise.resolve(h)],g=h.files;if(y.checkCRC32)for(var C=0;C<g.length;C++)v.push(c(g[C]));return s.Promise.all(v)}).then(function(h){for(var v=h.shift(),g=v.files,C=0;C<g.length;C++){var B=g[C],b=B.fileNameStr,T=n.resolve(B.fileNameStr);O.file(T,B.decompressed,{binary:!0,optimizedBinaryString:!0,date:B.date,dir:B.dir,comment:B.fileCommentStr.length?B.fileCommentStr:null,unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions,createFolders:y.createFolders}),B.dir||(O.file(T).unsafeOriginalName=b)}return v.zipComment.length&&(O.comment=v.zipComment),O})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var n=t("../utils"),s=t("../stream/GenericWorker");function a(l,f){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(f)}n.inherits(a,s),a.prototype._bindStream=function(l){var f=this;this._stream=l,l.pause(),l.on("data",function(p){f.push({data:p,meta:{percent:0}})}).on("error",function(p){f.isPaused?this.generatedError=p:f.error(p)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},a.prototype.pause=function(){return s.prototype.pause.call(this)?(this._stream.pause(),!0):!1},a.prototype.resume=function(){return s.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var n=t("readable-stream").Readable,s=t("../utils");s.inherits(a,n);function a(l,f,p){n.call(this,f),this._helper=l;var c=this;l.on("data",function(_,y){c.push(_)||c._helper.pause(),p&&p(y)}).on("error",function(_){c.emit("error",_)}).on("end",function(){c.push(null)})}a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,s);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,s)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var s=new Buffer(n);return s.fill(0),s},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,r,i){var n=t("./utf8"),s=t("./utils"),a=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),f=t("./defaults"),p=t("./compressedObject"),c=t("./zipObject"),_=t("./generate"),y=t("./nodejsUtils"),O=t("./nodejs/NodejsStreamInputAdapter"),E=function(b,T,N){var R=s.getTypeOf(T),k,I=s.extend(N||{},f);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&I.unixPermissions&16384&&(I.dir=!0),I.dosPermissions&&I.dosPermissions&16&&(I.dir=!0),I.dir&&(b=v(b)),I.createFolders&&(k=h(b))&&g.call(this,k,!0);var X=R==="string"&&I.binary===!1&&I.base64===!1;(!N||typeof N.binary>"u")&&(I.binary=!X);var H=T instanceof p&&T.uncompressedSize===0;(H||I.dir||!T||T.length===0)&&(I.base64=!1,I.binary=!0,T="",I.compression="STORE",R="string");var $=null;T instanceof p||T instanceof a?$=T:y.isNode&&y.isStream(T)?$=new O(b,T):$=s.prepareContent(b,T,I.binary,I.optimizedBinaryString,I.base64);var se=new c(b,$,I);this.files[b]=se},h=function(b){b.slice(-1)==="/"&&(b=b.substring(0,b.length-1));var T=b.lastIndexOf("/");return T>0?b.substring(0,T):""},v=function(b){return b.slice(-1)!=="/"&&(b+="/"),b},g=function(b,T){return T=typeof T<"u"?T:f.createFolders,b=v(b),this.files[b]||E.call(this,b,null,{dir:!0,createFolders:T}),this.files[b]};function C(b){return Object.prototype.toString.call(b)==="[object RegExp]"}var B={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(b){var T,N,R;for(T in this.files)R=this.files[T],N=T.slice(this.root.length,T.length),N&&T.slice(0,this.root.length)===this.root&&b(N,R)},filter:function(b){var T=[];return this.forEach(function(N,R){b(N,R)&&T.push(R)}),T},file:function(b,T,N){if(arguments.length===1)if(C(b)){var R=b;return this.filter(function(I,X){return!X.dir&&R.test(I)})}else{var k=this.files[this.root+b];return k&&!k.dir?k:null}else b=this.root+b,E.call(this,b,T,N);return this},folder:function(b){if(!b)return this;if(C(b))return this.filter(function(k,I){return I.dir&&b.test(k)});var T=this.root+b,N=g.call(this,T),R=this.clone();return R.root=N.name,R},remove:function(b){b=this.root+b;var T=this.files[b];if(T||(b.slice(-1)!=="/"&&(b+="/"),T=this.files[b]),T&&!T.dir)delete this.files[b];else for(var N=this.filter(function(k,I){return I.name.slice(0,b.length)===b}),R=0;R<N.length;R++)delete this.files[N[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(b){var T,N={};try{if(N=s.extend(b||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),N.type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");s.checkSupport(N.type),(N.platform==="darwin"||N.platform==="freebsd"||N.platform==="linux"||N.platform==="sunos")&&(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var R=N.comment||this.comment||"";T=_.generateWorker(this,N,R)}catch(k){T=new a("error"),T.error(k)}return new l(T,N.type||"string",N.mimeType)},generateAsync:function(b,T){return this.generateInternalStream(b).accumulate(T)},generateNodeStream:function(b,T){return b=b||{},b.type||(b.type="nodebuffer"),this.generateInternalStream(b).toNodejsStream(T)}};r.exports=B},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var n=t("./DataReader"),s=t("../utils");function a(l){n.call(this,l);for(var f=0;f<this.data.length;f++)l[f]=l[f]&255}s.inherits(a,n),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var f=l.charCodeAt(0),p=l.charCodeAt(1),c=l.charCodeAt(2),_=l.charCodeAt(3),y=this.length-4;y>=0;--y)if(this.data[y]===f&&this.data[y+1]===p&&this.data[y+2]===c&&this.data[y+3]===_)return y-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var f=l.charCodeAt(0),p=l.charCodeAt(1),c=l.charCodeAt(2),_=l.charCodeAt(3),y=this.readData(4);return f===y[0]&&p===y[1]&&c===y[2]&&_===y[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var n=t("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l=0,f;for(this.checkOffset(a),f=this.index+a-1;f>=this.index;f--)l=(l<<8)+this.byteAt(f);return this.index+=a,l},readString:function(a){return n.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}},r.exports=s},{"../utils":32}],19:[function(t,r,i){var n=t("./Uint8ArrayReader"),s=t("../utils");function a(l){n.call(this,l)}s.inherits(a,n),a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var n=t("./DataReader"),s=t("../utils");function a(l){n.call(this,l)}s.inherits(a,n),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){var f=this.readData(4);return l===f},a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var n=t("./ArrayReader"),s=t("../utils");function a(l){n.call(this,l)}s.inherits(a,n),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var n=t("../utils"),s=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),f=t("./NodeBufferReader"),p=t("./Uint8ArrayReader");r.exports=function(c){var _=n.getTypeOf(c);return n.checkSupport(_),_==="string"&&!s.uint8array?new l(c):_==="nodebuffer"?new f(c):s.uint8array?new p(n.transformTo("uint8array",c)):new a(n.transformTo("array",c))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var n=t("./GenericWorker"),s=t("../utils");function a(l){n.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,n),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var n=t("./GenericWorker"),s=t("../crc32"),a=t("../utils");function l(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a.inherits(l,n),l.prototype.processChunk=function(f){this.streamInfo.crc32=s(f.data,this.streamInfo.crc32||0),this.push(f)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var n=t("../utils"),s=t("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}n.inherits(a,s),a.prototype.processChunk=function(l){if(l){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+l.data.length}s.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var n=t("../utils"),s=t("./GenericWorker"),a=16*1024;function l(f){s.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(c){p.dataIsReady=!0,p.data=c,p.max=c&&c.length||0,p.type=n.getTypeOf(c),p.isPaused||p._tickAndRepeat()},function(c){p.error(c)})}n.inherits(l,s),l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return s.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=a,p=null,c=Math.min(this.max,this.index+f);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,c);break;case"uint8array":p=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":p=this.data.slice(this.index,c);break}return this.index=c,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function n(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return this.isFinished?!1:(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var s=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=n},{}],29:[function(t,r,i){var n=t("../utils"),s=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),f=t("../support"),p=t("../external"),c=null;if(f.nodestream)try{c=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(h,v,g){switch(h){case"blob":return n.newBlob(n.transformTo("arraybuffer",v),g);case"base64":return l.encode(v);default:return n.transformTo(h,v)}}function y(h,v){var g,C=0,B=null,b=0;for(g=0;g<v.length;g++)b+=v[g].length;switch(h){case"string":return v.join("");case"array":return Array.prototype.concat.apply([],v);case"uint8array":for(B=new Uint8Array(b),g=0;g<v.length;g++)B.set(v[g],C),C+=v[g].length;return B;case"nodebuffer":return Buffer.concat(v);default:throw new Error("concat : unsupported type '"+h+"'")}}function O(h,v){return new p.Promise(function(g,C){var B=[],b=h._internalType,T=h._outputType,N=h._mimeType;h.on("data",function(R,k){B.push(R),v&&v(k)}).on("error",function(R){B=[],C(R)}).on("end",function(){try{var R=_(T,y(b,B),N);g(R)}catch(k){C(k)}B=[]}).resume()})}function E(h,v,g){var C=v;switch(v){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string";break}try{this._internalType=C,this._outputType=v,this._mimeType=g,n.checkSupport(C),this._worker=h.pipe(new s(C)),h.lock()}catch(B){this._worker=new a("error"),this._worker.error(B)}}E.prototype={accumulate:function(h){return O(this,h)},on:function(h,v){var g=this;return h==="data"?this._worker.on(h,function(C){v.call(g,C.data,C.meta)}):this._worker.on(h,function(){n.delay(v,arguments,g)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:this._outputType!=="nodebuffer"},h)}},r.exports=E},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var s=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,a=new s;a.append(n),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var n=t("./utils"),s=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),f=new Array(256),p=0;p<256;p++)f[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;f[254]=f[254]=1;var c=function(h){var v,g,C,B,b,T=h.length,N=0;for(B=0;B<T;B++)g=h.charCodeAt(B),(g&64512)===55296&&B+1<T&&(C=h.charCodeAt(B+1),(C&64512)===56320&&(g=65536+(g-55296<<10)+(C-56320),B++)),N+=g<128?1:g<2048?2:g<65536?3:4;for(s.uint8array?v=new Uint8Array(N):v=new Array(N),b=0,B=0;b<N;B++)g=h.charCodeAt(B),(g&64512)===55296&&B+1<T&&(C=h.charCodeAt(B+1),(C&64512)===56320&&(g=65536+(g-55296<<10)+(C-56320),B++)),g<128?v[b++]=g:g<2048?(v[b++]=192|g>>>6,v[b++]=128|g&63):g<65536?(v[b++]=224|g>>>12,v[b++]=128|g>>>6&63,v[b++]=128|g&63):(v[b++]=240|g>>>18,v[b++]=128|g>>>12&63,v[b++]=128|g>>>6&63,v[b++]=128|g&63);return v},_=function(h,v){var g;for(v=v||h.length,v>h.length&&(v=h.length),g=v-1;g>=0&&(h[g]&192)===128;)g--;return g<0||g===0?v:g+f[h[g]]>v?g:v},y=function(h){var v,g,C,B,b=h.length,T=new Array(b*2);for(g=0,v=0;v<b;){if(C=h[v++],C<128){T[g++]=C;continue}if(B=f[C],B>4){T[g++]=65533,v+=B-1;continue}for(C&=B===2?31:B===3?15:7;B>1&&v<b;)C=C<<6|h[v++]&63,B--;if(B>1){T[g++]=65533;continue}C<65536?T[g++]=C:(C-=65536,T[g++]=55296|C>>10&1023,T[g++]=56320|C&1023)}return T.length!==g&&(T.subarray?T=T.subarray(0,g):T.length=g),n.applyFromCharCode(T)};i.utf8encode=function(v){return s.nodebuffer?a.newBufferFrom(v,"utf-8"):c(v)},i.utf8decode=function(v){return s.nodebuffer?n.transformTo("nodebuffer",v).toString("utf-8"):(v=n.transformTo(s.uint8array?"uint8array":"array",v),y(v))};function O(){l.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(O,l),O.prototype.processChunk=function(h){var v=n.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var g=v;v=new Uint8Array(g.length+this.leftOver.length),v.set(this.leftOver,0),v.set(g,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var C=_(v),B=v;C!==v.length&&(s.uint8array?(B=v.subarray(0,C),this.leftOver=v.subarray(C,v.length)):(B=v.slice(0,C),this.leftOver=v.slice(C,v.length))),this.push({data:i.utf8decode(B),meta:h.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=O;function E(){l.call(this,"utf-8 encode")}n.inherits(E,l),E.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var n=t("./support"),s=t("./base64"),a=t("./nodejsUtils"),l=t("./external");t("setimmediate");function f(h){var v=null;return n.uint8array?v=new Uint8Array(h.length):v=new Array(h.length),c(h,v)}i.newBlob=function(h,v){i.checkSupport("blob");try{return new Blob([h],{type:v})}catch{try{var g=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,C=new g;return C.append(h),C.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};function p(h){return h}function c(h,v){for(var g=0;g<h.length;++g)v[g]=h.charCodeAt(g)&255;return v}var _={stringifyByChunk:function(h,v,g){var C=[],B=0,b=h.length;if(b<=g)return String.fromCharCode.apply(null,h);for(;B<b;)v==="array"||v==="nodebuffer"?C.push(String.fromCharCode.apply(null,h.slice(B,Math.min(B+g,b)))):C.push(String.fromCharCode.apply(null,h.subarray(B,Math.min(B+g,b)))),B+=g;return C.join("")},stringifyByChar:function(h){for(var v="",g=0;g<h.length;g++)v+=String.fromCharCode(h[g]);return v},applyCanBeUsed:{uint8array:(function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function y(h){var v=65536,g=i.getTypeOf(h),C=!0;if(g==="uint8array"?C=_.applyCanBeUsed.uint8array:g==="nodebuffer"&&(C=_.applyCanBeUsed.nodebuffer),C)for(;v>1;)try{return _.stringifyByChunk(h,g,v)}catch{v=Math.floor(v/2)}return _.stringifyByChar(h)}i.applyFromCharCode=y;function O(h,v){for(var g=0;g<h.length;g++)v[g]=h[g];return v}var E={};E.string={string:p,array:function(h){return c(h,new Array(h.length))},arraybuffer:function(h){return E.string.uint8array(h).buffer},uint8array:function(h){return c(h,new Uint8Array(h.length))},nodebuffer:function(h){return c(h,a.allocBuffer(h.length))}},E.array={string:y,array:p,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(h)}},E.arraybuffer={string:function(h){return y(new Uint8Array(h))},array:function(h){return O(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:p,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(new Uint8Array(h))}},E.uint8array={string:y,array:function(h){return O(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:p,nodebuffer:function(h){return a.newBufferFrom(h)}},E.nodebuffer={string:y,array:function(h){return O(h,new Array(h.length))},arraybuffer:function(h){return E.nodebuffer.uint8array(h).buffer},uint8array:function(h){return O(h,new Uint8Array(h.length))},nodebuffer:p},i.transformTo=function(h,v){if(v||(v=""),!h)return v;i.checkSupport(h);var g=i.getTypeOf(v),C=E[g][h](v);return C},i.resolve=function(h){for(var v=h.split("/"),g=[],C=0;C<v.length;C++){var B=v[C];B==="."||B===""&&C!==0&&C!==v.length-1||(B===".."?g.pop():g.push(B))}return g.join("/")},i.getTypeOf=function(h){if(typeof h=="string")return"string";if(Object.prototype.toString.call(h)==="[object Array]")return"array";if(n.nodebuffer&&a.isBuffer(h))return"nodebuffer";if(n.uint8array&&h instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&h instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(h){var v=n[h.toLowerCase()];if(!v)throw new Error(h+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(h){var v="",g,C;for(C=0;C<(h||"").length;C++)g=h.charCodeAt(C),v+="\\x"+(g<16?"0":"")+g.toString(16).toUpperCase();return v},i.delay=function(h,v,g){setImmediate(function(){h.apply(g||null,v||[])})},i.inherits=function(h,v){var g=function(){};g.prototype=v.prototype,h.prototype=new g},i.extend=function(){var h={},v,g;for(v=0;v<arguments.length;v++)for(g in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],g)&&typeof h[g]>"u"&&(h[g]=arguments[v][g]);return h},i.prepareContent=function(h,v,g,C,B){var b=l.Promise.resolve(v).then(function(T){var N=n.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1);return N&&typeof FileReader<"u"?new l.Promise(function(R,k){var I=new FileReader;I.onload=function(X){R(X.target.result)},I.onerror=function(X){k(X.target.error)},I.readAsArrayBuffer(T)}):T});return b.then(function(T){var N=i.getTypeOf(T);return N?(N==="arraybuffer"?T=i.transformTo("uint8array",T):N==="string"&&(B?T=s.decode(T):g&&C!==!0&&(T=f(T))),T):l.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var n=t("./reader/readerFor"),s=t("./utils"),a=t("./signature"),l=t("./zipEntry"),f=t("./support");function p(c){this.files=[],this.loadOptions=c}p.prototype={checkSignature:function(c){if(!this.reader.readAndCheckSignature(c)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(_)+", expected "+s.pretty(c)+")")}},isSignature:function(c,_){var y=this.reader.index;this.reader.setIndex(c);var O=this.reader.readString(4),E=O===_;return this.reader.setIndex(y),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var c=this.reader.readData(this.zipCommentLength),_=f.uint8array?"uint8array":"array",y=s.transformTo(_,c);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var c=this.zip64EndOfCentralSize-44,_=0,y,O,E;_<c;)y=this.reader.readInt(2),O=this.reader.readInt(4),E=this.reader.readData(O),this.zip64ExtensibleData[y]={id:y,length:O,value:E}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var c,_;for(c=0;c<this.files.length;c++)_=this.files[c],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)c=new l({zip64:this.zip64},this.loadOptions),c.readCentralPart(this.reader),this.files.push(c);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var c=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(c<0){var _=!this.isSignature(0,a.LOCAL_FILE_HEADER);throw _?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(c);var y=c;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,c=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),c<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(c),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var O=this.centralDirOffset+this.centralDirSize;this.zip64&&(O+=20,O+=12+this.zip64EndOfCentralSize);var E=y-O;if(E>0)this.isSignature(y,a.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(c){this.reader=n(c)},load:function(c){this.prepareReader(c),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var n=t("./reader/readerFor"),s=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),f=t("./utf8"),p=t("./compressions"),c=t("./support"),_=0,y=3,O=function(h){for(var v in p)if(Object.prototype.hasOwnProperty.call(p,v)&&p[v].magic===h)return p[v];return null};function E(h,v){this.options=h,this.loadOptions=v}E.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(h){var v,g;if(h.skip(22),this.fileNameLength=h.readInt(2),g=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(v=O(this.compressionMethod),v===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var v=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(v),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),h===_&&(this.dosPermissions=this.externalFileAttributes&63),h===y&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var v=h.index+this.extraFieldsLength,g,C,B;for(this.extraFields||(this.extraFields={});h.index+4<v;)g=h.readInt(2),C=h.readInt(2),B=h.readData(C),this.extraFields[g]={id:g,length:C,value:B};h.setIndex(v)},handleUTF8:function(){var h=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var g=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var C=this.findExtraFieldUnicodeComment();if(C!==null)this.fileCommentStr=C;else{var B=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(B)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var v=n(h.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var v=n(h.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null}},r.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),a=t("./utf8"),l=t("./compressedObject"),f=t("./stream/GenericWorker"),p=function(O,E,h){this.name=O,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=E,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}};p.prototype={internalStream:function(O){var E=null,h="string";try{if(!O)throw new Error("No output type specified.");h=O.toLowerCase();var v=h==="string"||h==="text";(h==="binarystring"||h==="text")&&(h="string"),E=this._decompressWorker();var g=!this._dataBinary;g&&!v&&(E=E.pipe(new a.Utf8EncodeWorker)),!g&&v&&(E=E.pipe(new a.Utf8DecodeWorker))}catch(C){E=new f("error"),E.error(C)}return new n(E,h,"")},async:function(O,E){return this.internalStream(O).accumulate(E)},nodeStream:function(O,E){return this.internalStream(O||"nodebuffer").toNodejsStream(E)},_compressWorker:function(O,E){if(this._data instanceof l&&this._data.compression.magic===O.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new a.Utf8EncodeWorker)),l.createWorkerFrom(h,O,E)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof f?this._data:new s(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<c.length;y++)p.prototype[c[y]]=_;r.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,a;if(s){var l=0,f=new s(O),p=n.document.createTextNode("");f.observe(p,{characterData:!0}),a=function(){p.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var c=new n.MessageChannel;c.port1.onmessage=O,a=function(){c.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?a=function(){var h=n.document.createElement("script");h.onreadystatechange=function(){O(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},n.document.documentElement.appendChild(h)}:a=function(){setTimeout(O,0)};var _,y=[];function O(){_=!0;for(var h,v,g=y.length;g;){for(v=y,y=[],h=-1;++h<g;)v[h]();g=y.length}_=!1}r.exports=E;function E(h){y.push(h)===1&&!_&&a()}}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var n=t("immediate");function s(){}var a={},l=["REJECTED"],f=["FULFILLED"],p=["PENDING"];r.exports=c;function c(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,b!==s&&E(this,b)}c.prototype.finally=function(b){if(typeof b!="function")return this;var T=this.constructor;return this.then(N,R);function N(k){function I(){return k}return T.resolve(b()).then(I)}function R(k){function I(){throw k}return T.resolve(b()).then(I)}},c.prototype.catch=function(b){return this.then(null,b)},c.prototype.then=function(b,T){if(typeof b!="function"&&this.state===f||typeof T!="function"&&this.state===l)return this;var N=new this.constructor(s);if(this.state!==p){var R=this.state===f?b:T;y(N,R,this.outcome)}else this.queue.push(new _(N,b,T));return N};function _(b,T,N){this.promise=b,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}_.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},_.prototype.otherCallFulfilled=function(b){y(this.promise,this.onFulfilled,b)},_.prototype.callRejected=function(b){a.reject(this.promise,b)},_.prototype.otherCallRejected=function(b){y(this.promise,this.onRejected,b)};function y(b,T,N){n(function(){var R;try{R=T(N)}catch(k){return a.reject(b,k)}R===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,R)})}a.resolve=function(b,T){var N=h(O,T);if(N.status==="error")return a.reject(b,N.value);var R=N.value;if(R)E(b,R);else{b.state=f,b.outcome=T;for(var k=-1,I=b.queue.length;++k<I;)b.queue[k].callFulfilled(T)}return b},a.reject=function(b,T){b.state=l,b.outcome=T;for(var N=-1,R=b.queue.length;++N<R;)b.queue[N].callRejected(T);return b};function O(b){var T=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof T=="function")return function(){T.apply(b,arguments)}}function E(b,T){var N=!1;function R(H){N||(N=!0,a.reject(b,H))}function k(H){N||(N=!0,a.resolve(b,H))}function I(){T(k,R)}var X=h(I);X.status==="error"&&R(X.value)}function h(b,T){var N={};try{N.value=b(T),N.status="success"}catch(R){N.status="error",N.value=R}return N}c.resolve=v;function v(b){return b instanceof this?b:a.resolve(new this(s),b)}c.reject=g;function g(b){var T=new this(s);return a.reject(T,b)}c.all=C;function C(b){var T=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=b.length,R=!1;if(!N)return this.resolve([]);for(var k=new Array(N),I=0,X=-1,H=new this(s);++X<N;)$(b[X],X);return H;function $(se,re){T.resolve(se).then(ge,function(ee){R||(R=!0,a.reject(H,ee))});function ge(ee){k[re]=ee,++I===N&&!R&&(R=!0,a.resolve(H,k))}}}c.race=B;function B(b){var T=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=b.length,R=!1;if(!N)return this.resolve([]);for(var k=-1,I=new this(s);++k<N;)X(b[k]);return I;function X(H){T.resolve(H).then(function($){R||(R=!0,a.resolve(I,$))},function($){R||(R=!0,a.reject(I,$))})}}},{immediate:36}],38:[function(t,r,i){var n=t("./lib/utils/common").assign,s=t("./lib/deflate"),a=t("./lib/inflate"),l=t("./lib/zlib/constants"),f={};n(f,s,a,l),r.exports=f},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var n=t("./zlib/deflate"),s=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),f=t("./zlib/zstream"),p=Object.prototype.toString,c=0,_=4,y=0,O=1,E=2,h=-1,v=0,g=8;function C(N){if(!(this instanceof C))return new C(N);this.options=s.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},N||{});var R=this.options;R.raw&&R.windowBits>0?R.windowBits=-R.windowBits:R.gzip&&R.windowBits>0&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=n.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(k!==y)throw new Error(l[k]);if(R.header&&n.deflateSetHeader(this.strm,R.header),R.dictionary){var I;if(typeof R.dictionary=="string"?I=a.string2buf(R.dictionary):p.call(R.dictionary)==="[object ArrayBuffer]"?I=new Uint8Array(R.dictionary):I=R.dictionary,k=n.deflateSetDictionary(this.strm,I),k!==y)throw new Error(l[k]);this._dict_set=!0}}C.prototype.push=function(N,R){var k=this.strm,I=this.options.chunkSize,X,H;if(this.ended)return!1;H=R===~~R?R:R===!0?_:c,typeof N=="string"?k.input=a.string2buf(N):p.call(N)==="[object ArrayBuffer]"?k.input=new Uint8Array(N):k.input=N,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new s.Buf8(I),k.next_out=0,k.avail_out=I),X=n.deflate(k,H),X!==O&&X!==y)return this.onEnd(X),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(H===_||H===E))&&(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(k.output,k.next_out))):this.onData(s.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&X!==O);return H===_?(X=n.deflateEnd(this.strm),this.onEnd(X),this.ended=!0,X===y):(H===E&&(this.onEnd(y),k.avail_out=0),!0)},C.prototype.onData=function(N){this.chunks.push(N)},C.prototype.onEnd=function(N){N===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg};function B(N,R){var k=new C(R);if(k.push(N,!0),k.err)throw k.msg||l[k.err];return k.result}function b(N,R){return R=R||{},R.raw=!0,B(N,R)}function T(N,R){return R=R||{},R.gzip=!0,B(N,R)}i.Deflate=C,i.deflate=B,i.deflateRaw=b,i.gzip=T},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var n=t("./zlib/inflate"),s=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),f=t("./zlib/messages"),p=t("./zlib/zstream"),c=t("./zlib/gzheader"),_=Object.prototype.toString;function y(h){if(!(this instanceof y))return new y(h);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},h||{});var v=this.options;v.raw&&v.windowBits>=0&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),v.windowBits>=0&&v.windowBits<16&&!(h&&h.windowBits)&&(v.windowBits+=32),v.windowBits>15&&v.windowBits<48&&(v.windowBits&15)===0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var g=n.inflateInit2(this.strm,v.windowBits);if(g!==l.Z_OK)throw new Error(f[g]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}y.prototype.push=function(h,v){var g=this.strm,C=this.options.chunkSize,B=this.options.dictionary,b,T,N,R,k,I,X=!1;if(this.ended)return!1;T=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof h=="string"?g.input=a.binstring2buf(h):_.call(h)==="[object ArrayBuffer]"?g.input=new Uint8Array(h):g.input=h,g.next_in=0,g.avail_in=g.input.length;do{if(g.avail_out===0&&(g.output=new s.Buf8(C),g.next_out=0,g.avail_out=C),b=n.inflate(g,l.Z_NO_FLUSH),b===l.Z_NEED_DICT&&B&&(typeof B=="string"?I=a.string2buf(B):_.call(B)==="[object ArrayBuffer]"?I=new Uint8Array(B):I=B,b=n.inflateSetDictionary(this.strm,I)),b===l.Z_BUF_ERROR&&X===!0&&(b=l.Z_OK,X=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),this.ended=!0,!1;g.next_out&&(g.avail_out===0||b===l.Z_STREAM_END||g.avail_in===0&&(T===l.Z_FINISH||T===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(N=a.utf8border(g.output,g.next_out),R=g.next_out-N,k=a.buf2string(g.output,N),g.next_out=R,g.avail_out=C-R,R&&s.arraySet(g.output,g.output,N,R,0),this.onData(k)):this.onData(s.shrinkBuf(g.output,g.next_out))),g.avail_in===0&&g.avail_out===0&&(X=!0)}while((g.avail_in>0||g.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(T=l.Z_FINISH),T===l.Z_FINISH?(b=n.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):(T===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),g.avail_out=0),!0)},y.prototype.onData=function(h){this.chunks.push(h)},y.prototype.onEnd=function(h){h===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function O(h,v){var g=new y(v);if(g.push(h,!0),g.err)throw g.msg||f[g.err];return g.result}function E(h,v){return v=v||{},v.raw=!0,O(h,v)}i.Inflate=y,i.inflate=O,i.inflateRaw=E,i.ungzip=O},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var p=f.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var c in p)p.hasOwnProperty(c)&&(l[c]=p[c])}}return l},i.shrinkBuf=function(l,f){return l.length===f?l:l.subarray?l.subarray(0,f):(l.length=f,l)};var s={arraySet:function(l,f,p,c,_){if(f.subarray&&l.subarray){l.set(f.subarray(p,p+c),_);return}for(var y=0;y<c;y++)l[_+y]=f[p+y]},flattenChunks:function(l){var f,p,c,_,y,O;for(c=0,f=0,p=l.length;f<p;f++)c+=l[f].length;for(O=new Uint8Array(c),_=0,f=0,p=l.length;f<p;f++)y=l[f],O.set(y,_),_+=y.length;return O}},a={arraySet:function(l,f,p,c,_){for(var y=0;y<c;y++)l[_+y]=f[p+y]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(n)},{}],42:[function(t,r,i){var n=t("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new n.Buf8(256),f=0;f<256;f++)l[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;l[254]=l[254]=1,i.string2buf=function(c){var _,y,O,E,h,v=c.length,g=0;for(E=0;E<v;E++)y=c.charCodeAt(E),(y&64512)===55296&&E+1<v&&(O=c.charCodeAt(E+1),(O&64512)===56320&&(y=65536+(y-55296<<10)+(O-56320),E++)),g+=y<128?1:y<2048?2:y<65536?3:4;for(_=new n.Buf8(g),h=0,E=0;h<g;E++)y=c.charCodeAt(E),(y&64512)===55296&&E+1<v&&(O=c.charCodeAt(E+1),(O&64512)===56320&&(y=65536+(y-55296<<10)+(O-56320),E++)),y<128?_[h++]=y:y<2048?(_[h++]=192|y>>>6,_[h++]=128|y&63):y<65536?(_[h++]=224|y>>>12,_[h++]=128|y>>>6&63,_[h++]=128|y&63):(_[h++]=240|y>>>18,_[h++]=128|y>>>12&63,_[h++]=128|y>>>6&63,_[h++]=128|y&63);return _};function p(c,_){if(_<65537&&(c.subarray&&a||!c.subarray&&s))return String.fromCharCode.apply(null,n.shrinkBuf(c,_));for(var y="",O=0;O<_;O++)y+=String.fromCharCode(c[O]);return y}i.buf2binstring=function(c){return p(c,c.length)},i.binstring2buf=function(c){for(var _=new n.Buf8(c.length),y=0,O=_.length;y<O;y++)_[y]=c.charCodeAt(y);return _},i.buf2string=function(c,_){var y,O,E,h,v=_||c.length,g=new Array(v*2);for(O=0,y=0;y<v;){if(E=c[y++],E<128){g[O++]=E;continue}if(h=l[E],h>4){g[O++]=65533,y+=h-1;continue}for(E&=h===2?31:h===3?15:7;h>1&&y<v;)E=E<<6|c[y++]&63,h--;if(h>1){g[O++]=65533;continue}E<65536?g[O++]=E:(E-=65536,g[O++]=55296|E>>10&1023,g[O++]=56320|E&1023)}return p(g,O)},i.utf8border=function(c,_){var y;for(_=_||c.length,_>c.length&&(_=c.length),y=_-1;y>=0&&(c[y]&192)===128;)y--;return y<0||y===0?_:y+l[c[y]]>_?y:_}},{"./common":41}],43:[function(t,r,i){function n(s,a,l,f){for(var p=s&65535|0,c=s>>>16&65535|0,_=0;l!==0;){_=l>2e3?2e3:l,l-=_;do p=p+a[f++]|0,c=c+p|0;while(--_);p%=65521,c%=65521}return p|c<<16|0}r.exports=n},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){function n(){for(var l,f=[],p=0;p<256;p++){l=p;for(var c=0;c<8;c++)l=l&1?3988292384^l>>>1:l>>>1;f[p]=l}return f}var s=n();function a(l,f,p,c){var _=s,y=c+p;l^=-1;for(var O=c;O<y;O++)l=l>>>8^_[(l^f[O])&255];return l^-1}r.exports=a},{}],46:[function(t,r,i){var n=t("../utils/common"),s=t("./trees"),a=t("./adler32"),l=t("./crc32"),f=t("./messages"),p=0,c=1,_=3,y=4,O=5,E=0,h=1,v=-2,g=-3,C=-5,B=-1,b=1,T=2,N=3,R=4,k=0,I=2,X=8,H=9,$=15,se=8,re=29,ge=256,ee=ge+1+re,Q=30,fe=19,Ae=2*ee+1,le=15,pe=3,Ne=258,De=Ne+pe+1,Oe=32,Ge=42,qe=69,Ce=73,Ue=91,We=103,Te=113,Be=666,Ie=1,z=2,M=3,Y=4,te=3;function ie(u,q){return u.msg=f[q],q}function me(u){return(u<<1)-(u>4?9:0)}function Se(u){for(var q=u.length;--q>=0;)u[q]=0}function we(u){var q=u.state,G=q.pending;G>u.avail_out&&(G=u.avail_out),G!==0&&(n.arraySet(u.output,q.pending_buf,q.pending_out,G,u.next_out),u.next_out+=G,q.pending_out+=G,u.total_out+=G,u.avail_out-=G,q.pending-=G,q.pending===0&&(q.pending_out=0))}function Ee(u,q){s._tr_flush_block(u,u.block_start>=0?u.block_start:-1,u.strstart-u.block_start,q),u.block_start=u.strstart,we(u.strm)}function _e(u,q){u.pending_buf[u.pending++]=q}function Me(u,q){u.pending_buf[u.pending++]=q>>>8&255,u.pending_buf[u.pending++]=q&255}function Xe(u,q,G,w){var L=u.avail_in;return L>w&&(L=w),L===0?0:(u.avail_in-=L,n.arraySet(q,u.input,u.next_in,L,G),u.state.wrap===1?u.adler=a(u.adler,q,L,G):u.state.wrap===2&&(u.adler=l(u.adler,q,L,G)),u.next_in+=L,u.total_in+=L,L)}function st(u,q){var G=u.max_chain_length,w=u.strstart,L,Z,be=u.prev_length,ce=u.nice_match,de=u.strstart>u.w_size-De?u.strstart-(u.w_size-De):0,ke=u.window,Je=u.w_mask,je=u.prev,Re=u.strstart+Ne,Le=ke[w+be-1],rt=ke[w+be];u.prev_length>=u.good_match&&(G>>=2),ce>u.lookahead&&(ce=u.lookahead);do if(L=q,!(ke[L+be]!==rt||ke[L+be-1]!==Le||ke[L]!==ke[w]||ke[++L]!==ke[w+1])){w+=2,L++;do;while(ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&ke[++w]===ke[++L]&&w<Re);if(Z=Ne-(Re-w),w=Re-Ne,Z>be){if(u.match_start=q,be=Z,Z>=ce)break;Le=ke[w+be-1],rt=ke[w+be]}}while((q=je[q&Je])>de&&--G!==0);return be<=u.lookahead?be:u.lookahead}function tt(u){var q=u.w_size,G,w,L,Z,be;do{if(Z=u.window_size-u.lookahead-u.strstart,u.strstart>=q+(q-De)){n.arraySet(u.window,u.window,q,q,0),u.match_start-=q,u.strstart-=q,u.block_start-=q,w=u.hash_size,G=w;do L=u.head[--G],u.head[G]=L>=q?L-q:0;while(--w);w=q,G=w;do L=u.prev[--G],u.prev[G]=L>=q?L-q:0;while(--w);Z+=q}if(u.strm.avail_in===0)break;if(w=Xe(u.strm,u.window,u.strstart+u.lookahead,Z),u.lookahead+=w,u.lookahead+u.insert>=pe)for(be=u.strstart-u.insert,u.ins_h=u.window[be],u.ins_h=(u.ins_h<<u.hash_shift^u.window[be+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[be+pe-1])&u.hash_mask,u.prev[be&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=be,be++,u.insert--,!(u.lookahead+u.insert<pe)););}while(u.lookahead<De&&u.strm.avail_in!==0)}function ut(u,q){var G=65535;for(G>u.pending_buf_size-5&&(G=u.pending_buf_size-5);;){if(u.lookahead<=1){if(tt(u),u.lookahead===0&&q===p)return Ie;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var w=u.block_start+G;if((u.strstart===0||u.strstart>=w)&&(u.lookahead=u.strstart-w,u.strstart=w,Ee(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-De&&(Ee(u,!1),u.strm.avail_out===0))return Ie}return u.insert=0,q===y?(Ee(u,!0),u.strm.avail_out===0?M:Y):(u.strstart>u.block_start&&(Ee(u,!1),u.strm.avail_out===0),Ie)}function dt(u,q){for(var G,w;;){if(u.lookahead<De){if(tt(u),u.lookahead<De&&q===p)return Ie;if(u.lookahead===0)break}if(G=0,u.lookahead>=pe&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+pe-1])&u.hash_mask,G=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),G!==0&&u.strstart-G<=u.w_size-De&&(u.match_length=st(u,G)),u.match_length>=pe)if(w=s._tr_tally(u,u.strstart-u.match_start,u.match_length-pe),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=pe){u.match_length--;do u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+pe-1])&u.hash_mask,G=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart;while(--u.match_length!==0);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else w=s._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(w&&(Ee(u,!1),u.strm.avail_out===0))return Ie}return u.insert=u.strstart<pe-1?u.strstart:pe-1,q===y?(Ee(u,!0),u.strm.avail_out===0?M:Y):u.last_lit&&(Ee(u,!1),u.strm.avail_out===0)?Ie:z}function ot(u,q){for(var G,w,L;;){if(u.lookahead<De){if(tt(u),u.lookahead<De&&q===p)return Ie;if(u.lookahead===0)break}if(G=0,u.lookahead>=pe&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+pe-1])&u.hash_mask,G=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=pe-1,G!==0&&u.prev_length<u.max_lazy_match&&u.strstart-G<=u.w_size-De&&(u.match_length=st(u,G),u.match_length<=5&&(u.strategy===b||u.match_length===pe&&u.strstart-u.match_start>4096)&&(u.match_length=pe-1)),u.prev_length>=pe&&u.match_length<=u.prev_length){L=u.strstart+u.lookahead-pe,w=s._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-pe),u.lookahead-=u.prev_length-1,u.prev_length-=2;do++u.strstart<=L&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+pe-1])&u.hash_mask,G=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart);while(--u.prev_length!==0);if(u.match_available=0,u.match_length=pe-1,u.strstart++,w&&(Ee(u,!1),u.strm.avail_out===0))return Ie}else if(u.match_available){if(w=s._tr_tally(u,0,u.window[u.strstart-1]),w&&Ee(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return Ie}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(w=s._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<pe-1?u.strstart:pe-1,q===y?(Ee(u,!0),u.strm.avail_out===0?M:Y):u.last_lit&&(Ee(u,!1),u.strm.avail_out===0)?Ie:z}function pt(u,q){for(var G,w,L,Z,be=u.window;;){if(u.lookahead<=Ne){if(tt(u),u.lookahead<=Ne&&q===p)return Ie;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=pe&&u.strstart>0&&(L=u.strstart-1,w=be[L],w===be[++L]&&w===be[++L]&&w===be[++L])){Z=u.strstart+Ne;do;while(w===be[++L]&&w===be[++L]&&w===be[++L]&&w===be[++L]&&w===be[++L]&&w===be[++L]&&w===be[++L]&&w===be[++L]&&L<Z);u.match_length=Ne-(Z-L),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=pe?(G=s._tr_tally(u,1,u.match_length-pe),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(G=s._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),G&&(Ee(u,!1),u.strm.avail_out===0))return Ie}return u.insert=0,q===y?(Ee(u,!0),u.strm.avail_out===0?M:Y):u.last_lit&&(Ee(u,!1),u.strm.avail_out===0)?Ie:z}function ct(u,q){for(var G;;){if(u.lookahead===0&&(tt(u),u.lookahead===0)){if(q===p)return Ie;break}if(u.match_length=0,G=s._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,G&&(Ee(u,!1),u.strm.avail_out===0))return Ie}return u.insert=0,q===y?(Ee(u,!0),u.strm.avail_out===0?M:Y):u.last_lit&&(Ee(u,!1),u.strm.avail_out===0)?Ie:z}function Ke(u,q,G,w,L){this.good_length=u,this.max_lazy=q,this.nice_length=G,this.max_chain=w,this.func=L}var lt;lt=[new Ke(0,0,0,0,ut),new Ke(4,4,8,4,dt),new Ke(4,5,16,8,dt),new Ke(4,6,32,32,dt),new Ke(4,4,16,16,ot),new Ke(8,16,32,32,ot),new Ke(8,16,128,128,ot),new Ke(8,32,128,256,ot),new Ke(32,128,258,1024,ot),new Ke(32,258,258,4096,ot)];function wt(u){u.window_size=2*u.w_size,Se(u.head),u.max_lazy_match=lt[u.level].max_lazy,u.good_match=lt[u.level].good_length,u.nice_match=lt[u.level].nice_length,u.max_chain_length=lt[u.level].max_chain,u.strstart=0,u.block_start=0,u.lookahead=0,u.insert=0,u.match_length=u.prev_length=pe-1,u.match_available=0,u.ins_h=0}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=X,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(Ae*2),this.dyn_dtree=new n.Buf16((2*Q+1)*2),this.bl_tree=new n.Buf16((2*fe+1)*2),Se(this.dyn_ltree),Se(this.dyn_dtree),Se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(le+1),this.heap=new n.Buf16(2*ee+1),Se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*ee+1),Se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function J(u){var q;return!u||!u.state?ie(u,v):(u.total_in=u.total_out=0,u.data_type=I,q=u.state,q.pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?Ge:Te,u.adler=q.wrap===2?0:1,q.last_flush=p,s._tr_init(q),E)}function ae(u){var q=J(u);return q===E&&wt(u.state),q}function ye(u,q){return!u||!u.state||u.state.wrap!==2?v:(u.state.gzhead=q,E)}function P(u,q,G,w,L,Z){if(!u)return v;var be=1;if(q===B&&(q=6),w<0?(be=0,w=-w):w>15&&(be=2,w-=16),L<1||L>H||G!==X||w<8||w>15||q<0||q>9||Z<0||Z>R)return ie(u,v);w===8&&(w=9);var ce=new A;return u.state=ce,ce.strm=u,ce.wrap=be,ce.gzhead=null,ce.w_bits=w,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=L+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+pe-1)/pe),ce.window=new n.Buf8(ce.w_size*2),ce.head=new n.Buf16(ce.hash_size),ce.prev=new n.Buf16(ce.w_size),ce.lit_bufsize=1<<L+6,ce.pending_buf_size=ce.lit_bufsize*4,ce.pending_buf=new n.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=q,ce.strategy=Z,ce.method=G,ae(u)}function d(u,q){return P(u,q,X,$,se,k)}function o(u,q){var G,w,L,Z;if(!u||!u.state||q>O||q<0)return u?ie(u,v):v;if(w=u.state,!u.output||!u.input&&u.avail_in!==0||w.status===Be&&q!==y)return ie(u,u.avail_out===0?C:v);if(w.strm=u,G=w.last_flush,w.last_flush=q,w.status===Ge)if(w.wrap===2)u.adler=0,_e(w,31),_e(w,139),_e(w,8),w.gzhead?(_e(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),_e(w,w.gzhead.time&255),_e(w,w.gzhead.time>>8&255),_e(w,w.gzhead.time>>16&255),_e(w,w.gzhead.time>>24&255),_e(w,w.level===9?2:w.strategy>=T||w.level<2?4:0),_e(w,w.gzhead.os&255),w.gzhead.extra&&w.gzhead.extra.length&&(_e(w,w.gzhead.extra.length&255),_e(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(u.adler=l(u.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=qe):(_e(w,0),_e(w,0),_e(w,0),_e(w,0),_e(w,0),_e(w,w.level===9?2:w.strategy>=T||w.level<2?4:0),_e(w,te),w.status=Te);else{var be=X+(w.w_bits-8<<4)<<8,ce=-1;w.strategy>=T||w.level<2?ce=0:w.level<6?ce=1:w.level===6?ce=2:ce=3,be|=ce<<6,w.strstart!==0&&(be|=Oe),be+=31-be%31,w.status=Te,Me(w,be),w.strstart!==0&&(Me(w,u.adler>>>16),Me(w,u.adler&65535)),u.adler=1}if(w.status===qe)if(w.gzhead.extra){for(L=w.pending;w.gzindex<(w.gzhead.extra.length&65535)&&!(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),we(u),L=w.pending,w.pending===w.pending_buf_size));)_e(w,w.gzhead.extra[w.gzindex]&255),w.gzindex++;w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=Ce)}else w.status=Ce;if(w.status===Ce)if(w.gzhead.name){L=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),we(u),L=w.pending,w.pending===w.pending_buf_size)){Z=1;break}w.gzindex<w.gzhead.name.length?Z=w.gzhead.name.charCodeAt(w.gzindex++)&255:Z=0,_e(w,Z)}while(Z!==0);w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),Z===0&&(w.gzindex=0,w.status=Ue)}else w.status=Ue;if(w.status===Ue)if(w.gzhead.comment){L=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),we(u),L=w.pending,w.pending===w.pending_buf_size)){Z=1;break}w.gzindex<w.gzhead.comment.length?Z=w.gzhead.comment.charCodeAt(w.gzindex++)&255:Z=0,_e(w,Z)}while(Z!==0);w.gzhead.hcrc&&w.pending>L&&(u.adler=l(u.adler,w.pending_buf,w.pending-L,L)),Z===0&&(w.status=We)}else w.status=We;if(w.status===We&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&we(u),w.pending+2<=w.pending_buf_size&&(_e(w,u.adler&255),_e(w,u.adler>>8&255),u.adler=0,w.status=Te)):w.status=Te),w.pending!==0){if(we(u),u.avail_out===0)return w.last_flush=-1,E}else if(u.avail_in===0&&me(q)<=me(G)&&q!==y)return ie(u,C);if(w.status===Be&&u.avail_in!==0)return ie(u,C);if(u.avail_in!==0||w.lookahead!==0||q!==p&&w.status!==Be){var de=w.strategy===T?ct(w,q):w.strategy===N?pt(w,q):lt[w.level].func(w,q);if((de===M||de===Y)&&(w.status=Be),de===Ie||de===M)return u.avail_out===0&&(w.last_flush=-1),E;if(de===z&&(q===c?s._tr_align(w):q!==O&&(s._tr_stored_block(w,0,0,!1),q===_&&(Se(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),we(u),u.avail_out===0))return w.last_flush=-1,E}return q!==y?E:w.wrap<=0?h:(w.wrap===2?(_e(w,u.adler&255),_e(w,u.adler>>8&255),_e(w,u.adler>>16&255),_e(w,u.adler>>24&255),_e(w,u.total_in&255),_e(w,u.total_in>>8&255),_e(w,u.total_in>>16&255),_e(w,u.total_in>>24&255)):(Me(w,u.adler>>>16),Me(w,u.adler&65535)),we(u),w.wrap>0&&(w.wrap=-w.wrap),w.pending!==0?E:h)}function x(u){var q;return!u||!u.state?v:(q=u.state.status,q!==Ge&&q!==qe&&q!==Ce&&q!==Ue&&q!==We&&q!==Te&&q!==Be?ie(u,v):(u.state=null,q===Te?ie(u,g):E))}function U(u,q){var G=q.length,w,L,Z,be,ce,de,ke,Je;if(!u||!u.state||(w=u.state,be=w.wrap,be===2||be===1&&w.status!==Ge||w.lookahead))return v;for(be===1&&(u.adler=a(u.adler,q,G,0)),w.wrap=0,G>=w.w_size&&(be===0&&(Se(w.head),w.strstart=0,w.block_start=0,w.insert=0),Je=new n.Buf8(w.w_size),n.arraySet(Je,q,G-w.w_size,w.w_size,0),q=Je,G=w.w_size),ce=u.avail_in,de=u.next_in,ke=u.input,u.avail_in=G,u.next_in=0,u.input=q,tt(w);w.lookahead>=pe;){L=w.strstart,Z=w.lookahead-(pe-1);do w.ins_h=(w.ins_h<<w.hash_shift^w.window[L+pe-1])&w.hash_mask,w.prev[L&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=L,L++;while(--Z);w.strstart=L,w.lookahead=pe-1,tt(w)}return w.strstart+=w.lookahead,w.block_start=w.strstart,w.insert=w.lookahead,w.lookahead=0,w.match_length=w.prev_length=pe-1,w.match_available=0,u.next_in=de,u.input=ke,u.avail_in=ce,w.wrap=be,E}i.deflateInit=d,i.deflateInit2=P,i.deflateReset=ae,i.deflateResetKeep=J,i.deflateSetHeader=ye,i.deflate=o,i.deflateEnd=x,i.deflateSetDictionary=U,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=n},{}],48:[function(t,r,i){var n=30,s=12;r.exports=function(l,f){var p,c,_,y,O,E,h,v,g,C,B,b,T,N,R,k,I,X,H,$,se,re,ge,ee,Q;p=l.state,c=l.next_in,ee=l.input,_=c+(l.avail_in-5),y=l.next_out,Q=l.output,O=y-(f-l.avail_out),E=y+(l.avail_out-257),h=p.dmax,v=p.wsize,g=p.whave,C=p.wnext,B=p.window,b=p.hold,T=p.bits,N=p.lencode,R=p.distcode,k=(1<<p.lenbits)-1,I=(1<<p.distbits)-1;e:do{T<15&&(b+=ee[c++]<<T,T+=8,b+=ee[c++]<<T,T+=8),X=N[b&k];t:for(;;){if(H=X>>>24,b>>>=H,T-=H,H=X>>>16&255,H===0)Q[y++]=X&65535;else if(H&16){$=X&65535,H&=15,H&&(T<H&&(b+=ee[c++]<<T,T+=8),$+=b&(1<<H)-1,b>>>=H,T-=H),T<15&&(b+=ee[c++]<<T,T+=8,b+=ee[c++]<<T,T+=8),X=R[b&I];r:for(;;){if(H=X>>>24,b>>>=H,T-=H,H=X>>>16&255,H&16){if(se=X&65535,H&=15,T<H&&(b+=ee[c++]<<T,T+=8,T<H&&(b+=ee[c++]<<T,T+=8)),se+=b&(1<<H)-1,se>h){l.msg="invalid distance too far back",p.mode=n;break e}if(b>>>=H,T-=H,H=y-O,se>H){if(H=se-H,H>g&&p.sane){l.msg="invalid distance too far back",p.mode=n;break e}if(re=0,ge=B,C===0){if(re+=v-H,H<$){$-=H;do Q[y++]=B[re++];while(--H);re=y-se,ge=Q}}else if(C<H){if(re+=v+C-H,H-=C,H<$){$-=H;do Q[y++]=B[re++];while(--H);if(re=0,C<$){H=C,$-=H;do Q[y++]=B[re++];while(--H);re=y-se,ge=Q}}}else if(re+=C-H,H<$){$-=H;do Q[y++]=B[re++];while(--H);re=y-se,ge=Q}for(;$>2;)Q[y++]=ge[re++],Q[y++]=ge[re++],Q[y++]=ge[re++],$-=3;$&&(Q[y++]=ge[re++],$>1&&(Q[y++]=ge[re++]))}else{re=y-se;do Q[y++]=Q[re++],Q[y++]=Q[re++],Q[y++]=Q[re++],$-=3;while($>2);$&&(Q[y++]=Q[re++],$>1&&(Q[y++]=Q[re++]))}}else if((H&64)===0){X=R[(X&65535)+(b&(1<<H)-1)];continue r}else{l.msg="invalid distance code",p.mode=n;break e}break}}else if((H&64)===0){X=N[(X&65535)+(b&(1<<H)-1)];continue t}else if(H&32){p.mode=s;break e}else{l.msg="invalid literal/length code",p.mode=n;break e}break}}while(c<_&&y<E);$=T>>3,c-=$,T-=$<<3,b&=(1<<T)-1,l.next_in=c,l.next_out=y,l.avail_in=c<_?5+(_-c):5-(c-_),l.avail_out=y<E?257+(E-y):257-(y-E),p.hold=b,p.bits=T}},{}],49:[function(t,r,i){var n=t("../utils/common"),s=t("./adler32"),a=t("./crc32"),l=t("./inffast"),f=t("./inftrees"),p=0,c=1,_=2,y=4,O=5,E=6,h=0,v=1,g=2,C=-2,B=-3,b=-4,T=-5,N=8,R=1,k=2,I=3,X=4,H=5,$=6,se=7,re=8,ge=9,ee=10,Q=11,fe=12,Ae=13,le=14,pe=15,Ne=16,De=17,Oe=18,Ge=19,qe=20,Ce=21,Ue=22,We=23,Te=24,Be=25,Ie=26,z=27,M=28,Y=29,te=30,ie=31,me=32,Se=852,we=592,Ee=15,_e=Ee;function Me(P){return(P>>>24&255)+(P>>>8&65280)+((P&65280)<<8)+((P&255)<<24)}function Xe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function st(P){var d;return!P||!P.state?C:(d=P.state,P.total_in=P.total_out=d.total=0,P.msg="",d.wrap&&(P.adler=d.wrap&1),d.mode=R,d.last=0,d.havedict=0,d.dmax=32768,d.head=null,d.hold=0,d.bits=0,d.lencode=d.lendyn=new n.Buf32(Se),d.distcode=d.distdyn=new n.Buf32(we),d.sane=1,d.back=-1,h)}function tt(P){var d;return!P||!P.state?C:(d=P.state,d.wsize=0,d.whave=0,d.wnext=0,st(P))}function ut(P,d){var o,x;return!P||!P.state||(x=P.state,d<0?(o=0,d=-d):(o=(d>>4)+1,d<48&&(d&=15)),d&&(d<8||d>15))?C:(x.window!==null&&x.wbits!==d&&(x.window=null),x.wrap=o,x.wbits=d,tt(P))}function dt(P,d){var o,x;return P?(x=new Xe,P.state=x,x.window=null,o=ut(P,d),o!==h&&(P.state=null),o):C}function ot(P){return dt(P,_e)}var pt=!0,ct,Ke;function lt(P){if(pt){var d;for(ct=new n.Buf32(512),Ke=new n.Buf32(32),d=0;d<144;)P.lens[d++]=8;for(;d<256;)P.lens[d++]=9;for(;d<280;)P.lens[d++]=7;for(;d<288;)P.lens[d++]=8;for(f(c,P.lens,0,288,ct,0,P.work,{bits:9}),d=0;d<32;)P.lens[d++]=5;f(_,P.lens,0,32,Ke,0,P.work,{bits:5}),pt=!1}P.lencode=ct,P.lenbits=9,P.distcode=Ke,P.distbits=5}function wt(P,d,o,x){var U,u=P.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new n.Buf8(u.wsize)),x>=u.wsize?(n.arraySet(u.window,d,o-u.wsize,u.wsize,0),u.wnext=0,u.whave=u.wsize):(U=u.wsize-u.wnext,U>x&&(U=x),n.arraySet(u.window,d,o-x,U,u.wnext),x-=U,x?(n.arraySet(u.window,d,o-x,x,0),u.wnext=x,u.whave=u.wsize):(u.wnext+=U,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=U))),0}function A(P,d){var o,x,U,u,q,G,w,L,Z,be,ce,de,ke,Je,je=0,Re,Le,rt,$e,Tt,Lt,Qe,vt,at=new n.Buf8(4),_t,gt,rr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return C;o=P.state,o.mode===fe&&(o.mode=Ae),q=P.next_out,U=P.output,w=P.avail_out,u=P.next_in,x=P.input,G=P.avail_in,L=o.hold,Z=o.bits,be=G,ce=w,vt=h;e:for(;;)switch(o.mode){case R:if(o.wrap===0){o.mode=Ae;break}for(;Z<16;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(o.wrap&2&&L===35615){o.check=0,at[0]=L&255,at[1]=L>>>8&255,o.check=a(o.check,at,2,0),L=0,Z=0,o.mode=k;break}if(o.flags=0,o.head&&(o.head.done=!1),!(o.wrap&1)||(((L&255)<<8)+(L>>8))%31){P.msg="incorrect header check",o.mode=te;break}if((L&15)!==N){P.msg="unknown compression method",o.mode=te;break}if(L>>>=4,Z-=4,Qe=(L&15)+8,o.wbits===0)o.wbits=Qe;else if(Qe>o.wbits){P.msg="invalid window size",o.mode=te;break}o.dmax=1<<Qe,P.adler=o.check=1,o.mode=L&512?ee:fe,L=0,Z=0;break;case k:for(;Z<16;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(o.flags=L,(o.flags&255)!==N){P.msg="unknown compression method",o.mode=te;break}if(o.flags&57344){P.msg="unknown header flags set",o.mode=te;break}o.head&&(o.head.text=L>>8&1),o.flags&512&&(at[0]=L&255,at[1]=L>>>8&255,o.check=a(o.check,at,2,0)),L=0,Z=0,o.mode=I;case I:for(;Z<32;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.head&&(o.head.time=L),o.flags&512&&(at[0]=L&255,at[1]=L>>>8&255,at[2]=L>>>16&255,at[3]=L>>>24&255,o.check=a(o.check,at,4,0)),L=0,Z=0,o.mode=X;case X:for(;Z<16;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.head&&(o.head.xflags=L&255,o.head.os=L>>8),o.flags&512&&(at[0]=L&255,at[1]=L>>>8&255,o.check=a(o.check,at,2,0)),L=0,Z=0,o.mode=H;case H:if(o.flags&1024){for(;Z<16;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.length=L,o.head&&(o.head.extra_len=L),o.flags&512&&(at[0]=L&255,at[1]=L>>>8&255,o.check=a(o.check,at,2,0)),L=0,Z=0}else o.head&&(o.head.extra=null);o.mode=$;case $:if(o.flags&1024&&(de=o.length,de>G&&(de=G),de&&(o.head&&(Qe=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),n.arraySet(o.head.extra,x,u,de,Qe)),o.flags&512&&(o.check=a(o.check,x,de,u)),G-=de,u+=de,o.length-=de),o.length))break e;o.length=0,o.mode=se;case se:if(o.flags&2048){if(G===0)break e;de=0;do Qe=x[u+de++],o.head&&Qe&&o.length<65536&&(o.head.name+=String.fromCharCode(Qe));while(Qe&&de<G);if(o.flags&512&&(o.check=a(o.check,x,de,u)),G-=de,u+=de,Qe)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=re;case re:if(o.flags&4096){if(G===0)break e;de=0;do Qe=x[u+de++],o.head&&Qe&&o.length<65536&&(o.head.comment+=String.fromCharCode(Qe));while(Qe&&de<G);if(o.flags&512&&(o.check=a(o.check,x,de,u)),G-=de,u+=de,Qe)break e}else o.head&&(o.head.comment=null);o.mode=ge;case ge:if(o.flags&512){for(;Z<16;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(L!==(o.check&65535)){P.msg="header crc mismatch",o.mode=te;break}L=0,Z=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),P.adler=o.check=0,o.mode=fe;break;case ee:for(;Z<32;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}P.adler=o.check=Me(L),L=0,Z=0,o.mode=Q;case Q:if(o.havedict===0)return P.next_out=q,P.avail_out=w,P.next_in=u,P.avail_in=G,o.hold=L,o.bits=Z,g;P.adler=o.check=1,o.mode=fe;case fe:if(d===O||d===E)break e;case Ae:if(o.last){L>>>=Z&7,Z-=Z&7,o.mode=z;break}for(;Z<3;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}switch(o.last=L&1,L>>>=1,Z-=1,L&3){case 0:o.mode=le;break;case 1:if(lt(o),o.mode=qe,d===E){L>>>=2,Z-=2;break e}break;case 2:o.mode=De;break;case 3:P.msg="invalid block type",o.mode=te}L>>>=2,Z-=2;break;case le:for(L>>>=Z&7,Z-=Z&7;Z<32;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if((L&65535)!==(L>>>16^65535)){P.msg="invalid stored block lengths",o.mode=te;break}if(o.length=L&65535,L=0,Z=0,o.mode=pe,d===E)break e;case pe:o.mode=Ne;case Ne:if(de=o.length,de){if(de>G&&(de=G),de>w&&(de=w),de===0)break e;n.arraySet(U,x,u,de,q),G-=de,u+=de,w-=de,q+=de,o.length-=de;break}o.mode=fe;break;case De:for(;Z<14;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(o.nlen=(L&31)+257,L>>>=5,Z-=5,o.ndist=(L&31)+1,L>>>=5,Z-=5,o.ncode=(L&15)+4,L>>>=4,Z-=4,o.nlen>286||o.ndist>30){P.msg="too many length or distance symbols",o.mode=te;break}o.have=0,o.mode=Oe;case Oe:for(;o.have<o.ncode;){for(;Z<3;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.lens[rr[o.have++]]=L&7,L>>>=3,Z-=3}for(;o.have<19;)o.lens[rr[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,_t={bits:o.lenbits},vt=f(p,o.lens,0,19,o.lencode,0,o.work,_t),o.lenbits=_t.bits,vt){P.msg="invalid code lengths set",o.mode=te;break}o.have=0,o.mode=Ge;case Ge:for(;o.have<o.nlen+o.ndist;){for(;je=o.lencode[L&(1<<o.lenbits)-1],Re=je>>>24,Le=je>>>16&255,rt=je&65535,!(Re<=Z);){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(rt<16)L>>>=Re,Z-=Re,o.lens[o.have++]=rt;else{if(rt===16){for(gt=Re+2;Z<gt;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(L>>>=Re,Z-=Re,o.have===0){P.msg="invalid bit length repeat",o.mode=te;break}Qe=o.lens[o.have-1],de=3+(L&3),L>>>=2,Z-=2}else if(rt===17){for(gt=Re+3;Z<gt;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}L>>>=Re,Z-=Re,Qe=0,de=3+(L&7),L>>>=3,Z-=3}else{for(gt=Re+7;Z<gt;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}L>>>=Re,Z-=Re,Qe=0,de=11+(L&127),L>>>=7,Z-=7}if(o.have+de>o.nlen+o.ndist){P.msg="invalid bit length repeat",o.mode=te;break}for(;de--;)o.lens[o.have++]=Qe}}if(o.mode===te)break;if(o.lens[256]===0){P.msg="invalid code -- missing end-of-block",o.mode=te;break}if(o.lenbits=9,_t={bits:o.lenbits},vt=f(c,o.lens,0,o.nlen,o.lencode,0,o.work,_t),o.lenbits=_t.bits,vt){P.msg="invalid literal/lengths set",o.mode=te;break}if(o.distbits=6,o.distcode=o.distdyn,_t={bits:o.distbits},vt=f(_,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,_t),o.distbits=_t.bits,vt){P.msg="invalid distances set",o.mode=te;break}if(o.mode=qe,d===E)break e;case qe:o.mode=Ce;case Ce:if(G>=6&&w>=258){P.next_out=q,P.avail_out=w,P.next_in=u,P.avail_in=G,o.hold=L,o.bits=Z,l(P,ce),q=P.next_out,U=P.output,w=P.avail_out,u=P.next_in,x=P.input,G=P.avail_in,L=o.hold,Z=o.bits,o.mode===fe&&(o.back=-1);break}for(o.back=0;je=o.lencode[L&(1<<o.lenbits)-1],Re=je>>>24,Le=je>>>16&255,rt=je&65535,!(Re<=Z);){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(Le&&(Le&240)===0){for($e=Re,Tt=Le,Lt=rt;je=o.lencode[Lt+((L&(1<<$e+Tt)-1)>>$e)],Re=je>>>24,Le=je>>>16&255,rt=je&65535,!($e+Re<=Z);){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}L>>>=$e,Z-=$e,o.back+=$e}if(L>>>=Re,Z-=Re,o.back+=Re,o.length=rt,Le===0){o.mode=Ie;break}if(Le&32){o.back=-1,o.mode=fe;break}if(Le&64){P.msg="invalid literal/length code",o.mode=te;break}o.extra=Le&15,o.mode=Ue;case Ue:if(o.extra){for(gt=o.extra;Z<gt;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.length+=L&(1<<o.extra)-1,L>>>=o.extra,Z-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=We;case We:for(;je=o.distcode[L&(1<<o.distbits)-1],Re=je>>>24,Le=je>>>16&255,rt=je&65535,!(Re<=Z);){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if((Le&240)===0){for($e=Re,Tt=Le,Lt=rt;je=o.distcode[Lt+((L&(1<<$e+Tt)-1)>>$e)],Re=je>>>24,Le=je>>>16&255,rt=je&65535,!($e+Re<=Z);){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}L>>>=$e,Z-=$e,o.back+=$e}if(L>>>=Re,Z-=Re,o.back+=Re,Le&64){P.msg="invalid distance code",o.mode=te;break}o.offset=rt,o.extra=Le&15,o.mode=Te;case Te:if(o.extra){for(gt=o.extra;Z<gt;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}o.offset+=L&(1<<o.extra)-1,L>>>=o.extra,Z-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){P.msg="invalid distance too far back",o.mode=te;break}o.mode=Be;case Be:if(w===0)break e;if(de=ce-w,o.offset>de){if(de=o.offset-de,de>o.whave&&o.sane){P.msg="invalid distance too far back",o.mode=te;break}de>o.wnext?(de-=o.wnext,ke=o.wsize-de):ke=o.wnext-de,de>o.length&&(de=o.length),Je=o.window}else Je=U,ke=q-o.offset,de=o.length;de>w&&(de=w),w-=de,o.length-=de;do U[q++]=Je[ke++];while(--de);o.length===0&&(o.mode=Ce);break;case Ie:if(w===0)break e;U[q++]=o.length,w--,o.mode=Ce;break;case z:if(o.wrap){for(;Z<32;){if(G===0)break e;G--,L|=x[u++]<<Z,Z+=8}if(ce-=w,P.total_out+=ce,o.total+=ce,ce&&(P.adler=o.check=o.flags?a(o.check,U,ce,q-ce):s(o.check,U,ce,q-ce)),ce=w,(o.flags?L:Me(L))!==o.check){P.msg="incorrect data check",o.mode=te;break}L=0,Z=0}o.mode=M;case M:if(o.wrap&&o.flags){for(;Z<32;){if(G===0)break e;G--,L+=x[u++]<<Z,Z+=8}if(L!==(o.total&4294967295)){P.msg="incorrect length check",o.mode=te;break}L=0,Z=0}o.mode=Y;case Y:vt=v;break e;case te:vt=B;break e;case ie:return b;case me:default:return C}return P.next_out=q,P.avail_out=w,P.next_in=u,P.avail_in=G,o.hold=L,o.bits=Z,(o.wsize||ce!==P.avail_out&&o.mode<te&&(o.mode<z||d!==y))&&wt(P,P.output,P.next_out,ce-P.avail_out),be-=P.avail_in,ce-=P.avail_out,P.total_in+=be,P.total_out+=ce,o.total+=ce,o.wrap&&ce&&(P.adler=o.check=o.flags?a(o.check,U,ce,P.next_out-ce):s(o.check,U,ce,P.next_out-ce)),P.data_type=o.bits+(o.last?64:0)+(o.mode===fe?128:0)+(o.mode===qe||o.mode===pe?256:0),(be===0&&ce===0||d===y)&&vt===h&&(vt=T),vt}function J(P){if(!P||!P.state)return C;var d=P.state;return d.window&&(d.window=null),P.state=null,h}function ae(P,d){var o;return!P||!P.state||(o=P.state,(o.wrap&2)===0)?C:(o.head=d,d.done=!1,h)}function ye(P,d){var o=d.length,x,U,u;return!P||!P.state||(x=P.state,x.wrap!==0&&x.mode!==Q)?C:x.mode===Q&&(U=1,U=s(U,d,o,0),U!==x.check)?B:(u=wt(P,d,o,o),u?(x.mode=ie,b):(x.havedict=1,h))}i.inflateReset=tt,i.inflateReset2=ut,i.inflateResetKeep=st,i.inflateInit=ot,i.inflateInit2=dt,i.inflate=A,i.inflateEnd=J,i.inflateGetHeader=ae,i.inflateSetDictionary=ye,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var n=t("../utils/common"),s=15,a=852,l=592,f=0,p=1,c=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],E=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(v,g,C,B,b,T,N,R){var k=R.bits,I=0,X=0,H=0,$=0,se=0,re=0,ge=0,ee=0,Q=0,fe=0,Ae,le,pe,Ne,De,Oe=null,Ge=0,qe,Ce=new n.Buf16(s+1),Ue=new n.Buf16(s+1),We=null,Te=0,Be,Ie,z;for(I=0;I<=s;I++)Ce[I]=0;for(X=0;X<B;X++)Ce[g[C+X]]++;for(se=k,$=s;$>=1&&Ce[$]===0;$--);if(se>$&&(se=$),$===0)return b[T++]=1<<24|64<<16|0,b[T++]=1<<24|64<<16|0,R.bits=1,0;for(H=1;H<$&&Ce[H]===0;H++);for(se<H&&(se=H),ee=1,I=1;I<=s;I++)if(ee<<=1,ee-=Ce[I],ee<0)return-1;if(ee>0&&(v===f||$!==1))return-1;for(Ue[1]=0,I=1;I<s;I++)Ue[I+1]=Ue[I]+Ce[I];for(X=0;X<B;X++)g[C+X]!==0&&(N[Ue[g[C+X]]++]=X);if(v===f?(Oe=We=N,qe=19):v===p?(Oe=_,Ge-=257,We=y,Te-=257,qe=256):(Oe=O,We=E,qe=-1),fe=0,X=0,I=H,De=T,re=se,ge=0,pe=-1,Q=1<<se,Ne=Q-1,v===p&&Q>a||v===c&&Q>l)return 1;for(;;){Be=I-ge,N[X]<qe?(Ie=0,z=N[X]):N[X]>qe?(Ie=We[Te+N[X]],z=Oe[Ge+N[X]]):(Ie=96,z=0),Ae=1<<I-ge,le=1<<re,H=le;do le-=Ae,b[De+(fe>>ge)+le]=Be<<24|Ie<<16|z|0;while(le!==0);for(Ae=1<<I-1;fe&Ae;)Ae>>=1;if(Ae!==0?(fe&=Ae-1,fe+=Ae):fe=0,X++,--Ce[I]===0){if(I===$)break;I=g[C+N[X]]}if(I>se&&(fe&Ne)!==pe){for(ge===0&&(ge=se),De+=H,re=I-ge,ee=1<<re;re+ge<$&&(ee-=Ce[re+ge],!(ee<=0));)re++,ee<<=1;if(Q+=1<<re,v===p&&Q>a||v===c&&Q>l)return 1;pe=fe&Ne,b[pe]=se<<24|re<<16|De-T|0}}return fe!==0&&(b[De+fe]=I-ge<<24|64<<16|0),R.bits=se,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var n=t("../utils/common"),s=4,a=0,l=1,f=2;function p(A){for(var J=A.length;--J>=0;)A[J]=0}var c=0,_=1,y=2,O=3,E=258,h=29,v=256,g=v+1+h,C=30,B=19,b=2*g+1,T=15,N=16,R=7,k=256,I=16,X=17,H=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],se=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=512,Q=new Array((g+2)*2);p(Q);var fe=new Array(C*2);p(fe);var Ae=new Array(ee);p(Ae);var le=new Array(E-O+1);p(le);var pe=new Array(h);p(pe);var Ne=new Array(C);p(Ne);function De(A,J,ae,ye,P){this.static_tree=A,this.extra_bits=J,this.extra_base=ae,this.elems=ye,this.max_length=P,this.has_stree=A&&A.length}var Oe,Ge,qe;function Ce(A,J){this.dyn_tree=A,this.max_code=0,this.stat_desc=J}function Ue(A){return A<256?Ae[A]:Ae[256+(A>>>7)]}function We(A,J){A.pending_buf[A.pending++]=J&255,A.pending_buf[A.pending++]=J>>>8&255}function Te(A,J,ae){A.bi_valid>N-ae?(A.bi_buf|=J<<A.bi_valid&65535,We(A,A.bi_buf),A.bi_buf=J>>N-A.bi_valid,A.bi_valid+=ae-N):(A.bi_buf|=J<<A.bi_valid&65535,A.bi_valid+=ae)}function Be(A,J,ae){Te(A,ae[J*2],ae[J*2+1])}function Ie(A,J){var ae=0;do ae|=A&1,A>>>=1,ae<<=1;while(--J>0);return ae>>>1}function z(A){A.bi_valid===16?(We(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):A.bi_valid>=8&&(A.pending_buf[A.pending++]=A.bi_buf&255,A.bi_buf>>=8,A.bi_valid-=8)}function M(A,J){var ae=J.dyn_tree,ye=J.max_code,P=J.stat_desc.static_tree,d=J.stat_desc.has_stree,o=J.stat_desc.extra_bits,x=J.stat_desc.extra_base,U=J.stat_desc.max_length,u,q,G,w,L,Z,be=0;for(w=0;w<=T;w++)A.bl_count[w]=0;for(ae[A.heap[A.heap_max]*2+1]=0,u=A.heap_max+1;u<b;u++)q=A.heap[u],w=ae[ae[q*2+1]*2+1]+1,w>U&&(w=U,be++),ae[q*2+1]=w,!(q>ye)&&(A.bl_count[w]++,L=0,q>=x&&(L=o[q-x]),Z=ae[q*2],A.opt_len+=Z*(w+L),d&&(A.static_len+=Z*(P[q*2+1]+L)));if(be!==0){do{for(w=U-1;A.bl_count[w]===0;)w--;A.bl_count[w]--,A.bl_count[w+1]+=2,A.bl_count[U]--,be-=2}while(be>0);for(w=U;w!==0;w--)for(q=A.bl_count[w];q!==0;)G=A.heap[--u],!(G>ye)&&(ae[G*2+1]!==w&&(A.opt_len+=(w-ae[G*2+1])*ae[G*2],ae[G*2+1]=w),q--)}}function Y(A,J,ae){var ye=new Array(T+1),P=0,d,o;for(d=1;d<=T;d++)ye[d]=P=P+ae[d-1]<<1;for(o=0;o<=J;o++){var x=A[o*2+1];x!==0&&(A[o*2]=Ie(ye[x]++,x))}}function te(){var A,J,ae,ye,P,d=new Array(T+1);for(ae=0,ye=0;ye<h-1;ye++)for(pe[ye]=ae,A=0;A<1<<$[ye];A++)le[ae++]=ye;for(le[ae-1]=ye,P=0,ye=0;ye<16;ye++)for(Ne[ye]=P,A=0;A<1<<se[ye];A++)Ae[P++]=ye;for(P>>=7;ye<C;ye++)for(Ne[ye]=P<<7,A=0;A<1<<se[ye]-7;A++)Ae[256+P++]=ye;for(J=0;J<=T;J++)d[J]=0;for(A=0;A<=143;)Q[A*2+1]=8,A++,d[8]++;for(;A<=255;)Q[A*2+1]=9,A++,d[9]++;for(;A<=279;)Q[A*2+1]=7,A++,d[7]++;for(;A<=287;)Q[A*2+1]=8,A++,d[8]++;for(Y(Q,g+1,d),A=0;A<C;A++)fe[A*2+1]=5,fe[A*2]=Ie(A,5);Oe=new De(Q,$,v+1,g,T),Ge=new De(fe,se,0,C,T),qe=new De(new Array(0),re,0,B,R)}function ie(A){var J;for(J=0;J<g;J++)A.dyn_ltree[J*2]=0;for(J=0;J<C;J++)A.dyn_dtree[J*2]=0;for(J=0;J<B;J++)A.bl_tree[J*2]=0;A.dyn_ltree[k*2]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function me(A){A.bi_valid>8?We(A,A.bi_buf):A.bi_valid>0&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function Se(A,J,ae,ye){me(A),We(A,ae),We(A,~ae),n.arraySet(A.pending_buf,A.window,J,ae,A.pending),A.pending+=ae}function we(A,J,ae,ye){var P=J*2,d=ae*2;return A[P]<A[d]||A[P]===A[d]&&ye[J]<=ye[ae]}function Ee(A,J,ae){for(var ye=A.heap[ae],P=ae<<1;P<=A.heap_len&&(P<A.heap_len&&we(J,A.heap[P+1],A.heap[P],A.depth)&&P++,!we(J,ye,A.heap[P],A.depth));)A.heap[ae]=A.heap[P],ae=P,P<<=1;A.heap[ae]=ye}function _e(A,J,ae){var ye,P,d=0,o,x;if(A.last_lit!==0)do ye=A.pending_buf[A.d_buf+d*2]<<8|A.pending_buf[A.d_buf+d*2+1],P=A.pending_buf[A.l_buf+d],d++,ye===0?Be(A,P,J):(o=le[P],Be(A,o+v+1,J),x=$[o],x!==0&&(P-=pe[o],Te(A,P,x)),ye--,o=Ue(ye),Be(A,o,ae),x=se[o],x!==0&&(ye-=Ne[o],Te(A,ye,x)));while(d<A.last_lit);Be(A,k,J)}function Me(A,J){var ae=J.dyn_tree,ye=J.stat_desc.static_tree,P=J.stat_desc.has_stree,d=J.stat_desc.elems,o,x,U=-1,u;for(A.heap_len=0,A.heap_max=b,o=0;o<d;o++)ae[o*2]!==0?(A.heap[++A.heap_len]=U=o,A.depth[o]=0):ae[o*2+1]=0;for(;A.heap_len<2;)u=A.heap[++A.heap_len]=U<2?++U:0,ae[u*2]=1,A.depth[u]=0,A.opt_len--,P&&(A.static_len-=ye[u*2+1]);for(J.max_code=U,o=A.heap_len>>1;o>=1;o--)Ee(A,ae,o);u=d;do o=A.heap[1],A.heap[1]=A.heap[A.heap_len--],Ee(A,ae,1),x=A.heap[1],A.heap[--A.heap_max]=o,A.heap[--A.heap_max]=x,ae[u*2]=ae[o*2]+ae[x*2],A.depth[u]=(A.depth[o]>=A.depth[x]?A.depth[o]:A.depth[x])+1,ae[o*2+1]=ae[x*2+1]=u,A.heap[1]=u++,Ee(A,ae,1);while(A.heap_len>=2);A.heap[--A.heap_max]=A.heap[1],M(A,J),Y(ae,U,A.bl_count)}function Xe(A,J,ae){var ye,P=-1,d,o=J[1],x=0,U=7,u=4;for(o===0&&(U=138,u=3),J[(ae+1)*2+1]=65535,ye=0;ye<=ae;ye++)d=o,o=J[(ye+1)*2+1],!(++x<U&&d===o)&&(x<u?A.bl_tree[d*2]+=x:d!==0?(d!==P&&A.bl_tree[d*2]++,A.bl_tree[I*2]++):x<=10?A.bl_tree[X*2]++:A.bl_tree[H*2]++,x=0,P=d,o===0?(U=138,u=3):d===o?(U=6,u=3):(U=7,u=4))}function st(A,J,ae){var ye,P=-1,d,o=J[1],x=0,U=7,u=4;for(o===0&&(U=138,u=3),ye=0;ye<=ae;ye++)if(d=o,o=J[(ye+1)*2+1],!(++x<U&&d===o)){if(x<u)do Be(A,d,A.bl_tree);while(--x!==0);else d!==0?(d!==P&&(Be(A,d,A.bl_tree),x--),Be(A,I,A.bl_tree),Te(A,x-3,2)):x<=10?(Be(A,X,A.bl_tree),Te(A,x-3,3)):(Be(A,H,A.bl_tree),Te(A,x-11,7));x=0,P=d,o===0?(U=138,u=3):d===o?(U=6,u=3):(U=7,u=4)}}function tt(A){var J;for(Xe(A,A.dyn_ltree,A.l_desc.max_code),Xe(A,A.dyn_dtree,A.d_desc.max_code),Me(A,A.bl_desc),J=B-1;J>=3&&A.bl_tree[ge[J]*2+1]===0;J--);return A.opt_len+=3*(J+1)+5+5+4,J}function ut(A,J,ae,ye){var P;for(Te(A,J-257,5),Te(A,ae-1,5),Te(A,ye-4,4),P=0;P<ye;P++)Te(A,A.bl_tree[ge[P]*2+1],3);st(A,A.dyn_ltree,J-1),st(A,A.dyn_dtree,ae-1)}function dt(A){var J=4093624447,ae;for(ae=0;ae<=31;ae++,J>>>=1)if(J&1&&A.dyn_ltree[ae*2]!==0)return a;if(A.dyn_ltree[18]!==0||A.dyn_ltree[20]!==0||A.dyn_ltree[26]!==0)return l;for(ae=32;ae<v;ae++)if(A.dyn_ltree[ae*2]!==0)return l;return a}var ot=!1;function pt(A){ot||(te(),ot=!0),A.l_desc=new Ce(A.dyn_ltree,Oe),A.d_desc=new Ce(A.dyn_dtree,Ge),A.bl_desc=new Ce(A.bl_tree,qe),A.bi_buf=0,A.bi_valid=0,ie(A)}function ct(A,J,ae,ye){Te(A,(c<<1)+(ye?1:0),3),Se(A,J,ae)}function Ke(A){Te(A,_<<1,3),Be(A,k,Q),z(A)}function lt(A,J,ae,ye){var P,d,o=0;A.level>0?(A.strm.data_type===f&&(A.strm.data_type=dt(A)),Me(A,A.l_desc),Me(A,A.d_desc),o=tt(A),P=A.opt_len+3+7>>>3,d=A.static_len+3+7>>>3,d<=P&&(P=d)):P=d=ae+5,ae+4<=P&&J!==-1?ct(A,J,ae,ye):A.strategy===s||d===P?(Te(A,(_<<1)+(ye?1:0),3),_e(A,Q,fe)):(Te(A,(y<<1)+(ye?1:0),3),ut(A,A.l_desc.max_code+1,A.d_desc.max_code+1,o+1),_e(A,A.dyn_ltree,A.dyn_dtree)),ie(A),ye&&me(A)}function wt(A,J,ae){return A.pending_buf[A.d_buf+A.last_lit*2]=J>>>8&255,A.pending_buf[A.d_buf+A.last_lit*2+1]=J&255,A.pending_buf[A.l_buf+A.last_lit]=ae&255,A.last_lit++,J===0?A.dyn_ltree[ae*2]++:(A.matches++,J--,A.dyn_ltree[(le[ae]+v+1)*2]++,A.dyn_dtree[Ue(J)*2]++),A.last_lit===A.lit_bufsize-1}i._tr_init=pt,i._tr_stored_block=ct,i._tr_flush_block=lt,i._tr_tally=wt,i._tr_align=Ke},{"../utils/common":41}],53:[function(t,r,i){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=n},{}],54:[function(t,r,i){(function(n){(function(s,a){if(s.setImmediate)return;var l=1,f={},p=!1,c=s.document,_;function y(R){typeof R!="function"&&(R=new Function(""+R));for(var k=new Array(arguments.length-1),I=0;I<k.length;I++)k[I]=arguments[I+1];var X={callback:R,args:k};return f[l]=X,_(l),l++}function O(R){delete f[R]}function E(R){var k=R.callback,I=R.args;switch(I.length){case 0:k();break;case 1:k(I[0]);break;case 2:k(I[0],I[1]);break;case 3:k(I[0],I[1],I[2]);break;default:k.apply(a,I);break}}function h(R){if(p)setTimeout(h,0,R);else{var k=f[R];if(k){p=!0;try{E(k)}finally{O(R),p=!1}}}}function v(){_=function(R){process.nextTick(function(){h(R)})}}function g(){if(s.postMessage&&!s.importScripts){var R=!0,k=s.onmessage;return s.onmessage=function(){R=!1},s.postMessage("","*"),s.onmessage=k,R}}function C(){var R="setImmediate$"+Math.random()+"$",k=function(I){I.source===s&&typeof I.data=="string"&&I.data.indexOf(R)===0&&h(+I.data.slice(R.length))};s.addEventListener?s.addEventListener("message",k,!1):s.attachEvent("onmessage",k),_=function(I){s.postMessage(R+I,"*")}}function B(){var R=new MessageChannel;R.port1.onmessage=function(k){var I=k.data;h(I)},_=function(k){R.port2.postMessage(k)}}function b(){var R=c.documentElement;_=function(k){var I=c.createElement("script");I.onreadystatechange=function(){h(k),I.onreadystatechange=null,R.removeChild(I),I=null},R.appendChild(I)}}function T(){_=function(R){setTimeout(h,0,R)}}var N=Object.getPrototypeOf&&Object.getPrototypeOf(s);N=N&&N.setTimeout?N:s,{}.toString.call(s.process)==="[object process]"?v():g()?C():s.MessageChannel?B():c&&"onreadystatechange"in c.createElement("script")?b():T(),N.setImmediate=y,N.clearImmediate=O})(typeof self>"u"?typeof n>"u"?this:n:self)}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fi)),fi.exports}var Ia=Ra();const Oa=Zt(Ia);class Ba{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new Oa}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return tr(e,"binary").then((function(r){return this.zip.loadAsync(r,{base64:t})}).bind(this))}request(e,t){var r=new Pe,i,n=new Rt(e);return t||(t=n.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i?i.then((function(s){let a=this.handleResponse(s,t);r.resolve(a)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):er(t)?r=Ct(e,"text/xml"):t=="xhtml"?r=Ct(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ct(e,"text/html"):r=e,r}getBlob(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||Vt.lookup(i.name),i.async("uint8array").then(function(n){return new Blob([n],{type:t})})}getText(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return i.async("string").then(function(n){return n})}getBase64(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||Vt.lookup(i.name),i.async("base64").then(function(n){return"data:"+t+";base64,"+n})}createUrl(e,t){var r=new Pe,i=window.URL||window.webkitURL||window.mozURL,n,s,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(s=this.getBase64(e),s&&s.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(s=this.getBlob(e),s&&s.then((function(l){n=i.createObjectURL(l),this.urlCache[e]=n,r.resolve(n)}).bind(this))),s||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}class es{constructor(e,t,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||tr,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Ye>"u"&&(e=Ye),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let r=e.resources.map(i=>{let{href:n}=i,s=this.resolver(n),a=window.encodeURIComponent(s);return this.storage.getItem(a).then(l=>!l||t?this.requester(s,"binary").then(f=>this.storage.setItem(a,f)):l)});return Promise.all(r)}put(e,t,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(n=>n||this.requester(e,"binary",t,r).then(s=>this.storage.setItem(i,s)))}request(e,t,r,i){return this.online?this.requester(e,t,r,i).then(n=>(this.put(e),n)):this.retrieve(e,t)}retrieve(e,t){new Pe;var r,i=new Rt(e);return t||(t=i.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(n=>{var s=new Pe,a;return n?(a=this.handleResponse(n,t),s.resolve(a)):s.reject({message:"File not found in storage: "+e,stack:new Error().stack}),s.promise})}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):er(t)?r=Ct(e,"text/xml"):t=="xhtml"?r=Ct(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ct(e,"text/html"):r=e,r}getBlob(e,t){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(i){if(i)return t=t||Vt.lookup(e),new Blob([i],{type:t})})}getText(e,t){let r=window.encodeURIComponent(e);return t=t||Vt.lookup(e),this.storage.getItem(r).then(function(i){var n=new Pe,s=new FileReader,a;if(i)return a=new Blob([i],{type:t}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsText(a,t),n.promise})}getBase64(e,t){let r=window.encodeURIComponent(e);return t=t||Vt.lookup(e),this.storage.getItem(r).then(i=>{var n=new Pe,s=new FileReader,a;if(i)return a=new Blob([i],{type:t}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsDataURL(a,t),n.promise})}createUrl(e,t){var r=new Pe,i=window.URL||window.webkitURL||window.mozURL,n,s,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(s=this.getBase64(e),s&&s.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(s=this.getBlob(e),s&&s.then((function(l){n=i.createObjectURL(l),this.urlCache[e]=n,r.resolve(n)}).bind(this))),s||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}St(es.prototype);class ci{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=Ze(e,"display_options");return t?(Nt(t,"option").forEach(i=>{let n="";switch(i.childNodes.length&&(n=i.childNodes[0].nodeValue),i.attributes.name.value){case"interactive":this.interactive=n;break;case"fixed-layout":this.fixedLayout=n;break;case"open-to-spread":this.openToSpread=n;break;case"orientation-lock":this.orientationLock=n;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const kn="META-INF/container.xml",La="META-INF/com.apple.ibooks.display-options.xml",xt={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class Si{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=ft(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),ft(this.settings,t),this.opening=new Pe,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Pe,spine:new Pe,metadata:new Pe,cover:new Pe,navigation:new Pe,pageList:new Pe,resources:new Pe,displayOptions:new Pe},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||tr,this.spine=new Ks,this.locations=new Gn(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var i=new Error("Cannot load book at "+e);this.emit(ve.BOOK.OPEN_FAILED,i)})}open(e,t){var r,i=t||this.determineType(e);return i===xt.BINARY?(this.archived=!0,this.url=new Dt("/",""),r=this.openEpub(e)):i===xt.BASE64?(this.archived=!0,this.url=new Dt("/",""),r=this.openEpub(e,i)):i===xt.EPUB?(this.archived=!0,this.url=new Dt("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==xt.OPF?(this.url=new Dt(e),r=this.openPackaging(this.url.Path.toString())):i==xt.MANIFEST?(this.url=new Dt(e),r=this.openManifest(this.url.Path.toString())):(this.url=new Dt(e),r=this.openContainer(kn).then(this.openPackaging.bind(this))),r}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(kn)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(t=>(this.container=new Js(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Rt(e),this.load(e).then(t=>(this.packaging=new un(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new Rt(e),this.load(e).then(t=>(this.packaging=new un,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var r=e,i=e.indexOf("://")>-1;return i?e:(this.path&&(r=this.path.resolve(e)),t!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,r,i;if(this.settings.encoding==="base64")return xt.BASE64;if(typeof e!="string")return xt.BINARY;if(t=new Dt(e),r=t.path(),i=r.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return xt.DIRECTORY;if(i==="epub")return xt.EPUB;if(i==="opf")return xt.OPF;if(i==="json")return xt.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(La)).then(t=>{this.displayOptions=new ci(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new ci,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new ci,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new ra(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((i,n)=>{this.navigation=new Xr(r),e.pageList&&(this.pageList=new Yr(e.pageList)),i(this.navigation)}):t?this.load(t,"xml").then(i=>(this.navigation=new Xr(i),this.pageList=new Yr(i),this.navigation)):new Promise((i,n)=>{this.navigation=new Xr,this.pageList=new Yr,i(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new Ci(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new Ba,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,i=this.settings.requestMethod||tr.bind(this);return this.storage=new es(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(s,a)=>{a.output=this.resources.substitute(s,a.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Dt("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new ze(e),r=this.spine.get(t.spinePos),i=this.load.bind(this);return r?r.load(i).then(function(n){var s=t.toRange(r.document);return s}):new Promise((n,s)=>{s("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${wr}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}St(Si.prototype);function Bt(m,e){return new Si(m,e)}Bt.VERSION=wr;typeof global<"u"&&(global.EPUBJS_VERSION=wr);Bt.Book=Si;Bt.Rendition=Ci;Bt.Contents=Di;Bt.CFI=ze;Bt.utils=Ws;const ht=[];for(let m=0;m<256;++m)ht.push((m+256).toString(16).slice(1));function Fa(m,e=0){return(ht[m[e+0]]+ht[m[e+1]]+ht[m[e+2]]+ht[m[e+3]]+"-"+ht[m[e+4]]+ht[m[e+5]]+"-"+ht[m[e+6]]+ht[m[e+7]]+"-"+ht[m[e+8]]+ht[m[e+9]]+"-"+ht[m[e+10]]+ht[m[e+11]]+ht[m[e+12]]+ht[m[e+13]]+ht[m[e+14]]+ht[m[e+15]]).toLowerCase()}let di;const Pa=new Uint8Array(16);function za(){if(!di){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");di=crypto.getRandomValues.bind(crypto)}return di(Pa)}const Ua=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Nn={randomUUID:Ua};function or(m,e,t){var i;if(Nn.randomUUID&&!m)return Nn.randomUUID();m=m||{};const r=m.random??((i=m.rng)==null?void 0:i.call(m))??za();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Fa(r)}Ye.config({name:"NeatReader",storeName:"ebookStore",description:"Neat Reader"});const ja=hs("ebook",()=>{const m=Pt([]),e=Pt([]),t=Pt(null),r=Pt(null),i=Pt({storage:{default:"local",localPath:"",autoSync:!0,syncInterval:15,baidupan:{accessToken:"",refreshToken:"",expiration:0,rootPath:"",userId:"",namingStrategy:"1"}},reader:{fontSize:18,fontFamily:"system",theme:"light",pageMode:"page",brightness:100,lineSpacing:1.5,lineHeight:1.5,paragraphSpacing:8,autoSaveInterval:10},ui:{viewMode:"grid",language:"zh-CN"}}),n=Pt({id:"device-1",name:"",type:"desktop",platform:"windows",lastSync:Date.now()}),s=$t(()=>m.value.filter(z=>z.storageType==="local")),a=$t(()=>m.value.filter(z=>z.storageType==="baidupan")),l=$t(()=>[...m.value].sort((z,M)=>M.lastRead-z.lastRead).slice(0,10)),f=$t(()=>z=>m.value.filter(M=>M.categoryId===z)),p=$t(()=>z=>e.value.find(M=>M.id===z)||null),c=z=>new Promise(async(M,Y)=>{try{const ie=await(await fetch(z)).blob(),me=new FileReader;me.onloadend=()=>M(me.result),me.onerror=Y,me.readAsDataURL(ie)}catch(te){Y(te)}}),_=async()=>{try{console.log("...");const z=await Ye.getItem("books");z?(console.log(":",z.length),m.value=z,await Promise.all(m.value.map(async M=>{if(M.cover&&M.cover.startsWith("blob:")&&(console.log(" blob :",M.id),M.cover=""),M.format==="epub"&&!M.cover)try{console.log(":",M.id);const Y=await Ye.getItem(`ebook_content_${M.id}`);if(Y){const te=Bt(Y);await new Promise((me,Se)=>{te.ready.then(me).catch(Se)});const ie=await te.coverUrl();if(ie)if(ie.startsWith("blob:"))try{console.log(" Base64"),M.cover=await c(ie),console.log(":",M.id),URL.revokeObjectURL(ie)}catch(me){console.warn(" Base64 :",me)}else M.cover=ie,console.log(":",M.id)}}catch(Y){console.warn(":",M.id,Y)}})),m.value.length>0&&console.log(":",{id:m.value[0].id,title:m.value[0].title,author:m.value[0].author,cover:m.value[0].cover,storageType:m.value[0].storageType})):(console.log(""),m.value=[])}catch(z){console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),m.value=[]}},y=async()=>{try{const z=m.value.map(M=>({id:M.id,title:M.title,author:M.author,cover:M.cover||"",path:M.path,format:M.format,size:M.size,lastRead:M.lastRead,totalChapters:M.totalChapters,readingProgress:M.readingProgress,storageType:M.storageType,baidupanPath:M.baidupanPath,categoryId:M.categoryId,addedAt:M.addedAt}));console.log(":",z.length),await Ye.setItem("books",z),console.log("")}catch(z){console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack))}},O=async()=>{try{console.log("...");const z=await Ye.getItem("categories");if(z&&Array.isArray(z)&&z.length>0)console.log(":",z.length),e.value=z.map(M=>({id:M.id||`category_${Date.now()}_${Math.random()}`,name:M.name||"",color:M.color||"#999999",bookIds:Array.isArray(M.bookIds)?[...M.bookIds]:[],createdAt:M.createdAt||Date.now(),updatedAt:M.updatedAt||Date.now()}));else{console.log(""),e.value=[];const M={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};e.value.push(M),await Ye.setItem("categories",[M]),console.log("")}}catch(z){console.error(":",z),e.value=[];const M={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};e.value.push(M);try{await Ye.setItem("categories",[M])}catch(Y){console.error(":",Y)}}},E=async()=>{try{console.log(":",e.value.length),console.log(":",JSON.stringify(e.value));const z=e.value.map(Y=>({id:Y.id,name:Y.name,color:Y.color,bookIds:Array.isArray(Y.bookIds)?[...Y.bookIds]:[],createdAt:Y.createdAt,updatedAt:Y.updatedAt}));console.log(":",JSON.stringify(z)),await Ye.setItem("categories",z);const M=await Ye.getItem("categories");console.log(":",M),M&&Array.isArray(M)&&M.length===z.length?console.log(""):console.error("")}catch(z){throw console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),z}},h=async(z,M)=>{try{console.log(":",z,M);const Y={id:`category_${or()}`,name:z,color:M,bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};return console.log(":",Y),e.value.push(Y),console.log(":",e.value.length),console.log("..."),await E(),console.log(":",Y.name),Y}catch(Y){throw console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),Y}},v=async(z,M)=>{try{const Y=e.value.findIndex(te=>te.id===z);return Y!==-1?(e.value[Y]={...e.value[Y],...M,updatedAt:Date.now()},await E(),console.log(":",e.value[Y].name),!0):!1}catch(Y){return console.error(":",Y),!1}},g=async z=>{try{const M=e.value.findIndex(Y=>Y.id===z);if(M!==-1){const Y=e.value[M].name,te=e.value.find(ie=>ie.name==="");if(te){for(const ie of e.value[M].bookIds){const me=m.value.findIndex(Se=>Se.id===ie);me!==-1&&(m.value[me].categoryId=te.id)}await y()}return e.value.splice(M,1),await E(),console.log(":",Y),!0}return!1}catch(M){return console.error(":",M),!1}},C=async(z,M)=>{try{const Y=m.value.findIndex(te=>te.id===z);if(Y!==-1){if(m.value[Y].categoryId){const ie=e.value.findIndex(me=>me.id===m.value[Y].categoryId);ie!==-1&&(e.value[ie].bookIds=e.value[ie].bookIds.filter(me=>me!==z),e.value[ie].updatedAt=Date.now())}m.value[Y].categoryId=M;const te=e.value.findIndex(ie=>ie.id===M);return te!==-1&&!e.value[te].bookIds.includes(z)&&(e.value[te].bookIds.push(z),e.value[te].updatedAt=Date.now()),await y(),await E(),console.log(":",z,"->",M),!0}return!1}catch(Y){return console.error(":",Y),!1}},B=async z=>{try{const M=m.value.findIndex(Y=>Y.id===z);if(M!==-1&&m.value[M].categoryId){const Y=m.value[M].categoryId,te=e.value.findIndex(ie=>ie.id===Y);return te!==-1&&(e.value[te].bookIds=e.value[te].bookIds.filter(ie=>ie!==z),e.value[te].updatedAt=Date.now()),m.value[M].categoryId=void 0,await y(),await E(),console.log(":",z),!0}return!1}catch(M){return console.error(":",M),!1}},b=async z=>{var M;try{console.log(":",z);const Y=m.value.filter(ie=>ie.title.toLowerCase().includes(z.toLowerCase())||ie.author.toLowerCase().includes(z.toLowerCase()));console.log(":",Y.length);const te=await Ae();if(console.log(":",te),te){const{accessToken:ie,rootPath:me}=i.value.storage.baidupan,Se=`${ee.apiUrl}/search`,we=me||`/apps/${ge}`,Ee=`${Se}?access_token=${ie}&key=${encodeURIComponent(z)}&dir=${encodeURIComponent(we)}&recursion=1`;console.log("URL:",Ee),console.log(":",we);try{const _e=await fetch(Ee,{method:"GET",headers:{"Content-Type":"application/json"}});if(_e.ok){const Me=await _e.json();if(console.log(":",Me),Me.list&&Array.isArray(Me.list)&&Me.list.length>0)for(const Xe of Me.list){if(!Xe.server_filename)continue;const st=(M=Xe.server_filename.split(".").pop())==null?void 0:M.toLowerCase();if(["epub","pdf","txt"].includes(st||"")&&!m.value.find(ut=>ut.baidupanPath===Xe.path)){const ut={id:`baidupan_${Xe.fs_id||Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:Xe.server_filename.replace(`.${st}`,""),author:"",cover:"",path:Xe.path||"",format:st||"txt",size:Xe.size||0,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"baidupan",baidupanPath:Xe.path||"",addedAt:Date.now()};Y.push(ut),console.log(":",ut.title)}}else console.log("")}else console.warn("API:",_e.status)}catch(_e){console.warn(":",_e)}}else console.log("");return console.log(":",Y.length),Y}catch(Y){return console.error(":",Y),[]}},T=async z=>{try{console.log(":",z.title),m.value.push(z),await y(),console.log("")}catch(M){throw console.error(":",M),M instanceof Error&&(console.error(":",M.message),console.error(":",M.stack)),M}},N=async(z,M)=>{const Y=m.value.findIndex(te=>te.id===z);Y!==-1&&(m.value[Y]={...m.value[Y],...M},await y())},R=async(z,M)=>{try{const Y=m.value.findIndex(ie=>ie.id===z);if(Y===-1)return!1;const te=M||m.value[Y].storageType;return m.value.splice(Y,1),y(),te==="local"&&(Ye.removeItem(`ebook_content_${z}`),Ye.removeItem(`ebook_cover_${z}`)),console.log(""),!0}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),!1}},k=z=>m.value.find(M=>M.id===z)||null,I=z=>{t.value=z},X=async z=>{try{const M=await Ye.getItem(`progress_${z}`);return r.value=M||null,M}catch(M){return console.error(":",M),null}},H=async z=>{try{r.value=z,await Ye.setItem(`progress_${z.ebookId}`,z),await N(z.ebookId,{lastRead:z.timestamp,readingProgress:Math.round(z.position*100)})}catch(M){console.error(":",M)}},$=async()=>{try{const z=await Ye.getItem("userConfig");z&&(z.storage.baidupan.rootPath==="/NeatReader"&&(z.storage.baidupan.rootPath=""),i.value=z)}catch(z){console.error(":",z)}},se=async()=>{try{const z=JSON.parse(JSON.stringify(i.value));await Ye.setItem("userConfig",z)}catch(z){console.error(":",z)}},re=async z=>{i.value={...i.value,...z},await se()},ge="Neat Reader",ee={clientId:"WreV7F9LXSzyYOQzzP7Ih1UmvuDxN763",clientSecret:"hNAobFVEevG7kseZry9xq3LM6jxoWSLz",redirectUri:"http://localhost:8080/callback",apiUrl:"http://localhost:3001/api/baidu/pan",oauthUrl:"http://localhost:3001/api/baidu/oauth"},Q=async()=>{try{const{refreshToken:z}=i.value.storage.baidupan;if(!z)return!1;const M=new URLSearchParams({client_id:ee.clientId,client_secret:ee.clientSecret,grant_type:"refresh_token",refresh_token:z}),Y=`${ee.oauthUrl}/token?${M.toString()}`;console.log("URL:",Y);const te=await fetch(Y,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log(":",te.status,te.statusText),!te.ok){const me=await te.text();return console.error(":",te.status,":",me),!1}const ie=await te.json();return console.log(":",{access_token:ie.access_token?"***":null,refresh_token:ie.refresh_token?"***":null,expires_in:ie.expires_in}),ie.error_code?(console.error(" API :",ie.error_code,ie.error_msg),!1):ie.access_token?(await re({storage:{...i.value.storage,baidupan:{...i.value.storage.baidupan,accessToken:ie.access_token,refreshToken:ie.refresh_token,expiration:Date.now()+ie.expires_in*1e3}}}),!0):!1}catch(z){return console.error(":",z),z instanceof Error&&(console.error(":",z.message),console.error(":",z.stack)),!1}},fe=()=>{const{accessToken:z,expiration:M}=i.value.storage.baidupan;return!!z&&M>Date.now()},Ae=async()=>fe()?!0:await Q(),le=z=>z>4294967296?(console.error(` ${(4294967296/(1024*1024*1024)).toFixed(1)}GB`),!1):!0,pe=async(z,M)=>{try{if(!await Ae()||!le(z.size))return!1;const{accessToken:Y}=i.value.storage.baidupan,te=M?M.replace(/^\/+|\/+$/g,""):"";console.log("Go:",z.name,":",te);const ie=new FormData;ie.append("accessToken",Y),ie.append("path",te),ie.append("file",z);const me=`${ee.apiUrl}/upload`;console.log("URL:",me);const Se=await fetch(me,{method:"POST",body:ie});if(!Se.ok)return console.error(":",Se.status,await Se.text()),!1;const we=await Se.json();return console.log(":",we),we.success?(console.log(":",we.path),!0):(console.error("errno:",we.errno),!1)}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),!1}},Ne=async z=>{try{if(!await Ae())return console.error(""),!1;console.log(" IndexedDB :",`ebook_content_${z.id}`);const M=await Ye.getItem(`ebook_content_${z.id}`);if(!M)return console.error(""),!1;console.log(":",M.byteLength);const te=`${(we=>{let Ee=we.replace(/[<>:"|?*\/\\]/g,"").replace(/\s+/g,"_").trim();return Ee.length>200&&(Ee=Ee.substring(0,200)),Ee})(z.title)}.${z.format}`,ie=new File([M],te,{type:`application/${z.format==="epub"?"epub+zip":z.format}`});console.log(" File :",te);let me=i.value.storage.baidupan.rootPath;return(!me||me==="/")&&(me=""),console.log(":",me?`${me}/${te}`:te),await pe(ie,me)?(console.log(""),await N(z.id,{storageType:"baidupan",baidupanPath:`${me}/${te}`,cover:z.cover}),!0):(console.error("uploadToBaidupan  false"),!1)}catch(M){return console.error(":",M),M instanceof Error&&(console.error(":",M.message),console.error(":",M.stack)),!1}},De=async z=>{try{if(!await Ae())return null;const{accessToken:M}=i.value.storage.baidupan,Y=`${ee.apiUrl}/file?method=download&path=${encodeURIComponent(z)}&fld_list=`;console.log("URL:",Y);const ie=await(await fetch(Y,{method:"GET",headers:{Authorization:`Bearer ${M}`}})).json();if(console.log(":",ie),ie.error_code)return console.error(":",ie),null;const me=await fetch(ie.download_url);return me.ok?await me.blob():(console.error(":",me.status),null)}catch(M){return console.error(":",M),null}},Oe=async z=>{try{if(!await Ae())return[];const{accessToken:M}=i.value.storage.baidupan,Y=`${ee.apiUrl}/file?method=list&path=${encodeURIComponent(z)}&web=1&order=name&desc=0`;console.log("URL:",Y);const ie=await(await fetch(Y,{method:"GET",headers:{Authorization:`Bearer ${M}`}})).json();return console.log(":",ie),ie.error_code?(console.error(":",ie),[]):ie.list||[]}catch(M){return console.error(":",M),[]}},Ge=async()=>{try{if(!await Ae())return console.error(""),!1;console.log(":",m.value.length);const z={ebooks:m.value,timestamp:Date.now(),deviceId:n.value.id,deviceName:n.value.name},M=new File([JSON.stringify(z)],"books.json",{type:"application/json"});await pe(M,"/sync");const Y={categories:e.value,timestamp:Date.now(),deviceId:n.value.id},te=new File([JSON.stringify(Y)],"categories.json",{type:"application/json"});await pe(te,"/sync"),console.log("");let ie=0;const me=10;for(let Se=0;Se<m.value.length;Se+=me){const Ee=m.value.slice(Se,Se+me).map(async _e=>{try{const Me=await Ye.getItem(`progress_${_e.id}`);if(Me){const Xe=new File([JSON.stringify(Me)],`${_e.id}.json`,{type:"application/json"});await pe(Xe,"/sync/progress"),ie++}}catch(Me){console.error(`: ${_e.id}`,Me)}});await Promise.all(Ee)}return console.log(` ${ie} `),!0}catch(z){return console.error(":",z),!1}},qe=z=>{fe()&&(console.log(":",z),(async()=>{try{const M=await Ye.getItem(`progress_${z}`);if(M){const Y=new File([JSON.stringify(M)],`${z}.json`,{type:"application/json"});await pe(Y,"/sync/progress"),console.log(":",z)}}catch(M){console.warn(":",M)}})())},Ce=async()=>{var z;try{if(!await Ae())return console.error(""),!1;console.log("");const M=await De("/sync/books.json");if(M){const ie=await M.text(),me=JSON.parse(ie);me.ebooks&&(m.value=me.ebooks,await y(),console.log(":",m.value.length))}const Y=await De("/sync/categories.json");if(Y){const ie=await Y.text(),me=JSON.parse(ie);me.categories&&(e.value=me.categories,await E(),console.log(":",e.value.length))}let te=0;for(const ie of m.value)try{const me=await De(`/sync/progress/${ie.id}.json`);if(me){const Se=await me.text(),we=JSON.parse(Se);await Ye.setItem(`progress_${ie.id}`,we),ie.id===((z=r.value)==null?void 0:z.ebookId)&&(r.value=we),te++}}catch(me){console.error(`: ${ie.id}`,me)}return console.log(` ${te} `),!0}catch(M){return console.error(":",M),!1}},Ue=async z=>{try{console.log(" EPUB :",z.name);const M=`epub_${or()}`,Y=await z.arrayBuffer();console.log(" IndexedDB:",`ebook_content_${M}`),await Ye.setItem(`ebook_content_${M}`,Y);let te="",ie="",me=z.name.replace(".epub","");try{const we=Bt(Y);await new Promise((Me,Xe)=>{we.ready.then(Me).catch(Xe)});const Ee=await we.loaded.metadata;console.log("EPUB :",Ee),Ee.creator&&(Array.isArray(Ee.creator)?ie=Ee.creator.join(", "):ie=Ee.creator),Ee.title&&(me=Ee.title);const _e=await we.coverUrl();if(console.log(" URL:",_e),_e)if(typeof _e=="string"&&_e.startsWith("blob:"))try{console.log(" Blob URL  Base64"),te=await c(_e),console.log("Base64 :",te.length),URL.revokeObjectURL(_e)}catch(Me){console.warn(" Base64 :",Me),te=""}else te=_e}catch(we){console.warn(":",we)}const Se={id:M,title:me,author:ie,cover:te,path:M,format:"epub",size:z.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return console.log(":",{id:Se.id,title:Se.title,author:Se.author,cover:Se.cover,storageType:Se.storageType}),await T(Se),console.log("EPUB "),Se}catch(M){return console.error(" EPUB :",M),M instanceof Error&&(console.error(":",M.message),console.error(":",M.stack)),null}},We=async z=>{try{const M=`pdf_${or()}`,Y=await z.arrayBuffer();await Ye.setItem(`ebook_content_${M}`,Y);const te={id:M,title:z.name.replace(".pdf",""),author:"",cover:"",path:M,format:"pdf",size:z.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return await T(te),te}catch(M){return console.error(" PDF :",M),null}},Te=async z=>{try{const M=`txt_${or()}`,Y=await z.arrayBuffer();await Ye.setItem(`ebook_content_${M}`,Y);const te={id:M,title:z.name.replace(".txt",""),author:"",cover:"",path:M,format:"txt",size:z.size,lastRead:Date.now(),totalChapters:1,readingProgress:0,storageType:"local",addedAt:Date.now()};return await T(te),te}catch(M){return console.error(" TXT :",M),null}};return{books:m,categories:e,currentBook:t,readingProgress:r,userConfig:i,deviceInfo:n,localBooks:s,baidupanBooks:a,recentBooks:l,getBooksByCategory:f,getCategoryById:p,loadBooks:_,saveBooks:y,addBook:T,updateBook:N,removeBook:R,getBookById:k,setCurrentBook:I,loadReadingProgress:X,saveReadingProgress:H,loadUserConfig:$,saveUserConfig:se,updateUserConfig:re,loadCategories:O,saveCategories:E,addCategory:h,updateCategory:v,deleteCategory:g,addBookToCategory:C,removeBookFromCategory:B,searchBooks:b,syncReadingProgress:Ge,syncReadingProgressFromBaidupan:Ce,importEpubFile:Ue,importPdfFile:We,importTxtFile:Te,importEbookFile:async z=>{var M;try{const Y=(M=z.name.split(".").pop())==null?void 0:M.toLowerCase();if(!Y)throw console.error(""),new Error("");switch(Y){case"epub":return await Ue(z);case"pdf":return await We(z);case"txt":return await Te(z);default:throw console.error(":",Y),new Error(`: ${Y}`)}}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),null}},uploadLocalBookToBaidupan:Ne,downloadFromBaidupan:De,listBaidupanFiles:Oe,isBaidupanTokenValid:fe,syncCurrentBookProgress:qe,initialize:async()=>{await Promise.all([_(),$(),O()])}}});export{Bt as e,Zt as g,Ye as l,ja as u};
