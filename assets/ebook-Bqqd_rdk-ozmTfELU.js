import{j as ls,Q as Ue,F as Ye}from"./index-BXAhAS9o.js";var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ze(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}function Le(v){throw new Error('Could not dynamically require "'+v+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bi={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var _i;function hs(){return _i||(_i=1,(function(v,t){(function(e){v.exports=e()})(function(){return(function e(r,i,n){function s(u,d){if(!i[u]){if(!r[u]){var p=typeof Le=="function"&&Le;if(!d&&p)return p(u,!0);if(o)return o(u,!0);var y=new Error("Cannot find module '"+u+"'");throw y.code="MODULE_NOT_FOUND",y}var _=i[u]={exports:{}};r[u][0].call(_.exports,function(O){var x=r[u][1][O];return s(x||O)},_,_.exports,e,r,i,n)}return i[u].exports}for(var o=typeof Le=="function"&&Le,h=0;h<n.length;h++)s(n[h]);return s})({1:[function(e,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,o;if(s){var h=0,u=new s(O),d=n.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=h=++h%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var p=new n.MessageChannel;p.port1.onmessage=O,o=function(){p.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var c=n.document.createElement("script");c.onreadystatechange=function(){O(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},n.document.documentElement.appendChild(c)}:o=function(){setTimeout(O,0)};var y,_=[];function O(){y=!0;for(var c,g,m=_.length;m;){for(g=_,_=[],c=-1;++c<m;)g[c]();m=_.length}y=!1}r.exports=x;function x(c){_.push(c)===1&&!y&&o()}}).call(this,typeof we<"u"?we:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(e,r,i){var n=e(1);function s(){}var o={},h=["REJECTED"],u=["FULFILLED"],d=["PENDING"];r.exports=p;function p(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,b!==s&&x(this,b)}p.prototype.catch=function(b){return this.then(null,b)},p.prototype.then=function(b,L){if(typeof b!="function"&&this.state===u||typeof L!="function"&&this.state===h)return this;var T=new this.constructor(s);if(this.state!==d){var D=this.state===u?b:L;_(T,D,this.outcome)}else this.queue.push(new y(T,b,L));return T};function y(b,L,T){this.promise=b,typeof L=="function"&&(this.onFulfilled=L,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}y.prototype.callFulfilled=function(b){o.resolve(this.promise,b)},y.prototype.otherCallFulfilled=function(b){_(this.promise,this.onFulfilled,b)},y.prototype.callRejected=function(b){o.reject(this.promise,b)},y.prototype.otherCallRejected=function(b){_(this.promise,this.onRejected,b)};function _(b,L,T){n(function(){var D;try{D=L(T)}catch(N){return o.reject(b,N)}D===b?o.reject(b,new TypeError("Cannot resolve promise with itself")):o.resolve(b,D)})}o.resolve=function(b,L){var T=c(O,L);if(T.status==="error")return o.reject(b,T.value);var D=T.value;if(D)x(b,D);else{b.state=u,b.outcome=L;for(var N=-1,A=b.queue.length;++N<A;)b.queue[N].callFulfilled(L)}return b},o.reject=function(b,L){b.state=h,b.outcome=L;for(var T=-1,D=b.queue.length;++T<D;)b.queue[T].callRejected(L);return b};function O(b){var L=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof L=="function")return function(){L.apply(b,arguments)}}function x(b,L){var T=!1;function D(X){T||(T=!0,o.reject(b,X))}function N(X){T||(T=!0,o.resolve(b,X))}function A(){L(N,D)}var W=c(A);W.status==="error"&&D(W.value)}function c(b,L){var T={};try{T.value=b(L),T.status="success"}catch(D){T.status="error",T.value=D}return T}p.resolve=g;function g(b){return b instanceof this?b:o.resolve(new this(s),b)}p.reject=m;function m(b){var L=new this(s);return o.reject(L,b)}p.all=C;function C(b){var L=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var N=new Array(T),A=0,W=-1,X=new this(s);++W<T;)$(b[W],W);return X;function $(et,at){L.resolve(et).then(pt,function(tt){D||(D=!0,o.reject(X,tt))});function pt(tt){N[at]=tt,++A===T&&!D&&(D=!0,o.resolve(X,N))}}}p.race=z;function z(b){var L=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var N=-1,A=new this(s);++N<T;)W(b[N]);return A;function W(X){L.resolve(X).then(function($){D||(D=!0,o.resolve(A,$))},function($){D||(D=!0,o.reject(A,$))})}}},{1:1}],3:[function(e,r,i){(function(n){typeof n.Promise!="function"&&(n.Promise=e(2))}).call(this,typeof we<"u"?we:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(e,r,i){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E};function s(E,I){if(!(E instanceof I))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var h=o();function u(){try{if(!h||!h.open)return!1;var E=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),I=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!E||I)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(E,I){E=E||[],I=I||{};try{return new Blob(E,I)}catch(V){if(V.name!=="TypeError")throw V;for(var R=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,H=new R,F=0;F<E.length;F+=1)H.append(E[F]);return H.getBlob(I.type)}}typeof Promise>"u"&&e(3);var p=Promise;function y(E,I){I&&E.then(function(R){I(null,R)},function(R){I(R)})}function _(E,I,R){typeof I=="function"&&E.then(I),typeof R=="function"&&E.catch(R)}function O(E){return typeof E!="string"&&(console.warn(E+" used as a key, but it is not a string."),E=String(E)),E}function x(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var c="local-forage-detect-blob-support",g=void 0,m={},C=Object.prototype.toString,z="readonly",b="readwrite";function L(E){for(var I=E.length,R=new ArrayBuffer(I),H=new Uint8Array(R),F=0;F<I;F++)H[F]=E.charCodeAt(F);return R}function T(E){return new p(function(I){var R=E.transaction(c,b),H=d([""]);R.objectStore(c).put(H,"key"),R.onabort=function(F){F.preventDefault(),F.stopPropagation(),I(!1)},R.oncomplete=function(){var F=navigator.userAgent.match(/Chrome\/(\d+)/),V=navigator.userAgent.match(/Edge\//);I(V||!F||parseInt(F[1],10)>=43)}}).catch(function(){return!1})}function D(E){return typeof g=="boolean"?p.resolve(g):T(E).then(function(I){return g=I,g})}function N(E){var I=m[E.name],R={};R.promise=new p(function(H,F){R.resolve=H,R.reject=F}),I.deferredOperations.push(R),I.dbReady?I.dbReady=I.dbReady.then(function(){return R.promise}):I.dbReady=R.promise}function A(E){var I=m[E.name],R=I.deferredOperations.pop();if(R)return R.resolve(),R.promise}function W(E,I){var R=m[E.name],H=R.deferredOperations.pop();if(H)return H.reject(I),H.promise}function X(E,I){return new p(function(R,H){if(m[E.name]=m[E.name]||mt(),E.db)if(I)N(E),E.db.close();else return R(E.db);var F=[E.name];I&&F.push(E.version);var V=h.open.apply(h,F);I&&(V.onupgradeneeded=function(K){var nt=V.result;try{nt.createObjectStore(E.storeName),K.oldVersion<=1&&nt.createObjectStore(c)}catch(ht){if(ht.name==="ConstraintError")console.warn('The database "'+E.name+'" has been upgraded from version '+K.oldVersion+" to version "+K.newVersion+', but the storage "'+E.storeName+'" already exists.');else throw ht}}),V.onerror=function(K){K.preventDefault(),H(V.error)},V.onsuccess=function(){var K=V.result;K.onversionchange=function(nt){nt.target.close()},R(K),A(E)}})}function $(E){return X(E,!1)}function et(E){return X(E,!0)}function at(E,I){if(!E.db)return!0;var R=!E.db.objectStoreNames.contains(E.storeName),H=E.version<E.db.version,F=E.version>E.db.version;if(H&&(E.version!==I&&console.warn('The database "'+E.name+`" can't be downgraded from version `+E.db.version+" to version "+E.version+"."),E.version=E.db.version),F||R){if(R){var V=E.db.version+1;V>E.version&&(E.version=V)}return!0}return!1}function pt(E){return new p(function(I,R){var H=new FileReader;H.onerror=R,H.onloadend=function(F){var V=btoa(F.target.result||"");I({__local_forage_encoded_blob:!0,data:V,type:E.type})},H.readAsBinaryString(E)})}function tt(E){var I=L(atob(E.data));return d([I],{type:E.type})}function ot(E){return E&&E.__local_forage_encoded_blob}function ut(E){var I=this,R=I._initReady().then(function(){var H=m[I._dbInfo.name];if(H&&H.dbReady)return H.dbReady});return _(R,E,E),R}function Ct(E){N(E);for(var I=m[E.name],R=I.forages,H=0;H<R.length;H++){var F=R[H];F._dbInfo.db&&(F._dbInfo.db.close(),F._dbInfo.db=null)}return E.db=null,$(E).then(function(V){return E.db=V,at(E)?et(E):V}).then(function(V){E.db=I.db=V;for(var K=0;K<R.length;K++)R[K]._dbInfo.db=V}).catch(function(V){throw W(E,V),V})}function ct(E,I,R,H){H===void 0&&(H=1);try{var F=E.db.transaction(E.storeName,I);R(null,F)}catch(V){if(H>0&&(!E.db||V.name==="InvalidStateError"||V.name==="NotFoundError"))return p.resolve().then(function(){if(!E.db||V.name==="NotFoundError"&&!E.db.objectStoreNames.contains(E.storeName)&&E.version<=E.db.version)return E.db&&(E.version=E.db.version+1),et(E)}).then(function(){return Ct(E).then(function(){ct(E,I,R,H-1)})}).catch(R);R(V)}}function mt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Rt(E){var I=this,R={db:null};if(E)for(var H in E)R[H]=E[H];var F=m[R.name];F||(F=mt(),m[R.name]=F),F.forages.push(I),I._initReady||(I._initReady=I.ready,I.ready=ut);var V=[];function K(){return p.resolve()}for(var nt=0;nt<F.forages.length;nt++){var ht=F.forages[nt];ht!==I&&V.push(ht._initReady().catch(K))}var lt=F.forages.slice(0);return p.all(V).then(function(){return R.db=F.db,$(R)}).then(function(st){return R.db=st,at(R,I._defaultConfig.version)?et(R):st}).then(function(st){R.db=F.db=st,I._dbInfo=R;for(var St=0;St<lt.length;St++){var zt=lt[St];zt!==I&&(zt._dbInfo.db=R.db,zt._dbInfo.version=R.version)}})}function xt(E,I){var R=this;E=O(E);var H=new p(function(F,V){R.ready().then(function(){ct(R._dbInfo,z,function(K,nt){if(K)return V(K);try{var ht=nt.objectStore(R._dbInfo.storeName),lt=ht.get(E);lt.onsuccess=function(){var st=lt.result;st===void 0&&(st=null),ot(st)&&(st=tt(st)),F(st)},lt.onerror=function(){V(lt.error)}}catch(st){V(st)}})}).catch(V)});return y(H,I),H}function At(E,I){var R=this,H=new p(function(F,V){R.ready().then(function(){ct(R._dbInfo,z,function(K,nt){if(K)return V(K);try{var ht=nt.objectStore(R._dbInfo.storeName),lt=ht.openCursor(),st=1;lt.onsuccess=function(){var St=lt.result;if(St){var zt=St.value;ot(zt)&&(zt=tt(zt));var Vt=E(zt,St.key,st++);Vt!==void 0?F(Vt):St.continue()}else F()},lt.onerror=function(){V(lt.error)}}catch(St){V(St)}})}).catch(V)});return y(H,I),H}function qt(E,I,R){var H=this;E=O(E);var F=new p(function(V,K){var nt;H.ready().then(function(){return nt=H._dbInfo,C.call(I)==="[object Blob]"?D(nt.db).then(function(ht){return ht?I:pt(I)}):I}).then(function(ht){ct(H._dbInfo,b,function(lt,st){if(lt)return K(lt);try{var St=st.objectStore(H._dbInfo.storeName);ht===null&&(ht=void 0);var zt=St.put(ht,E);st.oncomplete=function(){ht===void 0&&(ht=null),V(ht)},st.onabort=st.onerror=function(){var Vt=zt.error?zt.error:zt.transaction.error;K(Vt)}}catch(Vt){K(Vt)}})}).catch(K)});return y(F,R),F}function Bt(E,I){var R=this;E=O(E);var H=new p(function(F,V){R.ready().then(function(){ct(R._dbInfo,b,function(K,nt){if(K)return V(K);try{var ht=nt.objectStore(R._dbInfo.storeName),lt=ht.delete(E);nt.oncomplete=function(){F()},nt.onerror=function(){V(lt.error)},nt.onabort=function(){var st=lt.error?lt.error:lt.transaction.error;V(st)}}catch(st){V(st)}})}).catch(V)});return y(H,I),H}function Nt(E){var I=this,R=new p(function(H,F){I.ready().then(function(){ct(I._dbInfo,b,function(V,K){if(V)return F(V);try{var nt=K.objectStore(I._dbInfo.storeName),ht=nt.clear();K.oncomplete=function(){H()},K.onabort=K.onerror=function(){var lt=ht.error?ht.error:ht.transaction.error;F(lt)}}catch(lt){F(lt)}})}).catch(F)});return y(R,E),R}function jt(E){var I=this,R=new p(function(H,F){I.ready().then(function(){ct(I._dbInfo,z,function(V,K){if(V)return F(V);try{var nt=K.objectStore(I._dbInfo.storeName),ht=nt.count();ht.onsuccess=function(){H(ht.result)},ht.onerror=function(){F(ht.error)}}catch(lt){F(lt)}})}).catch(F)});return y(R,E),R}function Ft(E,I){var R=this,H=new p(function(F,V){if(E<0){F(null);return}R.ready().then(function(){ct(R._dbInfo,z,function(K,nt){if(K)return V(K);try{var ht=nt.objectStore(R._dbInfo.storeName),lt=!1,st=ht.openKeyCursor();st.onsuccess=function(){var St=st.result;if(!St){F(null);return}E===0||lt?F(St.key):(lt=!0,St.advance(E))},st.onerror=function(){V(st.error)}}catch(St){V(St)}})}).catch(V)});return y(H,I),H}function Tt(E){var I=this,R=new p(function(H,F){I.ready().then(function(){ct(I._dbInfo,z,function(V,K){if(V)return F(V);try{var nt=K.objectStore(I._dbInfo.storeName),ht=nt.openKeyCursor(),lt=[];ht.onsuccess=function(){var st=ht.result;if(!st){H(lt);return}lt.push(st.key),st.continue()},ht.onerror=function(){F(ht.error)}}catch(st){F(st)}})}).catch(F)});return y(R,E),R}function U(E,I){I=x.apply(this,arguments);var R=this.config();E=typeof E!="function"&&E||{},E.name||(E.name=E.name||R.name,E.storeName=E.storeName||R.storeName);var H=this,F;if(!E.name)F=p.reject("Invalid arguments");else{var V=E.name===R.name&&H._dbInfo.db,K=V?p.resolve(H._dbInfo.db):$(E).then(function(nt){var ht=m[E.name],lt=ht.forages;ht.db=nt;for(var st=0;st<lt.length;st++)lt[st]._dbInfo.db=nt;return nt});E.storeName?F=K.then(function(nt){if(nt.objectStoreNames.contains(E.storeName)){var ht=nt.version+1;N(E);var lt=m[E.name],st=lt.forages;nt.close();for(var St=0;St<st.length;St++){var zt=st[St];zt._dbInfo.db=null,zt._dbInfo.version=ht}var Vt=new p(function(Wt,re){var $t=h.open(E.name,ht);$t.onerror=function(ve){var _r=$t.result;_r.close(),re(ve)},$t.onupgradeneeded=function(){var ve=$t.result;ve.deleteObjectStore(E.storeName)},$t.onsuccess=function(){var ve=$t.result;ve.close(),Wt(ve)}});return Vt.then(function(Wt){lt.db=Wt;for(var re=0;re<st.length;re++){var $t=st[re];$t._dbInfo.db=Wt,A($t._dbInfo)}}).catch(function(Wt){throw(W(E,Wt)||p.resolve()).catch(function(){}),Wt})}}):F=K.then(function(nt){N(E);var ht=m[E.name],lt=ht.forages;nt.close();for(var st=0;st<lt.length;st++){var St=lt[st];St._dbInfo.db=null}var zt=new p(function(Vt,Wt){var re=h.deleteDatabase(E.name);re.onerror=function(){var $t=re.result;$t&&$t.close(),Wt(re.error)},re.onblocked=function(){console.warn('dropInstance blocked for database "'+E.name+'" until all open connections are closed')},re.onsuccess=function(){var $t=re.result;$t&&$t.close(),Vt($t)}});return zt.then(function(Vt){ht.db=Vt;for(var Wt=0;Wt<lt.length;Wt++){var re=lt[Wt];A(re._dbInfo)}}).catch(function(Vt){throw(W(E,Vt)||p.resolve()).catch(function(){}),Vt})})}return y(F,I),F}var P={_driver:"asyncStorage",_initStorage:Rt,_support:u(),iterate:At,getItem:xt,setItem:qt,removeItem:Bt,clear:Nt,length:jt,key:Ft,keys:Tt,dropInstance:U};function Y(){return typeof openDatabase=="function"}var rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q="~~local_forage_type~",vt=/^~~local_forage_type~([^~]+)~/,kt="__lfsc__:",Lt=kt.length,Dt="arbf",bt="blob",Et="si08",_t="ui08",Xt="uic8",se="si16",ce="si32",ee="ur16",ge="ui32",de="fl32",oe="fl64",fe=Lt+Dt.length,ue=Object.prototype.toString;function Kt(E){var I=E.length*.75,R=E.length,H,F=0,V,K,nt,ht;E[E.length-1]==="="&&(I--,E[E.length-2]==="="&&I--);var lt=new ArrayBuffer(I),st=new Uint8Array(lt);for(H=0;H<R;H+=4)V=rt.indexOf(E[H]),K=rt.indexOf(E[H+1]),nt=rt.indexOf(E[H+2]),ht=rt.indexOf(E[H+3]),st[F++]=V<<2|K>>4,st[F++]=(K&15)<<4|nt>>2,st[F++]=(nt&3)<<6|ht&63;return lt}function ae(E){var I=new Uint8Array(E),R="",H;for(H=0;H<I.length;H+=3)R+=rt[I[H]>>2],R+=rt[(I[H]&3)<<4|I[H+1]>>4],R+=rt[(I[H+1]&15)<<2|I[H+2]>>6],R+=rt[I[H+2]&63];return I.length%3===2?R=R.substring(0,R.length-1)+"=":I.length%3===1&&(R=R.substring(0,R.length-2)+"=="),R}function be(E,I){var R="";if(E&&(R=ue.call(E)),E&&(R==="[object ArrayBuffer]"||E.buffer&&ue.call(E.buffer)==="[object ArrayBuffer]")){var H,F=kt;E instanceof ArrayBuffer?(H=E,F+=Dt):(H=E.buffer,R==="[object Int8Array]"?F+=Et:R==="[object Uint8Array]"?F+=_t:R==="[object Uint8ClampedArray]"?F+=Xt:R==="[object Int16Array]"?F+=se:R==="[object Uint16Array]"?F+=ee:R==="[object Int32Array]"?F+=ce:R==="[object Uint32Array]"?F+=ge:R==="[object Float32Array]"?F+=de:R==="[object Float64Array]"?F+=oe:I(new Error("Failed to get type for BinaryArray"))),I(F+ae(H))}else if(R==="[object Blob]"){var V=new FileReader;V.onload=function(){var K=Q+E.type+"~"+ae(this.result);I(kt+bt+K)},V.readAsArrayBuffer(E)}else try{I(JSON.stringify(E))}catch(K){console.error("Couldn't convert value into a JSON string: ",E),I(null,K)}}function S(E){if(E.substring(0,Lt)!==kt)return JSON.parse(E);var I=E.substring(fe),R=E.substring(Lt,fe),H;if(R===bt&&vt.test(I)){var F=I.match(vt);H=F[1],I=I.substring(F[0].length)}var V=Kt(I);switch(R){case Dt:return V;case bt:return d([V],{type:H});case Et:return new Int8Array(V);case _t:return new Uint8Array(V);case Xt:return new Uint8ClampedArray(V);case se:return new Int16Array(V);case ee:return new Uint16Array(V);case ce:return new Int32Array(V);case ge:return new Uint32Array(V);case de:return new Float32Array(V);case oe:return new Float64Array(V);default:throw new Error("Unkown type: "+R)}}var J={serialize:be,deserialize:S,stringToBuffer:Kt,bufferToString:ae};function it(E,I,R,H){E.executeSql("CREATE TABLE IF NOT EXISTS "+I.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],R,H)}function yt(E){var I=this,R={db:null};if(E)for(var H in E)R[H]=typeof E[H]!="string"?E[H].toString():E[H];var F=new p(function(V,K){try{R.db=openDatabase(R.name,String(R.version),R.description,R.size)}catch(nt){return K(nt)}R.db.transaction(function(nt){it(nt,R,function(){I._dbInfo=R,V()},function(ht,lt){K(lt)})},K)});return R.serializer=J,F}function M(E,I,R,H,F,V){E.executeSql(R,H,F,function(K,nt){nt.code===nt.SYNTAX_ERR?K.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[I.storeName],function(ht,lt){lt.rows.length?V(ht,nt):it(ht,I,function(){ht.executeSql(R,H,F,V)},V)},V):V(K,nt)},V)}function f(E,I){var R=this;E=O(E);var H=new p(function(F,V){R.ready().then(function(){var K=R._dbInfo;K.db.transaction(function(nt){M(nt,K,"SELECT * FROM "+K.storeName+" WHERE key = ? LIMIT 1",[E],function(ht,lt){var st=lt.rows.length?lt.rows.item(0).value:null;st&&(st=K.serializer.deserialize(st)),F(st)},function(ht,lt){V(lt)})})}).catch(V)});return y(H,I),H}function a(E,I){var R=this,H=new p(function(F,V){R.ready().then(function(){var K=R._dbInfo;K.db.transaction(function(nt){M(nt,K,"SELECT * FROM "+K.storeName,[],function(ht,lt){for(var st=lt.rows,St=st.length,zt=0;zt<St;zt++){var Vt=st.item(zt),Wt=Vt.value;if(Wt&&(Wt=K.serializer.deserialize(Wt)),Wt=E(Wt,Vt.key,zt+1),Wt!==void 0){F(Wt);return}}F()},function(ht,lt){V(lt)})})}).catch(V)});return y(H,I),H}function k(E,I,R,H){var F=this;E=O(E);var V=new p(function(K,nt){F.ready().then(function(){I===void 0&&(I=null);var ht=I,lt=F._dbInfo;lt.serializer.serialize(I,function(st,St){St?nt(St):lt.db.transaction(function(zt){M(zt,lt,"INSERT OR REPLACE INTO "+lt.storeName+" (key, value) VALUES (?, ?)",[E,st],function(){K(ht)},function(Vt,Wt){nt(Wt)})},function(zt){if(zt.code===zt.QUOTA_ERR){if(H>0){K(k.apply(F,[E,ht,R,H-1]));return}nt(zt)}})})}).catch(nt)});return y(V,R),V}function j(E,I,R){return k.apply(this,[E,I,R,1])}function l(E,I){var R=this;E=O(E);var H=new p(function(F,V){R.ready().then(function(){var K=R._dbInfo;K.db.transaction(function(nt){M(nt,K,"DELETE FROM "+K.storeName+" WHERE key = ?",[E],function(){F()},function(ht,lt){V(lt)})})}).catch(V)});return y(H,I),H}function q(E){var I=this,R=new p(function(H,F){I.ready().then(function(){var V=I._dbInfo;V.db.transaction(function(K){M(K,V,"DELETE FROM "+V.storeName,[],function(){H()},function(nt,ht){F(ht)})})}).catch(F)});return y(R,E),R}function G(E){var I=this,R=new p(function(H,F){I.ready().then(function(){var V=I._dbInfo;V.db.transaction(function(K){M(K,V,"SELECT COUNT(key) as c FROM "+V.storeName,[],function(nt,ht){var lt=ht.rows.item(0).c;H(lt)},function(nt,ht){F(ht)})})}).catch(F)});return y(R,E),R}function w(E,I){var R=this,H=new p(function(F,V){R.ready().then(function(){var K=R._dbInfo;K.db.transaction(function(nt){M(nt,K,"SELECT key FROM "+K.storeName+" WHERE id = ? LIMIT 1",[E+1],function(ht,lt){var st=lt.rows.length?lt.rows.item(0).key:null;F(st)},function(ht,lt){V(lt)})})}).catch(V)});return y(H,I),H}function B(E){var I=this,R=new p(function(H,F){I.ready().then(function(){var V=I._dbInfo;V.db.transaction(function(K){M(K,V,"SELECT key FROM "+V.storeName,[],function(nt,ht){for(var lt=[],st=0;st<ht.rows.length;st++)lt.push(ht.rows.item(st).key);H(lt)},function(nt,ht){F(ht)})})}).catch(F)});return y(R,E),R}function Z(E){return new p(function(I,R){E.transaction(function(H){H.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(F,V){for(var K=[],nt=0;nt<V.rows.length;nt++)K.push(V.rows.item(nt).name);I({db:E,storeNames:K})},function(F,V){R(V)})},function(H){R(H)})})}function wt(E,I){I=x.apply(this,arguments);var R=this.config();E=typeof E!="function"&&E||{},E.name||(E.name=E.name||R.name,E.storeName=E.storeName||R.storeName);var H=this,F;return E.name?F=new p(function(V){var K;E.name===R.name?K=H._dbInfo.db:K=openDatabase(E.name,"","",0),E.storeName?V({db:K,storeNames:[E.storeName]}):V(Z(K))}).then(function(V){return new p(function(K,nt){V.db.transaction(function(ht){function lt(Vt){return new p(function(Wt,re){ht.executeSql("DROP TABLE IF EXISTS "+Vt,[],function(){Wt()},function($t,ve){re(ve)})})}for(var st=[],St=0,zt=V.storeNames.length;St<zt;St++)st.push(lt(V.storeNames[St]));p.all(st).then(function(){K()}).catch(function(Vt){nt(Vt)})},function(ht){nt(ht)})})}):F=p.reject("Invalid arguments"),y(F,I),F}var dt={_driver:"webSQLStorage",_initStorage:yt,_support:Y(),iterate:a,getItem:f,setItem:j,removeItem:l,clear:q,length:G,key:w,keys:B,dropInstance:wt};function ft(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function It(E,I){var R=E.name+"/";return E.storeName!==I.storeName&&(R+=E.storeName+"/"),R}function ie(){var E="_localforage_support_test";try{return localStorage.setItem(E,!0),localStorage.removeItem(E),!1}catch{return!0}}function Ut(){return!ie()||localStorage.length>0}function Ot(E){var I=this,R={};if(E)for(var H in E)R[H]=E[H];return R.keyPrefix=It(E,I._defaultConfig),Ut()?(I._dbInfo=R,R.serializer=J,p.resolve()):p.reject()}function Ht(E){var I=this,R=I.ready().then(function(){for(var H=I._dbInfo.keyPrefix,F=localStorage.length-1;F>=0;F--){var V=localStorage.key(F);V.indexOf(H)===0&&localStorage.removeItem(V)}});return y(R,E),R}function te(E,I){var R=this;E=O(E);var H=R.ready().then(function(){var F=R._dbInfo,V=localStorage.getItem(F.keyPrefix+E);return V&&(V=F.serializer.deserialize(V)),V});return y(H,I),H}function Yt(E,I){var R=this,H=R.ready().then(function(){for(var F=R._dbInfo,V=F.keyPrefix,K=V.length,nt=localStorage.length,ht=1,lt=0;lt<nt;lt++){var st=localStorage.key(lt);if(st.indexOf(V)===0){var St=localStorage.getItem(st);if(St&&(St=F.serializer.deserialize(St)),St=E(St,st.substring(K),ht++),St!==void 0)return St}}});return y(H,I),H}function Te(E,I){var R=this,H=R.ready().then(function(){var F=R._dbInfo,V;try{V=localStorage.key(E)}catch{V=null}return V&&(V=V.substring(F.keyPrefix.length)),V});return y(H,I),H}function De(E){var I=this,R=I.ready().then(function(){for(var H=I._dbInfo,F=localStorage.length,V=[],K=0;K<F;K++){var nt=localStorage.key(K);nt.indexOf(H.keyPrefix)===0&&V.push(nt.substring(H.keyPrefix.length))}return V});return y(R,E),R}function Jt(E){var I=this,R=I.keys().then(function(H){return H.length});return y(R,E),R}function pe(E,I){var R=this;E=O(E);var H=R.ready().then(function(){var F=R._dbInfo;localStorage.removeItem(F.keyPrefix+E)});return y(H,I),H}function ne(E,I,R){var H=this;E=O(E);var F=H.ready().then(function(){I===void 0&&(I=null);var V=I;return new p(function(K,nt){var ht=H._dbInfo;ht.serializer.serialize(I,function(lt,st){if(st)nt(st);else try{localStorage.setItem(ht.keyPrefix+E,lt),K(V)}catch(St){(St.name==="QuotaExceededError"||St.name==="NS_ERROR_DOM_QUOTA_REACHED")&&nt(St),nt(St)}})})});return y(F,R),F}function _e(E,I){if(I=x.apply(this,arguments),E=typeof E!="function"&&E||{},!E.name){var R=this.config();E.name=E.name||R.name,E.storeName=E.storeName||R.storeName}var H=this,F;return E.name?F=new p(function(V){E.storeName?V(It(E,H._defaultConfig)):V(E.name+"/")}).then(function(V){for(var K=localStorage.length-1;K>=0;K--){var nt=localStorage.key(K);nt.indexOf(V)===0&&localStorage.removeItem(nt)}}):F=p.reject("Invalid arguments"),y(F,I),F}var me={_driver:"localStorageWrapper",_initStorage:Ot,_support:ft(),iterate:Yt,getItem:te,setItem:ne,removeItem:pe,clear:Ht,length:Jt,key:Te,keys:De,dropInstance:_e},er=function(E,I){return E===I||typeof E=="number"&&typeof I=="number"&&isNaN(E)&&isNaN(I)},ts=function(E,I){for(var R=E.length,H=0;H<R;){if(er(E[H],I))return!0;H++}return!1},vi=Array.isArray||function(E){return Object.prototype.toString.call(E)==="[object Array]"},Xe={},yi={},Be={INDEXEDDB:P,WEBSQL:dt,LOCALSTORAGE:me},es=[Be.INDEXEDDB._driver,Be.WEBSQL._driver,Be.LOCALSTORAGE._driver],rr=["dropInstance"],wr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(rr),rs={description:"",driver:es.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function is(E,I){E[I]=function(){var R=arguments;return E.ready().then(function(){return E[I].apply(E,R)})}}function br(){for(var E=1;E<arguments.length;E++){var I=arguments[E];if(I)for(var R in I)I.hasOwnProperty(R)&&(vi(I[R])?arguments[0][R]=I[R].slice():arguments[0][R]=I[R])}return arguments[0]}var ns=(function(){function E(I){s(this,E);for(var R in Be)if(Be.hasOwnProperty(R)){var H=Be[R],F=H._driver;this[R]=F,Xe[F]||this.defineDriver(H)}this._defaultConfig=br({},rs),this._config=br({},this._defaultConfig,I),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return E.prototype.config=function(I){if((typeof I>"u"?"undefined":n(I))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var R in I){if(R==="storeName"&&(I[R]=I[R].replace(/\W/g,"_")),R==="version"&&typeof I[R]!="number")return new Error("Database version must be a number.");this._config[R]=I[R]}return"driver"in I&&I.driver?this.setDriver(this._config.driver):!0}else return typeof I=="string"?this._config[I]:this._config},E.prototype.defineDriver=function(I,R,H){var F=new p(function(V,K){try{var nt=I._driver,ht=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!I._driver){K(ht);return}for(var lt=wr.concat("_initStorage"),st=0,St=lt.length;st<St;st++){var zt=lt[st],Vt=!ts(rr,zt);if((Vt||I[zt])&&typeof I[zt]!="function"){K(ht);return}}var Wt=function(){for(var $t=function(os){return function(){var as=new Error("Method "+os+" is not implemented by the current driver"),wi=p.reject(as);return y(wi,arguments[arguments.length-1]),wi}},ve=0,_r=rr.length;ve<_r;ve++){var xr=rr[ve];I[xr]||(I[xr]=$t(xr))}};Wt();var re=function($t){Xe[nt]&&console.info("Redefining LocalForage driver: "+nt),Xe[nt]=I,yi[nt]=$t,V()};"_support"in I?I._support&&typeof I._support=="function"?I._support().then(re,K):re(!!I._support):re(!0)}catch($t){K($t)}});return _(F,R,H),F},E.prototype.driver=function(){return this._driver||null},E.prototype.getDriver=function(I,R,H){var F=Xe[I]?p.resolve(Xe[I]):p.reject(new Error("Driver not found."));return _(F,R,H),F},E.prototype.getSerializer=function(I){var R=p.resolve(J);return _(R,I),R},E.prototype.ready=function(I){var R=this,H=R._driverSet.then(function(){return R._ready===null&&(R._ready=R._initDriver()),R._ready});return _(H,I,I),H},E.prototype.setDriver=function(I,R,H){var F=this;vi(I)||(I=[I]);var V=this._getSupportedDrivers(I);function K(){F._config.driver=F.driver()}function nt(st){return F._extend(st),K(),F._ready=F._initStorage(F._config),F._ready}function ht(st){return function(){var St=0;function zt(){for(;St<st.length;){var Vt=st[St];return St++,F._dbInfo=null,F._ready=null,F.getDriver(Vt).then(nt).catch(zt)}K();var Wt=new Error("No available storage method found.");return F._driverSet=p.reject(Wt),F._driverSet}return zt()}}var lt=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=lt.then(function(){var st=V[0];return F._dbInfo=null,F._ready=null,F.getDriver(st).then(function(St){F._driver=St._driver,K(),F._wrapLibraryMethodsWithReady(),F._initDriver=ht(V)})}).catch(function(){K();var st=new Error("No available storage method found.");return F._driverSet=p.reject(st),F._driverSet}),_(this._driverSet,R,H),this._driverSet},E.prototype.supports=function(I){return!!yi[I]},E.prototype._extend=function(I){br(this,I)},E.prototype._getSupportedDrivers=function(I){for(var R=[],H=0,F=I.length;H<F;H++){var V=I[H];this.supports(V)&&R.push(V)}return R},E.prototype._wrapLibraryMethodsWithReady=function(){for(var I=0,R=wr.length;I<R;I++)is(this,wr[I])},E.prototype.createInstance=function(I){return new E(I)},E})(),ss=new ns;r.exports=ss},{3:3}]},{},[4])(4)})})(bi)),bi.exports}var cs=hs();const Zt=Ze(cs);var Er={exports:{}},kr={exports:{}},Sr,xi;function Rn(){if(xi)return Sr;xi=1;var v=void 0;return Sr=function(t){return t!==v&&t!==null},Sr}var Cr,Ei;function us(){if(Ei)return Cr;Ei=1;var v=Rn(),t={object:!0,function:!0,undefined:!0};return Cr=function(e){return v(e)?hasOwnProperty.call(t,typeof e):!1},Cr}var Nr,ki;function ds(){if(ki)return Nr;ki=1;var v=us();return Nr=function(t){if(!v(t))return!1;try{return t.constructor?t.constructor.prototype===t:!1}catch{return!1}},Nr}var Tr,Si;function fs(){if(Si)return Tr;Si=1;var v=ds();return Tr=function(t){if(typeof t!="function"||!hasOwnProperty.call(t,"length"))return!1;try{if(typeof t.length!="number"||typeof t.call!="function"||typeof t.apply!="function")return!1}catch{return!1}return!v(t)},Tr}var Ir,Ci;function ps(){if(Ci)return Ir;Ci=1;var v=fs(),t=/^\s*class[\s{/}]/,e=Function.prototype.toString;return Ir=function(r){return!(!v(r)||t.test(e.call(r)))},Ir}var Ni,Ti;function gs(){return Ti||(Ti=1,Ni=function(){var v=Object.assign,t;return typeof v!="function"?!1:(t={foo:"raz"},v(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}),Ni}var Ii,Ri;function ms(){return Ri||(Ri=1,Ii=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Ii}var Oi,Li;function vs(){return Li||(Li=1,Oi=function(){}),Oi}var Rr,Ai;function li(){if(Ai)return Rr;Ai=1;var v=vs()();return Rr=function(t){return t!==v&&t!==null},Rr}var Or,zi;function ys(){if(zi)return Or;zi=1;var v=li(),t=Object.keys;return Or=function(e){return t(v(e)?Object(e):e)},Or}var Di,Bi;function ws(){return Bi||(Bi=1,Di=ms()()?Object.keys:ys()),Di}var Lr,Ui;function bs(){if(Ui)return Lr;Ui=1;var v=li();return Lr=function(t){if(!v(t))throw new TypeError("Cannot use null or undefined");return t},Lr}var Ar,Pi;function _s(){if(Pi)return Ar;Pi=1;var v=ws(),t=bs(),e=Math.max;return Ar=function(r,i){var n,s,o=e(arguments.length,2),h;for(r=Object(t(r)),h=function(u){try{r[u]=i[u]}catch(d){n||(n=d)}},s=1;s<o;++s)i=arguments[s],v(i).forEach(h);if(n!==void 0)throw n;return r},Ar}var Mi,ji;function xs(){return ji||(ji=1,Mi=gs()()?Object.assign:_s()),Mi}var zr,qi;function Es(){if(qi)return zr;qi=1;var v=li(),t=Array.prototype.forEach,e=Object.create,r=function(i,n){var s;for(s in i)n[s]=i[s]};return zr=function(i){var n=e(null);return t.call(arguments,function(s){v(s)&&r(Object(s),n)}),n},zr}var Dr,Fi;function ks(){if(Fi)return Dr;Fi=1;var v="razdwatrzy";return Dr=function(){return typeof v.contains!="function"?!1:v.contains("dwa")===!0&&v.contains("foo")===!1},Dr}var Br,Wi;function Ss(){if(Wi)return Br;Wi=1;var v=String.prototype.indexOf;return Br=function(t){return v.call(this,t,arguments[1])>-1},Br}var Hi,Vi;function Cs(){return Vi||(Vi=1,Hi=ks()()?String.prototype.contains:Ss()),Hi}var Gi;function Ns(){if(Gi)return kr.exports;Gi=1;var v=Rn(),t=ps(),e=xs(),r=Es(),i=Cs(),n=kr.exports=function(s,o){var h,u,d,p,y;return arguments.length<2||typeof s!="string"?(p=o,o=s,s=null):p=arguments[2],v(s)?(h=i.call(s,"c"),u=i.call(s,"e"),d=i.call(s,"w")):(h=d=!0,u=!1),y={value:o,configurable:h,enumerable:u,writable:d},p?e(r(p),y):y};return n.gs=function(s,o,h){var u,d,p,y;return typeof s!="string"?(p=h,h=o,o=s,s=null):p=arguments[3],v(o)?t(o)?v(h)?t(h)||(p=h,h=void 0):h=void 0:(p=o,o=h=void 0):o=void 0,v(s)?(u=i.call(s,"c"),d=i.call(s,"e")):(u=!0,d=!1),y={get:o,set:h,configurable:u,enumerable:d},p?e(r(p),y):y},kr.exports}var Zi,Xi;function Ts(){return Xi||(Xi=1,Zi=function(v){if(typeof v!="function")throw new TypeError(v+" is not a function");return v}),Zi}var Yi;function Is(){return Yi||(Yi=1,(function(v,t){var e=Ns(),r=Ts(),i=Function.prototype.apply,n=Function.prototype.call,s=Object.create,o=Object.defineProperty,h=Object.defineProperties,u=Object.prototype.hasOwnProperty,d={configurable:!0,enumerable:!1,writable:!0},p,y,_,O,x,c,g;p=function(m,C){var z;return r(C),u.call(this,"__ee__")?z=this.__ee__:(z=d.value=s(null),o(this,"__ee__",d),d.value=null),z[m]?typeof z[m]=="object"?z[m].push(C):z[m]=[z[m],C]:z[m]=C,this},y=function(m,C){var z,b;return r(C),b=this,p.call(this,m,z=function(){_.call(b,m,z),i.call(C,this,arguments)}),z.__eeOnceListener__=C,this},_=function(m,C){var z,b,L,T;if(r(C),!u.call(this,"__ee__"))return this;if(z=this.__ee__,!z[m])return this;if(b=z[m],typeof b=="object")for(T=0;L=b[T];++T)(L===C||L.__eeOnceListener__===C)&&(b.length===2?z[m]=b[T?0:1]:b.splice(T,1));else(b===C||b.__eeOnceListener__===C)&&delete z[m];return this},O=function(m){var C,z,b,L,T;if(u.call(this,"__ee__")&&(L=this.__ee__[m],!!L))if(typeof L=="object"){for(z=arguments.length,T=new Array(z-1),C=1;C<z;++C)T[C-1]=arguments[C];for(L=L.slice(),C=0;b=L[C];++C)i.call(b,this,T)}else switch(arguments.length){case 1:n.call(L,this);break;case 2:n.call(L,this,arguments[1]);break;case 3:n.call(L,this,arguments[1],arguments[2]);break;default:for(z=arguments.length,T=new Array(z-1),C=1;C<z;++C)T[C-1]=arguments[C];i.call(L,this,T)}},x={on:p,once:y,off:_,emit:O},c={on:e(p),once:e(y),off:e(_),emit:e(O)},g=h({},c),v.exports=t=function(m){return m==null?s(g):h(Object(m),c)},t.methods=x})(Er,Er.exports)),Er.exports}var Rs=Is();const Ne=Ze(Rs);var $e={},Ie={},Pe={},$i;function mr(){if($i)return Pe;$i=1;function v(i,n,s){if(s===void 0&&(s=Array.prototype),i&&typeof s.find=="function")return s.find.call(i,n);for(var o=0;o<i.length;o++)if(Object.prototype.hasOwnProperty.call(i,o)){var h=i[o];if(n.call(void 0,h,o,i))return h}}function t(i,n){return n===void 0&&(n=Object),n&&typeof n.freeze=="function"?n.freeze(i):i}var e=t({HTML:"text/html",isHTML:function(i){return i===e.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=t({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Pe.find=v,Pe.freeze=t,Pe.MIME_TYPE=e,Pe.NAMESPACE=r,Pe}var Ki;function On(){if(Ki)return Ie;Ki=1;var v=mr(),t=v.find,e=v.NAMESPACE;function r(f){return f!==""}function i(f){return f?f.split(/[\t\n\f\r ]+/).filter(r):[]}function n(f,a){return f.hasOwnProperty(a)||(f[a]=!0),f}function s(f){if(!f)return[];var a=i(f);return Object.keys(a.reduce(n,{}))}function o(f){return function(a){return f&&f.indexOf(a)!==-1}}function h(f,a){for(var k in f)Object.prototype.hasOwnProperty.call(f,k)&&(a[k]=f[k])}function u(f,a){var k=f.prototype;if(!(k instanceof a)){let j=function(){};j.prototype=a.prototype,j=new j,h(k,j),f.prototype=k=j}k.constructor!=f&&(typeof f!="function"&&console.error("unknown Class:"+f),k.constructor=f)}var d={},p=d.ELEMENT_NODE=1,y=d.ATTRIBUTE_NODE=2,_=d.TEXT_NODE=3,O=d.CDATA_SECTION_NODE=4,x=d.ENTITY_REFERENCE_NODE=5,c=d.ENTITY_NODE=6,g=d.PROCESSING_INSTRUCTION_NODE=7,m=d.COMMENT_NODE=8,C=d.DOCUMENT_NODE=9,z=d.DOCUMENT_TYPE_NODE=10,b=d.DOCUMENT_FRAGMENT_NODE=11,L=d.NOTATION_NODE=12,T={},D={};T.INDEX_SIZE_ERR=(D[1]="Index size error",1),T.DOMSTRING_SIZE_ERR=(D[2]="DOMString size error",2);var N=T.HIERARCHY_REQUEST_ERR=(D[3]="Hierarchy request error",3);T.WRONG_DOCUMENT_ERR=(D[4]="Wrong document",4),T.INVALID_CHARACTER_ERR=(D[5]="Invalid character",5),T.NO_DATA_ALLOWED_ERR=(D[6]="No data allowed",6),T.NO_MODIFICATION_ALLOWED_ERR=(D[7]="No modification allowed",7);var A=T.NOT_FOUND_ERR=(D[8]="Not found",8);T.NOT_SUPPORTED_ERR=(D[9]="Not supported",9);var W=T.INUSE_ATTRIBUTE_ERR=(D[10]="Attribute in use",10);T.INVALID_STATE_ERR=(D[11]="Invalid state",11),T.SYNTAX_ERR=(D[12]="Syntax error",12),T.INVALID_MODIFICATION_ERR=(D[13]="Invalid modification",13),T.NAMESPACE_ERR=(D[14]="Invalid namespace",14),T.INVALID_ACCESS_ERR=(D[15]="Invalid access",15);function X(f,a){if(a instanceof Error)var k=a;else k=this,Error.call(this,D[f]),this.message=D[f],Error.captureStackTrace&&Error.captureStackTrace(this,X);return k.code=f,a&&(this.message=this.message+": "+a),k}X.prototype=Error.prototype,h(T,X);function $(){}$.prototype={length:0,item:function(f){return f>=0&&f<this.length?this[f]:null},toString:function(f,a){for(var k=[],j=0;j<this.length;j++)J(this[j],k,f,a);return k.join("")},filter:function(f){return Array.prototype.filter.call(this,f)},indexOf:function(f){return Array.prototype.indexOf.call(this,f)}};function et(f,a){this._node=f,this._refresh=a,at(this)}function at(f){var a=f._node._inc||f._node.ownerDocument._inc;if(f._inc!==a){var k=f._refresh(f._node);if(M(f,"length",k.length),!f.$$length||k.length<f.$$length)for(var j=k.length;j in f;j++)Object.prototype.hasOwnProperty.call(f,j)&&delete f[j];h(k,f),f._inc=a}}et.prototype.item=function(f){return at(this),this[f]||null},u(et,$);function pt(){}function tt(f,a){for(var k=f.length;k--;)if(f[k]===a)return k}function ot(f,a,k,j){if(j?a[tt(a,j)]=k:a[a.length++]=k,f){k.ownerElement=f;var l=f.ownerDocument;l&&(j&&qt(l,f,j),At(l,f,k))}}function ut(f,a,k){var j=tt(a,k);if(j>=0){for(var l=a.length-1;j<l;)a[j]=a[++j];if(a.length=l,f){var q=f.ownerDocument;q&&(qt(q,f,k),k.ownerElement=null)}}else throw new X(A,new Error(f.tagName+"@"+k))}pt.prototype={length:0,item:$.prototype.item,getNamedItem:function(f){for(var a=this.length;a--;){var k=this[a];if(k.nodeName==f)return k}},setNamedItem:function(f){var a=f.ownerElement;if(a&&a!=this._ownerElement)throw new X(W);var k=this.getNamedItem(f.nodeName);return ot(this._ownerElement,this,f,k),k},setNamedItemNS:function(f){var a=f.ownerElement,k;if(a&&a!=this._ownerElement)throw new X(W);return k=this.getNamedItemNS(f.namespaceURI,f.localName),ot(this._ownerElement,this,f,k),k},removeNamedItem:function(f){var a=this.getNamedItem(f);return ut(this._ownerElement,this,a),a},removeNamedItemNS:function(f,a){var k=this.getNamedItemNS(f,a);return ut(this._ownerElement,this,k),k},getNamedItemNS:function(f,a){for(var k=this.length;k--;){var j=this[k];if(j.localName==a&&j.namespaceURI==f)return j}return null}};function Ct(){}Ct.prototype={hasFeature:function(f,a){return!0},createDocument:function(f,a,k){var j=new xt;if(j.implementation=this,j.childNodes=new $,j.doctype=k||null,k&&j.appendChild(k),a){var l=j.createElementNS(f,a);j.appendChild(l)}return j},createDocumentType:function(f,a,k){var j=new ee;return j.name=f,j.nodeName=f,j.publicId=a||"",j.systemId=k||"",j}};function ct(){}ct.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(f,a){return Lt(this,f,a)},replaceChild:function(f,a){Lt(this,f,a,kt),a&&this.removeChild(a)},removeChild:function(f){return Nt(this,f)},appendChild:function(f){return this.insertBefore(f,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(f){return yt(this.ownerDocument||this,this,f)},normalize:function(){for(var f=this.firstChild;f;){var a=f.nextSibling;a&&a.nodeType==_&&f.nodeType==_?(this.removeChild(a),f.appendData(a.data)):(f.normalize(),f=a)}},isSupported:function(f,a){return this.ownerDocument.implementation.hasFeature(f,a)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(f){for(var a=this;a;){var k=a._nsMap;if(k){for(var j in k)if(Object.prototype.hasOwnProperty.call(k,j)&&k[j]===f)return j}a=a.nodeType==y?a.ownerDocument:a.parentNode}return null},lookupNamespaceURI:function(f){for(var a=this;a;){var k=a._nsMap;if(k&&f in k&&Object.prototype.hasOwnProperty.call(k,f))return k[f];a=a.nodeType==y?a.ownerDocument:a.parentNode}return null},isDefaultNamespace:function(f){var a=this.lookupPrefix(f);return a==null}};function mt(f){return f=="<"&&"&lt;"||f==">"&&"&gt;"||f=="&"&&"&amp;"||f=='"'&&"&quot;"||"&#"+f.charCodeAt()+";"}h(d,ct),h(d,ct.prototype);function Rt(f,a){if(a(f))return!0;if(f=f.firstChild)do if(Rt(f,a))return!0;while(f=f.nextSibling)}function xt(){this.ownerDocument=this}function At(f,a,k){f&&f._inc++;var j=k.namespaceURI;j===e.XMLNS&&(a._nsMap[k.prefix?k.localName:""]=k.value)}function qt(f,a,k,j){f&&f._inc++;var l=k.namespaceURI;l===e.XMLNS&&delete a._nsMap[k.prefix?k.localName:""]}function Bt(f,a,k){if(f&&f._inc){f._inc++;var j=a.childNodes;if(k)j[j.length++]=k;else{for(var l=a.firstChild,q=0;l;)j[q++]=l,l=l.nextSibling;j.length=q,delete j[j.length]}}}function Nt(f,a){var k=a.previousSibling,j=a.nextSibling;return k?k.nextSibling=j:f.firstChild=j,j?j.previousSibling=k:f.lastChild=k,a.parentNode=null,a.previousSibling=null,a.nextSibling=null,Bt(f.ownerDocument,f),a}function jt(f){return f&&(f.nodeType===ct.DOCUMENT_NODE||f.nodeType===ct.DOCUMENT_FRAGMENT_NODE||f.nodeType===ct.ELEMENT_NODE)}function Ft(f){return f&&(U(f)||P(f)||Tt(f)||f.nodeType===ct.DOCUMENT_FRAGMENT_NODE||f.nodeType===ct.COMMENT_NODE||f.nodeType===ct.PROCESSING_INSTRUCTION_NODE)}function Tt(f){return f&&f.nodeType===ct.DOCUMENT_TYPE_NODE}function U(f){return f&&f.nodeType===ct.ELEMENT_NODE}function P(f){return f&&f.nodeType===ct.TEXT_NODE}function Y(f,a){var k=f.childNodes||[];if(t(k,U)||Tt(a))return!1;var j=t(k,Tt);return!(a&&j&&k.indexOf(j)>k.indexOf(a))}function rt(f,a){var k=f.childNodes||[];function j(q){return U(q)&&q!==a}if(t(k,j))return!1;var l=t(k,Tt);return!(a&&l&&k.indexOf(l)>k.indexOf(a))}function Q(f,a,k){if(!jt(f))throw new X(N,"Unexpected parent node type "+f.nodeType);if(k&&k.parentNode!==f)throw new X(A,"child not in parent");if(!Ft(a)||Tt(a)&&f.nodeType!==ct.DOCUMENT_NODE)throw new X(N,"Unexpected node type "+a.nodeType+" for parent node type "+f.nodeType)}function vt(f,a,k){var j=f.childNodes||[],l=a.childNodes||[];if(a.nodeType===ct.DOCUMENT_FRAGMENT_NODE){var q=l.filter(U);if(q.length>1||t(l,P))throw new X(N,"More than one element or text in fragment");if(q.length===1&&!Y(f,k))throw new X(N,"Element in fragment can not be inserted before doctype")}if(U(a)&&!Y(f,k))throw new X(N,"Only one element can be added and only after doctype");if(Tt(a)){if(t(j,Tt))throw new X(N,"Only one doctype is allowed");var G=t(j,U);if(k&&j.indexOf(G)<j.indexOf(k))throw new X(N,"Doctype can only be inserted before an element");if(!k&&G)throw new X(N,"Doctype can not be appended since element is present")}}function kt(f,a,k){var j=f.childNodes||[],l=a.childNodes||[];if(a.nodeType===ct.DOCUMENT_FRAGMENT_NODE){var q=l.filter(U);if(q.length>1||t(l,P))throw new X(N,"More than one element or text in fragment");if(q.length===1&&!rt(f,k))throw new X(N,"Element in fragment can not be inserted before doctype")}if(U(a)&&!rt(f,k))throw new X(N,"Only one element can be added and only after doctype");if(Tt(a)){if(t(j,function(w){return Tt(w)&&w!==k}))throw new X(N,"Only one doctype is allowed");var G=t(j,U);if(k&&j.indexOf(G)<j.indexOf(k))throw new X(N,"Doctype can only be inserted before an element")}}function Lt(f,a,k,j){Q(f,a,k),f.nodeType===ct.DOCUMENT_NODE&&(j||vt)(f,a,k);var l=a.parentNode;if(l&&l.removeChild(a),a.nodeType===b){var q=a.firstChild;if(q==null)return a;var G=a.lastChild}else q=G=a;var w=k?k.previousSibling:f.lastChild;q.previousSibling=w,G.nextSibling=k,w?w.nextSibling=q:f.firstChild=q,k==null?f.lastChild=G:k.previousSibling=G;do q.parentNode=f;while(q!==G&&(q=q.nextSibling));return Bt(f.ownerDocument||f,f),a.nodeType==b&&(a.firstChild=a.lastChild=null),a}function Dt(f,a){return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=f,a.previousSibling=f.lastChild,a.nextSibling=null,a.previousSibling?a.previousSibling.nextSibling=a:f.firstChild=a,f.lastChild=a,Bt(f.ownerDocument,f,a),a}xt.prototype={nodeName:"#document",nodeType:C,doctype:null,documentElement:null,_inc:1,insertBefore:function(f,a){if(f.nodeType==b){for(var k=f.firstChild;k;){var j=k.nextSibling;this.insertBefore(k,a),k=j}return f}return Lt(this,f,a),f.ownerDocument=this,this.documentElement===null&&f.nodeType===p&&(this.documentElement=f),f},removeChild:function(f){return this.documentElement==f&&(this.documentElement=null),Nt(this,f)},replaceChild:function(f,a){Lt(this,f,a,kt),f.ownerDocument=this,a&&this.removeChild(a),U(f)&&(this.documentElement=f)},importNode:function(f,a){return it(this,f,a)},getElementById:function(f){var a=null;return Rt(this.documentElement,function(k){if(k.nodeType==p&&k.getAttribute("id")==f)return a=k,!0}),a},getElementsByClassName:function(f){var a=s(f);return new et(this,function(k){var j=[];return a.length>0&&Rt(k.documentElement,function(l){if(l!==k&&l.nodeType===p){var q=l.getAttribute("class");if(q){var G=f===q;if(!G){var w=s(q);G=a.every(o(w))}G&&j.push(l)}}}),j})},createElement:function(f){var a=new bt;a.ownerDocument=this,a.nodeName=f,a.tagName=f,a.localName=f,a.childNodes=new $;var k=a.attributes=new pt;return k._ownerElement=a,a},createDocumentFragment:function(){var f=new fe;return f.ownerDocument=this,f.childNodes=new $,f},createTextNode:function(f){var a=new Xt;return a.ownerDocument=this,a.appendData(f),a},createComment:function(f){var a=new se;return a.ownerDocument=this,a.appendData(f),a},createCDATASection:function(f){var a=new ce;return a.ownerDocument=this,a.appendData(f),a},createProcessingInstruction:function(f,a){var k=new ue;return k.ownerDocument=this,k.tagName=k.nodeName=k.target=f,k.nodeValue=k.data=a,k},createAttribute:function(f){var a=new Et;return a.ownerDocument=this,a.name=f,a.nodeName=f,a.localName=f,a.specified=!0,a},createEntityReference:function(f){var a=new oe;return a.ownerDocument=this,a.nodeName=f,a},createElementNS:function(f,a){var k=new bt,j=a.split(":"),l=k.attributes=new pt;return k.childNodes=new $,k.ownerDocument=this,k.nodeName=a,k.tagName=a,k.namespaceURI=f,j.length==2?(k.prefix=j[0],k.localName=j[1]):k.localName=a,l._ownerElement=k,k},createAttributeNS:function(f,a){var k=new Et,j=a.split(":");return k.ownerDocument=this,k.nodeName=a,k.name=a,k.namespaceURI=f,k.specified=!0,j.length==2?(k.prefix=j[0],k.localName=j[1]):k.localName=a,k}},u(xt,ct);function bt(){this._nsMap={}}bt.prototype={nodeType:p,hasAttribute:function(f){return this.getAttributeNode(f)!=null},getAttribute:function(f){var a=this.getAttributeNode(f);return a&&a.value||""},getAttributeNode:function(f){return this.attributes.getNamedItem(f)},setAttribute:function(f,a){var k=this.ownerDocument.createAttribute(f);k.value=k.nodeValue=""+a,this.setAttributeNode(k)},removeAttribute:function(f){var a=this.getAttributeNode(f);a&&this.removeAttributeNode(a)},appendChild:function(f){return f.nodeType===b?this.insertBefore(f,null):Dt(this,f)},setAttributeNode:function(f){return this.attributes.setNamedItem(f)},setAttributeNodeNS:function(f){return this.attributes.setNamedItemNS(f)},removeAttributeNode:function(f){return this.attributes.removeNamedItem(f.nodeName)},removeAttributeNS:function(f,a){var k=this.getAttributeNodeNS(f,a);k&&this.removeAttributeNode(k)},hasAttributeNS:function(f,a){return this.getAttributeNodeNS(f,a)!=null},getAttributeNS:function(f,a){var k=this.getAttributeNodeNS(f,a);return k&&k.value||""},setAttributeNS:function(f,a,k){var j=this.ownerDocument.createAttributeNS(f,a);j.value=j.nodeValue=""+k,this.setAttributeNode(j)},getAttributeNodeNS:function(f,a){return this.attributes.getNamedItemNS(f,a)},getElementsByTagName:function(f){return new et(this,function(a){var k=[];return Rt(a,function(j){j!==a&&j.nodeType==p&&(f==="*"||j.tagName==f)&&k.push(j)}),k})},getElementsByTagNameNS:function(f,a){return new et(this,function(k){var j=[];return Rt(k,function(l){l!==k&&l.nodeType===p&&(f==="*"||l.namespaceURI===f)&&(a==="*"||l.localName==a)&&j.push(l)}),j})}},xt.prototype.getElementsByTagName=bt.prototype.getElementsByTagName,xt.prototype.getElementsByTagNameNS=bt.prototype.getElementsByTagNameNS,u(bt,ct);function Et(){}Et.prototype.nodeType=y,u(Et,ct);function _t(){}_t.prototype={data:"",substringData:function(f,a){return this.data.substring(f,f+a)},appendData:function(f){f=this.data+f,this.nodeValue=this.data=f,this.length=f.length},insertData:function(f,a){this.replaceData(f,0,a)},appendChild:function(f){throw new Error(D[N])},deleteData:function(f,a){this.replaceData(f,a,"")},replaceData:function(f,a,k){var j=this.data.substring(0,f),l=this.data.substring(f+a);k=j+k+l,this.nodeValue=this.data=k,this.length=k.length}},u(_t,ct);function Xt(){}Xt.prototype={nodeName:"#text",nodeType:_,splitText:function(f){var a=this.data,k=a.substring(f);a=a.substring(0,f),this.data=this.nodeValue=a,this.length=a.length;var j=this.ownerDocument.createTextNode(k);return this.parentNode&&this.parentNode.insertBefore(j,this.nextSibling),j}},u(Xt,_t);function se(){}se.prototype={nodeName:"#comment",nodeType:m},u(se,_t);function ce(){}ce.prototype={nodeName:"#cdata-section",nodeType:O},u(ce,_t);function ee(){}ee.prototype.nodeType=z,u(ee,ct);function ge(){}ge.prototype.nodeType=L,u(ge,ct);function de(){}de.prototype.nodeType=c,u(de,ct);function oe(){}oe.prototype.nodeType=x,u(oe,ct);function fe(){}fe.prototype.nodeName="#document-fragment",fe.prototype.nodeType=b,u(fe,ct);function ue(){}ue.prototype.nodeType=g,u(ue,ct);function Kt(){}Kt.prototype.serializeToString=function(f,a,k){return ae.call(f,a,k)},ct.prototype.toString=ae;function ae(f,a){var k=[],j=this.nodeType==9&&this.documentElement||this,l=j.prefix,q=j.namespaceURI;if(q&&l==null){var l=j.lookupPrefix(q);if(l==null)var G=[{namespace:q,prefix:null}]}return J(this,k,f,a,G),k.join("")}function be(f,a,k){var j=f.prefix||"",l=f.namespaceURI;if(!l||j==="xml"&&l===e.XML||l===e.XMLNS)return!1;for(var q=k.length;q--;){var G=k[q];if(G.prefix===j)return G.namespace!==l}return!0}function S(f,a,k){f.push(" ",a,'="',k.replace(/[<&"]/g,mt),'"')}function J(f,a,k,j,l){if(l||(l=[]),j)if(f=j(f),f){if(typeof f=="string"){a.push(f);return}}else return;switch(f.nodeType){case p:var q=f.attributes,G=q.length,w=f.firstChild,B=f.tagName;k=e.isHTML(f.namespaceURI)||k;var Z=B;if(!k&&!f.prefix&&f.namespaceURI){for(var wt,dt=0;dt<q.length;dt++)if(q.item(dt).name==="xmlns"){wt=q.item(dt).value;break}if(!wt)for(var ft=l.length-1;ft>=0;ft--){var It=l[ft];if(It.prefix===""&&It.namespace===f.namespaceURI){wt=It.namespace;break}}if(wt!==f.namespaceURI)for(var ft=l.length-1;ft>=0;ft--){var It=l[ft];if(It.namespace===f.namespaceURI){It.prefix&&(Z=It.prefix+":"+B);break}}}a.push("<",Z);for(var ie=0;ie<G;ie++){var Ut=q.item(ie);Ut.prefix=="xmlns"?l.push({prefix:Ut.localName,namespace:Ut.value}):Ut.nodeName=="xmlns"&&l.push({prefix:"",namespace:Ut.value})}for(var ie=0;ie<G;ie++){var Ut=q.item(ie);if(be(Ut,k,l)){var Ot=Ut.prefix||"",Ht=Ut.namespaceURI;S(a,Ot?"xmlns:"+Ot:"xmlns",Ht),l.push({prefix:Ot,namespace:Ht})}J(Ut,a,k,j,l)}if(B===Z&&be(f,k,l)){var Ot=f.prefix||"",Ht=f.namespaceURI;S(a,Ot?"xmlns:"+Ot:"xmlns",Ht),l.push({prefix:Ot,namespace:Ht})}if(w||k&&!/^(?:meta|link|img|br|hr|input)$/i.test(B)){if(a.push(">"),k&&/^script$/i.test(B))for(;w;)w.data?a.push(w.data):J(w,a,k,j,l.slice()),w=w.nextSibling;else for(;w;)J(w,a,k,j,l.slice()),w=w.nextSibling;a.push("</",Z,">")}else a.push("/>");return;case C:case b:for(var w=f.firstChild;w;)J(w,a,k,j,l.slice()),w=w.nextSibling;return;case y:return S(a,f.name,f.value);case _:return a.push(f.data.replace(/[<&]/g,mt).replace(/]]>/g,"]]&gt;"));case O:return a.push("<![CDATA[",f.data,"]]>");case m:return a.push("<!--",f.data,"-->");case z:var te=f.publicId,Yt=f.systemId;if(a.push("<!DOCTYPE ",f.name),te)a.push(" PUBLIC ",te),Yt&&Yt!="."&&a.push(" ",Yt),a.push(">");else if(Yt&&Yt!=".")a.push(" SYSTEM ",Yt,">");else{var Te=f.internalSubset;Te&&a.push(" [",Te,"]"),a.push(">")}return;case g:return a.push("<?",f.target," ",f.data,"?>");case x:return a.push("&",f.nodeName,";");default:a.push("??",f.nodeName)}}function it(f,a,k){var j;switch(a.nodeType){case p:j=a.cloneNode(!1),j.ownerDocument=f;case b:break;case y:k=!0;break}if(j||(j=a.cloneNode(!1)),j.ownerDocument=f,j.parentNode=null,k)for(var l=a.firstChild;l;)j.appendChild(it(f,l,k)),l=l.nextSibling;return j}function yt(f,a,k){var j=new a.constructor;for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)){var q=a[l];typeof q!="object"&&q!=j[l]&&(j[l]=q)}switch(a.childNodes&&(j.childNodes=new $),j.ownerDocument=f,j.nodeType){case p:var G=a.attributes,w=j.attributes=new pt,B=G.length;w._ownerElement=j;for(var Z=0;Z<B;Z++)j.setAttributeNode(yt(f,G.item(Z),!0));break;case y:k=!0}if(k)for(var wt=a.firstChild;wt;)j.appendChild(yt(f,wt,k)),wt=wt.nextSibling;return j}function M(f,a,k){f[a]=k}try{if(Object.defineProperty){let f=function(a){switch(a.nodeType){case p:case b:var k=[];for(a=a.firstChild;a;)a.nodeType!==7&&a.nodeType!==8&&k.push(f(a)),a=a.nextSibling;return k.join("");default:return a.nodeValue}};Object.defineProperty(et.prototype,"length",{get:function(){return at(this),this.$$length}}),Object.defineProperty(ct.prototype,"textContent",{get:function(){return f(this)},set:function(a){switch(this.nodeType){case p:case b:for(;this.firstChild;)this.removeChild(this.firstChild);(a||String(a))&&this.appendChild(this.ownerDocument.createTextNode(a));break;default:this.data=a,this.value=a,this.nodeValue=a}}}),M=function(a,k,j){a["$$"+k]=j}}}catch{}return Ie.DocumentType=ee,Ie.DOMException=X,Ie.DOMImplementation=Ct,Ie.Element=bt,Ie.Node=ct,Ie.NodeList=$,Ie.XMLSerializer=Kt,Ie}var Me={},Ji={},Qi;function Os(){return Qi||(Qi=1,(function(v){var t=mr().freeze;v.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),v.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),v.entityMap=v.HTML_ENTITIES})(Ji)),Ji}var ir={},tn;function Ls(){if(tn)return ir;tn=1;var v=mr().NAMESPACE,t=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,e=new RegExp("[\\-\\.0-9"+t.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+t.source+e.source+"*(?::"+t.source+e.source+"*)?$"),i=0,n=1,s=2,o=3,h=4,u=5,d=6,p=7;function y(N,A){this.message=N,this.locator=A,Error.captureStackTrace&&Error.captureStackTrace(this,y)}y.prototype=new Error,y.prototype.name=y.name;function _(){}_.prototype={parse:function(N,A,W){var X=this.domBuilder;X.startDocument(),z(A,A={}),O(N,A,W,X,this.errorHandler),X.endDocument()}};function O(N,A,W,X,$){function et(bt){if(bt>65535){bt-=65536;var Et=55296+(bt>>10),_t=56320+(bt&1023);return String.fromCharCode(Et,_t)}else return String.fromCharCode(bt)}function at(bt){var Et=bt.slice(1,-1);return Et in W?W[Et]:Et.charAt(0)==="#"?et(parseInt(Et.substr(1).replace("x","0x"))):($.error("entity not found:"+bt),bt)}function pt(bt){if(bt>xt){var Et=N.substring(xt,bt).replace(/&#?\w+;/g,at);ct&&tt(xt),X.characters(Et,0,bt-xt),xt=bt}}function tt(bt,Et){for(;bt>=ut&&(Et=Ct.exec(N));)ot=Et.index,ut=ot+Et[0].length,ct.lineNumber++;ct.columnNumber=bt-ot+1}for(var ot=0,ut=0,Ct=/.*(?:\r\n?|\n)|.*$/g,ct=X.locator,mt=[{currentNSMap:A}],Rt={},xt=0;;){try{var At=N.indexOf("<",xt);if(At<0){if(!N.substr(xt).match(/^\s*$/)){var qt=X.doc,Bt=qt.createTextNode(N.substr(xt));qt.appendChild(Bt),X.currentElement=Bt}return}switch(At>xt&&pt(At),N.charAt(At+1)){case"/":var Q=N.indexOf(">",At+3),Nt=N.substring(At+2,Q).replace(/[ \t\n\r]+$/g,""),jt=mt.pop();Q<0?(Nt=N.substring(At+2).replace(/[\s<].*/,""),$.error("end tag name: "+Nt+" is not complete:"+jt.tagName),Q=At+1+Nt.length):Nt.match(/\s</)&&(Nt=Nt.replace(/[\s<].*/,""),$.error("end tag name: "+Nt+" maybe not complete"),Q=At+1+Nt.length);var Ft=jt.localNSMap,Tt=jt.tagName==Nt,U=Tt||jt.tagName&&jt.tagName.toLowerCase()==Nt.toLowerCase();if(U){if(X.endElement(jt.uri,jt.localName,Nt),Ft)for(var P in Ft)Object.prototype.hasOwnProperty.call(Ft,P)&&X.endPrefixMapping(P);Tt||$.fatalError("end tag name: "+Nt+" is not match the current start tagName:"+jt.tagName)}else mt.push(jt);Q++;break;case"?":ct&&tt(At),Q=L(N,At,X);break;case"!":ct&&tt(At),Q=b(N,At,X,$);break;default:ct&&tt(At);var Y=new T,rt=mt[mt.length-1].currentNSMap,Q=c(N,At,Y,rt,at,$),vt=Y.length;if(!Y.closed&&C(N,Q,Y.tagName,Rt)&&(Y.closed=!0,W.nbsp||$.warning("unclosed xml attribute")),ct&&vt){for(var kt=x(ct,{}),Lt=0;Lt<vt;Lt++){var Dt=Y[Lt];tt(Dt.offset),Dt.locator=x(ct,{})}X.locator=kt,g(Y,X,rt)&&mt.push(Y),X.locator=ct}else g(Y,X,rt)&&mt.push(Y);v.isHTML(Y.uri)&&!Y.closed?Q=m(N,Q,Y.tagName,at,X):Q++}}catch(bt){if(bt instanceof y)throw bt;$.error("element parse error: "+bt),Q=-1}Q>xt?xt=Q:pt(Math.max(At,xt)+1)}}function x(N,A){return A.lineNumber=N.lineNumber,A.columnNumber=N.columnNumber,A}function c(N,A,W,X,$,et){function at(ct,mt,Rt){W.attributeNames.hasOwnProperty(ct)&&et.fatalError("Attribute "+ct+" redefined"),W.addValue(ct,mt,Rt)}for(var pt,tt,ot=++A,ut=i;;){var Ct=N.charAt(ot);switch(Ct){case"=":if(ut===n)pt=N.slice(A,ot),ut=o;else if(ut===s)ut=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(ut===o||ut===n)if(ut===n&&(et.warning('attribute value must after "="'),pt=N.slice(A,ot)),A=ot+1,ot=N.indexOf(Ct,A),ot>0)tt=N.slice(A,ot).replace(/&#?\w+;/g,$),at(pt,tt,A-1),ut=u;else throw new Error("attribute value no end '"+Ct+"' match");else if(ut==h)tt=N.slice(A,ot).replace(/&#?\w+;/g,$),at(pt,tt,A),et.warning('attribute "'+pt+'" missed start quot('+Ct+")!!"),A=ot+1,ut=u;else throw new Error('attribute value must after "="');break;case"/":switch(ut){case i:W.setTagName(N.slice(A,ot));case u:case d:case p:ut=p,W.closed=!0;case h:case n:break;case s:W.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return et.error("unexpected end of input"),ut==i&&W.setTagName(N.slice(A,ot)),ot;case">":switch(ut){case i:W.setTagName(N.slice(A,ot));case u:case d:case p:break;case h:case n:tt=N.slice(A,ot),tt.slice(-1)==="/"&&(W.closed=!0,tt=tt.slice(0,-1));case s:ut===s&&(tt=pt),ut==h?(et.warning('attribute "'+tt+'" missed quot(")!'),at(pt,tt.replace(/&#?\w+;/g,$),A)):((!v.isHTML(X[""])||!tt.match(/^(?:disabled|checked|selected)$/i))&&et.warning('attribute "'+tt+'" missed value!! "'+tt+'" instead!!'),at(tt,tt,A));break;case o:throw new Error("attribute value missed!!")}return ot;case"":Ct=" ";default:if(Ct<=" ")switch(ut){case i:W.setTagName(N.slice(A,ot)),ut=d;break;case n:pt=N.slice(A,ot),ut=s;break;case h:var tt=N.slice(A,ot).replace(/&#?\w+;/g,$);et.warning('attribute "'+tt+'" missed quot(")!!'),at(pt,tt,A);case u:ut=d;break}else switch(ut){case s:W.tagName,(!v.isHTML(X[""])||!pt.match(/^(?:disabled|checked|selected)$/i))&&et.warning('attribute "'+pt+'" missed value!! "'+pt+'" instead2!!'),at(pt,pt,A),A=ot,ut=n;break;case u:et.warning('attribute space is required"'+pt+'"!!');case d:ut=n,A=ot;break;case o:ut=h,A=ot;break;case p:throw new Error("elements closed character '/' and '>' must be connected to")}}ot++}}function g(N,A,W){for(var X=N.tagName,$=null,et=N.length;et--;){var at=N[et],pt=at.qName,tt=at.value,ct=pt.indexOf(":");if(ct>0)var ot=at.prefix=pt.slice(0,ct),ut=pt.slice(ct+1),Ct=ot==="xmlns"&&ut;else ut=pt,ot=null,Ct=pt==="xmlns"&&"";at.localName=ut,Ct!==!1&&($==null&&($={},z(W,W={})),W[Ct]=$[Ct]=tt,at.uri=v.XMLNS,A.startPrefixMapping(Ct,tt))}for(var et=N.length;et--;){at=N[et];var ot=at.prefix;ot&&(ot==="xml"&&(at.uri=v.XML),ot!=="xmlns"&&(at.uri=W[ot||""]))}var ct=X.indexOf(":");ct>0?(ot=N.prefix=X.slice(0,ct),ut=N.localName=X.slice(ct+1)):(ot=null,ut=N.localName=X);var mt=N.uri=W[ot||""];if(A.startElement(mt,ut,X,N),N.closed){if(A.endElement(mt,ut,X),$)for(ot in $)Object.prototype.hasOwnProperty.call($,ot)&&A.endPrefixMapping(ot)}else return N.currentNSMap=W,N.localNSMap=$,!0}function m(N,A,W,X,$){if(/^(?:script|textarea)$/i.test(W)){var et=N.indexOf("</"+W+">",A),at=N.substring(A+1,et);if(/[&<]/.test(at))return/^script$/i.test(W)?($.characters(at,0,at.length),et):(at=at.replace(/&#?\w+;/g,X),$.characters(at,0,at.length),et)}return A+1}function C(N,A,W,X){var $=X[W];return $==null&&($=N.lastIndexOf("</"+W+">"),$<A&&($=N.lastIndexOf("</"+W)),X[W]=$),$<A}function z(N,A){for(var W in N)Object.prototype.hasOwnProperty.call(N,W)&&(A[W]=N[W])}function b(N,A,W,X){var $=N.charAt(A+2);switch($){case"-":if(N.charAt(A+3)==="-"){var et=N.indexOf("-->",A+4);return et>A?(W.comment(N,A+4,et-A-4),et+3):(X.error("Unclosed comment"),-1)}else return-1;default:if(N.substr(A+3,6)=="CDATA["){var et=N.indexOf("]]>",A+9);return W.startCDATA(),W.characters(N,A+9,et-A-9),W.endCDATA(),et+3}var at=D(N,A),pt=at.length;if(pt>1&&/!doctype/i.test(at[0][0])){var tt=at[1][0],ot=!1,ut=!1;pt>3&&(/^public$/i.test(at[2][0])?(ot=at[3][0],ut=pt>4&&at[4][0]):/^system$/i.test(at[2][0])&&(ut=at[3][0]));var Ct=at[pt-1];return W.startDTD(tt,ot,ut),W.endDTD(),Ct.index+Ct[0].length}}return-1}function L(N,A,W){var X=N.indexOf("?>",A);if(X){var $=N.substring(A,X).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return $?($[0].length,W.processingInstruction($[1],$[2]),X+2):-1}return-1}function T(){this.attributeNames={}}T.prototype={setTagName:function(N){if(!r.test(N))throw new Error("invalid tagName:"+N);this.tagName=N},addValue:function(N,A,W){if(!r.test(N))throw new Error("invalid attribute:"+N);this.attributeNames[N]=this.length,this[this.length++]={qName:N,value:A,offset:W}},length:0,getLocalName:function(N){return this[N].localName},getLocator:function(N){return this[N].locator},getQName:function(N){return this[N].qName},getURI:function(N){return this[N].uri},getValue:function(N){return this[N].value}};function D(N,A){var W,X=[],$=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for($.lastIndex=A,$.exec(N);W=$.exec(N);)if(X.push(W),W[1])return X}return ir.XMLReader=_,ir.ParseError=y,ir}var en;function As(){if(en)return Me;en=1;var v=mr(),t=On(),e=Os(),r=Ls(),i=t.DOMImplementation,n=v.NAMESPACE,s=r.ParseError,o=r.XMLReader;function h(x){this.options=x||{locator:{}}}h.prototype.parseFromString=function(x,c){var g=this.options,m=new o,C=g.domBuilder||new d,z=g.errorHandler,b=g.locator,L=g.xmlns||{},T=/\/x?html?$/.test(c),D=T?e.HTML_ENTITIES:e.XML_ENTITIES;return b&&C.setDocumentLocator(b),m.errorHandler=u(z,C,b),m.domBuilder=g.domBuilder||C,T&&(L[""]=n.HTML),L.xml=L.xml||n.XML,x&&typeof x=="string"?m.parse(x,L,D):m.errorHandler.error("invalid doc source"),C.doc};function u(x,c,g){if(!x){if(c instanceof d)return c;x=c}var m={},C=x instanceof Function;g=g||{};function z(b){var L=x[b];!L&&C&&(L=x.length==2?function(T){x(b,T)}:x),m[b]=L&&function(T){L("[xmldom "+b+"]	"+T+y(g))}||function(){}}return z("warning"),z("error"),z("fatalError"),m}function d(){this.cdata=!1}function p(x,c){c.lineNumber=x.lineNumber,c.columnNumber=x.columnNumber}d.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(x,c,g,m){var C=this.doc,z=C.createElementNS(x,g||c),b=m.length;O(this,z),this.currentElement=z,this.locator&&p(this.locator,z);for(var L=0;L<b;L++){var x=m.getURI(L),T=m.getValue(L),g=m.getQName(L),D=C.createAttributeNS(x,g);this.locator&&p(m.getLocator(L),D),D.value=D.nodeValue=T,z.setAttributeNode(D)}},endElement:function(x,c,g){var m=this.currentElement;m.tagName,this.currentElement=m.parentNode},startPrefixMapping:function(x,c){},endPrefixMapping:function(x){},processingInstruction:function(x,c){var g=this.doc.createProcessingInstruction(x,c);this.locator&&p(this.locator,g),O(this,g)},ignorableWhitespace:function(x,c,g){},characters:function(x,c,g){if(x=_.apply(this,arguments),x){if(this.cdata)var m=this.doc.createCDATASection(x);else var m=this.doc.createTextNode(x);this.currentElement?this.currentElement.appendChild(m):/^\s*$/.test(x)&&this.doc.appendChild(m),this.locator&&p(this.locator,m)}},skippedEntity:function(x){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(x){(this.locator=x)&&(x.lineNumber=0)},comment:function(x,c,g){x=_.apply(this,arguments);var m=this.doc.createComment(x);this.locator&&p(this.locator,m),O(this,m)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(x,c,g){var m=this.doc.implementation;if(m&&m.createDocumentType){var C=m.createDocumentType(x,c,g);this.locator&&p(this.locator,C),O(this,C),this.doc.doctype=C}},warning:function(x){console.warn("[xmldom warning]	"+x,y(this.locator))},error:function(x){console.error("[xmldom error]	"+x,y(this.locator))},fatalError:function(x){throw new s(x,this.locator)}};function y(x){if(x)return`
@`+(x.systemId||"")+"#[line:"+x.lineNumber+",col:"+x.columnNumber+"]"}function _(x,c,g){return typeof x=="string"?x.substr(c,g):x.length>=c+g||c?new java.lang.String(x,c,g)+"":x}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(x){d.prototype[x]=function(){return null}});function O(x,c){x.currentElement?x.currentElement.appendChild(c):x.doc.appendChild(c)}return Me.__DOMHandler=d,Me.DOMParser=h,Me.DOMImplementation=t.DOMImplementation,Me.XMLSerializer=t.XMLSerializer,Me}var rn;function zs(){if(rn)return $e;rn=1;var v=On();return $e.DOMImplementation=v.DOMImplementation,$e.XMLSerializer=v.XMLSerializer,$e.DOMParser=As().DOMParser,$e}var Ln=zs();const hi=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,Ds=1,Bs=3,An=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function vr(){var v=new Date().getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(v+Math.random()*16)%16|0;return v=Math.floor(v/16),(e=="x"?r:r&7|8).toString(16)});return t}function Us(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function zn(v){return!!(v&&v.nodeType==1)}function Qt(v){return!isNaN(parseFloat(v))&&isFinite(v)}function Dn(v){let t=parseFloat(v);return Qt(v)===!1?!1:typeof v=="string"&&v.indexOf(".")>-1?!0:Math.floor(t)!==t}function Fe(v){var t=["Webkit","webkit","Moz","O","ms"],e=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=v.toLowerCase(),i=t.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return v;for(var n=0;n<i;n++)if(typeof document.body.style[e[n]+r]<"u")return e[n]+r;return v}function Bn(v){for(var t=1,e=arguments.length;t<e;t++){var r=arguments[t];for(var i in r)v[i]===void 0&&(v[i]=r[i])}return v}function he(v){var t=[].slice.call(arguments,1);return t.forEach(function(e){e&&Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(v,r,Object.getOwnPropertyDescriptor(e,r))})}),v}function Ps(v,t,e){var r=Ge(v,t,e);return t.splice(r,0,v),r}function Ge(v,t,e,r,i){var n=r||0,s=i||t.length,o=parseInt(n+(s-n)/2),h;return e||(e=function(u,d){if(u>d)return 1;if(u<d)return-1;if(u==d)return 0}),s-n<=0?o:(h=e(t[o],v),s-n===1?h>=0?o:o+1:h===0?o:h===-1?Ge(v,t,e,o,s):Ge(v,t,e,n,o))}function lr(v,t,e,r,i){var n=r||0,s=i||t.length,o=parseInt(n+(s-n)/2),h;return e||(e=function(u,d){if(u>d)return 1;if(u<d)return-1;if(u==d)return 0}),s-n<=0?-1:(h=e(t[o],v),s-n===1?h===0?o:-1:h===0?o:h===-1?lr(v,t,e,o,s):lr(v,t,e,n,o))}function or(v){var t=window.getComputedStyle(v),e=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return e.forEach(function(s){i+=parseFloat(t[s])||0}),r.forEach(function(s){n+=parseFloat(t[s])||0}),{height:n,width:i}}function hr(v){var t=window.getComputedStyle(v),e=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,n=0;return e.forEach(function(s){i+=parseFloat(t[s])||0}),r.forEach(function(s){n+=parseFloat(t[s])||0}),{height:n,width:i}}function ii(v){let t,e=v.ownerDocument;if(v.nodeType==Node.TEXT_NODE){let r=e.createRange();r.selectNodeContents(v),t=r.getBoundingClientRect()}else t=v.getBoundingClientRect();return t}function cr(){var v=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:v,bottom:t,width:v,height:t}}function ci(v,t){for(var e=v.parentNode,r=e.childNodes,i,n=-1,s=0;s<r.length&&(i=r[s],i.nodeType===t&&n++,i!=v);s++);return n}function Ms(v){return ci(v,Bs)}function Un(v){return ci(v,Ds)}function Qe(v){return["xml","opf","ncx"].indexOf(v)>-1}function Pn(v,t){return new Blob([v],{type:t})}function ur(v,t){var e,r=Pn(v,t);return e=An.createObjectURL(r),e}function Mn(v){return An.revokeObjectURL(v)}function ni(v,t){var e,r;if(typeof v=="string")return e=btoa(v),r="data:"+t+";base64,"+e,r}function jn(v){return Object.prototype.toString.call(v).slice(8,-1)}function Ce(v,t,e){var r,i;return typeof DOMParser>"u"||e?i=Ln.DOMParser:i=DOMParser,v.charCodeAt(0)===65279&&(v=v.slice(1)),r=new i().parseFromString(v,t),r}function Gt(v,t){var e;if(!v)throw new Error("No Element Provided");if(typeof v.querySelector<"u")return v.querySelector(t);if(e=v.getElementsByTagName(t),e.length)return e[0]}function Re(v,t){return typeof v.querySelector<"u"?v.querySelectorAll(t):v.getElementsByTagName(t)}function We(v,t,e){var r,i;if(typeof v.querySelector<"u"){t+="[";for(var n in e)t+=n+"~='"+e[n]+"'";return t+="]",v.querySelector(t)}else if(r=v.getElementsByTagName(t),i=Array.prototype.slice.call(r,0).filter(function(s){for(var o in e)if(s.getAttribute(o)===e[o])return!0;return!1}),i)return i[0]}function dr(v,t){var e=v.ownerDocument||v;typeof e.createTreeWalker<"u"?qn(v,t,NodeFilter.SHOW_TEXT):ui(v,function(r){r&&r.nodeType===3&&t(r)})}function qn(v,t,e){var r=document.createTreeWalker(v,e,null,!1);let i;for(;i=r.nextNode();)t(i)}function ui(v,t){if(t(v))return!0;if(v=v.firstChild,v)do{if(ui(v,t))return!0;v=v.nextSibling}while(v)}function Fn(v){return new Promise(function(t,e){var r=new FileReader;r.readAsDataURL(v),r.onloadend=function(){t(r.result)}})}function Pt(){this.resolve=null,this.reject=null,this.id=vr(),this.promise=new Promise((v,t)=>{this.resolve=v,this.reject=t}),Object.freeze(this)}function fr(v,t,e){var r;if(typeof v.querySelector<"u"&&(r=v.querySelector(`${t}[*|type="${e}"]`)),!r||r.length===0){r=Re(v,t);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===e||r[i].getAttribute("epub:type")===e)return r[i]}else return r}function si(v){for(var t=[],e=v.childNodes,r=0;r<e.length;r++){let i=e[r];i.nodeType===1&&t.push(i)}return t}function oi(v){for(var t=[v];v;v=v.parentNode)t.unshift(v);return t}function He(v,t,e){for(var r=[],i=v.childNodes,n=0;n<i.length;n++){let s=i[n];if(s.nodeType===1&&s.nodeName.toLowerCase()===t){if(e)return s;r.push(s)}}if(!e)return r}function js(v,t){let e;if(!(v===null||t===""))for(e=v.parentNode;e.nodeType===1;){if(e.tagName.toLowerCase()===t)return e;e=e.parentNode}}class Wn{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(t,e){this.startContainer=t,this.startOffset=e,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(t,e){this.endContainer=t,this.endOffset=e,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(t){this.collapsed=!0,t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(t){let e=t.parentNode,r=Array.prototype.indexOf.call(e.childNodes,t);this.setStart(e,r),this.setEnd(e,r+1)}selectNodeContents(t){t.childNodes[t.childNodes-1];let e=t.nodeType===3?t.textContent.length:parent.childNodes.length;this.setStart(t,0),this.setEnd(t,e)}_commonAncestorContainer(t,e){var r=oi(t||this.startContainer),i=oi(e||this.endContainer);if(r[0]==i[0]){for(var n=0;n<r.length;n++)if(r[n]!=i[n])return r[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const qs=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:Wn,blob2base64:Fn,borders:hr,bounds:or,createBase64Url:ni,createBlob:Pn,createBlobUrl:ur,defaults:Bn,defer:Pt,documentHeight:Us,extend:he,filterChildren:He,findChildren:si,getParentByTagName:js,indexOfElementNode:Un,indexOfNode:ci,indexOfSorted:lr,indexOfTextNode:Ms,insert:Ps,isElement:zn,isFloat:Dn,isNumber:Qt,isXml:Qe,locationOf:Ge,nodeBounds:ii,parents:oi,parse:Ce,prefixed:Fe,qs:Gt,qsa:Re,qsp:We,querySelectorByType:fr,requestAnimationFrame:hi,revokeBlobUrl:Mn,sprint:dr,treeWalker:qn,type:jn,uuid:vr,walk:ui,windowBounds:cr},Symbol.toStringTag,{value:"Module"}));var Ur,nn;function Fs(){if(nn)return Ur;if(nn=1,!v)var v={cwd:function(){return"/"}};function t(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function e(n,s){for(var o="",h=-1,u=0,d,p=0;p<=n.length;++p){if(p<n.length)d=n.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(h===p-1||u===1))if(h!==p-1&&u===2){if(o.length<2||o.charCodeAt(o.length-1)!==46||o.charCodeAt(o.length-2)!==46){if(o.length>2){for(var y=o.length-1,_=y;_>=0&&o.charCodeAt(_)!==47;--_);if(_!==y){_===-1?o="":o=o.slice(0,_),h=p,u=0;continue}}else if(o.length===2||o.length===1){o="",h=p,u=0;continue}}s&&(o.length>0?o+="/..":o="..")}else o.length>0?o+="/"+n.slice(h+1,p):o=n.slice(h+1,p);h=p,u=0}else d===46&&u!==-1?++u:u=-1}return o}function r(n,s){var o=s.dir||s.root,h=s.base||(s.name||"")+(s.ext||"");return o?o===s.root?o+h:o+n+h:h}var i={resolve:function(){for(var n="",s=!1,o,h=arguments.length-1;h>=-1&&!s;h--){var u;h>=0?u=arguments[h]:(o===void 0&&(o=v.cwd()),u=o),t(u),u.length!==0&&(n=u+"/"+n,s=u.charCodeAt(0)===47)}return n=e(n,!s),s?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(n){if(t(n),n.length===0)return".";var s=n.charCodeAt(0)===47,o=n.charCodeAt(n.length-1)===47;return n=e(n,!s),n.length===0&&!s&&(n="."),n.length>0&&o&&(n+="/"),s?"/"+n:n},isAbsolute:function(n){return t(n),n.length>0&&n.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var n,s=0;s<arguments.length;++s){var o=arguments[s];t(o),o.length>0&&(n===void 0?n=o:n+="/"+o)}return n===void 0?".":i.normalize(n)},relative:function(n,s){if(t(n),t(s),n===s||(n=i.resolve(n),s=i.resolve(s),n===s))return"";for(var o=1;o<n.length&&n.charCodeAt(o)===47;++o);for(var h=n.length,u=h-o,d=1;d<s.length&&s.charCodeAt(d)===47;++d);for(var p=s.length,y=p-d,_=u<y?u:y,O=-1,x=0;x<=_;++x){if(x===_){if(y>_){if(s.charCodeAt(d+x)===47)return s.slice(d+x+1);if(x===0)return s.slice(d+x)}else u>_&&(n.charCodeAt(o+x)===47?O=x:x===0&&(O=0));break}var c=n.charCodeAt(o+x),g=s.charCodeAt(d+x);if(c!==g)break;c===47&&(O=x)}var m="";for(x=o+O+1;x<=h;++x)(x===h||n.charCodeAt(x)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+s.slice(d+O):(d+=O,s.charCodeAt(d)===47&&++d,s.slice(d))},_makeLong:function(n){return n},dirname:function(n){if(t(n),n.length===0)return".";for(var s=n.charCodeAt(0),o=s===47,h=-1,u=!0,d=n.length-1;d>=1;--d)if(s=n.charCodeAt(d),s===47){if(!u){h=d;break}}else u=!1;return h===-1?o?"/":".":o&&h===1?"//":n.slice(0,h)},basename:function(n,s){if(s!==void 0&&typeof s!="string")throw new TypeError('"ext" argument must be a string');t(n);var o=0,h=-1,u=!0,d;if(s!==void 0&&s.length>0&&s.length<=n.length){if(s.length===n.length&&s===n)return"";var p=s.length-1,y=-1;for(d=n.length-1;d>=0;--d){var _=n.charCodeAt(d);if(_===47){if(!u){o=d+1;break}}else y===-1&&(u=!1,y=d+1),p>=0&&(_===s.charCodeAt(p)?--p===-1&&(h=d):(p=-1,h=y))}return o===h?h=y:h===-1&&(h=n.length),n.slice(o,h)}else{for(d=n.length-1;d>=0;--d)if(n.charCodeAt(d)===47){if(!u){o=d+1;break}}else h===-1&&(u=!1,h=d+1);return h===-1?"":n.slice(o,h)}},extname:function(n){t(n);for(var s=-1,o=0,h=-1,u=!0,d=0,p=n.length-1;p>=0;--p){var y=n.charCodeAt(p);if(y===47){if(!u){o=p+1;break}continue}h===-1&&(u=!1,h=p+1),y===46?s===-1?s=p:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||h===-1||d===0||d===1&&s===h-1&&s===o+1?"":n.slice(s,h)},format:function(n){if(n===null||typeof n!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof n);return r("/",n)},parse:function(n){t(n);var s={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return s;var o=n.charCodeAt(0),h=o===47,u;h?(s.root="/",u=1):u=0;for(var d=-1,p=0,y=-1,_=!0,O=n.length-1,x=0;O>=u;--O){if(o=n.charCodeAt(O),o===47){if(!_){p=O+1;break}continue}y===-1&&(_=!1,y=O+1),o===46?d===-1?d=O:x!==1&&(x=1):d!==-1&&(x=-1)}return d===-1||y===-1||x===0||x===1&&d===y-1&&d===p+1?y!==-1&&(p===0&&h?s.base=s.name=n.slice(1,y):s.base=s.name=n.slice(p,y)):(p===0&&h?(s.name=n.slice(1,d),s.base=n.slice(1,y)):(s.name=n.slice(p,d),s.base=n.slice(p,y)),s.ext=n.slice(d,y)),p>0?s.dir=n.slice(0,p-1):h&&(s.dir="/"),s},sep:"/",delimiter:":",posix:null};return Ur=i,Ur}var Ws=Fs();const Ae=Ze(Ws);class Oe{constructor(t){var e,r;e=t.indexOf("://"),e>-1&&(t=new URL(t).pathname),r=this.parse(t),this.path=t,this.isDirectory(t)?this.directory=t:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(t){return Ae.parse(t)}isAbsolute(t){return Ae.isAbsolute(t||this.path)}isDirectory(t){return t.charAt(t.length-1)==="/"}resolve(t){return Ae.resolve(this.directory,t)}relative(t){var e=t&&t.indexOf("://")>-1;return e?t:Ae.relative(this.directory,t)}splitPath(t){return this.splitPathRe.exec(t).slice(1)}toString(){return this.path}}class ke{constructor(t,e){var r=t.indexOf("://")>-1,i=t,n;if(this.Url=void 0,this.href=t,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=e,!r&&e!==!1&&typeof e!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(t,this.base):this.Url=new URL(t),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(n=new Oe(this.base),i=n.resolve(i))}this.Path=new Oe(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(t){var e=t.indexOf("://")>-1,r;return e?t:(r=Ae.resolve(this.directory,t),this.origin+r)}relative(t){return Ae.relative(t,this.directory)}toString(){return this.href}}const je=1,ye=3,Hs=9;class Mt{constructor(t,e,r){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Mt))return new Mt(t,e,r);if(typeof e=="string"?this.base=this.parseComponent(e):typeof e=="object"&&e.steps&&(this.base=e),i=this.checkType(t),i==="string")return this.str=t,he(this,this.parse(t));if(i==="range")return he(this,this.fromRange(t,this.base,r));if(i==="node")return he(this,this.fromNode(t,this.base,r));if(i==="EpubCFI"&&t.path)return t;if(t)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(t){return this.isCfiString(t)?"string":t&&typeof t=="object"&&(jn(t)==="Range"||typeof t.startContainer<"u")?"range":t&&typeof t=="object"&&typeof t.nodeType<"u"?"node":t&&typeof t=="object"&&t instanceof Mt?"EpubCFI":!1}parse(t){var e={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,i,n;return typeof t!="string"?{spinePos:-1}:(t.indexOf("epubcfi(")===0&&t[t.length-1]===")"&&(t=t.slice(8,t.length-1)),r=this.getChapterComponent(t),r?(e.base=this.parseComponent(r),i=this.getPathComponent(t),e.path=this.parseComponent(i),n=this.getRange(t),n&&(e.range=!0,e.start=this.parseComponent(n[0]),e.end=this.parseComponent(n[1])),e.spinePos=e.base.steps[1].index,e):{spinePos:-1})}parseComponent(t){var e={steps:[],terminal:{offset:null,assertion:null}},r=t.split(":"),i=r[0].split("/"),n;return r.length>1&&(n=r[1],e.terminal=this.parseTerminal(n)),i[0]===""&&i.shift(),e.steps=i.map((function(s){return this.parseStep(s)}).bind(this)),e}parseStep(t){var e,r,i,n,s;if(n=t.match(/\[(.*)\]/),n&&n[1]&&(s=n[1]),r=parseInt(t),!isNaN(r))return r%2===0?(e="element",i=r/2-1):(e="text",i=(r-1)/2),{type:e,index:i,id:s||null}}parseTerminal(t){var e,r,i=t.match(/\[(.*)\]/);return i&&i[1]?(e=parseInt(t.split("[")[0]),r=i[1]):e=parseInt(t),Qt(e)||(e=null),{offset:e,assertion:r}}getChapterComponent(t){var e=t.split("!");return e[0]}getPathComponent(t){var e=t.split("!");if(e[1])return e[1].split(",")[0]}getRange(t){var e=t.split(",");return e.length===3?[e[1],e[2]]:!1}getCharecterOffsetComponent(t){var e=t.split(":");return e[1]||""}joinSteps(t){return t?t.map(function(e){var r="";return e.type==="element"&&(r+=(e.index+1)*2),e.type==="text"&&(r+=1+2*e.index),e.id&&(r+="["+e.id+"]"),r}).join("/"):""}segmentString(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&t.terminal.offset!=null&&(e+=":"+t.terminal.offset),t.terminal&&t.terminal.assertion!=null&&(e+="["+t.terminal.assertion+"]"),e}toString(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+=")",t}compare(t,e){var r,i,n,s;if(typeof t=="string"&&(t=new Mt(t)),typeof e=="string"&&(e=new Mt(e)),t.spinePos>e.spinePos)return 1;if(t.spinePos<e.spinePos)return-1;t.range?(r=t.path.steps.concat(t.start.steps),n=t.start.terminal):(r=t.path.steps,n=t.path.terminal),e.range?(i=e.path.steps.concat(e.start.steps),s=e.start.terminal):(i=e.path.steps,s=e.path.terminal);for(var o=0;o<r.length;o++){if(!r[o])return-1;if(!i[o]||r[o].index>i[o].index)return 1;if(r[o].index<i[o].index)return-1}return r.length<i.length?-1:n.offset>s.offset?1:n.offset<s.offset?-1:0}step(t){var e=t.nodeType===ye?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}}filteredStep(t,e){var r=this.filter(t,e),i;if(r)return i=r.nodeType===ye?"text":"element",{id:r.id,tagName:r.tagName,type:i,index:this.filteredPosition(r,e)}}pathTo(t,e,r){for(var i={steps:[],terminal:{offset:null,assertion:null}},n=t,s;n&&n.parentNode&&n.parentNode.nodeType!=Hs;)r?s=this.filteredStep(n,r):s=this.step(n),s&&i.steps.unshift(s),n=n.parentNode;return e!=null&&e>=0&&(i.terminal.offset=e,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(t,e){return!t||!e?!1:t.index===e.index&&t.id===e.id&&t.type===e.type}fromRange(t,e,r){var i={range:!1,base:{},path:{},start:null,end:null},n=t.startContainer,s=t.endContainer,o=t.startOffset,h=t.endOffset,u=!1;if(r&&(u=n.ownerDocument.querySelector("."+r)!=null),typeof e=="string"?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):typeof e=="object"&&(i.base=e),t.collapsed)u&&(o=this.patchOffset(n,o,r)),i.path=this.pathTo(n,o,r);else{i.range=!0,u&&(o=this.patchOffset(n,o,r)),i.start=this.pathTo(n,o,r),u&&(h=this.patchOffset(s,h,r)),i.end=this.pathTo(s,h,r),i.path={steps:[],terminal:null};var d=i.start.steps.length,p;for(p=0;p<d&&this.equalStep(i.start.steps[p],i.end.steps[p]);p++)p===d-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[p]),i.range=!1):i.path.steps.push(i.start.steps[p]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(t,e,r){var i={range:!1,base:{},path:{},start:null,end:null};return typeof e=="string"?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):typeof e=="object"&&(i.base=e),i.path=this.pathTo(t,null,r),i}filter(t,e){var r,i,n,s,o,h=!1;return t.nodeType===ye?(h=!0,n=t.parentNode,r=t.parentNode.classList.contains(e)):(h=!1,r=t.classList.contains(e)),r&&h?(s=n.previousSibling,o=n.nextSibling,s&&s.nodeType===ye?i=s:o&&o.nodeType===ye&&(i=o),i||t):r&&!h?!1:t}patchOffset(t,e,r){if(t.nodeType!=ye)throw new Error("Anchor must be a text node");var i=t,n=e;for(t.parentNode.classList.contains(r)&&(i=t.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===je)if(i.previousSibling.classList.contains(r))n+=i.previousSibling.textContent.length;else break;else n+=i.previousSibling.textContent.length;i=i.previousSibling}return n}normalizedMap(t,e,r){var i={},n=-1,s,o=t.length,h,u;for(s=0;s<o;s++)h=t[s].nodeType,h===je&&t[s].classList.contains(r)&&(h=ye),s>0&&h===ye&&u===ye?i[s]=n:e===h&&(n=n+1,i[s]=n),u=h;return i}position(t){var e,r;return t.nodeType===je?(e=t.parentNode.children,e||(e=si(t.parentNode)),r=Array.prototype.indexOf.call(e,t)):(e=this.textNodes(t.parentNode),r=e.indexOf(t)),r}filteredPosition(t,e){var r,i,n;return t.nodeType===je?(r=t.parentNode.children,n=this.normalizedMap(r,je,e)):(r=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(t=t.parentNode,r=t.parentNode.childNodes),n=this.normalizedMap(r,ye,e)),i=Array.prototype.indexOf.call(r,t),n[i]}stepsToXpath(t){var e=[".","*"];return t.forEach(function(r){var i=r.index+1;r.id?e.push("*[position()="+i+" and @id='"+r.id+"']"):r.type==="text"?e.push("text()["+i+"]"):e.push("*["+i+"]")}),e.join("/")}stepsToQuerySelector(t){var e=["html"];return t.forEach(function(r){var i=r.index+1;r.id?e.push("#"+r.id):r.type==="text"||e.push("*:nth-child("+i+")")}),e.join(">")}textNodes(t,e){return Array.prototype.slice.call(t.childNodes).filter(function(r){return r.nodeType===ye?!0:!!(e&&r.classList.contains(e))})}walkToNode(t,e,r){var i=e||document,n=i.documentElement,s,o,h=t.length,u;for(u=0;u<h&&(o=t[u],o.type==="element"?o.id?n=i.getElementById(o.id):(s=n.children||si(n),n=s[o.index]):o.type==="text"&&(n=this.textNodes(n,r)[o.index]),!!n);u++);return n}findNode(t,e,r){var i=e||document,n,s;return!r&&typeof i.evaluate<"u"?(s=this.stepsToXpath(t),n=i.evaluate(s,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?n=this.walkToNode(t,i,r):n=this.walkToNode(t,i),n}fixMiss(t,e,r,i){var n=this.findNode(t.slice(0,-1),r,i),s=n.childNodes,o=this.normalizedMap(s,ye,i),h,u,d=t[t.length-1].index;for(let p in o){if(!o.hasOwnProperty(p))return;if(o[p]===d)if(h=s[p],u=h.textContent.length,e>u)e=e-u;else{h.nodeType===je?n=h.childNodes[0]:n=h;break}}return{container:n,offset:e}}toRange(t,e){var r=t||document,i,n,s,o,h,u=this,d,p,y=e?r.querySelector("."+e)!=null:!1,_;if(typeof r.createRange<"u"?i=r.createRange():i=new Wn,u.range?(n=u.start,d=u.path.steps.concat(n.steps),o=this.findNode(d,r,y?e:null),s=u.end,p=u.path.steps.concat(s.steps),h=this.findNode(p,r,y?e:null)):(n=u.path,d=u.path.steps,o=this.findNode(u.path.steps,r,y?e:null)),o)try{n.terminal.offset!=null?i.setStart(o,n.terminal.offset):i.setStart(o,0)}catch{_=this.fixMiss(d,n.terminal.offset,r,y?e:null),i.setStart(_.container,_.offset)}else return console.log("No startContainer found for",this.toString()),null;if(h)try{s.terminal.offset!=null?i.setEnd(h,s.terminal.offset):i.setEnd(h,0)}catch{_=this.fixMiss(p,u.end.terminal.offset,r,y?e:null),i.setEnd(_.container,_.offset)}return i}isCfiString(t){return typeof t=="string"&&t.indexOf("epubcfi(")===0&&t[t.length-1]===")"}generateChapterComponent(t,e,r){var i=parseInt(e),n=(t+1)*2,s="/"+n+"/";return s+=(i+1)*2,r&&(s+="["+r+"]"),s}collapse(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class Se{constructor(t){this.context=t||this,this.hooks=[]}register(){for(var t=0;t<arguments.length;++t)if(typeof arguments[t]=="function")this.hooks.push(arguments[t]);else for(var e=0;e<arguments[t].length;++e)this.hooks.push(arguments[t][e])}deregister(t){let e;for(let r=0;r<this.hooks.length;r++)if(e=this.hooks[r],e===t){this.hooks.splice(r,1);break}}trigger(){var t=arguments,e=this.context,r=[];return this.hooks.forEach(function(i){try{var n=i.apply(e,t)}catch(s){console.log(s)}n&&typeof n.then=="function"&&r.push(n)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function Hn(v,t){var e,r,i=t.url,n=i.indexOf("://")>-1;v&&(r=Gt(v,"head"),e=Gt(r,"base"),e||(e=v.createElement("base"),r.insertBefore(e,r.firstChild)),!n&&window&&window.location&&(i=window.location.origin+i),e.setAttribute("href",i))}function Vs(v,t){var e,r,i=t.canonical;v&&(e=Gt(v,"head"),r=Gt(e,"link[rel='canonical']"),r?r.setAttribute("href",i):(r=v.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",i),e.appendChild(r)))}function Gs(v,t){var e,r,i=t.idref;v&&(e=Gt(v,"head"),r=Gt(e,"link[property='dc.identifier']"),r?r.setAttribute("content",i):(r=v.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",i),e.appendChild(r)))}function Zs(v,t){var e=v.querySelectorAll("a[href]");if(e.length)for(var r=Gt(v.ownerDocument,"base"),i=r?r.getAttribute("href"):void 0,n=(function(o){var h=o.getAttribute("href");if(h.indexOf("mailto:")!==0){var u=h.indexOf("://")>-1;if(u)o.setAttribute("target","_blank");else{var d;try{d=new ke(h,i)}catch{}o.onclick=function(){return d&&d.hash?t(d.Path.path+d.hash):t(d?d.Path.path:h),!1}}}}).bind(this),s=0;s<e.length;s++)n(e[s])}function sn(v,t,e){return t.forEach(function(r,i){r&&e[i]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),v=v.replace(new RegExp(r,"g"),e[i]))}),v}function tr(v,t,e,r){var i=typeof window<"u"?window.URL:!1,n=i?"blob":"arraybuffer",s=new Pt,o=new XMLHttpRequest,h=XMLHttpRequest.prototype,u;"overrideMimeType"in h||Object.defineProperty(h,"overrideMimeType",{value:function(){}}),e&&(o.withCredentials=!0),o.onreadystatechange=p,o.onerror=d,o.open("GET",v,!0);for(u in r)o.setRequestHeader(u,r[u]);t=="json"&&o.setRequestHeader("Accept","application/json"),t||(t=new Oe(v).extension),t=="blob"&&(o.responseType=n),Qe(t)&&o.overrideMimeType("text/xml"),t=="binary"&&(o.responseType="arraybuffer"),o.send();function d(y){s.reject(y)}function p(){if(this.readyState===XMLHttpRequest.DONE){var y=!1;if((this.responseType===""||this.responseType==="document")&&(y=this.responseXML),this.status===200||this.status===0||y){var _;if(!this.response&&!y)return s.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),s.promise;if(this.status===403)return s.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),s.promise;y?_=this.responseXML:Qe(t)?_=Ce(this.response,"text/xml"):t=="xhtml"?_=Ce(this.response,"application/xhtml+xml"):t=="html"||t=="htm"?_=Ce(this.response,"text/html"):t=="json"?_=JSON.parse(this.response):t=="blob"?i?_=this.response:_=new Blob([this.response]):_=this.response,s.resolve(_)}else s.reject({status:this.status,message:this.response,stack:new Error().stack})}}return s.promise}class Xs{constructor(t,e){this.idref=t.idref,this.linear=t.linear==="yes",this.properties=t.properties,this.index=t.index,this.href=t.href,this.url=t.url,this.canonical=t.canonical,this.next=t.next,this.prev=t.prev,this.cfiBase=t.cfiBase,e?this.hooks=e:(this.hooks={},this.hooks.serialize=new Se(this),this.hooks.content=new Se(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(t){var e=t||this.request||tr,r=new Pt,i=r.promise;return this.contents?r.resolve(this.contents):e(this.url).then((function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(n){r.reject(n)}),i}base(){return Hn(this.document,this)}render(t){var e=new Pt,r=e.promise;return this.output,this.load(t).then((function(i){var n=typeof navigator<"u"&&navigator.userAgent||"",s=n.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||s?o=Ln.DOMParser:o=XMLSerializer;var h=new o;return this.output=h.serializeToString(i),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){e.resolve(this.output)}).bind(this)).catch(function(i){e.reject(i)}),r}find(t){var e=this,r=[],i=t.toLowerCase(),n=function(s){for(var o=s.textContent.toLowerCase(),h=e.document.createRange(),u,d,p=-1,y,_=150;d!=-1;)d=o.indexOf(i,p+1),d!=-1&&(h=e.document.createRange(),h.setStart(s,d),h.setEnd(s,d+i.length),u=e.cfiFromRange(h),s.textContent.length<_?y=s.textContent:(y=s.textContent.substring(d-_/2,d+_/2),y="..."+y+"..."),r.push({cfi:u,excerpt:y})),p=d};return dr(e.document,function(s){n(s)}),r}search(t,e=5){if(typeof document.createTreeWalker>"u")return this.find(t);let r=[];const i=150,n=this,s=t.toLowerCase(),o=function(p){const y=p.reduce((_,O)=>_+O.textContent,"").toLowerCase().indexOf(s);if(y!=-1){const _=y+s.length;let O=0,x=0;if(y<p[0].length){let c;for(;O<p.length-1&&(x+=p[O].length,!(_<=x));)O+=1;let g=p[0],m=p[O],C=n.document.createRange();C.setStart(g,y);let z=p.slice(0,O).reduce((L,T)=>L+T.textContent.length,0);C.setEnd(m,z>_?_:_-z),c=n.cfiFromRange(C);let b=p.slice(0,O+1).reduce((L,T)=>L+T.textContent,"");b.length>i&&(b=b.substring(y-i/2,y+i/2),b="..."+b+"..."),r.push({cfi:c,excerpt:b})}}},h=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let u,d=[];for(;u=h.nextNode();)d.push(u),d.length==e&&(o(d.slice(0,e)),d=d.slice(1,e));return d.length>0&&o(d),r}reconcileLayoutSettings(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach(function(r){var i=r.replace("rendition:",""),n=i.indexOf("-"),s,o;n!=-1&&(s=i.slice(0,n),o=i.slice(n+1),e[s]=o)}),e}cfiFromRange(t){return new Mt(t,this.cfiBase).toString()}cfiFromElement(t){return new Mt(t,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class Ys{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Se,this.hooks.content=new Se,this.hooks.content.register(Hn),this.hooks.content.register(Vs),this.hooks.content.register(Gs),this.epubcfi=new Mt,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(t,e,r){this.items=t.spine,this.manifest=t.manifest,this.spineNodeIndex=t.spineNodeIndex,this.baseUrl=t.baseUrl||t.basePath||"",this.length=this.items.length,this.items.forEach((i,n)=>{var s=this.manifest[i.idref],o;i.index=n,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=e(i.href,!0),i.canonical=r(i.href)),s&&(i.href=s.href,i.url=e(i.href,!0),i.canonical=r(i.href),s.properties.length&&i.properties.push.apply(i.properties,s.properties)),i.linear==="yes"?(i.prev=(function(){let h=i.index;for(;h>0;){let u=this.get(h-1);if(u&&u.linear)return u;h-=1}}).bind(this),i.next=(function(){let h=i.index;for(;h<this.spineItems.length-1;){let u=this.get(h+1);if(u&&u.linear)return u;h+=1}}).bind(this)):(i.prev=function(){},i.next=function(){}),o=new Xs(i,this.hooks),this.append(o)}),this.loaded=!0}get(t){var e=0;if(typeof t>"u")for(;e<this.spineItems.length;){let r=this.spineItems[e];if(r&&r.linear)break;e+=1}else this.epubcfi.isCfiString(t)?e=new Mt(t).spinePos:typeof t=="number"||isNaN(t)===!1?e=t:typeof t=="string"&&t.indexOf("#")===0?e=this.spineById[t.substring(1)]:typeof t=="string"&&(t=t.split("#")[0],e=this.spineByHref[t]||this.spineByHref[encodeURI(t)]);return this.spineItems[e]||null}append(t){var e=this.spineItems.length;return t.index=e,this.spineItems.push(t),this.spineByHref[decodeURI(t.href)]=e,this.spineByHref[encodeURI(t.href)]=e,this.spineByHref[t.href]=e,this.spineById[t.idref]=e,e}prepend(t){return this.spineByHref[t.href]=0,this.spineById[t.idref]=0,this.spineItems.forEach(function(e,r){e.index=r}),0}remove(t){var e=this.spineItems.indexOf(t);if(e>-1)return delete this.spineByHref[t.href],delete this.spineById[t.idref],this.spineItems.splice(e,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let t=0;do{let e=this.get(t);if(e&&e.linear)return e;t+=1}while(t<this.spineItems.length)}last(){let t=this.spineItems.length-1;do{let e=this.get(t);if(e&&e.linear)return e;t-=1}while(t>=0)}destroy(){this.each(t=>t.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class di{constructor(t){this._q=[],this.context=t,this.tick=hi,this.running=!1,this.paused=!1}enqueue(){var t,e,r,i=[].shift.call(arguments),n=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(t=new Pt,e=t.promise,r={task:i,args:n,deferred:t,promise:e}):r={promise:i},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var t,e,r;if(this._q.length&&!this.paused){if(t=this._q.shift(),e=t.task,e)return r=e.apply(this.context,t.args),r&&typeof r.then=="function"?r.then((function(){t.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){t.deferred.reject.apply(this.context,arguments)}).bind(this)):(t.deferred.resolve.apply(this.context,r),t.promise);if(t.promise)return t.promise}else return t=new Pt,t.deferred.resolve(),t.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Pt),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const yr="0.3",ar=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],gt={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class Vn{constructor(t,e,r){this.spine=t,this.request=e,this.pause=r||100,this.q=new di(this),this.epubcfi=new Mt,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(t){return t&&(this.break=t),this.q.pause(),this.spine.each((function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(t){return t.load(this.request).then((function(e){var r=new Pt,i=this.parse(e,t.cfiBase);return this._locations=this._locations.concat(i),t.unload(),this.processingTimeout=setTimeout(()=>r.resolve(i),this.pause),r.promise}).bind(this))}parse(t,e,r){var i=[],n,s=t.ownerDocument,o=Gt(s,"body"),h=0,u,d=r||this.break,p=function(y){var _=y.length,O,x=0;if(y.textContent.trim().length===0)return!1;for(h==0&&(n=this.createRange(),n.startContainer=y,n.startOffset=0),O=d-h,O>_&&(h+=_,x=_);x<_;)if(O=d-h,h===0&&(x+=1,n=this.createRange(),n.startContainer=y,n.startOffset=x),x+O>=_)h+=_-x,x=_;else{x+=O,n.endContainer=y,n.endOffset=x;let c=new Mt(n,e).toString();i.push(c),h=0}u=y};if(dr(o,p.bind(this)),n&&n.startContainer&&u){n.endContainer=u,n.endOffset=u.length;let y=new Mt(n,e).toString();i.push(y),h=0}return i}generateFromWords(t,e,r){var i=t?new Mt(t):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(n){n.linear&&(i?n.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),n,e,i,r):this.q.enqueue(this.processWords.bind(this),n,e,i,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(t,e,r,i){return i&&this._locationsWords.length>=i?Promise.resolve():t.load(this.request).then((function(n){var s=new Pt,o=this.parseWords(n,t,e,r),h=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=i?o.slice(0,h):o),t.unload(),this.processingTimeout=setTimeout(()=>s.resolve(o),this.pause),s.promise}).bind(this))}countWords(t){return t=t.replace(/(^\s*)|(\s*$)/gi,""),t=t.replace(/[ ]{2,}/gi," "),t=t.replace(/\n /,`
`),t.split(" ").length}parseWords(t,e,r,i){var n=e.cfiBase,s=[],o=t.ownerDocument,h=Gt(o,"body"),u=r,d=i?i.spinePos!==e.index:!0,p;i&&e.index===i.spinePos&&(p=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,t.ownerDocument));var y=function(_){if(!d)if(_===p)d=!0;else return!1;if(_.textContent.length<10&&_.textContent.trim().length===0)return!1;var O=this.countWords(_.textContent),x,c=0;if(O===0)return!1;for(x=u-this._wordCounter,x>O&&(this._wordCounter+=O,c=O);c<O;)if(x=u-this._wordCounter,c+x>=O)this._wordCounter+=O-c,c=O;else{c+=x;let g=new Mt(_,n);s.push({cfi:g.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return dr(h,y.bind(this)),s}locationFromCfi(t){let e;return Mt.prototype.isCfiString(t)&&(t=new Mt(t)),this._locations.length===0?-1:(e=Ge(t,this._locations,this.epubcfi.compare),e>this.total?this.total:e)}percentageFromCfi(t){if(this._locations.length===0)return null;var e=this.locationFromCfi(t);return this.percentageFromLocation(e)}percentageFromLocation(t){return!t||!this.total?0:t/this.total}cfiFromLocation(t){var e=-1;return typeof t!="number"&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(e=this._locations[t]),e}cfiFromPercentage(t){let e;if(t>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),t>=1){let r=new Mt(this._locations[this.total]);return r.collapse(),r.toString()}return e=Math.ceil(this.total*t),this.cfiFromLocation(e)}load(t){return typeof t=="string"?this._locations=JSON.parse(t):this._locations=t,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(t){var e;if(typeof t=="string")this._currentCfi=t;else if(typeof t=="number")this._current=t;else return;this._locations.length!==0&&(typeof t=="string"?(e=this.locationFromCfi(t),this._current=e):e=t,this.emit(gt.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(e)}))}get currentLocation(){return this._current}set currentLocation(t){this.setCurrent(t)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}Ne(Vn.prototype);class $s{constructor(t){this.packagePath="",this.directory="",this.encoding="",t&&this.parse(t)}parse(t){var e;if(!t)throw new Error("Container File Not Found");if(e=Gt(t,"rootfile"),!e)throw new Error("No RootFile Found");this.packagePath=e.getAttribute("full-path"),this.directory=Ae.dirname(this.packagePath),this.encoding=t.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class on{constructor(t){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},t&&this.parse(t)}parse(t){var e,r,i;if(!t)throw new Error("Package File Not Found");if(e=Gt(t,"metadata"),!e)throw new Error("No Metadata Found");if(r=Gt(t,"manifest"),!r)throw new Error("No Manifest Found");if(i=Gt(t,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,i),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=Un(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(e),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(t){var e={};return e.title=this.getElementText(t,"title"),e.creator=this.getElementText(t,"creator"),e.description=this.getElementText(t,"description"),e.pubdate=this.getElementText(t,"date"),e.publisher=this.getElementText(t,"publisher"),e.identifier=this.getElementText(t,"identifier"),e.language=this.getElementText(t,"language"),e.rights=this.getElementText(t,"rights"),e.modified_date=this.getPropertyText(t,"dcterms:modified"),e.layout=this.getPropertyText(t,"rendition:layout"),e.orientation=this.getPropertyText(t,"rendition:orientation"),e.flow=this.getPropertyText(t,"rendition:flow"),e.viewport=this.getPropertyText(t,"rendition:viewport"),e.media_active_class=this.getPropertyText(t,"media:active-class"),e.spread=this.getPropertyText(t,"rendition:spread"),e}parseManifest(t){var e={},r=Re(t,"item"),i=Array.prototype.slice.call(r);return i.forEach(function(n){var s=n.getAttribute("id"),o=n.getAttribute("href")||"",h=n.getAttribute("media-type")||"",u=n.getAttribute("media-overlay")||"",d=n.getAttribute("properties")||"";e[s]={href:o,type:h,overlay:u,properties:d.length?d.split(" "):[]}}),e}parseSpine(t,e){var r=[],i=Re(t,"itemref"),n=Array.prototype.slice.call(i);return n.forEach(function(s,o){var h=s.getAttribute("idref"),u=s.getAttribute("properties")||"",d=u.length?u.split(" "):[],p={id:s.getAttribute("id"),idref:h,linear:s.getAttribute("linear")||"yes",properties:d,index:o};r.push(p)}),r}findUniqueIdentifier(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e)return"";var r=t.getElementById(e);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(t){var e=We(t,"item",{properties:"nav"});return e?e.getAttribute("href"):!1}findNcxPath(t,e){var r=We(t,"item",{"media-type":"application/x-dtbncx+xml"}),i;return r||(i=e.getAttribute("toc"),i&&(r=t.querySelector(`#${i}`))),r?r.getAttribute("href"):!1}findCoverPath(t){var e=Gt(t,"package");e.getAttribute("version");var r=We(t,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var i=We(t,"meta",{name:"cover"});if(i){var n=i.getAttribute("content"),s=t.getElementById(n);return s?s.getAttribute("href"):""}else return!1}getElementText(t,e){var r=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e),i;return!r||r.length===0?"":(i=r[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(t,e){var r=We(t,"meta",{property:e});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(t){this.metadata=t.metadata;let e=t.readingOrder||t.spine;return this.spine=e.map((r,i)=>(r.index=i,r.linear=r.linear||"yes",r)),t.resources.forEach((r,i)=>{this.manifest[i]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=t.toc.map((r,i)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Pr{constructor(t){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,t&&this.parse(t)}parse(t){let e=t.nodeType,r,i;e&&(r=Gt(t,"html"),i=Gt(t,"ncx")),e?r?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):i&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc)}unpack(t){for(var e,r=0;r<t.length;r++)e=t[r],e.href&&(this.tocByHref[e.href]=r),e.id&&(this.tocById[e.id]=r),this.length++,e.subitems.length&&this.unpack(e.subitems)}get(t){var e;return t?(t.indexOf("#")===0?e=this.tocById[t.substring(1)]:t in this.tocByHref&&(e=this.tocByHref[t]),this.getByIndex(t,e,this.toc)):this.toc}getByIndex(t,e,r){if(r.length===0)return;const i=r[e];if(i&&(t===i.id||t===i.href))return i;{let n;for(let s=0;s<r.length&&(n=this.getByIndex(t,e,r[s].subitems),!n);++s);return n}}landmark(t){var e;return t?(e=this.landmarksByType[t],this.landmarks[e]):this.landmarks}parseNav(t){var e=fr(t,"nav","toc"),r=[];if(!e)return r;let i=He(e,"ol",!0);return i&&(r=this.parseNavList(i)),r}parseNavList(t,e){const r=[];if(!t||!t.children)return r;for(let i=0;i<t.children.length;i++){const n=this.navItem(t.children[i],e);n&&r.push(n)}return r}navItem(t,e){let r=t.getAttribute("id")||void 0,i=He(t,"a",!0)||He(t,"span",!0);if(!i)return;let n=i.getAttribute("href")||"";r||(r=n);let s=i.textContent||"",o=[],h=He(t,"ol",!0);return h&&(o=this.parseNavList(h,r)),{id:r,href:n,label:s,subitems:o,parent:e}}parseLandmarks(t){var e=fr(t,"nav","landmarks"),r=e?Re(e,"li"):[],i=r.length,n,s=[],o;if(!r||i===0)return s;for(n=0;n<i;++n)o=this.landmarkItem(r[n]),o&&(s.push(o),this.landmarksByType[o.type]=n);return s}landmarkItem(t){let e=He(t,"a",!0);if(!e)return;let r=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=e.getAttribute("href")||"",n=e.textContent||"";return{href:i,label:n,type:r}}parseNcx(t){var e=Re(t,"navPoint"),r=e.length,i,n={},s=[],o,h;if(!e||r===0)return s;for(i=0;i<r;++i)o=this.ncxItem(e[i]),n[o.id]=o,o.parent?(h=n[o.parent],h.subitems.push(o)):s.push(o);return s}ncxItem(t){var e=t.getAttribute("id")||!1,r=Gt(t,"content"),i=r.getAttribute("src"),n=Gt(t,"navLabel"),s=n.textContent?n.textContent:"",o=[],h=t.parentNode,u;return h&&(h.nodeName==="navPoint"||h.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=h.getAttribute("id")),{id:e,href:i,label:s,subitems:o,parent:u}}load(t){return t.map(e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e))}forEach(t){return this.toc.forEach(t)}}var Ke={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},Ks=(function(){var v,t,e,r,i={};for(v in Ke)if(Ke.hasOwnProperty(v)){for(t in Ke[v])if(Ke[v].hasOwnProperty(t))if(e=Ke[v][t],typeof e=="string")i[e]=v+"/"+t;else for(r=0;r<e.length;r++)i[e[r]]=v+"/"+t}return i})(),Js="text/plain";function Qs(v){return v&&Ks[v.split(".").pop().toLowerCase()]||Js}const Ve={lookup:Qs};class to{constructor(t,e){this.settings={replacements:e&&e.replacements||"base64",archive:e&&e.archive,resolver:e&&e.resolver,request:e&&e.request},this.process(t)}process(t){this.manifest=t,this.resources=Object.keys(t).map(function(e){return t[e]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(t){if(t.type==="application/xhtml+xml"||t.type==="text/html")return!0}),this.assets=this.resources.filter(function(t){if(t.type!=="application/xhtml+xml"&&t.type!=="text/html")return!0}),this.css=this.resources.filter(function(t){if(t.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(t){return t.href}).bind(this)),this.cssUrls=this.css.map(function(t){return t.href})}createUrl(t){var e=new ke(t),r=Ve.lookup(e.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(t,"blob").then(i=>Fn(i)).then(i=>ni(i,r)):this.settings.request(t,"blob").then(i=>ur(i,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(e){e(this.urls)}).bind(this));var t=this.urls.map(e=>{var r=this.settings.resolver(e);return this.createUrl(r).catch(i=>(console.error(i),null))});return Promise.all(t).then(e=>(this.replacementUrls=e.filter(r=>typeof r=="string"),e))}replaceCss(t,e){var r=[];return t=t||this.settings.archive,e=e||this.settings.resolver,this.cssUrls.forEach((function(i){var n=this.createCssFile(i,t,e).then((function(s){var o=this.urls.indexOf(i);o>-1&&(this.replacementUrls[o]=s)}).bind(this));r.push(n)}).bind(this)),Promise.all(r)}createCssFile(t){var e;if(Ae.isAbsolute(t))return new Promise(function(s){s()});var r=this.settings.resolver(t),i;this.settings.archive?i=this.settings.archive.getText(r):i=this.settings.request(r,"text");var n=this.urls.map(s=>{var o=this.settings.resolver(s),h=new Oe(r).relative(o);return h});return i?i.then(s=>(s=sn(s,n,this.replacementUrls),this.settings.replacements==="base64"?e=ni(s,"text/css"):e=ur(s,"text/css"),e),s=>new Promise(function(o){o()})):new Promise(function(s){s()})}relativeTo(t,e){return e=e||this.settings.resolver,this.urls.map((function(r){var i=e(r),n=new Oe(t).relative(i);return n}).bind(this))}get(t){var e=this.urls.indexOf(t);if(e!==-1)return this.replacementUrls.length?new Promise((function(r,i){r(this.replacementUrls[e])}).bind(this)):this.createUrl(t)}substitute(t,e){var r;return e?r=this.relativeTo(e):r=this.urls,sn(t,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Mr{constructor(t){this.pages=[],this.locations=[],this.epubcfi=new Mt,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,t&&(this.pageList=this.parse(t)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(t){var e=Gt(t,"html"),r=Gt(t,"ncx");if(e)return this.parseNav(t);if(r)return this.parseNcx(t)}parseNav(t){var e=fr(t,"nav","page-list"),r=e?Re(e,"li"):[],i=r.length,n,s=[],o;if(!r||i===0)return s;for(n=0;n<i;++n)o=this.item(r[n]),s.push(o);return s}parseNcx(t){var e=[],r=0,i,n,s,o=0;if(n=Gt(t,"pageList"),!n||(s=Re(n,"pageTarget"),o=s.length,!s||s.length===0))return e;for(r=0;r<o;++r)i=this.ncxItem(s[r]),e.push(i);return e}ncxItem(t){var e=Gt(t,"navLabel"),r=Gt(e,"text"),i=r.textContent,n=Gt(t,"content"),s=n.getAttribute("src"),o=parseInt(i,10);return{href:s,page:o}}item(t){var e=Gt(t,"a"),r=e.getAttribute("href")||"",i=e.textContent||"",n=parseInt(i),s=r.indexOf("epubcfi"),o,h,u;return s!=-1?(o=r.split("#"),h=o[0],u=o.length>1?o[1]:!1,{cfi:u,href:r,packageUrl:h,page:n}):{href:r,page:n}}process(t){t.forEach(function(e){this.pages.push(e.page),e.cfi&&this.locations.push(e.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(t){var e=-1;if(this.locations.length===0)return-1;var r=lr(t,this.locations,this.epubcfi.compare);return r!=-1?e=this.pages[r]:(r=Ge(t,this.locations,this.epubcfi.compare),e=r-1>=0?this.pages[r-1]:this.pages[0],e!==void 0||(e=-1)),e}cfiFromPage(t){var e=-1;typeof t!="number"&&(t=parseInt(t));var r=this.pages.indexOf(t);return r!=-1&&(e=this.locations[r]),e}pageFromPercentage(t){var e=Math.round(this.totalPages*t);return e}percentageFromPage(t){var e=(t-this.firstPage)/this.totalPages;return Math.round(e*1e3)/1e3}percentageFromCfi(t){var e=this.pageFromCfi(t),r=this.percentageFromPage(e);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class Gn{constructor(t){this.settings=t,this.name=t.layout||"reflowable",this._spread=t.spread!=="none",this._minSpreadWidth=t.minSpreadWidth||800,this._evenSpreads=t.evenSpreads||!1,t.flow==="scrolled"||t.flow==="scrolled-continuous"||t.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(t){return typeof t<"u"&&(t==="scrolled"||t==="scrolled-continuous"||t==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(t,e){return t&&(this._spread=t!=="none",this.update({spread:this._spread})),e>=0&&(this._minSpreadWidth=e),this._spread}calculate(t,e,r){var i=1,n=r||0,s=t,o=e,h=Math.floor(s/12),u,d,p,y;this._spread&&s>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(n=h%2===0?h:h-1),this.name==="pre-paginated"&&(n=0),i>1?(u=s/i-n,p=u+n):(u=s,p=s),this.name==="pre-paginated"&&i>1&&(s=u),d=u*i+n,y=s,this.width=s,this.height=o,this.spreadWidth=d,this.pageWidth=p,this.delta=y,this.columnWidth=u,this.gap=n,this.divisor=i,this.update({width:s,height:o,spreadWidth:d,pageWidth:p,delta:y,columnWidth:u,gap:n,divisor:i})}format(t,e,r){var i;return this.name==="pre-paginated"?i=t.fit(this.columnWidth,this.height,e):this._flow==="paginated"?i=t.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?i=t.size(null,this.height):i=t.size(this.width,null),i}count(t,e){let r,i;return this.name==="pre-paginated"?(r=1,i=1):this._flow==="paginated"?(e=e||this.delta,r=Math.ceil(t/e),i=r*this.divisor):(e=e||this.height,r=Math.ceil(t/e),i=r),{spreads:r,pages:i}}update(t){if(Object.keys(t).forEach(e=>{this.props[e]===t[e]&&delete t[e]}),Object.keys(t).length>0){let e=he(this.props,t);this.emit(gt.LAYOUT.UPDATED,e,t)}}}Ne(Gn.prototype);class eo{constructor(t){this.rendition=t,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(t){if(t){if(typeof t=="string")return this.registerUrl("default",t);if(typeof t=="object")return this.registerRules("default",t)}}registerThemes(t){for(var e in t)t.hasOwnProperty(e)&&(typeof t[e]=="string"?this.registerUrl(e,t[e]):this.registerRules(e,t[e]))}registerCss(t,e){this._themes[t]={serialized:e},(this._injected[t]||t=="default")&&this.update(t)}registerUrl(t,e){var r=new ke(e);this._themes[t]={url:r.toString()},(this._injected[t]||t=="default")&&this.update(t)}registerRules(t,e){this._themes[t]={rules:e},(this._injected[t]||t=="default")&&this.update(t)}select(t){var e=this._current,r;this._current=t,this.update(t),r=this.rendition.getContents(),r.forEach(i=>{i.removeClass(e),i.addClass(t)})}update(t){var e=this.rendition.getContents();e.forEach(r=>{this.add(t,r)})}inject(t){var e=[],r=this._themes,i;for(var n in r)r.hasOwnProperty(n)&&(n===this._current||n==="default")&&(i=r[n],(i.rules&&Object.keys(i.rules).length>0||i.url&&e.indexOf(i.url)===-1)&&this.add(n,t),this._injected.push(n));this._current!="default"&&t.addClass(this._current)}add(t,e){var r=this._themes[t];!r||!e||(r.url?e.addStylesheet(r.url):r.serialized?(e.addStylesheetCss(r.serialized,t),r.injected=!0):r.rules&&(e.addStylesheetRules(r.rules,t),r.injected=!0))}override(t,e,r){var i=this.rendition.getContents();this._overrides[t]={value:e,priority:r===!0},i.forEach(n=>{n.css(t,this._overrides[t].value,this._overrides[t].priority)})}removeOverride(t){var e=this.rendition.getContents();delete this._overrides[t],e.forEach(r=>{r.css(t)})}overrides(t){var e=this._overrides;for(var r in e)e.hasOwnProperty(r)&&t.css(r,e[r].value,e[r].priority)}fontSize(t){this.override("font-size",t)}font(t){this.override("font-family",t,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class pr{constructor(t,e,r,i=!1){this.layout=t,this.horizontal=r==="horizontal",this.direction=e||"ltr",this._dev=i}section(t){var e=this.findRanges(t),r=this.rangeListToCfiList(t.section.cfiBase,e);return r}page(t,e,r,i){var n=t&&t.document?t.document.body:!1,s;if(n){if(s=this.rangePairToCfiPair(e,{start:this.findStart(n,r,i),end:this.findEnd(n,r,i)}),this._dev===!0){let o=t.document,h=new Mt(s.start).toRange(o),u=new Mt(s.end).toRange(o),d=o.defaultView.getSelection(),p=o.createRange();d.removeAllRanges(),p.setStart(h.startContainer,h.startOffset),p.setEnd(u.endContainer,u.endOffset),d.addRange(p)}return s}}walk(t,e){if(!(t&&t.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(h){return h.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=r.acceptNode;i.acceptNode=r.acceptNode;for(var n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,i,!1),s,o;(s=n.nextNode())&&(o=e(s),!o););return o}}findRanges(t){for(var e=[],r=t.contents.scrollWidth(),i=Math.ceil(r/this.layout.spreadWidth),n=i*this.layout.divisor,s=this.layout.columnWidth,o=this.layout.gap,h,u,d=0;d<n.pages;d++)h=(s+o)*d,u=s*(d+1)+o*d,e.push({start:this.findStart(t.document.body,h,u),end:this.findEnd(t.document.body,h,u)});return e}findStart(t,e,r){for(var i=[t],n,s,o=t;i.length;)if(n=i.shift(),s=this.walk(n,h=>{var u,d,p,y,_;if(_=ii(h),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?_.left:_.top,d=this.horizontal?_.right:_.bottom,u>=e&&u<=r||d>e)return h;o=h,i.push(h)}else if(this.horizontal&&this.direction==="rtl"){if(u=_.left,d=_.right,d<=r&&d>=e||u<r)return h;o=h,i.push(h)}else{if(p=_.top,y=_.bottom,p>=e&&p<=r||y>e)return h;o=h,i.push(h)}}),s)return this.findTextStartRange(s,e,r);return this.findTextStartRange(o,e,r)}findEnd(t,e,r){for(var i=[t],n,s=t,o;i.length;)if(n=i.shift(),o=this.walk(n,h=>{var u,d,p,y,_;if(_=ii(h),this.horizontal&&this.direction==="ltr"){if(u=Math.round(_.left),d=Math.round(_.right),u>r&&s)return s;if(d>r)return h;s=h,i.push(h)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?_.left:_.top),d=Math.round(this.horizontal?_.right:_.bottom),d<e&&s)return s;if(u<e)return h;s=h,i.push(h)}else{if(p=Math.round(_.top),y=Math.round(_.bottom),p>r&&s)return s;if(y>r)return h;s=h,i.push(h)}}),o)return this.findTextEndRange(o,e,r);return this.findTextEndRange(s,e,r)}findTextStartRange(t,e,r){for(var i=this.splitTextNodeIntoRanges(t),n,s,o,h,u,d=0;d<i.length;d++)if(n=i[d],s=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=s.left,o>=e)return n}else if(this.horizontal&&this.direction==="rtl"){if(u=s.right,u<=r)return n}else if(h=s.top,h>=e)return n;return i[0]}findTextEndRange(t,e,r){for(var i=this.splitTextNodeIntoRanges(t),n,s,o,h,u,d,p,y=0;y<i.length;y++){if(s=i[y],o=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(h=o.left,u=o.right,h>r&&n)return n;if(u>r)return s}else if(this.horizontal&&this.direction==="rtl"){if(h=o.left,u=o.right,u<e&&n)return n;if(h<e)return s}else{if(d=o.top,p=o.bottom,d>r&&n)return n;if(p>r)return s}n=s}return i[i.length-1]}splitTextNodeIntoRanges(t,e){var r=[],i=t.textContent||"",n=i.trim(),s,o=t.ownerDocument,h=e||" ",u=n.indexOf(h);if(u===-1||t.nodeType!=Node.TEXT_NODE)return s=o.createRange(),s.selectNodeContents(t),[s];for(s=o.createRange(),s.setStart(t,0),s.setEnd(t,u),r.push(s),s=!1;u!=-1;)u=n.indexOf(h,u+1),u>0&&(s&&(s.setEnd(t,u),r.push(s)),s=o.createRange(),s.setStart(t,u+1));return s&&(s.setEnd(t,n.length),r.push(s)),r}rangePairToCfiPair(t,e){var r=e.start,i=e.end;r.collapse(!0),i.collapse(!1);let n=new Mt(r,t).toString(),s=new Mt(i,t).toString();return{start:n,end:s}}rangeListToCfiList(t,e){for(var r=[],i,n=0;n<e.length;n++)i=this.rangePairToCfiPair(t,e[n]),r.push(i);return r}axis(t){return t&&(this.horizontal=t==="horizontal"),this.horizontal}}const Zn=typeof navigator<"u",ro=Zn&&/Chrome/.test(navigator.userAgent),an=Zn&&!ro&&/AppleWebKit/.test(navigator.userAgent),io=1;class fi{constructor(t,e,r,i){this.epubcfi=new Mt,this.document=t,this.documentElement=this.document.documentElement,this.content=e||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",yr),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return ar}width(t){var e=this.content;return t&&Qt(t)&&(t=t+"px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}height(t){var e=this.content;return t&&Qt(t)&&(t=t+"px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}contentWidth(t){var e=this.content||this.document.body;return t&&Qt(t)&&(t=t+"px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}contentHeight(t){var e=this.content||this.document.body;return t&&Qt(t)&&(t=t+"px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}textWidth(){let t,e,r=this.document.createRange(),i=this.content||this.document.body,n=hr(i);return r.selectNodeContents(i),t=r.getBoundingClientRect(),e=t.width,n&&n.width&&(e+=n.width),Math.round(e)}textHeight(){let t,e,r=this.document.createRange(),i=this.content||this.document.body;return r.selectNodeContents(i),t=r.getBoundingClientRect(),e=t.bottom,Math.round(e)}scrollWidth(){var t=this.documentElement.scrollWidth;return t}scrollHeight(){var t=this.documentElement.scrollHeight;return t}overflow(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow}overflowX(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY}css(t,e,r){var i=this.content||this.document.body;return e?i.style.setProperty(t,e,r?"important":""):i.style.removeProperty(t),this.window.getComputedStyle(i)[t]}viewport(t){var e=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],n={};if(e&&e.hasAttribute("content")){let s=e.getAttribute("content"),o=s.match(/width\s*=\s*([^,]*)/),h=s.match(/height\s*=\s*([^,]*)/),u=s.match(/initial-scale\s*=\s*([^,]*)/),d=s.match(/minimum-scale\s*=\s*([^,]*)/),p=s.match(/maximum-scale\s*=\s*([^,]*)/),y=s.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(r.width=o[1]),h&&h.length&&typeof h[1]<"u"&&(r.height=h[1]),u&&u.length&&typeof u[1]<"u"&&(r.scale=u[1]),d&&d.length&&typeof d[1]<"u"&&(r.minimum=d[1]),p&&p.length&&typeof p[1]<"u"&&(r.maximum=p[1]),y&&y.length&&typeof y[1]<"u"&&(r.scalable=y[1])}return n=Bn(t||{},r),t&&(n.width&&i.push("width="+n.width),n.height&&i.push("height="+n.height),n.scale&&i.push("initial-scale="+n.scale),n.scalable==="no"?(i.push("minimum-scale="+n.scale),i.push("maximum-scale="+n.scale),i.push("user-scalable="+n.scalable)):(n.scalable&&i.push("user-scalable="+n.scalable),n.minimum&&i.push("minimum-scale="+n.minimum),n.maximum&&i.push("minimum-scale="+n.maximum)),e||(e=this.document.createElement("meta"),e.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(e)),e.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(gt.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let t=this.textWidth(),e=this.textHeight();(t!=this._size.width||e!=this._size.height)&&(this._size={width:t,height:e},this.onResize&&this.onResize(this._size),this.emit(gt.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var t=this.document.styleSheets,e=(function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<t.length;r+=1){var i;try{i=t[r].cssRules}catch{return}if(!i)return;for(var n=0;n<i.length;n+=1)if(i[n].media){var s=this.window.matchMedia(i[n].media.mediaText);s.addListener(e)}}}resizeObservers(){this.observer=new ResizeObserver(t=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(e=>{this.resizeCheck()});let t={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,t)}imageLoadListeners(){for(var t=this.document.querySelectorAll("img"),e,r=0;r<t.length;r++)e=t[r],typeof e.naturalWidth<"u"&&e.naturalWidth===0&&(e.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(t,e){var r,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(t)){let n=new Mt(t).toRange(this.document,e);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let s=n.startContainer.textContent.indexOf(" ",n.startOffset);s==-1&&(s=n.startContainer.textContent.length),n.setEnd(n.startContainer,s)}}catch(s){console.error("setting end offset to start container length failed",s)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)r=n.startContainer.getBoundingClientRect(),i.left=r.left,i.top=r.top;else if(an){let s=n.startContainer,o=new Range;try{s.nodeType===io?r=s.getBoundingClientRect():n.startOffset+2<s.length?(o.setStart(s,n.startOffset),o.setEnd(s,n.startOffset+2),r=o.getBoundingClientRect()):n.startOffset-2>0?(o.setStart(s,n.startOffset-2),o.setEnd(s,n.startOffset),r=o.getBoundingClientRect()):r=s.parentNode.getBoundingClientRect()}catch(h){console.error(h,h.stack)}}else r=n.getBoundingClientRect()}}else if(typeof t=="string"&&t.indexOf("#")>-1){let n=t.substring(t.indexOf("#")+1),s=this.document.getElementById(n);if(s)if(an){let o=new Range;o.selectNode(s),r=o.getBoundingClientRect()}else r=s.getBoundingClientRect()}return r&&(i.left=r.left,i.top=r.top),i}addStylesheet(t){return new Promise((function(e,r){var i,n=!1;if(!this.document){e(!1);return}if(i=this.document.querySelector("link[href='"+t+"']"),i){e(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=t,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{e(!0)},1))},this.document.head.appendChild(i)}).bind(this))}_getStylesheetNode(t){var e;return t="epubjs-inserted-css-"+(t||""),this.document?(e=this.document.getElementById(t),e||(e=this.document.createElement("style"),e.id=t,this.document.head.appendChild(e)),e):!1}addStylesheetCss(t,e){if(!this.document||!t)return!1;var r;return r=this._getStylesheetNode(e),r.innerHTML=t,!0}addStylesheetRules(t,e){var r;if(!(!this.document||!t||t.length===0))if(r=this._getStylesheetNode(e).sheet,Object.prototype.toString.call(t)==="[object Array]")for(var i=0,n=t.length;i<n;i++){var s=1,o=t[i],h=t[i][0],u="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],s=0);for(var d=o.length;s<d;s++){var p=o[s];u+=p[0]+":"+p[1]+(p[2]?" !important":"")+`;
`}r.insertRule(h+"{"+u+"}",r.cssRules.length)}else Object.keys(t).forEach(y=>{const _=t[y];if(Array.isArray(_))_.forEach(O=>{const x=Object.keys(O).map(c=>`${c}:${O[c]}`).join(";");r.insertRule(`${y}{${x}}`,r.cssRules.length)});else{const O=Object.keys(_).map(x=>`${x}:${_[x]}`).join(";");r.insertRule(`${y}{${O}}`,r.cssRules.length)}})}addScript(t){return new Promise((function(e,r){var i,n=!1;if(!this.document){e(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){e(!0)},1))},this.document.head.appendChild(i)}).bind(this))}addClass(t){var e;this.document&&(e=this.content||this.document.body,e&&e.classList.add(t))}removeClass(t){var e;this.document&&(e=this.content||this.document.body,e&&e.classList.remove(t))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),ar.forEach(function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(ar.forEach(function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(t){this.emit(t.type,t)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var e=this.window.getSelection();this.triggerSelectedEvent(e)}).bind(this),250)}triggerSelectedEvent(t){var e,r;t&&t.rangeCount>0&&(e=t.getRangeAt(0),e.collapsed||(r=new Mt(e,this.cfiBase).toString(),this.emit(gt.CONTENTS.SELECTED,r),this.emit(gt.CONTENTS.SELECTED_RANGE,e)))}range(t,e){var r=new Mt(t);return r.toRange(this.document,e)}cfiFromRange(t,e){return new Mt(t,this.cfiBase,e).toString()}cfiFromNode(t,e){return new Mt(t,this.cfiBase,e).toString()}map(t){var e=new pr(t);return e.section()}size(t,e){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),r.width=t,this.css("padding","0 "+t/12+"px")),e>=0&&(this.height(e),r.height=e),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(t,e,r,i,n){let s=Fe("column-axis"),o=Fe("column-gap"),h=Fe("column-width"),u=Fe("column-fill"),d=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&d==="horizontal"&&this.direction(n),this.width(t),this.height(e),this.viewport({width:t,height:e,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),d==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(s,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(s,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(o,i+"px"),this.css(h,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(t,e,r){var i="scale("+t+")",n="";this.css("transform-origin","top left"),(e>=0||r>=0)&&(n=" translate("+(e||0)+"px, "+(r||0)+"px )"),this.css("transform",i+n)}fit(t,e,r){var i=this.viewport(),n=parseInt(i.width),s=parseInt(i.height),o=t/n,h=e/s,u=o<h?o:h;if(this.layoutStyle("paginated"),this.width(n),this.height(s),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",n*u+"px "+s*u+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var d=t-n*u;this.css("margin-left",d+"px")}}direction(t){this.documentElement&&(this.documentElement.style.direction=t)}mapPage(t,e,r,i,n){var s=new pr(e,n);return s.page(this,t,r,i)}linksHandler(){Zs(this.content,t=>{this.emit(gt.CONTENTS.LINK_CLICKED,t)})}writingMode(t){let e=Fe("writing-mode");return t&&this.documentElement&&(this.documentElement.style[e]=t),this.window.getComputedStyle(this.documentElement)[e]||""}layoutStyle(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(t,e){return navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}Ne(fi.prototype);class no{constructor(t){this.rendition=t,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(t,e,r,i,n,s){let o=encodeURI(e+t),h=new Mt(e).spinePos,u=new Xn({type:t,cfiRange:e,data:r,sectionIndex:h,cb:i,className:n,styles:s});return this._annotations[o]=u,h in this._annotationsBySectionIndex?this._annotationsBySectionIndex[h].push(o):this._annotationsBySectionIndex[h]=[o],this.rendition.views().forEach(d=>{u.sectionIndex===d.index&&u.attach(d)}),u}remove(t,e){let r=encodeURI(t+e);if(r in this._annotations){let i=this._annotations[r];if(e&&i.type!==e)return;this.rendition.views().forEach(n=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,r),i.sectionIndex===n.index&&i.detach(n)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(t,e){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter(r=>r!==e)}_annotationsAt(t){return this._annotationsBySectionIndex[t]}highlight(t,e,r,i,n){return this.add("highlight",t,e,r,i,n)}underline(t,e,r,i,n){return this.add("underline",t,e,r,i,n)}mark(t,e,r){return this.add("mark",t,e,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(t){let e=t.index;e in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[e].forEach(r=>{this._annotations[r].attach(t)})}clear(t){let e=t.index;e in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[e].forEach(r=>{this._annotations[r].detach(t)})}show(){}hide(){}}class Xn{constructor({type:t,cfiRange:e,data:r,sectionIndex:i,cb:n,className:s,styles:o}){this.type=t,this.cfiRange=e,this.data=r,this.sectionIndex=i,this.mark=void 0,this.cb=n,this.className=s,this.styles=o}update(t){this.data=t}attach(t){let{cfiRange:e,data:r,type:i,mark:n,cb:s,className:o,styles:h}=this,u;return i==="highlight"?u=t.highlight(e,r,s,o,h):i==="underline"?u=t.underline(e,r,s,o,h):i==="mark"&&(u=t.mark(e,r,s)),this.mark=u,this.emit(gt.ANNOTATION.ATTACH,u),u}detach(t){let{cfiRange:e,type:r}=this,i;return t&&(r==="highlight"?i=t.unhighlight(e):r==="underline"?i=t.ununderline(e):r==="mark"&&(i=t.unmark(e))),this.mark=void 0,this.emit(gt.ANNOTATION.DETACH,i),i}text(){}}Ne(Xn.prototype);var xe={},Je={},ln;function so(){if(ln)return Je;ln=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.createElement=v;function v(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}return Je.default={createElement:v},Je}var qe={},hn;function oo(){if(hn)return qe;hn=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.proxyMouse=v,qe.clone=t,qe.default={proxyMouse:v};function v(r,i){function n(u){for(var d=i.length-1;d>=0;d--){var p=i[d],y=u.clientX,_=u.clientY;if(u.touches&&u.touches.length&&(y=u.touches[0].clientX,_=u.touches[0].clientY),!!e(p,r,y,_)){p.dispatchEvent(t(u));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var s=["mouseup","mousedown","click","touchstart"],o=0;o<s.length;o++){var h=s[o];this.target.addEventListener(h,function(u){return n(u)},!1)}}function t(r){var i=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,i)}catch{var n=document.createEvent("MouseEvents");return n.initMouseEvent(r.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),n}}function e(r,i,n,s){var o=i.getBoundingClientRect();function h(_,O,x){var c=_.top-o.top,g=_.left-o.left,m=c+_.height,C=g+_.width;return c<=x&&g<=O&&m>x&&C>O}var u=r.getBoundingClientRect();if(!h(u,n,s))return!1;for(var d=r.getClientRects(),p=0,y=d.length;p<y;p++)if(h(d[p],n,s))return!0;return!1}return qe}var cn;function ao(){if(cn)return xe;cn=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.Underline=xe.Highlight=xe.Mark=xe.Pane=void 0;var v=function x(c,g,m){c===null&&(c=Function.prototype);var C=Object.getOwnPropertyDescriptor(c,g);if(C===void 0){var z=Object.getPrototypeOf(c);return z===null?void 0:x(z,g,m)}else{if("value"in C)return C.value;var b=C.get;return b===void 0?void 0:b.call(m)}},t=(function(){function x(c,g){for(var m=0;m<g.length;m++){var C=g[m];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(c,C.key,C)}}return function(c,g,m){return g&&x(c.prototype,g),m&&x(c,m),c}})(),e=so(),r=s(e),i=oo(),n=s(i);function s(x){return x&&x.__esModule?x:{default:x}}function o(x,c){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:x}function h(x,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);x.prototype=Object.create(c&&c.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(x,c):x.__proto__=c)}function u(x,c){if(!(x instanceof c))throw new TypeError("Cannot call a class as a function")}xe.Pane=(function(){function x(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;u(this,x),this.target=c,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),n.default.proxyMouse(this.target,this.marks),this.container=g,this.container.appendChild(this.element),this.render()}return t(x,[{key:"addMark",value:function(c){var g=r.default.createElement("g");return this.element.appendChild(g),c.bind(g,this.container),this.marks.push(c),c.render(),c}},{key:"removeMark",value:function(c){var g=this.marks.indexOf(c);if(g!==-1){var m=c.unbind();this.element.removeChild(m),this.marks.splice(g,1)}}},{key:"render",value:function(){_(this.element,y(this.target,this.container));var c=!0,g=!1,m=void 0;try{for(var C=this.marks[Symbol.iterator](),z;!(c=(z=C.next()).done);c=!0){var b=z.value;b.render()}}catch(L){g=!0,m=L}finally{try{!c&&C.return&&C.return()}finally{if(g)throw m}}}}]),x})();var d=xe.Mark=(function(){function x(){u(this,x),this.element=null}return t(x,[{key:"bind",value:function(c,g){this.element=c,this.container=g}},{key:"unbind",value:function(){var c=this.element;return this.element=null,c}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(c){this.element&&this.element.dispatchEvent(c)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var c=[],g=this.element.firstChild;g;)c.push(g.getBoundingClientRect()),g=g.nextSibling;return c}},{key:"filteredRanges",value:function(){var c=Array.from(this.range.getClientRects());return c.filter(function(g){for(var m=0;m<c.length;m++){if(c[m]===g)return!0;var C=O(c[m],g);if(C)return!1}return!0})}}]),x})(),p=xe.Highlight=(function(x){h(c,x);function c(g,m,C,z){u(this,c);var b=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.range=g,b.className=m,b.data=C||{},b.attributes=z||{},b}return t(c,[{key:"bind",value:function(g,m){v(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"bind",this).call(this,g,m);for(var C in this.data)this.data.hasOwnProperty(C)&&(this.element.dataset[C]=this.data[C]);for(var C in this.attributes)this.attributes.hasOwnProperty(C)&&this.element.setAttribute(C,this.attributes[C]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),m=this.filteredRanges(),C=this.element.getBoundingClientRect(),z=this.container.getBoundingClientRect(),b=0,L=m.length;b<L;b++){var T=m[b],D=r.default.createElement("rect");D.setAttribute("x",T.left-C.left+z.left),D.setAttribute("y",T.top-C.top+z.top),D.setAttribute("height",T.height),D.setAttribute("width",T.width),g.appendChild(D)}this.element.appendChild(g)}}]),c})(d);xe.Underline=(function(x){h(c,x);function c(g,m,C,z){return u(this,c),o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,g,m,C,z))}return t(c,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),m=this.filteredRanges(),C=this.element.getBoundingClientRect(),z=this.container.getBoundingClientRect(),b=0,L=m.length;b<L;b++){var T=m[b],D=r.default.createElement("rect");D.setAttribute("x",T.left-C.left+z.left),D.setAttribute("y",T.top-C.top+z.top),D.setAttribute("height",T.height),D.setAttribute("width",T.width),D.setAttribute("fill","none");var N=r.default.createElement("line");N.setAttribute("x1",T.left-C.left+z.left),N.setAttribute("x2",T.left-C.left+z.left+T.width),N.setAttribute("y1",T.top-C.top+z.top+T.height-1),N.setAttribute("y2",T.top-C.top+z.top+T.height-1),N.setAttribute("stroke-width",1),N.setAttribute("stroke","black"),N.setAttribute("stroke-linecap","square"),g.appendChild(D),g.appendChild(N)}this.element.appendChild(g)}}]),c})(p);function y(x,c){var g=c.getBoundingClientRect(),m=x.getBoundingClientRect();return{top:m.top-g.top,left:m.left-g.left,height:x.scrollHeight,width:x.scrollWidth}}function _(x,c){x.style.setProperty("top",c.top+"px","important"),x.style.setProperty("left",c.left+"px","important"),x.style.setProperty("height",c.height+"px","important"),x.style.setProperty("width",c.width+"px","important")}function O(x,c){return c.right<=x.right&&c.left>=x.left&&c.top>=x.top&&c.bottom<=x.bottom}return xe}var nr=ao();class Yn{constructor(t,e){this.settings=he({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},e||{}),this.id="epubjs-view-"+vr(),this.section=t,this.index=t.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new Mt,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(t){var e=document.createElement("div");return e.classList.add("epub-view"),e.style.height="0px",e.style.width="0px",e.style.overflow="hidden",e.style.position="relative",e.style.display="block",t&&t=="horizontal"?e.style.flex="none":e.style.flex="initial",e}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=or(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(t,e){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=r.indexOf("vertical")===0?"horizontal":"vertical":i=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(gt.VIEWS.AXIS,i),this.setWritingMode(r),this.emit(gt.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,s)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}).bind(this),(function(r){return this.emit(gt.VIEWS.LOAD_ERROR,r),new Promise((i,n)=>{n(r)})}).bind(this)).then((function(){this.emit(gt.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(t,e){var r=t||this.settings.width,i=e||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,i):this.settings.axis==="horizontal"?this.lock("height",r,i):this.lock("width",r,i),this.settings.width=r,this.settings.height=i}lock(t,e,r){var i=hr(this.element),n;this.iframe?n=hr(this.iframe):n={width:0,height:0},t=="width"&&Qt(e)&&(this.lockedWidth=e-i.width-n.width),t=="height"&&Qt(r)&&(this.lockedHeight=r-i.height-n.height),t==="both"&&Qt(e)&&Qt(r)&&(this.lockedWidth=e-i.width-n.width,this.lockedHeight=r-i.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(t){var e=this.lockedWidth,r=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(e=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(e=this.contents.textWidth(),e%this.layout.pageWidth>0&&(e=Math.ceil(e/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=e/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(e+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||e!=this._width||r!=this._height)&&this.reframe(e,r),this._expanding=!1)}reframe(t,e){var r;Qt(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),Qt(e)&&(this.element.style.height=e+"px",this.iframe.style.height=e+"px",this._height=e);let i=this.prevBounds?t-this.prevBounds.width:t,n=this.prevBounds?e-this.prevBounds.height:e;r={width:t,height:e,widthDelta:i,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let s;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(s=this.marks[o],this.placeMark(s.element,s.range))}),this.onResize(this,r),this.emit(gt.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=or(this.element)}load(t){var e=new Pt,r=e.promise;if(!this.iframe)return e.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(n){this.onLoad(n,e)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=ur(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return e.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(t)})}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close()}return r}onLoad(t,e){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new fi(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(gt.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(gt.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),e.resolve(this.contents)}setLayout(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(t){this.settings.axis=t,t=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(t){this.writingMode=t}addListeners(){}removeListeners(t){}display(t){var e=new Pt;return this.displayed?e.resolve(this):this.render(t).then((function(){this.emit(gt.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,e.resolve(this)}).bind(this),function(r){e.reject(r,this)}),e.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(gt.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(gt.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(t){this.iframe.getBoundingClientRect();var e=this.contents.locationOf(t,this.settings.ignoreClass);return{left:e.left,top:e.top}}onDisplayed(t){}onResize(t,e){}bounds(t){return(t||!this.elementBounds)&&(this.elementBounds=or(this.element)),this.elementBounds}highlight(t,e={},r,i="epubjs-hl",n={}){if(!this.contents)return;const s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(t),h=()=>{this.emit(gt.VIEWS.MARK_CLICKED,t,e)};e.epubcfi=t,this.pane||(this.pane=new nr.Pane(this.iframe,this.element));let u=new nr.Highlight(o,i,e,s),d=this.pane.addMark(u);return this.highlights[t]={mark:d,element:d.element,listeners:[h,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",h),d.element.addEventListener("touchstart",h),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}underline(t,e={},r,i="epubjs-ul",n={}){if(!this.contents)return;const s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(t),h=()=>{this.emit(gt.VIEWS.MARK_CLICKED,t,e)};e.epubcfi=t,this.pane||(this.pane=new nr.Pane(this.iframe,this.element));let u=new nr.Underline(o,i,e,s),d=this.pane.addMark(u);return this.underlines[t]={mark:d,element:d.element,listeners:[h,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",h),d.element.addEventListener("touchstart",h),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}mark(t,e={},r){if(!this.contents)return;if(t in this.marks)return this.marks[t];let i=this.contents.range(t);if(!i)return;let n=i.commonAncestorContainer,s=n.nodeType===1?n:n.parentNode,o=u=>{this.emit(gt.VIEWS.MARK_CLICKED,t,e)};i.collapsed&&n.nodeType===1?(i=new Range,i.selectNodeContents(n)):i.collapsed&&(i=new Range,i.selectNodeContents(s));let h=this.document.createElement("a");return h.setAttribute("ref","epubjs-mk"),h.style.position="absolute",h.dataset.epubcfi=t,e&&Object.keys(e).forEach(u=>{h.dataset[u]=e[u]}),r&&(h.addEventListener("click",r),h.addEventListener("touchstart",r)),h.addEventListener("click",o),h.addEventListener("touchstart",o),this.placeMark(h,i),this.element.appendChild(h),this.marks[t]={element:h,range:i,listeners:[o,r]},s}placeMark(t,e){let r,i,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=e.getBoundingClientRect();r=o.top,i=o.right}else{let o=e.getClientRects(),h;for(var s=0;s!=o.length;s++)h=o[s],(!n||h.left<n)&&(n=h.left,i=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=h.top)}t.style.top=`${r}px`,t.style.left=`${i}px`}unhighlight(t){let e;t in this.highlights&&(e=this.highlights[t],this.pane.removeMark(e.mark),e.listeners.forEach(r=>{r&&(e.element.removeEventListener("click",r),e.element.removeEventListener("touchstart",r))}),delete this.highlights[t])}ununderline(t){let e;t in this.underlines&&(e=this.underlines[t],this.pane.removeMark(e.mark),e.listeners.forEach(r=>{r&&(e.element.removeEventListener("click",r),e.element.removeEventListener("touchstart",r))}),delete this.underlines[t])}unmark(t){let e;t in this.marks&&(e=this.marks[t],this.element.removeChild(e.element),e.listeners.forEach(r=>{r&&(e.element.removeEventListener("click",r),e.element.removeEventListener("touchstart",r))}),delete this.marks[t])}destroy(){for(let t in this.highlights)this.unhighlight(t);for(let t in this.underlines)this.ununderline(t);for(let t in this.marks)this.unmark(t);this.blobUrl&&Mn(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}Ne(Yn.prototype);function lo(){var v="reverse",t=ho();return document.body.appendChild(t),t.scrollLeft>0?v="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(t.children[0].children[1].scrollIntoView(),t.scrollLeft<0&&(v="negative")):(t.scrollLeft=1,t.scrollLeft===0&&(v="negative")),document.body.removeChild(t),v}function ho(){var v=document.createElement("div");v.dir="rtl",v.style.position="fixed",v.style.width="1px",v.style.height="1px",v.style.top="0px",v.style.left="0px",v.style.overflow="hidden";var t=document.createElement("div");t.style.width="2px";var e=document.createElement("span");e.style.width="1px",e.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",t.appendChild(e),t.appendChild(r),v.appendChild(t),v}var jr,un;function pi(){if(un)return jr;un=1;function v(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return jr=v,jr}var qr,dn;function co(){if(dn)return qr;dn=1;var v=typeof we=="object"&&we&&we.Object===Object&&we;return qr=v,qr}var Fr,fn;function $n(){if(fn)return Fr;fn=1;var v=co(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=v||t||Function("return this")();return Fr=e,Fr}var Wr,pn;function uo(){if(pn)return Wr;pn=1;var v=$n(),t=function(){return v.Date.now()};return Wr=t,Wr}var Hr,gn;function fo(){if(gn)return Hr;gn=1;var v=/\s/;function t(e){for(var r=e.length;r--&&v.test(e.charAt(r)););return r}return Hr=t,Hr}var Vr,mn;function po(){if(mn)return Vr;mn=1;var v=fo(),t=/^\s+/;function e(r){return r&&r.slice(0,v(r)+1).replace(t,"")}return Vr=e,Vr}var Gr,vn;function Kn(){if(vn)return Gr;vn=1;var v=$n(),t=v.Symbol;return Gr=t,Gr}var Zr,yn;function go(){if(yn)return Zr;yn=1;var v=Kn(),t=Object.prototype,e=t.hasOwnProperty,r=t.toString,i=v?v.toStringTag:void 0;function n(s){var o=e.call(s,i),h=s[i];try{s[i]=void 0;var u=!0}catch{}var d=r.call(s);return u&&(o?s[i]=h:delete s[i]),d}return Zr=n,Zr}var Xr,wn;function mo(){if(wn)return Xr;wn=1;var v=Object.prototype,t=v.toString;function e(r){return t.call(r)}return Xr=e,Xr}var Yr,bn;function vo(){if(bn)return Yr;bn=1;var v=Kn(),t=go(),e=mo(),r="[object Null]",i="[object Undefined]",n=v?v.toStringTag:void 0;function s(o){return o==null?o===void 0?i:r:n&&n in Object(o)?t(o):e(o)}return Yr=s,Yr}var $r,_n;function yo(){if(_n)return $r;_n=1;function v(t){return t!=null&&typeof t=="object"}return $r=v,$r}var Kr,xn;function wo(){if(xn)return Kr;xn=1;var v=vo(),t=yo(),e="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&v(i)==e}return Kr=r,Kr}var Jr,En;function bo(){if(En)return Jr;En=1;var v=po(),t=pi(),e=wo(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function h(u){if(typeof u=="number")return u;if(e(u))return r;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=v(u);var p=n.test(u);return p||s.test(u)?o(u.slice(2),p?2:8):i.test(u)?r:+u}return Jr=h,Jr}var Qr,kn;function Jn(){if(kn)return Qr;kn=1;var v=pi(),t=uo(),e=bo(),r="Expected a function",i=Math.max,n=Math.min;function s(o,h,u){var d,p,y,_,O,x,c=0,g=!1,m=!1,C=!0;if(typeof o!="function")throw new TypeError(r);h=e(h)||0,v(u)&&(g=!!u.leading,m="maxWait"in u,y=m?i(e(u.maxWait)||0,h):y,C="trailing"in u?!!u.trailing:C);function z($){var et=d,at=p;return d=p=void 0,c=$,_=o.apply(at,et),_}function b($){return c=$,O=setTimeout(D,h),g?z($):_}function L($){var et=$-x,at=$-c,pt=h-et;return m?n(pt,y-at):pt}function T($){var et=$-x,at=$-c;return x===void 0||et>=h||et<0||m&&at>=y}function D(){var $=t();if(T($))return N($);O=setTimeout(D,L($))}function N($){return O=void 0,C&&d?z($):(d=p=void 0,_)}function A(){O!==void 0&&clearTimeout(O),c=0,d=x=p=O=void 0}function W(){return O===void 0?_:N(t())}function X(){var $=t(),et=T($);if(d=arguments,p=this,x=$,et){if(O===void 0)return b(x);if(m)return clearTimeout(O),O=setTimeout(D,h),z(x)}return O===void 0&&(O=setTimeout(D,h)),_}return X.cancel=A,X.flush=W,X}return Qr=s,Qr}var ti,Sn;function _o(){if(Sn)return ti;Sn=1;var v=Jn(),t=pi(),e="Expected a function";function r(i,n,s){var o=!0,h=!0;if(typeof i!="function")throw new TypeError(e);return t(s)&&(o="leading"in s?!!s.leading:o,h="trailing"in s?!!s.trailing:h),v(i,n,{leading:o,maxWait:n,trailing:h})}return ti=r,ti}var xo=_o();const Eo=Ze(xo);class ko{constructor(t){this.settings=t||{},this.id="epubjs-container-"+vr(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(t){let e=t.height,r=t.width,i=t.overflow||!1,n=t.axis||"vertical",s=t.direction;he(this.settings,t),t.height&&Qt(t.height)&&(e=t.height+"px"),t.width&&Qt(t.width)&&(r=t.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",n==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),r&&(o.style.width=r),e&&(o.style.height=e),i&&(i==="scroll"&&n==="vertical"?(o.style["overflow-y"]=i,o.style["overflow-x"]="hidden"):i==="scroll"&&n==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=i):o.style.overflow=i),s&&(o.dir=s,o.style.direction=s),s&&this.settings.fullsize&&(document.body.style.direction=s),o}wrap(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e}getElement(t){var e;if(zn(t)?e=t:typeof t=="string"&&(e=document.getElementById(t)),!e)throw new Error("Not an Element");return e}attachTo(t){var e=this.getElement(t),r;if(e)return this.settings.hidden?r=this.wrapper:r=this.container,e.appendChild(r),this.element=e,e}getContainer(){return this.container}onResize(t){(!Qt(this.settings.width)||!Qt(this.settings.height))&&(this.resizeFunc=Eo(t,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(t,e){var r;let i=t||this.settings.width,n=e||this.settings.height;t===null?(r=this.element.getBoundingClientRect(),r.width&&(t=Math.floor(r.width),this.container.style.width=t+"px")):Qt(t)?this.container.style.width=t+"px":this.container.style.width=t,e===null?(r=r||this.element.getBoundingClientRect(),r.height&&(e=r.height,this.container.style.height=e+"px")):Qt(e)?this.container.style.height=e+"px":this.container.style.height=e,Qt(t)||(t=this.container.clientWidth),Qt(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let s=cr(),o=window.getComputedStyle(document.body),h={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return i||(t=s.width-h.left-h.right),(this.settings.fullsize&&!n||!n)&&(e=s.height-h.top-h.bottom),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let t;return this.container.style.overflow!=="visible"&&(t=this.container&&this.container.getBoundingClientRect()),!t||!t.width||!t.height?cr():t}getSheet(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}addStyleRules(t,e){var r="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),e.forEach(function(n){for(var s in n)n.hasOwnProperty(s)&&(i+=s+":"+n[s]+";")}),this.sheet.insertRule(r+t+" {"+i+"}",0)}axis(t){t==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}direction(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}overflow(t){this.container&&(t==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):t==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class So{constructor(t){this.container=t,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(t){return this._views.indexOf(t)}slice(){return this._views.slice.apply(this._views,arguments)}get(t){return this._views[t]}append(t){return this._views.push(t),this.container&&this.container.appendChild(t.element),this.length++,t}prepend(t){return this._views.unshift(t),this.container&&this.container.insertBefore(t.element,this.container.firstChild),this.length++,t}insert(t,e){return this._views.splice(e,0,t),this.container&&(e<this.container.children.length?this.container.insertBefore(t.element,this.container.children[e]):this.container.appendChild(t.element)),this.length++,t}remove(t){var e=this._views.indexOf(t);e>-1&&this._views.splice(e,1),this.destroy(t),this.length--}destroy(t){t.displayed&&t.destroy(),this.container&&this.container.removeChild(t.element),t=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var t,e=this.length;if(this.length){for(var r=0;r<e;r++)t=this._views[r],this.destroy(t);this._views=[],this.length=0}}find(t){for(var e,r=this.length,i=0;i<r;i++)if(e=this._views[i],e.displayed&&e.section.index==t.index)return e}displayed(){for(var t=[],e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&t.push(e);return t}show(){for(var t,e=this.length,r=0;r<e;r++)t=this._views[r],t.displayed&&t.show();this.hidden=!1}hide(){for(var t,e=this.length,r=0;r<e;r++)t=this._views[r],t.displayed&&t.hide();this.hidden=!0}}class gr{constructor(t){this.name="default",this.optsSettings=t.settings,this.View=t.view,this.request=t.request,this.renditionQueue=t.queue,this.q=new di(this),this.settings=he(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),he(this.settings,t.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(t,e){let r=t.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=e,this.settings.rtlScrollType=lo(),this.stage=new ko({width:e.width,height:e.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(t),this.container=this.stage.getContainer(),this.views=new So(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var t;window.addEventListener("unload",(function(e){this.destroy()}).bind(this)),this.settings.fullsize?t=window:t=this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll)}removeEventListeners(){var t;this.settings.fullsize?t=window:t=this.container,t.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(t){let{orientation:e}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(gt.MANAGERS.ORIENTATION_CHANGE,e)}).bind(this),500)}onResized(t){this.resize()}resize(t,e,r){let i=this.stage.size(t,e);if(this.winBounds=cr(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(gt.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(t,e){return new this.View(t,he(this.viewSettings,{forceRight:e}))}handleNextPrePaginated(t,e,r){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(t||e.index===0)return;if(i=e.next(),i&&!i.properties.includes("page-spread-left"))return r.call(this,i)}}display(t,e){var r=new Pt,i=r.promise;(e===t.href||Qt(e))&&(e=void 0);var n=this.views.find(t);if(n&&t&&this.layout.name!=="pre-paginated"){let o=n.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let h=n.width();this.scrollTo(o.left+h,o.top,!0)}if(e){let h=n.locationOf(e),u=n.width();this.moveTo(h,u)}return r.resolve(),i}this.clear();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&t.properties.includes("page-spread-right")&&(s=!0),this.add(t,s).then((function(o){if(e){let h=o.locationOf(e),u=o.width();this.moveTo(h,u)}}).bind(this),o=>{r.reject(o)}).then((function(){return this.handleNextPrePaginated(s,t,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),i}afterDisplayed(t){this.emit(gt.MANAGERS.ADDED,t)}afterResized(t){this.emit(gt.MANAGERS.RESIZE,t.section)}moveTo(t,e){var r=0,i=0;this.isPaginated?(r=Math.floor(t.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),i=Math.floor(t.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=t.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-e),this.scrollTo(r,i,!0)}add(t,e){var r=this.createView(t,e);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(gt.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(gt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}append(t,e){var r=this.createView(t,e);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(gt.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(gt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}prepend(t,e){var r=this.createView(t,e);return r.on(gt.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(gt.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(gt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}counter(t){this.settings.axis==="vertical"?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}next(){var t,e;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,e=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,e<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(e=this.container.scrollLeft,e>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):(e=this.container.scrollLeft+this.layout.delta*-1,e>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next(),t)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&t.properties.includes("page-spread-right")&&(i=!0),this.append(t,i).then((function(){return this.handleNextPrePaginated(i,t,this.append)}).bind(this),n=>n).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var t,e;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,e=this.container.scrollLeft,e>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(e=this.container.scrollLeft+this.container.offsetWidth,e<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):(e=this.container.scrollLeft,e<0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev(),t)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof t.prev()!="object"&&(i=!0),this.prepend(t,i).then((function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=t.prev(),n))return this.prepend(n)}).bind(this),n=>n).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var t=this.visible();return t.length?t[t.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let t=this.visible(),e=this.container.getBoundingClientRect(),r=e.height<window.innerHeight?e.height:window.innerHeight,i=e.width<window.innerWidth?e.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let s=0,o=0;return this.settings.fullsize&&(s=n?window.scrollY:window.scrollX),t.map(h=>{let{index:u,href:d}=h.section,p=h.position(),y=h.width(),_=h.height(),O,x,c,g;n?(O=s+e.top-p.top+o,x=O+r-o,g=this.layout.count(_,r).pages,c=r):(O=s+e.left-p.left+o,x=O+i-o,g=this.layout.count(y,i).pages,c=i);let m=Math.ceil(O/c),C=[],z=Math.ceil(x/c);if(this.settings.direction==="rtl"&&!n){let T=m;m=g-z,z=g-T}C=[];for(var b=m;b<=z;b++){let T=b+1;C.push(T)}let L=this.mapping.page(h.contents,h.section.cfiBase,O,x);return{index:u,href:d,pages:C,totalPages:g,mapping:L}})}paginatedLocation(){let t=this.visible(),e=this.container.getBoundingClientRect(),r=0,i=0;return this.settings.fullsize&&(r=window.scrollX),t.map(n=>{let{index:s,href:o}=n.section,h,u=n.position(),d=n.width(),p,y,_;this.settings.direction==="rtl"?(h=e.right-r,_=Math.min(Math.abs(h-u.left),this.layout.width)-i,y=u.width-(u.right-h)-i,p=y-_):(h=e.left+r,_=Math.min(u.right-h,this.layout.width)-i,p=h-u.left+i,y=p+_),i+=_;let O=this.mapping.page(n.contents,n.section.cfiBase,p,y),x=this.layout.count(d).pages,c=Math.floor(p/this.layout.pageWidth),g=[],m=Math.floor(y/this.layout.pageWidth);if(c<0&&(c=0,m=m+1),this.settings.direction==="rtl"){let z=c;c=x-m,m=x-z}for(var C=c+1;C<=m;C++){let z=C;g.push(z)}return{index:s,href:o,pages:g,totalPages:x,mapping:O}})}isVisible(t,e,r,i){var n=t.position(),s=i||this.bounds();return this.settings.axis==="horizontal"&&n.right>s.left-e&&n.left<s.right+r?!0:this.settings.axis==="vertical"&&n.bottom>s.top-e&&n.top<s.bottom+r}visible(){for(var t=this.bounds(),e=this.views.displayed(),r=e.length,i=[],n,s,o=0;o<r;o++)s=e[o],n=this.isVisible(s,0,0,t),n===!0&&i.push(s);return i}scrollBy(t,e,r){let i=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*i,e*i):(t&&(this.container.scrollLeft+=t*i),e&&(this.container.scrollTop+=e)),this.scrolled=!0}scrollTo(t,e,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,e):(this.container.scrollLeft=t,this.container.scrollTop=e),this.scrolled=!0}onScroll(){let t,e;this.settings.fullsize?(t=window.scrollY,e=window.scrollX):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:(this.emit(gt.MANAGERS.SCROLL,{top:t,left:e}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(gt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var t;return t=this.stage.bounds(),t}applyLayout(t){this.layout=t,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(t){this.viewSettings.layout=t,this.mapping=new pr(t.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(e){e&&e.setLayout(t)})}updateWritingMode(t){this.writingMode=t}updateAxis(t,e){!e&&t===this.settings.axis||(this.settings.axis=t,this.stage&&this.stage.axis(t),this.viewSettings.axis=t,this.mapping&&(this.mapping=new pr(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(t==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(t,e="auto"){let r=t==="paginated"||t==="auto";this.isPaginated=r,t==="scrolled-doc"||t==="scrolled-continuous"||t==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=t,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":e,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var t=[];return this.views&&this.views.forEach(function(e){const r=e&&e.contents;r&&t.push(r)}),t}direction(t="ltr"){this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout()}isRendered(){return this.rendered}}Ne(gr.prototype);const Co={easeInCubic:function(v){return Math.pow(v,3)}};class ai{constructor(t,e){this.settings=he({duration:80,minVelocity:.2,minDistance:10,easing:Co.easeInCubic},e||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(t)}setup(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(gt.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(gt.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(t){let e=t.contents;["touchstart","touchmove","touchend"].forEach(r=>{e.on(r,i=>this.triggerViewEvent(i,e))})}triggerViewEvent(t,e){this.emit(t.type,t,e)}onScroll(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(t){this.resizeCanceler=!0}onTouchStart(t){let{screenX:e,screenY:r}=t.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=e,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=e,this.endTouchY=r,this.endTime=this.now()}onTouchMove(t){let{screenX:e,screenY:r}=t.touches[0],i=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=e-this.endTouchX),this.endTouchX=e,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let e=this.wasSwiped();e!==0?this.snap(e):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let t=this.layout.pageWidth*this.layout.divisor,e=this.endTouchX-this.startTouchX,r=Math.abs(e),i=this.endTime-this.startTime,n=e/i,s=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=t)return 0;if(n>s)return-1;if(n<-s)return 1}needsSnap(){let t=this.scrollLeft,e=this.layout.pageWidth*this.layout.divisor;return t%e!==0}snap(t=0){let e=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,i=Math.round(e/r)*r;return t&&(i+=t*r),this.smoothScrollTo(i)}smoothScrollTo(t){const e=new Pt,r=this.scrollLeft,i=this.now(),n=this.settings.duration,s=this.settings.easing;this.snapping=!0;function o(){const h=this.now(),u=Math.min(1,(h-i)/n);if(s(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,e.resolve();return}u<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(r+(t-r)*u,0)):(this.scrollTo(t,0),this.snapping=!1,e.resolve())}return o.call(this),e.promise}scrollTo(t=0,e=0){this.fullsize?window.scroll(t,e):(this.scroller.scrollLeft=t,this.scroller.scrollTop=e)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}Ne(ai.prototype);var No=Jn();const To=Ze(No);class Io extends gr{constructor(t){super(t),this.name="continuous",this.settings=he(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),he(this.settings,t.settings||{}),t.settings.gap!="undefined"&&t.settings.gap===0&&(this.settings.gap=t.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(t,e){return gr.prototype.display.call(this,t,e).then((function(){return this.fill()}).bind(this))}fill(t){var e=t||new Pt;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(e):e.resolve()}),e.promise}moveTo(t){var e=0,r=0;this.isPaginated?(e=Math.floor(t.left/this.layout.delta)*this.layout.delta,e+this.settings.offsetDelta):(r=t.top,t.top+this.settings.offsetDelta),(e>0||r>0)&&this.scrollBy(e,r,!0)}afterResized(t){this.emit(gt.MANAGERS.RESIZE,t.section)}removeShownListeners(t){t.onDisplayed=function(){}}add(t){var e=this.createView(t);return this.views.append(e),e.on(gt.VIEWS.RESIZED,r=>{e.expanded=!0}),e.on(gt.VIEWS.AXIS,r=>{this.updateAxis(r)}),e.on(gt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),e.onDisplayed=this.afterDisplayed.bind(this),e.onResize=this.afterResized.bind(this),e.display(this.request)}append(t){var e=this.createView(t);return e.on(gt.VIEWS.RESIZED,r=>{e.expanded=!0}),e.on(gt.VIEWS.AXIS,r=>{this.updateAxis(r)}),e.on(gt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(e),e.onDisplayed=this.afterDisplayed.bind(this),e}prepend(t){var e=this.createView(t);return e.on(gt.VIEWS.RESIZED,r=>{this.counter(r),e.expanded=!0}),e.on(gt.VIEWS.AXIS,r=>{this.updateAxis(r)}),e.on(gt.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(e),e.onDisplayed=this.afterDisplayed.bind(this),e}counter(t){this.settings.axis==="vertical"?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}update(t){for(var e=this.bounds(),r=this.views.all(),i=r.length,n=typeof t<"u"?t:this.settings.offset||0,s,o,h=new Pt,u=[],d=0;d<i;d++)if(o=r[d],s=this.isVisible(o,n,n,e),s===!0)if(o.displayed)o.show();else{let p=o.display(this.request).then(function(y){y.show()},y=>{o.hide()});u.push(p)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return u.length?Promise.all(u).catch(p=>{h.reject(p)}):(h.resolve(),h.promise)}check(t,e){var r=new Pt,i=[],n=this.settings.axis==="horizontal",s=this.settings.offset||0;t&&n&&(s=t),e&&!n&&(s=e);var o=this._bounds;let h=n?this.scrollLeft:this.scrollTop,u=n?Math.floor(o.width):o.height,d=n?this.container.scrollWidth:this.container.scrollHeight,p=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",y=this.settings.rtlScrollType,_=this.settings.direction==="rtl";this.settings.fullsize?(n&&_&&y==="negative"||!n&&_&&y==="default")&&(h=h*-1):(_&&y==="default"&&p==="horizontal"&&(h=d-u-h),_&&y==="negative"&&p==="horizontal"&&(h=h*-1));let O=()=>{let C=this.views.first(),z=C&&C.section.prev();z&&i.push(this.prepend(z))},x=()=>{let C=this.views.last(),z=C&&C.section.next();z&&i.push(this.append(z))},c=h+u+s,g=h-s;c>=d&&x(),g<0&&O();let m=i.map(C=>C.display(this.request));return i.length?Promise.all(m).then(()=>this.check()).then(()=>this.update(s),C=>C):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var t=new Pt,e=this.views.displayed(),r=e[0],i=e[e.length-1],n=this.views.indexOf(r),s=this.views.indexOf(i),o=this.views.slice(0,n),h=this.views.slice(s+1),u=0;u<o.length-1;u++)this.erase(o[u],o);for(var d=1;d<h.length;d++)this.erase(h[d]);return t.resolve(),t.promise}erase(t,e){var r,i;this.settings.fullsize?(r=window.scrollY,i=window.scrollX):(r=this.container.scrollTop,i=this.container.scrollLeft);var n=t.bounds();this.views.remove(t),e&&(this.settings.axis==="vertical"?this.scrollTo(0,r-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(n.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(n.width),0,!0))}addEventListeners(t){window.addEventListener("unload",(function(e){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new ai(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var t;this.tick=hi;let e=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(t=window,this.scrollTop=window.scrollY*e,this.scrollLeft=window.scrollX*e):(t=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll),this._scrolled=To(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var t;this.settings.fullsize?t=window:t=this.container,t.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let t,e,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(t=window.scrollY*r,e=window.scrollX*r):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(e-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=e,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(gt.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(gt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(t,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-t,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(t){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(t,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new ai(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class gi{constructor(t,e){this.settings=he(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),he(this.settings,e),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=t,this.hooks={},this.hooks.display=new Se(this),this.hooks.serialize=new Se(this),this.hooks.content=new Se(this),this.hooks.unloaded=new Se(this),this.hooks.layout=new Se(this),this.hooks.render=new Se(this),this.hooks.show=new Se(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new eo(this),this.annotations=new no(this),this.epubcfi=new Mt,this.q=new di(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Pt,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(t){this.manager=t}requireManager(t){var e;return typeof t=="string"&&t==="default"?e=gr:typeof t=="string"&&t==="continuous"?e=Io:e=t,e}requireView(t){var e;return typeof t=="string"&&t==="iframe"?e=Yn:e=t,e}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(gt.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(gt.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(gt.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(gt.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(gt.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(gt.RENDITION.STARTED),this.starting.resolve()}attachTo(t){return this.q.enqueue((function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(gt.RENDITION.ATTACHED)}).bind(this))}display(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t)}_display(t){if(this.book){this.epubcfi.isCfiString(t);var e=new Pt,r=e.promise,i;return this.displaying=e,this.book.locations.length()&&Dn(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),i=this.book.spine.get(t),i?(this.manager.display(i,t).then(()=>{e.resolve(i),this.displaying=void 0,this.emit(gt.RENDITION.DISPLAYED,i),this.reportLocation()},n=>{this.emit(gt.RENDITION.DISPLAY_ERROR,n)}),r):(e.reject(new Error("No Section Found")),r)}}afterDisplayed(t){t.on(gt.VIEWS.MARK_CLICKED,(e,r)=>this.triggerMarkEvent(e,r,t.contents)),this.hooks.render.trigger(t,this).then(()=>{t.contents?this.hooks.content.trigger(t.contents,this).then(()=>{this.emit(gt.RENDITION.RENDERED,t.section,t)}):this.emit(gt.RENDITION.RENDERED,t.section,t)})}afterRemoved(t){this.hooks.unloaded.trigger(t,this).then(()=>{this.emit(gt.RENDITION.REMOVED,t.section,t)})}onResized(t,e){this.emit(gt.RENDITION.RESIZED,{width:t.width,height:t.height},e),this.location&&this.location.start&&this.display(e||this.location.start.cfi)}onOrientationChange(t){this.emit(gt.RENDITION.ORIENTATION_CHANGE,t)}moveTo(t){this.manager.moveTo(t)}resize(t,e,r){t&&(this.settings.width=t),e&&(this.settings.height=e),this.manager.resize(t,e,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(t){var e,r=this.settings.layout||t.layout||"reflowable",i=this.settings.spread||t.spread||"auto",n=this.settings.orientation||t.orientation||"auto",s=this.settings.flow||t.flow||"auto",o=t.viewport||"",h=this.settings.minSpreadWidth||t.minSpreadWidth||800,u=this.settings.direction||t.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),e={layout:r,spread:i,orientation:n,flow:s,viewport:o,minSpreadWidth:h,direction:u},e}flow(t){var e=t;(t==="scrolled"||t==="scrolled-doc"||t==="scrolled-continuous")&&(e="scrolled"),(t==="auto"||t==="paginated")&&(e="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(e),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(e),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(t){return t&&(this._layout=new Gn(t),this._layout.spread(t.spread,this.settings.minSpreadWidth),this._layout.on(gt.LAYOUT.UPDATED,(e,r)=>{this.emit(gt.RENDITION.LAYOUT,e,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(t,e){this.settings.spread=t,e&&(this.settings.minSpreadWidth=e),this._layout&&this._layout.spread(t,e),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var t=this.manager.currentLocation();if(t&&t.then&&typeof t.then=="function")t.then((function(e){let r=this.located(e);!r||!r.start||!r.end||(this.location=r,this.emit(gt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(gt.RENDITION.RELOCATED,this.location))}).bind(this));else if(t){let e=this.located(t);if(!e||!e.start||!e.end)return;this.location=e,this.emit(gt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(gt.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var t=this.manager.currentLocation();if(t&&t.then&&typeof t.then=="function")t.then((function(e){return this.located(e)}).bind(this));else if(t)return this.located(t)}located(t){if(!t.length)return{};let e=t[0],r=t[t.length-1],i={start:{index:e.index,href:e.href,cfi:e.mapping.start,displayed:{page:e.pages[0]||1,total:e.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},n=this.book.locations.locationFromCfi(e.mapping.start),s=this.book.locations.locationFromCfi(r.mapping.end);n!=null&&(i.start.location=n,i.start.percentage=this.book.locations.percentageFromLocation(n)),s!=null&&(i.end.location=s,i.end.percentage=this.book.locations.percentageFromLocation(s));let o=this.book.pageList.pageFromCfi(e.mapping.start),h=this.book.pageList.pageFromCfi(r.mapping.end);return o!=-1&&(i.start.page=o),h!=-1&&(i.end.page=h),r.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),e.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(t){ar.forEach(e=>{t.on(e,r=>this.triggerViewEvent(r,t))}),t.on(gt.CONTENTS.SELECTED,e=>this.triggerSelectedEvent(e,t))}triggerViewEvent(t,e){this.emit(t.type,t,e)}triggerSelectedEvent(t,e){this.emit(gt.RENDITION.SELECTED,t,e)}triggerMarkEvent(t,e,r){this.emit(gt.RENDITION.MARK_CLICKED,t,e,r)}getRange(t,e){var r=new Mt(t),i=this.manager.visible().filter(function(n){if(r.spinePos===n.index)return!0});if(i.length)return i[0].contents.range(r,e)}adjustImages(t){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let e=t.window.getComputedStyle(t.content,null),r=(t.content.offsetHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)))*.95,i=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,s){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(t){t&&t.on(gt.CONTENTS.LINK_CLICKED,e=>{let r=this.book.path.relative(e);this.display(r)})}injectStylesheet(t,e){let r=t.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(r)}injectScript(t,e){let r=t.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",t.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(t,e){let r=this.book.packaging.metadata.identifier,i=t.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),r&&i.setAttribute("content",r),t.getElementsByTagName("head")[0].appendChild(i)}}Ne(gi.prototype);var Cn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Nn;function Ro(){return Nn||(Nn=1,(function(v,t){(function(e){v.exports=e()})(function(){return(function e(r,i,n){function s(u,d){if(!i[u]){if(!r[u]){var p=typeof Le=="function"&&Le;if(!d&&p)return p(u,!0);if(o)return o(u,!0);var y=new Error("Cannot find module '"+u+"'");throw y.code="MODULE_NOT_FOUND",y}var _=i[u]={exports:{}};r[u][0].call(_.exports,function(O){var x=r[u][1][O];return s(x||O)},_,_.exports,e,r,i,n)}return i[u].exports}for(var o=typeof Le=="function"&&Le,h=0;h<n.length;h++)s(n[h]);return s})({1:[function(e,r,i){var n=e("./utils"),s=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(h){for(var u=[],d,p,y,_,O,x,c,g=0,m=h.length,C=m,z=n.getTypeOf(h)!=="string";g<h.length;)C=m-g,z?(d=h[g++],p=g<m?h[g++]:0,y=g<m?h[g++]:0):(d=h.charCodeAt(g++),p=g<m?h.charCodeAt(g++):0,y=g<m?h.charCodeAt(g++):0),_=d>>2,O=(d&3)<<4|p>>4,x=C>1?(p&15)<<2|y>>6:64,c=C>2?y&63:64,u.push(o.charAt(_)+o.charAt(O)+o.charAt(x)+o.charAt(c));return u.join("")},i.decode=function(h){var u,d,p,y,_,O,x,c=0,g=0,m="data:";if(h.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");h=h.replace(/[^A-Za-z0-9+/=]/g,"");var C=h.length*3/4;if(h.charAt(h.length-1)===o.charAt(64)&&C--,h.charAt(h.length-2)===o.charAt(64)&&C--,C%1!==0)throw new Error("Invalid base64 input, bad content length.");var z;for(s.uint8array?z=new Uint8Array(C|0):z=new Array(C|0);c<h.length;)y=o.indexOf(h.charAt(c++)),_=o.indexOf(h.charAt(c++)),O=o.indexOf(h.charAt(c++)),x=o.indexOf(h.charAt(c++)),u=y<<2|_>>4,d=(_&15)<<4|O>>2,p=(O&3)<<6|x,z[g++]=u,O!==64&&(z[g++]=d),x!==64&&(z[g++]=p);return z}},{"./support":30,"./utils":32}],2:[function(e,r,i){var n=e("./external"),s=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),h=e("./stream/DataLengthProbe");function u(d,p,y,_,O){this.compressedSize=d,this.uncompressedSize=p,this.crc32=y,this.compression=_,this.compressedContent=O}u.prototype={getContentWorker:function(){var d=new s(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,p,y){return d.pipe(new o).pipe(new h("uncompressedSize")).pipe(p.compressWorker(y)).pipe(new h("compressedSize")).withStreamInfo("compression",p)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var n=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var n=e("./utils");function s(){for(var d,p=[],y=0;y<256;y++){d=y;for(var _=0;_<8;_++)d=d&1?3988292384^d>>>1:d>>>1;p[y]=d}return p}var o=s();function h(d,p,y,_){var O=o,x=_+y;d=d^-1;for(var c=_;c<x;c++)d=d>>>8^O[(d^p[c])&255];return d^-1}function u(d,p,y,_){var O=o,x=_+y;d=d^-1;for(var c=_;c<x;c++)d=d>>>8^O[(d^p.charCodeAt(c))&255];return d^-1}r.exports=function(d,p){if(typeof d>"u"||!d.length)return 0;var y=n.getTypeOf(d)!=="string";return y?h(p|0,d,d.length,0):u(p|0,d,d.length,0)}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var n=null;typeof Promise<"u"?n=Promise:n=e("lie"),r.exports={Promise:n}},{lie:37}],7:[function(e,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=e("pako"),o=e("./utils"),h=e("./stream/GenericWorker"),u=n?"uint8array":"array";i.magic="\b\0";function d(p,y){h.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=y,this.meta={}}o.inherits(d,h),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,p.data),!1)},d.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(y){p.push({data:y,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){var n=e("../utils"),s=e("../stream/GenericWorker"),o=e("../utf8"),h=e("../crc32"),u=e("../signature"),d=function(g,m){var C="",z;for(z=0;z<m;z++)C+=String.fromCharCode(g&255),g=g>>>8;return C},p=function(g,m){var C=g;return g||(C=m?16893:33204),(C&65535)<<16},y=function(g){return(g||0)&63},_=function(g,m,C,z,b,L){var T=g.file,D=g.compression,N=L!==o.utf8encode,A=n.transformTo("string",L(T.name)),W=n.transformTo("string",o.utf8encode(T.name)),X=T.comment,$=n.transformTo("string",L(X)),et=n.transformTo("string",o.utf8encode(X)),at=W.length!==T.name.length,pt=et.length!==X.length,tt,ot,ut="",Ct="",ct="",mt=T.dir,Rt=T.date,xt={crc32:0,compressedSize:0,uncompressedSize:0};(!m||C)&&(xt.crc32=g.crc32,xt.compressedSize=g.compressedSize,xt.uncompressedSize=g.uncompressedSize);var At=0;m&&(At|=8),!N&&(at||pt)&&(At|=2048);var qt=0,Bt=0;mt&&(qt|=16),b==="UNIX"?(Bt=798,qt|=p(T.unixPermissions,mt)):(Bt=20,qt|=y(T.dosPermissions)),tt=Rt.getUTCHours(),tt=tt<<6,tt=tt|Rt.getUTCMinutes(),tt=tt<<5,tt=tt|Rt.getUTCSeconds()/2,ot=Rt.getUTCFullYear()-1980,ot=ot<<4,ot=ot|Rt.getUTCMonth()+1,ot=ot<<5,ot=ot|Rt.getUTCDate(),at&&(Ct=d(1,1)+d(h(A),4)+W,ut+="up"+d(Ct.length,2)+Ct),pt&&(ct=d(1,1)+d(h($),4)+et,ut+="uc"+d(ct.length,2)+ct);var Nt="";Nt+=`
\0`,Nt+=d(At,2),Nt+=D.magic,Nt+=d(tt,2),Nt+=d(ot,2),Nt+=d(xt.crc32,4),Nt+=d(xt.compressedSize,4),Nt+=d(xt.uncompressedSize,4),Nt+=d(A.length,2),Nt+=d(ut.length,2);var jt=u.LOCAL_FILE_HEADER+Nt+A+ut,Ft=u.CENTRAL_FILE_HEADER+d(Bt,2)+Nt+d($.length,2)+"\0\0\0\0"+d(qt,4)+d(z,4)+A+ut+$;return{fileRecord:jt,dirRecord:Ft}},O=function(g,m,C,z,b){var L="",T=n.transformTo("string",b(z));return L=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(g,2)+d(g,2)+d(m,4)+d(C,4)+d(T.length,2)+T,L},x=function(g){var m="";return m=u.DATA_DESCRIPTOR+d(g.crc32,4)+d(g.compressedSize,4)+d(g.uncompressedSize,4),m};function c(g,m,C,z){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=C,this.encodeFileName=z,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(c,s),c.prototype.push=function(g){var m=g.meta.percent||0,C=this.entriesCount,z=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,s.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:C?(m+100*(C-z-1))/C:100}}))},c.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var m=this.streamFiles&&!g.file.dir;if(m){var C=_(g,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:C.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(g){this.accumulate=!1;var m=this.streamFiles&&!g.file.dir,C=_(g,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(C.dirRecord),m)this.push({data:x(g),meta:{percent:100}});else for(this.push({data:C.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var g=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var C=this.bytesWritten-g,z=O(this.dirRecords.length,C,g,this.zipComment,this.encodeFileName);this.push({data:z,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(g){this._sources.push(g);var m=this;return g.on("data",function(C){m.processChunk(C)}),g.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),g.on("error",function(C){m.error(C)}),this},c.prototype.resume=function(){if(!s.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},c.prototype.error=function(g){var m=this._sources;if(!s.prototype.error.call(this,g))return!1;for(var C=0;C<m.length;C++)try{m[C].error(g)}catch{}return!0},c.prototype.lock=function(){s.prototype.lock.call(this);for(var g=this._sources,m=0;m<g.length;m++)g[m].lock()},r.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var n=e("../compressions"),s=e("./ZipFileWorker"),o=function(h,u){var d=h||u,p=n[d];if(!p)throw new Error(d+" is not a valid compression method !");return p};i.generateWorker=function(h,u,d){var p=new s(u.streamFiles,d,u.platform,u.encodeFileName),y=0;try{h.forEach(function(_,O){y++;var x=o(O.options.compression,u.compression),c=O.options.compressionOptions||u.compressionOptions||{},g=O.dir,m=O.date;O._compressWorker(x,c).withStreamInfo("file",{name:_,dir:g,date:m,comment:O.comment||"",unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions}).pipe(p)}),p.entriesCount=y}catch(_){p.error(_)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new n;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}n.prototype=e("./object"),n.prototype.loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(s,o){return new n().loadAsync(s,o)},n.external=e("./external"),r.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var n=e("./utils"),s=e("./external"),o=e("./utf8"),h=e("./zipEntries"),u=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(y){return new s.Promise(function(_,O){var x=y.decompressed.getContentWorker().pipe(new u);x.on("error",function(c){O(c)}).on("end",function(){x.streamInfo.crc32!==y.decompressed.crc32?O(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}r.exports=function(y,_){var O=this;return _=n.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(y)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",y,!0,_.optimizedBinaryString,_.base64).then(function(x){var c=new h(_);return c.load(x),c}).then(function(x){var c=[s.Promise.resolve(x)],g=x.files;if(_.checkCRC32)for(var m=0;m<g.length;m++)c.push(p(g[m]));return s.Promise.all(c)}).then(function(x){for(var c=x.shift(),g=c.files,m=0;m<g.length;m++){var C=g[m],z=C.fileNameStr,b=n.resolve(C.fileNameStr);O.file(b,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:_.createFolders}),C.dir||(O.file(b).unsafeOriginalName=z)}return c.zipComment.length&&(O.comment=c.zipComment),O})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var n=e("../utils"),s=e("../stream/GenericWorker");function o(h,u){s.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(u)}n.inherits(o,s),o.prototype._bindStream=function(h){var u=this;this._stream=h,h.pause(),h.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return s.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return s.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var n=e("readable-stream").Readable,s=e("../utils");s.inherits(o,n);function o(h,u,d){n.call(this,u),this._helper=h;var p=this;h.on("data",function(y,_){p.push(y)||p._helper.pause(),d&&d(_)}).on("error",function(y){p.emit("error",y)}).on("end",function(){p.push(null)})}o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,s);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,s)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var s=new Buffer(n);return s.fill(0),s},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,r,i){var n=e("./utf8"),s=e("./utils"),o=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),u=e("./defaults"),d=e("./compressedObject"),p=e("./zipObject"),y=e("./generate"),_=e("./nodejsUtils"),O=e("./nodejs/NodejsStreamInputAdapter"),x=function(b,L,T){var D=s.getTypeOf(L),N,A=s.extend(T||{},u);A.date=A.date||new Date,A.compression!==null&&(A.compression=A.compression.toUpperCase()),typeof A.unixPermissions=="string"&&(A.unixPermissions=parseInt(A.unixPermissions,8)),A.unixPermissions&&A.unixPermissions&16384&&(A.dir=!0),A.dosPermissions&&A.dosPermissions&16&&(A.dir=!0),A.dir&&(b=g(b)),A.createFolders&&(N=c(b))&&m.call(this,N,!0);var W=D==="string"&&A.binary===!1&&A.base64===!1;(!T||typeof T.binary>"u")&&(A.binary=!W);var X=L instanceof d&&L.uncompressedSize===0;(X||A.dir||!L||L.length===0)&&(A.base64=!1,A.binary=!0,L="",A.compression="STORE",D="string");var $=null;L instanceof d||L instanceof o?$=L:_.isNode&&_.isStream(L)?$=new O(b,L):$=s.prepareContent(b,L,A.binary,A.optimizedBinaryString,A.base64);var et=new p(b,$,A);this.files[b]=et},c=function(b){b.slice(-1)==="/"&&(b=b.substring(0,b.length-1));var L=b.lastIndexOf("/");return L>0?b.substring(0,L):""},g=function(b){return b.slice(-1)!=="/"&&(b+="/"),b},m=function(b,L){return L=typeof L<"u"?L:u.createFolders,b=g(b),this.files[b]||x.call(this,b,null,{dir:!0,createFolders:L}),this.files[b]};function C(b){return Object.prototype.toString.call(b)==="[object RegExp]"}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(b){var L,T,D;for(L in this.files)D=this.files[L],T=L.slice(this.root.length,L.length),T&&L.slice(0,this.root.length)===this.root&&b(T,D)},filter:function(b){var L=[];return this.forEach(function(T,D){b(T,D)&&L.push(D)}),L},file:function(b,L,T){if(arguments.length===1)if(C(b)){var D=b;return this.filter(function(A,W){return!W.dir&&D.test(A)})}else{var N=this.files[this.root+b];return N&&!N.dir?N:null}else b=this.root+b,x.call(this,b,L,T);return this},folder:function(b){if(!b)return this;if(C(b))return this.filter(function(N,A){return A.dir&&b.test(N)});var L=this.root+b,T=m.call(this,L),D=this.clone();return D.root=T.name,D},remove:function(b){b=this.root+b;var L=this.files[b];if(L||(b.slice(-1)!=="/"&&(b+="/"),L=this.files[b]),L&&!L.dir)delete this.files[b];else for(var T=this.filter(function(N,A){return A.name.slice(0,b.length)===b}),D=0;D<T.length;D++)delete this.files[T[D].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(b){var L,T={};try{if(T=s.extend(b||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),T.type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");s.checkSupport(T.type),(T.platform==="darwin"||T.platform==="freebsd"||T.platform==="linux"||T.platform==="sunos")&&(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var D=T.comment||this.comment||"";L=y.generateWorker(this,T,D)}catch(N){L=new o("error"),L.error(N)}return new h(L,T.type||"string",T.mimeType)},generateAsync:function(b,L){return this.generateInternalStream(b).accumulate(L)},generateNodeStream:function(b,L){return b=b||{},b.type||(b.type="nodebuffer"),this.generateInternalStream(b).toNodejsStream(L)}};r.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var n=e("./DataReader"),s=e("../utils");function o(h){n.call(this,h);for(var u=0;u<this.data.length;u++)h[u]=h[u]&255}s.inherits(o,n),o.prototype.byteAt=function(h){return this.data[this.zero+h]},o.prototype.lastIndexOfSignature=function(h){for(var u=h.charCodeAt(0),d=h.charCodeAt(1),p=h.charCodeAt(2),y=h.charCodeAt(3),_=this.length-4;_>=0;--_)if(this.data[_]===u&&this.data[_+1]===d&&this.data[_+2]===p&&this.data[_+3]===y)return _-this.zero;return-1},o.prototype.readAndCheckSignature=function(h){var u=h.charCodeAt(0),d=h.charCodeAt(1),p=h.charCodeAt(2),y=h.charCodeAt(3),_=this.readData(4);return u===_[0]&&d===_[1]&&p===_[2]&&y===_[3]},o.prototype.readData=function(h){if(this.checkOffset(h),h===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,u},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var n=e("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var h=0,u;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)h=(h<<8)+this.byteAt(u);return this.index+=o,h},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},r.exports=s},{"../utils":32}],19:[function(e,r,i){var n=e("./Uint8ArrayReader"),s=e("../utils");function o(h){n.call(this,h)}s.inherits(o,n),o.prototype.readData=function(h){this.checkOffset(h);var u=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,u},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var n=e("./DataReader"),s=e("../utils");function o(h){n.call(this,h)}s.inherits(o,n),o.prototype.byteAt=function(h){return this.data.charCodeAt(this.zero+h)},o.prototype.lastIndexOfSignature=function(h){return this.data.lastIndexOf(h)-this.zero},o.prototype.readAndCheckSignature=function(h){var u=this.readData(4);return h===u},o.prototype.readData=function(h){this.checkOffset(h);var u=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,u},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var n=e("./ArrayReader"),s=e("../utils");function o(h){n.call(this,h)}s.inherits(o,n),o.prototype.readData=function(h){if(this.checkOffset(h),h===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+h);return this.index+=h,u},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var n=e("../utils"),s=e("../support"),o=e("./ArrayReader"),h=e("./StringReader"),u=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");r.exports=function(p){var y=n.getTypeOf(p);return n.checkSupport(y),y==="string"&&!s.uint8array?new h(p):y==="nodebuffer"?new u(p):s.uint8array?new d(n.transformTo("uint8array",p)):new o(n.transformTo("array",p))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var n=e("./GenericWorker"),s=e("../utils");function o(h){n.call(this,"ConvertWorker to "+h),this.destType=h}s.inherits(o,n),o.prototype.processChunk=function(h){this.push({data:s.transformTo(this.destType,h.data),meta:h.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var n=e("./GenericWorker"),s=e("../crc32"),o=e("../utils");function h(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(h,n),h.prototype.processChunk=function(u){this.streamInfo.crc32=s(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=h},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var n=e("../utils"),s=e("./GenericWorker");function o(h){s.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}n.inherits(o,s),o.prototype.processChunk=function(h){if(h){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+h.data.length}s.prototype.processChunk.call(this,h)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var n=e("../utils"),s=e("./GenericWorker"),o=16*1024;function h(u){s.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(p){d.dataIsReady=!0,d.data=p,d.max=p&&p.length||0,d.type=n.getTypeOf(p),d.isPaused||d._tickAndRepeat()},function(p){d.error(p)})}n.inherits(h,s),h.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},h.prototype.resume=function(){return s.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},h.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},h.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=o,d=null,p=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,p);break;case"uint8array":d=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":d=this.data.slice(this.index,p);break}return this.index=p,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=h},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function n(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return this.isFinished?!1:(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var h=0;h<this._listeners[s].length;h++)this._listeners[s][h].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(h){o.processChunk(h)}),s.on("end",function(){o.end()}),s.on("error",function(h){o.error(h)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var s=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=n},{}],29:[function(e,r,i){var n=e("../utils"),s=e("./ConvertWorker"),o=e("./GenericWorker"),h=e("../base64"),u=e("../support"),d=e("../external"),p=null;if(u.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(c,g,m){switch(c){case"blob":return n.newBlob(n.transformTo("arraybuffer",g),m);case"base64":return h.encode(g);default:return n.transformTo(c,g)}}function _(c,g){var m,C=0,z=null,b=0;for(m=0;m<g.length;m++)b+=g[m].length;switch(c){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(z=new Uint8Array(b),m=0;m<g.length;m++)z.set(g[m],C),C+=g[m].length;return z;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+c+"'")}}function O(c,g){return new d.Promise(function(m,C){var z=[],b=c._internalType,L=c._outputType,T=c._mimeType;c.on("data",function(D,N){z.push(D),g&&g(N)}).on("error",function(D){z=[],C(D)}).on("end",function(){try{var D=y(L,_(b,z),T);m(D)}catch(N){C(N)}z=[]}).resume()})}function x(c,g,m){var C=g;switch(g){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string";break}try{this._internalType=C,this._outputType=g,this._mimeType=m,n.checkSupport(C),this._worker=c.pipe(new s(C)),c.lock()}catch(z){this._worker=new o("error"),this._worker.error(z)}}x.prototype={accumulate:function(c){return O(this,c)},on:function(c,g){var m=this;return c==="data"?this._worker.on(c,function(C){g.call(m,C.data,C.meta)}):this._worker.on(c,function(){n.delay(g,arguments,m)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(c){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},c)}},r.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var s=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new s;o.append(n),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var n=e("./utils"),s=e("./support"),o=e("./nodejsUtils"),h=e("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;u[254]=u[254]=1;var p=function(c){var g,m,C,z,b,L=c.length,T=0;for(z=0;z<L;z++)m=c.charCodeAt(z),(m&64512)===55296&&z+1<L&&(C=c.charCodeAt(z+1),(C&64512)===56320&&(m=65536+(m-55296<<10)+(C-56320),z++)),T+=m<128?1:m<2048?2:m<65536?3:4;for(s.uint8array?g=new Uint8Array(T):g=new Array(T),b=0,z=0;b<T;z++)m=c.charCodeAt(z),(m&64512)===55296&&z+1<L&&(C=c.charCodeAt(z+1),(C&64512)===56320&&(m=65536+(m-55296<<10)+(C-56320),z++)),m<128?g[b++]=m:m<2048?(g[b++]=192|m>>>6,g[b++]=128|m&63):m<65536?(g[b++]=224|m>>>12,g[b++]=128|m>>>6&63,g[b++]=128|m&63):(g[b++]=240|m>>>18,g[b++]=128|m>>>12&63,g[b++]=128|m>>>6&63,g[b++]=128|m&63);return g},y=function(c,g){var m;for(g=g||c.length,g>c.length&&(g=c.length),m=g-1;m>=0&&(c[m]&192)===128;)m--;return m<0||m===0?g:m+u[c[m]]>g?m:g},_=function(c){var g,m,C,z,b=c.length,L=new Array(b*2);for(m=0,g=0;g<b;){if(C=c[g++],C<128){L[m++]=C;continue}if(z=u[C],z>4){L[m++]=65533,g+=z-1;continue}for(C&=z===2?31:z===3?15:7;z>1&&g<b;)C=C<<6|c[g++]&63,z--;if(z>1){L[m++]=65533;continue}C<65536?L[m++]=C:(C-=65536,L[m++]=55296|C>>10&1023,L[m++]=56320|C&1023)}return L.length!==m&&(L.subarray?L=L.subarray(0,m):L.length=m),n.applyFromCharCode(L)};i.utf8encode=function(c){return s.nodebuffer?o.newBufferFrom(c,"utf-8"):p(c)},i.utf8decode=function(c){return s.nodebuffer?n.transformTo("nodebuffer",c).toString("utf-8"):(c=n.transformTo(s.uint8array?"uint8array":"array",c),_(c))};function O(){h.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(O,h),O.prototype.processChunk=function(c){var g=n.transformTo(s.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var m=g;g=new Uint8Array(m.length+this.leftOver.length),g.set(this.leftOver,0),g.set(m,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var C=y(g),z=g;C!==g.length&&(s.uint8array?(z=g.subarray(0,C),this.leftOver=g.subarray(C,g.length)):(z=g.slice(0,C),this.leftOver=g.slice(C,g.length))),this.push({data:i.utf8decode(z),meta:c.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=O;function x(){h.call(this,"utf-8 encode")}n.inherits(x,h),x.prototype.processChunk=function(c){this.push({data:i.utf8encode(c.data),meta:c.meta})},i.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var n=e("./support"),s=e("./base64"),o=e("./nodejsUtils"),h=e("./external");e("setimmediate");function u(c){var g=null;return n.uint8array?g=new Uint8Array(c.length):g=new Array(c.length),p(c,g)}i.newBlob=function(c,g){i.checkSupport("blob");try{return new Blob([c],{type:g})}catch{try{var m=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,C=new m;return C.append(c),C.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};function d(c){return c}function p(c,g){for(var m=0;m<c.length;++m)g[m]=c.charCodeAt(m)&255;return g}var y={stringifyByChunk:function(c,g,m){var C=[],z=0,b=c.length;if(b<=m)return String.fromCharCode.apply(null,c);for(;z<b;)g==="array"||g==="nodebuffer"?C.push(String.fromCharCode.apply(null,c.slice(z,Math.min(z+m,b)))):C.push(String.fromCharCode.apply(null,c.subarray(z,Math.min(z+m,b)))),z+=m;return C.join("")},stringifyByChar:function(c){for(var g="",m=0;m<c.length;m++)g+=String.fromCharCode(c[m]);return g},applyCanBeUsed:{uint8array:(function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function _(c){var g=65536,m=i.getTypeOf(c),C=!0;if(m==="uint8array"?C=y.applyCanBeUsed.uint8array:m==="nodebuffer"&&(C=y.applyCanBeUsed.nodebuffer),C)for(;g>1;)try{return y.stringifyByChunk(c,m,g)}catch{g=Math.floor(g/2)}return y.stringifyByChar(c)}i.applyFromCharCode=_;function O(c,g){for(var m=0;m<c.length;m++)g[m]=c[m];return g}var x={};x.string={string:d,array:function(c){return p(c,new Array(c.length))},arraybuffer:function(c){return x.string.uint8array(c).buffer},uint8array:function(c){return p(c,new Uint8Array(c.length))},nodebuffer:function(c){return p(c,o.allocBuffer(c.length))}},x.array={string:_,array:d,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(c)}},x.arraybuffer={string:function(c){return _(new Uint8Array(c))},array:function(c){return O(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:d,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(new Uint8Array(c))}},x.uint8array={string:_,array:function(c){return O(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:d,nodebuffer:function(c){return o.newBufferFrom(c)}},x.nodebuffer={string:_,array:function(c){return O(c,new Array(c.length))},arraybuffer:function(c){return x.nodebuffer.uint8array(c).buffer},uint8array:function(c){return O(c,new Uint8Array(c.length))},nodebuffer:d},i.transformTo=function(c,g){if(g||(g=""),!c)return g;i.checkSupport(c);var m=i.getTypeOf(g),C=x[m][c](g);return C},i.resolve=function(c){for(var g=c.split("/"),m=[],C=0;C<g.length;C++){var z=g[C];z==="."||z===""&&C!==0&&C!==g.length-1||(z===".."?m.pop():m.push(z))}return m.join("/")},i.getTypeOf=function(c){if(typeof c=="string")return"string";if(Object.prototype.toString.call(c)==="[object Array]")return"array";if(n.nodebuffer&&o.isBuffer(c))return"nodebuffer";if(n.uint8array&&c instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&c instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(c){var g=n[c.toLowerCase()];if(!g)throw new Error(c+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(c){var g="",m,C;for(C=0;C<(c||"").length;C++)m=c.charCodeAt(C),g+="\\x"+(m<16?"0":"")+m.toString(16).toUpperCase();return g},i.delay=function(c,g,m){setImmediate(function(){c.apply(m||null,g||[])})},i.inherits=function(c,g){var m=function(){};m.prototype=g.prototype,c.prototype=new m},i.extend=function(){var c={},g,m;for(g=0;g<arguments.length;g++)for(m in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],m)&&typeof c[m]>"u"&&(c[m]=arguments[g][m]);return c},i.prepareContent=function(c,g,m,C,z){var b=h.Promise.resolve(g).then(function(L){var T=n.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1);return T&&typeof FileReader<"u"?new h.Promise(function(D,N){var A=new FileReader;A.onload=function(W){D(W.target.result)},A.onerror=function(W){N(W.target.error)},A.readAsArrayBuffer(L)}):L});return b.then(function(L){var T=i.getTypeOf(L);return T?(T==="arraybuffer"?L=i.transformTo("uint8array",L):T==="string"&&(z?L=s.decode(L):m&&C!==!0&&(L=u(L))),L):h.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var n=e("./reader/readerFor"),s=e("./utils"),o=e("./signature"),h=e("./zipEntry"),u=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(y)+", expected "+s.pretty(p)+")")}},isSignature:function(p,y){var _=this.reader.index;this.reader.setIndex(p);var O=this.reader.readString(4),x=O===y;return this.reader.setIndex(_),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),y=u.uint8array?"uint8array":"array",_=s.transformTo(y,p);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p=this.zip64EndOfCentralSize-44,y=0,_,O,x;y<p;)_=this.reader.readInt(2),O=this.reader.readInt(4),x=this.reader.readData(O),this.zip64ExtensibleData[_]={id:_,length:O,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,y;for(p=0;p<this.files.length;p++)y=this.files[p],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)p=new h({zip64:this.zip64},this.loadOptions),p.readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0){var y=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw y?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(p);var _=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),p<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var O=this.centralDirOffset+this.centralDirSize;this.zip64&&(O+=20,O+=12+this.zip64EndOfCentralSize);var x=_-O;if(x>0)this.isSignature(_,o.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=n(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var n=e("./reader/readerFor"),s=e("./utils"),o=e("./compressedObject"),h=e("./crc32"),u=e("./utf8"),d=e("./compressions"),p=e("./support"),y=0,_=3,O=function(c){for(var g in d)if(Object.prototype.hasOwnProperty.call(d,g)&&d[g].magic===c)return d[g];return null};function x(c,g){this.options=c,this.loadOptions=g}x.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(c){var g,m;if(c.skip(22),this.fileNameLength=c.readInt(2),m=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=O(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var g=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(g),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),c===y&&(this.dosPermissions=this.externalFileAttributes&63),c===_&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var g=c.index+this.extraFieldsLength,m,C,z;for(this.extraFields||(this.extraFields={});c.index+4<g;)m=c.readInt(2),C=c.readInt(2),z=c.readData(C),this.extraFields[m]={id:m,length:C,value:z};c.setIndex(g)},handleUTF8:function(){var c=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var m=s.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var C=this.findExtraFieldUnicodeComment();if(C!==null)this.fileCommentStr=C;else{var z=s.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(z)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var g=n(c.value);return g.readInt(1)!==1||h(this.fileName)!==g.readInt(4)?null:u.utf8decode(g.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var g=n(c.value);return g.readInt(1)!==1||h(this.fileComment)!==g.readInt(4)?null:u.utf8decode(g.readData(c.length-5))}return null}},r.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){var n=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),o=e("./utf8"),h=e("./compressedObject"),u=e("./stream/GenericWorker"),d=function(O,x,c){this.name=O,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=x,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};d.prototype={internalStream:function(O){var x=null,c="string";try{if(!O)throw new Error("No output type specified.");c=O.toLowerCase();var g=c==="string"||c==="text";(c==="binarystring"||c==="text")&&(c="string"),x=this._decompressWorker();var m=!this._dataBinary;m&&!g&&(x=x.pipe(new o.Utf8EncodeWorker)),!m&&g&&(x=x.pipe(new o.Utf8DecodeWorker))}catch(C){x=new u("error"),x.error(C)}return new n(x,c,"")},async:function(O,x){return this.internalStream(O).accumulate(x)},nodeStream:function(O,x){return this.internalStream(O||"nodebuffer").toNodejsStream(x)},_compressWorker:function(O,x){if(this._data instanceof h&&this._data.compression.magic===O.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new o.Utf8EncodeWorker)),h.createWorkerFrom(c,O,x)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof u?this._data:new s(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<p.length;_++)d.prototype[p[_]]=y;r.exports=d},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(n){var s=n.MutationObserver||n.WebKitMutationObserver,o;if(s){var h=0,u=new s(O),d=n.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=h=++h%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var p=new n.MessageChannel;p.port1.onmessage=O,o=function(){p.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var c=n.document.createElement("script");c.onreadystatechange=function(){O(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},n.document.documentElement.appendChild(c)}:o=function(){setTimeout(O,0)};var y,_=[];function O(){y=!0;for(var c,g,m=_.length;m;){for(g=_,_=[],c=-1;++c<m;)g[c]();m=_.length}y=!1}r.exports=x;function x(c){_.push(c)===1&&!y&&o()}}).call(this,typeof we<"u"?we:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var n=e("immediate");function s(){}var o={},h=["REJECTED"],u=["FULFILLED"],d=["PENDING"];r.exports=p;function p(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,b!==s&&x(this,b)}p.prototype.finally=function(b){if(typeof b!="function")return this;var L=this.constructor;return this.then(T,D);function T(N){function A(){return N}return L.resolve(b()).then(A)}function D(N){function A(){throw N}return L.resolve(b()).then(A)}},p.prototype.catch=function(b){return this.then(null,b)},p.prototype.then=function(b,L){if(typeof b!="function"&&this.state===u||typeof L!="function"&&this.state===h)return this;var T=new this.constructor(s);if(this.state!==d){var D=this.state===u?b:L;_(T,D,this.outcome)}else this.queue.push(new y(T,b,L));return T};function y(b,L,T){this.promise=b,typeof L=="function"&&(this.onFulfilled=L,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}y.prototype.callFulfilled=function(b){o.resolve(this.promise,b)},y.prototype.otherCallFulfilled=function(b){_(this.promise,this.onFulfilled,b)},y.prototype.callRejected=function(b){o.reject(this.promise,b)},y.prototype.otherCallRejected=function(b){_(this.promise,this.onRejected,b)};function _(b,L,T){n(function(){var D;try{D=L(T)}catch(N){return o.reject(b,N)}D===b?o.reject(b,new TypeError("Cannot resolve promise with itself")):o.resolve(b,D)})}o.resolve=function(b,L){var T=c(O,L);if(T.status==="error")return o.reject(b,T.value);var D=T.value;if(D)x(b,D);else{b.state=u,b.outcome=L;for(var N=-1,A=b.queue.length;++N<A;)b.queue[N].callFulfilled(L)}return b},o.reject=function(b,L){b.state=h,b.outcome=L;for(var T=-1,D=b.queue.length;++T<D;)b.queue[T].callRejected(L);return b};function O(b){var L=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof L=="function")return function(){L.apply(b,arguments)}}function x(b,L){var T=!1;function D(X){T||(T=!0,o.reject(b,X))}function N(X){T||(T=!0,o.resolve(b,X))}function A(){L(N,D)}var W=c(A);W.status==="error"&&D(W.value)}function c(b,L){var T={};try{T.value=b(L),T.status="success"}catch(D){T.status="error",T.value=D}return T}p.resolve=g;function g(b){return b instanceof this?b:o.resolve(new this(s),b)}p.reject=m;function m(b){var L=new this(s);return o.reject(L,b)}p.all=C;function C(b){var L=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var N=new Array(T),A=0,W=-1,X=new this(s);++W<T;)$(b[W],W);return X;function $(et,at){L.resolve(et).then(pt,function(tt){D||(D=!0,o.reject(X,tt))});function pt(tt){N[at]=tt,++A===T&&!D&&(D=!0,o.resolve(X,N))}}}p.race=z;function z(b){var L=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var N=-1,A=new this(s);++N<T;)W(b[N]);return A;function W(X){L.resolve(X).then(function($){D||(D=!0,o.resolve(A,$))},function($){D||(D=!0,o.reject(A,$))})}}},{immediate:36}],38:[function(e,r,i){var n=e("./lib/utils/common").assign,s=e("./lib/deflate"),o=e("./lib/inflate"),h=e("./lib/zlib/constants"),u={};n(u,s,o,h),r.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var n=e("./zlib/deflate"),s=e("./utils/common"),o=e("./utils/strings"),h=e("./zlib/messages"),u=e("./zlib/zstream"),d=Object.prototype.toString,p=0,y=4,_=0,O=1,x=2,c=-1,g=0,m=8;function C(T){if(!(this instanceof C))return new C(T);this.options=s.assign({level:c,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},T||{});var D=this.options;D.raw&&D.windowBits>0?D.windowBits=-D.windowBits:D.gzip&&D.windowBits>0&&D.windowBits<16&&(D.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var N=n.deflateInit2(this.strm,D.level,D.method,D.windowBits,D.memLevel,D.strategy);if(N!==_)throw new Error(h[N]);if(D.header&&n.deflateSetHeader(this.strm,D.header),D.dictionary){var A;if(typeof D.dictionary=="string"?A=o.string2buf(D.dictionary):d.call(D.dictionary)==="[object ArrayBuffer]"?A=new Uint8Array(D.dictionary):A=D.dictionary,N=n.deflateSetDictionary(this.strm,A),N!==_)throw new Error(h[N]);this._dict_set=!0}}C.prototype.push=function(T,D){var N=this.strm,A=this.options.chunkSize,W,X;if(this.ended)return!1;X=D===~~D?D:D===!0?y:p,typeof T=="string"?N.input=o.string2buf(T):d.call(T)==="[object ArrayBuffer]"?N.input=new Uint8Array(T):N.input=T,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new s.Buf8(A),N.next_out=0,N.avail_out=A),W=n.deflate(N,X),W!==O&&W!==_)return this.onEnd(W),this.ended=!0,!1;(N.avail_out===0||N.avail_in===0&&(X===y||X===x))&&(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(N.output,N.next_out))):this.onData(s.shrinkBuf(N.output,N.next_out)))}while((N.avail_in>0||N.avail_out===0)&&W!==O);return X===y?(W=n.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===_):(X===x&&(this.onEnd(_),N.avail_out=0),!0)},C.prototype.onData=function(T){this.chunks.push(T)},C.prototype.onEnd=function(T){T===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg};function z(T,D){var N=new C(D);if(N.push(T,!0),N.err)throw N.msg||h[N.err];return N.result}function b(T,D){return D=D||{},D.raw=!0,z(T,D)}function L(T,D){return D=D||{},D.gzip=!0,z(T,D)}i.Deflate=C,i.deflate=z,i.deflateRaw=b,i.gzip=L},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var n=e("./zlib/inflate"),s=e("./utils/common"),o=e("./utils/strings"),h=e("./zlib/constants"),u=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),y=Object.prototype.toString;function _(c){if(!(this instanceof _))return new _(c);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},c||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(c&&c.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)===0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var m=n.inflateInit2(this.strm,g.windowBits);if(m!==h.Z_OK)throw new Error(u[m]);this.header=new p,n.inflateGetHeader(this.strm,this.header)}_.prototype.push=function(c,g){var m=this.strm,C=this.options.chunkSize,z=this.options.dictionary,b,L,T,D,N,A,W=!1;if(this.ended)return!1;L=g===~~g?g:g===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof c=="string"?m.input=o.binstring2buf(c):y.call(c)==="[object ArrayBuffer]"?m.input=new Uint8Array(c):m.input=c,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new s.Buf8(C),m.next_out=0,m.avail_out=C),b=n.inflate(m,h.Z_NO_FLUSH),b===h.Z_NEED_DICT&&z&&(typeof z=="string"?A=o.string2buf(z):y.call(z)==="[object ArrayBuffer]"?A=new Uint8Array(z):A=z,b=n.inflateSetDictionary(this.strm,A)),b===h.Z_BUF_ERROR&&W===!0&&(b=h.Z_OK,W=!1),b!==h.Z_STREAM_END&&b!==h.Z_OK)return this.onEnd(b),this.ended=!0,!1;m.next_out&&(m.avail_out===0||b===h.Z_STREAM_END||m.avail_in===0&&(L===h.Z_FINISH||L===h.Z_SYNC_FLUSH))&&(this.options.to==="string"?(T=o.utf8border(m.output,m.next_out),D=m.next_out-T,N=o.buf2string(m.output,T),m.next_out=D,m.avail_out=C-D,D&&s.arraySet(m.output,m.output,T,D,0),this.onData(N)):this.onData(s.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(W=!0)}while((m.avail_in>0||m.avail_out===0)&&b!==h.Z_STREAM_END);return b===h.Z_STREAM_END&&(L=h.Z_FINISH),L===h.Z_FINISH?(b=n.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===h.Z_OK):(L===h.Z_SYNC_FLUSH&&(this.onEnd(h.Z_OK),m.avail_out=0),!0)},_.prototype.onData=function(c){this.chunks.push(c)},_.prototype.onEnd=function(c){c===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg};function O(c,g){var m=new _(g);if(m.push(c,!0),m.err)throw m.msg||u[m.err];return m.result}function x(c,g){return g=g||{},g.raw=!0,O(c,g)}i.Inflate=_,i.inflate=O,i.inflateRaw=x,i.ungzip=O},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(h){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(h[p]=d[p])}}return h},i.shrinkBuf=function(h,u){return h.length===u?h:h.subarray?h.subarray(0,u):(h.length=u,h)};var s={arraySet:function(h,u,d,p,y){if(u.subarray&&h.subarray){h.set(u.subarray(d,d+p),y);return}for(var _=0;_<p;_++)h[y+_]=u[d+_]},flattenChunks:function(h){var u,d,p,y,_,O;for(p=0,u=0,d=h.length;u<d;u++)p+=h[u].length;for(O=new Uint8Array(p),y=0,u=0,d=h.length;u<d;u++)_=h[u],O.set(_,y),y+=_.length;return O}},o={arraySet:function(h,u,d,p,y){for(var _=0;_<p;_++)h[y+_]=u[d+_]},flattenChunks:function(h){return[].concat.apply([],h)}};i.setTyped=function(h){h?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(n)},{}],42:[function(e,r,i){var n=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var h=new n.Buf8(256),u=0;u<256;u++)h[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;h[254]=h[254]=1,i.string2buf=function(p){var y,_,O,x,c,g=p.length,m=0;for(x=0;x<g;x++)_=p.charCodeAt(x),(_&64512)===55296&&x+1<g&&(O=p.charCodeAt(x+1),(O&64512)===56320&&(_=65536+(_-55296<<10)+(O-56320),x++)),m+=_<128?1:_<2048?2:_<65536?3:4;for(y=new n.Buf8(m),c=0,x=0;c<m;x++)_=p.charCodeAt(x),(_&64512)===55296&&x+1<g&&(O=p.charCodeAt(x+1),(O&64512)===56320&&(_=65536+(_-55296<<10)+(O-56320),x++)),_<128?y[c++]=_:_<2048?(y[c++]=192|_>>>6,y[c++]=128|_&63):_<65536?(y[c++]=224|_>>>12,y[c++]=128|_>>>6&63,y[c++]=128|_&63):(y[c++]=240|_>>>18,y[c++]=128|_>>>12&63,y[c++]=128|_>>>6&63,y[c++]=128|_&63);return y};function d(p,y){if(y<65537&&(p.subarray&&o||!p.subarray&&s))return String.fromCharCode.apply(null,n.shrinkBuf(p,y));for(var _="",O=0;O<y;O++)_+=String.fromCharCode(p[O]);return _}i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var y=new n.Buf8(p.length),_=0,O=y.length;_<O;_++)y[_]=p.charCodeAt(_);return y},i.buf2string=function(p,y){var _,O,x,c,g=y||p.length,m=new Array(g*2);for(O=0,_=0;_<g;){if(x=p[_++],x<128){m[O++]=x;continue}if(c=h[x],c>4){m[O++]=65533,_+=c-1;continue}for(x&=c===2?31:c===3?15:7;c>1&&_<g;)x=x<<6|p[_++]&63,c--;if(c>1){m[O++]=65533;continue}x<65536?m[O++]=x:(x-=65536,m[O++]=55296|x>>10&1023,m[O++]=56320|x&1023)}return d(m,O)},i.utf8border=function(p,y){var _;for(y=y||p.length,y>p.length&&(y=p.length),_=y-1;_>=0&&(p[_]&192)===128;)_--;return _<0||_===0?y:_+h[p[_]]>y?_:y}},{"./common":41}],43:[function(e,r,i){function n(s,o,h,u){for(var d=s&65535|0,p=s>>>16&65535|0,y=0;h!==0;){y=h>2e3?2e3:h,h-=y;do d=d+o[u++]|0,p=p+d|0;while(--y);d%=65521,p%=65521}return d|p<<16|0}r.exports=n},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){function n(){for(var h,u=[],d=0;d<256;d++){h=d;for(var p=0;p<8;p++)h=h&1?3988292384^h>>>1:h>>>1;u[d]=h}return u}var s=n();function o(h,u,d,p){var y=s,_=p+d;h^=-1;for(var O=p;O<_;O++)h=h>>>8^y[(h^u[O])&255];return h^-1}r.exports=o},{}],46:[function(e,r,i){var n=e("../utils/common"),s=e("./trees"),o=e("./adler32"),h=e("./crc32"),u=e("./messages"),d=0,p=1,y=3,_=4,O=5,x=0,c=1,g=-2,m=-3,C=-5,z=-1,b=1,L=2,T=3,D=4,N=0,A=2,W=8,X=9,$=15,et=8,at=29,pt=256,tt=pt+1+at,ot=30,ut=19,Ct=2*tt+1,ct=15,mt=3,Rt=258,xt=Rt+mt+1,At=32,qt=42,Bt=69,Nt=73,jt=91,Ft=103,Tt=113,U=666,P=1,Y=2,rt=3,Q=4,vt=3;function kt(l,q){return l.msg=u[q],q}function Lt(l){return(l<<1)-(l>4?9:0)}function Dt(l){for(var q=l.length;--q>=0;)l[q]=0}function bt(l){var q=l.state,G=q.pending;G>l.avail_out&&(G=l.avail_out),G!==0&&(n.arraySet(l.output,q.pending_buf,q.pending_out,G,l.next_out),l.next_out+=G,q.pending_out+=G,l.total_out+=G,l.avail_out-=G,q.pending-=G,q.pending===0&&(q.pending_out=0))}function Et(l,q){s._tr_flush_block(l,l.block_start>=0?l.block_start:-1,l.strstart-l.block_start,q),l.block_start=l.strstart,bt(l.strm)}function _t(l,q){l.pending_buf[l.pending++]=q}function Xt(l,q){l.pending_buf[l.pending++]=q>>>8&255,l.pending_buf[l.pending++]=q&255}function se(l,q,G,w){var B=l.avail_in;return B>w&&(B=w),B===0?0:(l.avail_in-=B,n.arraySet(q,l.input,l.next_in,B,G),l.state.wrap===1?l.adler=o(l.adler,q,B,G):l.state.wrap===2&&(l.adler=h(l.adler,q,B,G)),l.next_in+=B,l.total_in+=B,B)}function ce(l,q){var G=l.max_chain_length,w=l.strstart,B,Z,wt=l.prev_length,dt=l.nice_match,ft=l.strstart>l.w_size-xt?l.strstart-(l.w_size-xt):0,It=l.window,ie=l.w_mask,Ut=l.prev,Ot=l.strstart+Rt,Ht=It[w+wt-1],te=It[w+wt];l.prev_length>=l.good_match&&(G>>=2),dt>l.lookahead&&(dt=l.lookahead);do if(B=q,!(It[B+wt]!==te||It[B+wt-1]!==Ht||It[B]!==It[w]||It[++B]!==It[w+1])){w+=2,B++;do;while(It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&It[++w]===It[++B]&&w<Ot);if(Z=Rt-(Ot-w),w=Ot-Rt,Z>wt){if(l.match_start=q,wt=Z,Z>=dt)break;Ht=It[w+wt-1],te=It[w+wt]}}while((q=Ut[q&ie])>ft&&--G!==0);return wt<=l.lookahead?wt:l.lookahead}function ee(l){var q=l.w_size,G,w,B,Z,wt;do{if(Z=l.window_size-l.lookahead-l.strstart,l.strstart>=q+(q-xt)){n.arraySet(l.window,l.window,q,q,0),l.match_start-=q,l.strstart-=q,l.block_start-=q,w=l.hash_size,G=w;do B=l.head[--G],l.head[G]=B>=q?B-q:0;while(--w);w=q,G=w;do B=l.prev[--G],l.prev[G]=B>=q?B-q:0;while(--w);Z+=q}if(l.strm.avail_in===0)break;if(w=se(l.strm,l.window,l.strstart+l.lookahead,Z),l.lookahead+=w,l.lookahead+l.insert>=mt)for(wt=l.strstart-l.insert,l.ins_h=l.window[wt],l.ins_h=(l.ins_h<<l.hash_shift^l.window[wt+1])&l.hash_mask;l.insert&&(l.ins_h=(l.ins_h<<l.hash_shift^l.window[wt+mt-1])&l.hash_mask,l.prev[wt&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=wt,wt++,l.insert--,!(l.lookahead+l.insert<mt)););}while(l.lookahead<xt&&l.strm.avail_in!==0)}function ge(l,q){var G=65535;for(G>l.pending_buf_size-5&&(G=l.pending_buf_size-5);;){if(l.lookahead<=1){if(ee(l),l.lookahead===0&&q===d)return P;if(l.lookahead===0)break}l.strstart+=l.lookahead,l.lookahead=0;var w=l.block_start+G;if((l.strstart===0||l.strstart>=w)&&(l.lookahead=l.strstart-w,l.strstart=w,Et(l,!1),l.strm.avail_out===0)||l.strstart-l.block_start>=l.w_size-xt&&(Et(l,!1),l.strm.avail_out===0))return P}return l.insert=0,q===_?(Et(l,!0),l.strm.avail_out===0?rt:Q):(l.strstart>l.block_start&&(Et(l,!1),l.strm.avail_out),P)}function de(l,q){for(var G,w;;){if(l.lookahead<xt){if(ee(l),l.lookahead<xt&&q===d)return P;if(l.lookahead===0)break}if(G=0,l.lookahead>=mt&&(l.ins_h=(l.ins_h<<l.hash_shift^l.window[l.strstart+mt-1])&l.hash_mask,G=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart),G!==0&&l.strstart-G<=l.w_size-xt&&(l.match_length=ce(l,G)),l.match_length>=mt)if(w=s._tr_tally(l,l.strstart-l.match_start,l.match_length-mt),l.lookahead-=l.match_length,l.match_length<=l.max_lazy_match&&l.lookahead>=mt){l.match_length--;do l.strstart++,l.ins_h=(l.ins_h<<l.hash_shift^l.window[l.strstart+mt-1])&l.hash_mask,G=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart;while(--l.match_length!==0);l.strstart++}else l.strstart+=l.match_length,l.match_length=0,l.ins_h=l.window[l.strstart],l.ins_h=(l.ins_h<<l.hash_shift^l.window[l.strstart+1])&l.hash_mask;else w=s._tr_tally(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++;if(w&&(Et(l,!1),l.strm.avail_out===0))return P}return l.insert=l.strstart<mt-1?l.strstart:mt-1,q===_?(Et(l,!0),l.strm.avail_out===0?rt:Q):l.last_lit&&(Et(l,!1),l.strm.avail_out===0)?P:Y}function oe(l,q){for(var G,w,B;;){if(l.lookahead<xt){if(ee(l),l.lookahead<xt&&q===d)return P;if(l.lookahead===0)break}if(G=0,l.lookahead>=mt&&(l.ins_h=(l.ins_h<<l.hash_shift^l.window[l.strstart+mt-1])&l.hash_mask,G=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart),l.prev_length=l.match_length,l.prev_match=l.match_start,l.match_length=mt-1,G!==0&&l.prev_length<l.max_lazy_match&&l.strstart-G<=l.w_size-xt&&(l.match_length=ce(l,G),l.match_length<=5&&(l.strategy===b||l.match_length===mt&&l.strstart-l.match_start>4096)&&(l.match_length=mt-1)),l.prev_length>=mt&&l.match_length<=l.prev_length){B=l.strstart+l.lookahead-mt,w=s._tr_tally(l,l.strstart-1-l.prev_match,l.prev_length-mt),l.lookahead-=l.prev_length-1,l.prev_length-=2;do++l.strstart<=B&&(l.ins_h=(l.ins_h<<l.hash_shift^l.window[l.strstart+mt-1])&l.hash_mask,G=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart);while(--l.prev_length!==0);if(l.match_available=0,l.match_length=mt-1,l.strstart++,w&&(Et(l,!1),l.strm.avail_out===0))return P}else if(l.match_available){if(w=s._tr_tally(l,0,l.window[l.strstart-1]),w&&Et(l,!1),l.strstart++,l.lookahead--,l.strm.avail_out===0)return P}else l.match_available=1,l.strstart++,l.lookahead--}return l.match_available&&(w=s._tr_tally(l,0,l.window[l.strstart-1]),l.match_available=0),l.insert=l.strstart<mt-1?l.strstart:mt-1,q===_?(Et(l,!0),l.strm.avail_out===0?rt:Q):l.last_lit&&(Et(l,!1),l.strm.avail_out===0)?P:Y}function fe(l,q){for(var G,w,B,Z,wt=l.window;;){if(l.lookahead<=Rt){if(ee(l),l.lookahead<=Rt&&q===d)return P;if(l.lookahead===0)break}if(l.match_length=0,l.lookahead>=mt&&l.strstart>0&&(B=l.strstart-1,w=wt[B],w===wt[++B]&&w===wt[++B]&&w===wt[++B])){Z=l.strstart+Rt;do;while(w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&w===wt[++B]&&B<Z);l.match_length=Rt-(Z-B),l.match_length>l.lookahead&&(l.match_length=l.lookahead)}if(l.match_length>=mt?(G=s._tr_tally(l,1,l.match_length-mt),l.lookahead-=l.match_length,l.strstart+=l.match_length,l.match_length=0):(G=s._tr_tally(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++),G&&(Et(l,!1),l.strm.avail_out===0))return P}return l.insert=0,q===_?(Et(l,!0),l.strm.avail_out===0?rt:Q):l.last_lit&&(Et(l,!1),l.strm.avail_out===0)?P:Y}function ue(l,q){for(var G;;){if(l.lookahead===0&&(ee(l),l.lookahead===0)){if(q===d)return P;break}if(l.match_length=0,G=s._tr_tally(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++,G&&(Et(l,!1),l.strm.avail_out===0))return P}return l.insert=0,q===_?(Et(l,!0),l.strm.avail_out===0?rt:Q):l.last_lit&&(Et(l,!1),l.strm.avail_out===0)?P:Y}function Kt(l,q,G,w,B){this.good_length=l,this.max_lazy=q,this.nice_length=G,this.max_chain=w,this.func=B}var ae;ae=[new Kt(0,0,0,0,ge),new Kt(4,4,8,4,de),new Kt(4,5,16,8,de),new Kt(4,6,32,32,de),new Kt(4,4,16,16,oe),new Kt(8,16,32,32,oe),new Kt(8,16,128,128,oe),new Kt(8,32,128,256,oe),new Kt(32,128,258,1024,oe),new Kt(32,258,258,4096,oe)];function be(l){l.window_size=2*l.w_size,Dt(l.head),l.max_lazy_match=ae[l.level].max_lazy,l.good_match=ae[l.level].good_length,l.nice_match=ae[l.level].nice_length,l.max_chain_length=ae[l.level].max_chain,l.strstart=0,l.block_start=0,l.lookahead=0,l.insert=0,l.match_length=l.prev_length=mt-1,l.match_available=0,l.ins_h=0}function S(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=W,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(Ct*2),this.dyn_dtree=new n.Buf16((2*ot+1)*2),this.bl_tree=new n.Buf16((2*ut+1)*2),Dt(this.dyn_ltree),Dt(this.dyn_dtree),Dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(ct+1),this.heap=new n.Buf16(2*tt+1),Dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*tt+1),Dt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function J(l){var q;return!l||!l.state?kt(l,g):(l.total_in=l.total_out=0,l.data_type=A,q=l.state,q.pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?qt:Tt,l.adler=q.wrap===2?0:1,q.last_flush=d,s._tr_init(q),x)}function it(l){var q=J(l);return q===x&&be(l.state),q}function yt(l,q){return!l||!l.state||l.state.wrap!==2?g:(l.state.gzhead=q,x)}function M(l,q,G,w,B,Z){if(!l)return g;var wt=1;if(q===z&&(q=6),w<0?(wt=0,w=-w):w>15&&(wt=2,w-=16),B<1||B>X||G!==W||w<8||w>15||q<0||q>9||Z<0||Z>D)return kt(l,g);w===8&&(w=9);var dt=new S;return l.state=dt,dt.strm=l,dt.wrap=wt,dt.gzhead=null,dt.w_bits=w,dt.w_size=1<<dt.w_bits,dt.w_mask=dt.w_size-1,dt.hash_bits=B+7,dt.hash_size=1<<dt.hash_bits,dt.hash_mask=dt.hash_size-1,dt.hash_shift=~~((dt.hash_bits+mt-1)/mt),dt.window=new n.Buf8(dt.w_size*2),dt.head=new n.Buf16(dt.hash_size),dt.prev=new n.Buf16(dt.w_size),dt.lit_bufsize=1<<B+6,dt.pending_buf_size=dt.lit_bufsize*4,dt.pending_buf=new n.Buf8(dt.pending_buf_size),dt.d_buf=1*dt.lit_bufsize,dt.l_buf=3*dt.lit_bufsize,dt.level=q,dt.strategy=Z,dt.method=G,it(l)}function f(l,q){return M(l,q,W,$,et,N)}function a(l,q){var G,w,B,Z;if(!l||!l.state||q>O||q<0)return l?kt(l,g):g;if(w=l.state,!l.output||!l.input&&l.avail_in!==0||w.status===U&&q!==_)return kt(l,l.avail_out===0?C:g);if(w.strm=l,G=w.last_flush,w.last_flush=q,w.status===qt)if(w.wrap===2)l.adler=0,_t(w,31),_t(w,139),_t(w,8),w.gzhead?(_t(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),_t(w,w.gzhead.time&255),_t(w,w.gzhead.time>>8&255),_t(w,w.gzhead.time>>16&255),_t(w,w.gzhead.time>>24&255),_t(w,w.level===9?2:w.strategy>=L||w.level<2?4:0),_t(w,w.gzhead.os&255),w.gzhead.extra&&w.gzhead.extra.length&&(_t(w,w.gzhead.extra.length&255),_t(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(l.adler=h(l.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=Bt):(_t(w,0),_t(w,0),_t(w,0),_t(w,0),_t(w,0),_t(w,w.level===9?2:w.strategy>=L||w.level<2?4:0),_t(w,vt),w.status=Tt);else{var wt=W+(w.w_bits-8<<4)<<8,dt=-1;w.strategy>=L||w.level<2?dt=0:w.level<6?dt=1:w.level===6?dt=2:dt=3,wt|=dt<<6,w.strstart!==0&&(wt|=At),wt+=31-wt%31,w.status=Tt,Xt(w,wt),w.strstart!==0&&(Xt(w,l.adler>>>16),Xt(w,l.adler&65535)),l.adler=1}if(w.status===Bt)if(w.gzhead.extra){for(B=w.pending;w.gzindex<(w.gzhead.extra.length&65535)&&!(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),bt(l),B=w.pending,w.pending===w.pending_buf_size));)_t(w,w.gzhead.extra[w.gzindex]&255),w.gzindex++;w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=Nt)}else w.status=Nt;if(w.status===Nt)if(w.gzhead.name){B=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),bt(l),B=w.pending,w.pending===w.pending_buf_size)){Z=1;break}w.gzindex<w.gzhead.name.length?Z=w.gzhead.name.charCodeAt(w.gzindex++)&255:Z=0,_t(w,Z)}while(Z!==0);w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),Z===0&&(w.gzindex=0,w.status=jt)}else w.status=jt;if(w.status===jt)if(w.gzhead.comment){B=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),bt(l),B=w.pending,w.pending===w.pending_buf_size)){Z=1;break}w.gzindex<w.gzhead.comment.length?Z=w.gzhead.comment.charCodeAt(w.gzindex++)&255:Z=0,_t(w,Z)}while(Z!==0);w.gzhead.hcrc&&w.pending>B&&(l.adler=h(l.adler,w.pending_buf,w.pending-B,B)),Z===0&&(w.status=Ft)}else w.status=Ft;if(w.status===Ft&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&bt(l),w.pending+2<=w.pending_buf_size&&(_t(w,l.adler&255),_t(w,l.adler>>8&255),l.adler=0,w.status=Tt)):w.status=Tt),w.pending!==0){if(bt(l),l.avail_out===0)return w.last_flush=-1,x}else if(l.avail_in===0&&Lt(q)<=Lt(G)&&q!==_)return kt(l,C);if(w.status===U&&l.avail_in!==0)return kt(l,C);if(l.avail_in!==0||w.lookahead!==0||q!==d&&w.status!==U){var ft=w.strategy===L?ue(w,q):w.strategy===T?fe(w,q):ae[w.level].func(w,q);if((ft===rt||ft===Q)&&(w.status=U),ft===P||ft===rt)return l.avail_out===0&&(w.last_flush=-1),x;if(ft===Y&&(q===p?s._tr_align(w):q!==O&&(s._tr_stored_block(w,0,0,!1),q===y&&(Dt(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),bt(l),l.avail_out===0))return w.last_flush=-1,x}return q!==_?x:w.wrap<=0?c:(w.wrap===2?(_t(w,l.adler&255),_t(w,l.adler>>8&255),_t(w,l.adler>>16&255),_t(w,l.adler>>24&255),_t(w,l.total_in&255),_t(w,l.total_in>>8&255),_t(w,l.total_in>>16&255),_t(w,l.total_in>>24&255)):(Xt(w,l.adler>>>16),Xt(w,l.adler&65535)),bt(l),w.wrap>0&&(w.wrap=-w.wrap),w.pending!==0?x:c)}function k(l){var q;return!l||!l.state?g:(q=l.state.status,q!==qt&&q!==Bt&&q!==Nt&&q!==jt&&q!==Ft&&q!==Tt&&q!==U?kt(l,g):(l.state=null,q===Tt?kt(l,m):x))}function j(l,q){var G=q.length,w,B,Z,wt,dt,ft,It,ie;if(!l||!l.state||(w=l.state,wt=w.wrap,wt===2||wt===1&&w.status!==qt||w.lookahead))return g;for(wt===1&&(l.adler=o(l.adler,q,G,0)),w.wrap=0,G>=w.w_size&&(wt===0&&(Dt(w.head),w.strstart=0,w.block_start=0,w.insert=0),ie=new n.Buf8(w.w_size),n.arraySet(ie,q,G-w.w_size,w.w_size,0),q=ie,G=w.w_size),dt=l.avail_in,ft=l.next_in,It=l.input,l.avail_in=G,l.next_in=0,l.input=q,ee(w);w.lookahead>=mt;){B=w.strstart,Z=w.lookahead-(mt-1);do w.ins_h=(w.ins_h<<w.hash_shift^w.window[B+mt-1])&w.hash_mask,w.prev[B&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=B,B++;while(--Z);w.strstart=B,w.lookahead=mt-1,ee(w)}return w.strstart+=w.lookahead,w.block_start=w.strstart,w.insert=w.lookahead,w.lookahead=0,w.match_length=w.prev_length=mt-1,w.match_available=0,l.next_in=ft,l.input=It,l.avail_in=dt,w.wrap=wt,x}i.deflateInit=f,i.deflateInit2=M,i.deflateReset=it,i.deflateResetKeep=J,i.deflateSetHeader=yt,i.deflate=a,i.deflateEnd=k,i.deflateSetDictionary=j,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=n},{}],48:[function(e,r,i){var n=30,s=12;r.exports=function(o,h){var u,d,p,y,_,O,x,c,g,m,C,z,b,L,T,D,N,A,W,X,$,et,at,pt,tt;u=o.state,d=o.next_in,pt=o.input,p=d+(o.avail_in-5),y=o.next_out,tt=o.output,_=y-(h-o.avail_out),O=y+(o.avail_out-257),x=u.dmax,c=u.wsize,g=u.whave,m=u.wnext,C=u.window,z=u.hold,b=u.bits,L=u.lencode,T=u.distcode,D=(1<<u.lenbits)-1,N=(1<<u.distbits)-1;t:do{b<15&&(z+=pt[d++]<<b,b+=8,z+=pt[d++]<<b,b+=8),A=L[z&D];e:for(;;){if(W=A>>>24,z>>>=W,b-=W,W=A>>>16&255,W===0)tt[y++]=A&65535;else if(W&16){X=A&65535,W&=15,W&&(b<W&&(z+=pt[d++]<<b,b+=8),X+=z&(1<<W)-1,z>>>=W,b-=W),b<15&&(z+=pt[d++]<<b,b+=8,z+=pt[d++]<<b,b+=8),A=T[z&N];r:for(;;){if(W=A>>>24,z>>>=W,b-=W,W=A>>>16&255,W&16){if($=A&65535,W&=15,b<W&&(z+=pt[d++]<<b,b+=8,b<W&&(z+=pt[d++]<<b,b+=8)),$+=z&(1<<W)-1,$>x){o.msg="invalid distance too far back",u.mode=n;break t}if(z>>>=W,b-=W,W=y-_,$>W){if(W=$-W,W>g&&u.sane){o.msg="invalid distance too far back",u.mode=n;break t}if(et=0,at=C,m===0){if(et+=c-W,W<X){X-=W;do tt[y++]=C[et++];while(--W);et=y-$,at=tt}}else if(m<W){if(et+=c+m-W,W-=m,W<X){X-=W;do tt[y++]=C[et++];while(--W);if(et=0,m<X){W=m,X-=W;do tt[y++]=C[et++];while(--W);et=y-$,at=tt}}}else if(et+=m-W,W<X){X-=W;do tt[y++]=C[et++];while(--W);et=y-$,at=tt}for(;X>2;)tt[y++]=at[et++],tt[y++]=at[et++],tt[y++]=at[et++],X-=3;X&&(tt[y++]=at[et++],X>1&&(tt[y++]=at[et++]))}else{et=y-$;do tt[y++]=tt[et++],tt[y++]=tt[et++],tt[y++]=tt[et++],X-=3;while(X>2);X&&(tt[y++]=tt[et++],X>1&&(tt[y++]=tt[et++]))}}else if((W&64)===0){A=T[(A&65535)+(z&(1<<W)-1)];continue r}else{o.msg="invalid distance code",u.mode=n;break t}break}}else if((W&64)===0){A=L[(A&65535)+(z&(1<<W)-1)];continue e}else if(W&32){u.mode=s;break t}else{o.msg="invalid literal/length code",u.mode=n;break t}break}}while(d<p&&y<O);X=b>>3,d-=X,b-=X<<3,z&=(1<<b)-1,o.next_in=d,o.next_out=y,o.avail_in=d<p?5+(p-d):5-(d-p),o.avail_out=y<O?257+(O-y):257-(y-O),u.hold=z,u.bits=b}},{}],49:[function(e,r,i){var n=e("../utils/common"),s=e("./adler32"),o=e("./crc32"),h=e("./inffast"),u=e("./inftrees"),d=0,p=1,y=2,_=4,O=5,x=6,c=0,g=1,m=2,C=-2,z=-3,b=-4,L=-5,T=8,D=1,N=2,A=3,W=4,X=5,$=6,et=7,at=8,pt=9,tt=10,ot=11,ut=12,Ct=13,ct=14,mt=15,Rt=16,xt=17,At=18,qt=19,Bt=20,Nt=21,jt=22,Ft=23,Tt=24,U=25,P=26,Y=27,rt=28,Q=29,vt=30,kt=31,Lt=32,Dt=852,bt=592,Et=15,_t=Et;function Xt(M){return(M>>>24&255)+(M>>>8&65280)+((M&65280)<<8)+((M&255)<<24)}function se(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ce(M){var f;return!M||!M.state?C:(f=M.state,M.total_in=M.total_out=f.total=0,M.msg="",f.wrap&&(M.adler=f.wrap&1),f.mode=D,f.last=0,f.havedict=0,f.dmax=32768,f.head=null,f.hold=0,f.bits=0,f.lencode=f.lendyn=new n.Buf32(Dt),f.distcode=f.distdyn=new n.Buf32(bt),f.sane=1,f.back=-1,c)}function ee(M){var f;return!M||!M.state?C:(f=M.state,f.wsize=0,f.whave=0,f.wnext=0,ce(M))}function ge(M,f){var a,k;return!M||!M.state||(k=M.state,f<0?(a=0,f=-f):(a=(f>>4)+1,f<48&&(f&=15)),f&&(f<8||f>15))?C:(k.window!==null&&k.wbits!==f&&(k.window=null),k.wrap=a,k.wbits=f,ee(M))}function de(M,f){var a,k;return M?(k=new se,M.state=k,k.window=null,a=ge(M,f),a!==c&&(M.state=null),a):C}function oe(M){return de(M,_t)}var fe=!0,ue,Kt;function ae(M){if(fe){var f;for(ue=new n.Buf32(512),Kt=new n.Buf32(32),f=0;f<144;)M.lens[f++]=8;for(;f<256;)M.lens[f++]=9;for(;f<280;)M.lens[f++]=7;for(;f<288;)M.lens[f++]=8;for(u(p,M.lens,0,288,ue,0,M.work,{bits:9}),f=0;f<32;)M.lens[f++]=5;u(y,M.lens,0,32,Kt,0,M.work,{bits:5}),fe=!1}M.lencode=ue,M.lenbits=9,M.distcode=Kt,M.distbits=5}function be(M,f,a,k){var j,l=M.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new n.Buf8(l.wsize)),k>=l.wsize?(n.arraySet(l.window,f,a-l.wsize,l.wsize,0),l.wnext=0,l.whave=l.wsize):(j=l.wsize-l.wnext,j>k&&(j=k),n.arraySet(l.window,f,a-k,j,l.wnext),k-=j,k?(n.arraySet(l.window,f,a-k,k,0),l.wnext=k,l.whave=l.wsize):(l.wnext+=j,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=j))),0}function S(M,f){var a,k,j,l,q,G,w,B,Z,wt,dt,ft,It,ie,Ut=0,Ot,Ht,te,Yt,Te,De,Jt,pe,ne=new n.Buf8(4),_e,me,er=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return C;a=M.state,a.mode===ut&&(a.mode=Ct),q=M.next_out,j=M.output,w=M.avail_out,l=M.next_in,k=M.input,G=M.avail_in,B=a.hold,Z=a.bits,wt=G,dt=w,pe=c;t:for(;;)switch(a.mode){case D:if(a.wrap===0){a.mode=Ct;break}for(;Z<16;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(a.wrap&2&&B===35615){a.check=0,ne[0]=B&255,ne[1]=B>>>8&255,a.check=o(a.check,ne,2,0),B=0,Z=0,a.mode=N;break}if(a.flags=0,a.head&&(a.head.done=!1),!(a.wrap&1)||(((B&255)<<8)+(B>>8))%31){M.msg="incorrect header check",a.mode=vt;break}if((B&15)!==T){M.msg="unknown compression method",a.mode=vt;break}if(B>>>=4,Z-=4,Jt=(B&15)+8,a.wbits===0)a.wbits=Jt;else if(Jt>a.wbits){M.msg="invalid window size",a.mode=vt;break}a.dmax=1<<Jt,M.adler=a.check=1,a.mode=B&512?tt:ut,B=0,Z=0;break;case N:for(;Z<16;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(a.flags=B,(a.flags&255)!==T){M.msg="unknown compression method",a.mode=vt;break}if(a.flags&57344){M.msg="unknown header flags set",a.mode=vt;break}a.head&&(a.head.text=B>>8&1),a.flags&512&&(ne[0]=B&255,ne[1]=B>>>8&255,a.check=o(a.check,ne,2,0)),B=0,Z=0,a.mode=A;case A:for(;Z<32;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.head&&(a.head.time=B),a.flags&512&&(ne[0]=B&255,ne[1]=B>>>8&255,ne[2]=B>>>16&255,ne[3]=B>>>24&255,a.check=o(a.check,ne,4,0)),B=0,Z=0,a.mode=W;case W:for(;Z<16;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.head&&(a.head.xflags=B&255,a.head.os=B>>8),a.flags&512&&(ne[0]=B&255,ne[1]=B>>>8&255,a.check=o(a.check,ne,2,0)),B=0,Z=0,a.mode=X;case X:if(a.flags&1024){for(;Z<16;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.length=B,a.head&&(a.head.extra_len=B),a.flags&512&&(ne[0]=B&255,ne[1]=B>>>8&255,a.check=o(a.check,ne,2,0)),B=0,Z=0}else a.head&&(a.head.extra=null);a.mode=$;case $:if(a.flags&1024&&(ft=a.length,ft>G&&(ft=G),ft&&(a.head&&(Jt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),n.arraySet(a.head.extra,k,l,ft,Jt)),a.flags&512&&(a.check=o(a.check,k,ft,l)),G-=ft,l+=ft,a.length-=ft),a.length))break t;a.length=0,a.mode=et;case et:if(a.flags&2048){if(G===0)break t;ft=0;do Jt=k[l+ft++],a.head&&Jt&&a.length<65536&&(a.head.name+=String.fromCharCode(Jt));while(Jt&&ft<G);if(a.flags&512&&(a.check=o(a.check,k,ft,l)),G-=ft,l+=ft,Jt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=at;case at:if(a.flags&4096){if(G===0)break t;ft=0;do Jt=k[l+ft++],a.head&&Jt&&a.length<65536&&(a.head.comment+=String.fromCharCode(Jt));while(Jt&&ft<G);if(a.flags&512&&(a.check=o(a.check,k,ft,l)),G-=ft,l+=ft,Jt)break t}else a.head&&(a.head.comment=null);a.mode=pt;case pt:if(a.flags&512){for(;Z<16;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(B!==(a.check&65535)){M.msg="header crc mismatch",a.mode=vt;break}B=0,Z=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),M.adler=a.check=0,a.mode=ut;break;case tt:for(;Z<32;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}M.adler=a.check=Xt(B),B=0,Z=0,a.mode=ot;case ot:if(a.havedict===0)return M.next_out=q,M.avail_out=w,M.next_in=l,M.avail_in=G,a.hold=B,a.bits=Z,m;M.adler=a.check=1,a.mode=ut;case ut:if(f===O||f===x)break t;case Ct:if(a.last){B>>>=Z&7,Z-=Z&7,a.mode=Y;break}for(;Z<3;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}switch(a.last=B&1,B>>>=1,Z-=1,B&3){case 0:a.mode=ct;break;case 1:if(ae(a),a.mode=Bt,f===x){B>>>=2,Z-=2;break t}break;case 2:a.mode=xt;break;case 3:M.msg="invalid block type",a.mode=vt}B>>>=2,Z-=2;break;case ct:for(B>>>=Z&7,Z-=Z&7;Z<32;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if((B&65535)!==(B>>>16^65535)){M.msg="invalid stored block lengths",a.mode=vt;break}if(a.length=B&65535,B=0,Z=0,a.mode=mt,f===x)break t;case mt:a.mode=Rt;case Rt:if(ft=a.length,ft){if(ft>G&&(ft=G),ft>w&&(ft=w),ft===0)break t;n.arraySet(j,k,l,ft,q),G-=ft,l+=ft,w-=ft,q+=ft,a.length-=ft;break}a.mode=ut;break;case xt:for(;Z<14;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(a.nlen=(B&31)+257,B>>>=5,Z-=5,a.ndist=(B&31)+1,B>>>=5,Z-=5,a.ncode=(B&15)+4,B>>>=4,Z-=4,a.nlen>286||a.ndist>30){M.msg="too many length or distance symbols",a.mode=vt;break}a.have=0,a.mode=At;case At:for(;a.have<a.ncode;){for(;Z<3;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.lens[er[a.have++]]=B&7,B>>>=3,Z-=3}for(;a.have<19;)a.lens[er[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,_e={bits:a.lenbits},pe=u(d,a.lens,0,19,a.lencode,0,a.work,_e),a.lenbits=_e.bits,pe){M.msg="invalid code lengths set",a.mode=vt;break}a.have=0,a.mode=qt;case qt:for(;a.have<a.nlen+a.ndist;){for(;Ut=a.lencode[B&(1<<a.lenbits)-1],Ot=Ut>>>24,Ht=Ut>>>16&255,te=Ut&65535,!(Ot<=Z);){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(te<16)B>>>=Ot,Z-=Ot,a.lens[a.have++]=te;else{if(te===16){for(me=Ot+2;Z<me;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(B>>>=Ot,Z-=Ot,a.have===0){M.msg="invalid bit length repeat",a.mode=vt;break}Jt=a.lens[a.have-1],ft=3+(B&3),B>>>=2,Z-=2}else if(te===17){for(me=Ot+3;Z<me;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}B>>>=Ot,Z-=Ot,Jt=0,ft=3+(B&7),B>>>=3,Z-=3}else{for(me=Ot+7;Z<me;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}B>>>=Ot,Z-=Ot,Jt=0,ft=11+(B&127),B>>>=7,Z-=7}if(a.have+ft>a.nlen+a.ndist){M.msg="invalid bit length repeat",a.mode=vt;break}for(;ft--;)a.lens[a.have++]=Jt}}if(a.mode===vt)break;if(a.lens[256]===0){M.msg="invalid code -- missing end-of-block",a.mode=vt;break}if(a.lenbits=9,_e={bits:a.lenbits},pe=u(p,a.lens,0,a.nlen,a.lencode,0,a.work,_e),a.lenbits=_e.bits,pe){M.msg="invalid literal/lengths set",a.mode=vt;break}if(a.distbits=6,a.distcode=a.distdyn,_e={bits:a.distbits},pe=u(y,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,_e),a.distbits=_e.bits,pe){M.msg="invalid distances set",a.mode=vt;break}if(a.mode=Bt,f===x)break t;case Bt:a.mode=Nt;case Nt:if(G>=6&&w>=258){M.next_out=q,M.avail_out=w,M.next_in=l,M.avail_in=G,a.hold=B,a.bits=Z,h(M,dt),q=M.next_out,j=M.output,w=M.avail_out,l=M.next_in,k=M.input,G=M.avail_in,B=a.hold,Z=a.bits,a.mode===ut&&(a.back=-1);break}for(a.back=0;Ut=a.lencode[B&(1<<a.lenbits)-1],Ot=Ut>>>24,Ht=Ut>>>16&255,te=Ut&65535,!(Ot<=Z);){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(Ht&&(Ht&240)===0){for(Yt=Ot,Te=Ht,De=te;Ut=a.lencode[De+((B&(1<<Yt+Te)-1)>>Yt)],Ot=Ut>>>24,Ht=Ut>>>16&255,te=Ut&65535,!(Yt+Ot<=Z);){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}B>>>=Yt,Z-=Yt,a.back+=Yt}if(B>>>=Ot,Z-=Ot,a.back+=Ot,a.length=te,Ht===0){a.mode=P;break}if(Ht&32){a.back=-1,a.mode=ut;break}if(Ht&64){M.msg="invalid literal/length code",a.mode=vt;break}a.extra=Ht&15,a.mode=jt;case jt:if(a.extra){for(me=a.extra;Z<me;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.length+=B&(1<<a.extra)-1,B>>>=a.extra,Z-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=Ft;case Ft:for(;Ut=a.distcode[B&(1<<a.distbits)-1],Ot=Ut>>>24,Ht=Ut>>>16&255,te=Ut&65535,!(Ot<=Z);){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if((Ht&240)===0){for(Yt=Ot,Te=Ht,De=te;Ut=a.distcode[De+((B&(1<<Yt+Te)-1)>>Yt)],Ot=Ut>>>24,Ht=Ut>>>16&255,te=Ut&65535,!(Yt+Ot<=Z);){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}B>>>=Yt,Z-=Yt,a.back+=Yt}if(B>>>=Ot,Z-=Ot,a.back+=Ot,Ht&64){M.msg="invalid distance code",a.mode=vt;break}a.offset=te,a.extra=Ht&15,a.mode=Tt;case Tt:if(a.extra){for(me=a.extra;Z<me;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}a.offset+=B&(1<<a.extra)-1,B>>>=a.extra,Z-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){M.msg="invalid distance too far back",a.mode=vt;break}a.mode=U;case U:if(w===0)break t;if(ft=dt-w,a.offset>ft){if(ft=a.offset-ft,ft>a.whave&&a.sane){M.msg="invalid distance too far back",a.mode=vt;break}ft>a.wnext?(ft-=a.wnext,It=a.wsize-ft):It=a.wnext-ft,ft>a.length&&(ft=a.length),ie=a.window}else ie=j,It=q-a.offset,ft=a.length;ft>w&&(ft=w),w-=ft,a.length-=ft;do j[q++]=ie[It++];while(--ft);a.length===0&&(a.mode=Nt);break;case P:if(w===0)break t;j[q++]=a.length,w--,a.mode=Nt;break;case Y:if(a.wrap){for(;Z<32;){if(G===0)break t;G--,B|=k[l++]<<Z,Z+=8}if(dt-=w,M.total_out+=dt,a.total+=dt,dt&&(M.adler=a.check=a.flags?o(a.check,j,dt,q-dt):s(a.check,j,dt,q-dt)),dt=w,(a.flags?B:Xt(B))!==a.check){M.msg="incorrect data check",a.mode=vt;break}B=0,Z=0}a.mode=rt;case rt:if(a.wrap&&a.flags){for(;Z<32;){if(G===0)break t;G--,B+=k[l++]<<Z,Z+=8}if(B!==(a.total&4294967295)){M.msg="incorrect length check",a.mode=vt;break}B=0,Z=0}a.mode=Q;case Q:pe=g;break t;case vt:pe=z;break t;case kt:return b;case Lt:default:return C}return M.next_out=q,M.avail_out=w,M.next_in=l,M.avail_in=G,a.hold=B,a.bits=Z,(a.wsize||dt!==M.avail_out&&a.mode<vt&&(a.mode<Y||f!==_))&&be(M,M.output,M.next_out,dt-M.avail_out),wt-=M.avail_in,dt-=M.avail_out,M.total_in+=wt,M.total_out+=dt,a.total+=dt,a.wrap&&dt&&(M.adler=a.check=a.flags?o(a.check,j,dt,M.next_out-dt):s(a.check,j,dt,M.next_out-dt)),M.data_type=a.bits+(a.last?64:0)+(a.mode===ut?128:0)+(a.mode===Bt||a.mode===mt?256:0),(wt===0&&dt===0||f===_)&&pe===c&&(pe=L),pe}function J(M){if(!M||!M.state)return C;var f=M.state;return f.window&&(f.window=null),M.state=null,c}function it(M,f){var a;return!M||!M.state||(a=M.state,(a.wrap&2)===0)?C:(a.head=f,f.done=!1,c)}function yt(M,f){var a=f.length,k,j,l;return!M||!M.state||(k=M.state,k.wrap!==0&&k.mode!==ot)?C:k.mode===ot&&(j=1,j=s(j,f,a,0),j!==k.check)?z:(l=be(M,f,a,a),l?(k.mode=kt,b):(k.havedict=1,c))}i.inflateReset=ee,i.inflateReset2=ge,i.inflateResetKeep=ce,i.inflateInit=oe,i.inflateInit2=de,i.inflate=S,i.inflateEnd=J,i.inflateGetHeader=it,i.inflateSetDictionary=yt,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var n=e("../utils/common"),s=15,o=852,h=592,u=0,d=1,p=2,y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,g,m,C,z,b,L,T){var D=T.bits,N=0,A=0,W=0,X=0,$=0,et=0,at=0,pt=0,tt=0,ot=0,ut,Ct,ct,mt,Rt,xt=null,At=0,qt,Bt=new n.Buf16(s+1),Nt=new n.Buf16(s+1),jt=null,Ft=0,Tt,U,P;for(N=0;N<=s;N++)Bt[N]=0;for(A=0;A<C;A++)Bt[g[m+A]]++;for($=D,X=s;X>=1&&Bt[X]===0;X--);if($>X&&($=X),X===0)return z[b++]=1<<24|64<<16|0,z[b++]=1<<24|64<<16|0,T.bits=1,0;for(W=1;W<X&&Bt[W]===0;W++);for($<W&&($=W),pt=1,N=1;N<=s;N++)if(pt<<=1,pt-=Bt[N],pt<0)return-1;if(pt>0&&(c===u||X!==1))return-1;for(Nt[1]=0,N=1;N<s;N++)Nt[N+1]=Nt[N]+Bt[N];for(A=0;A<C;A++)g[m+A]!==0&&(L[Nt[g[m+A]]++]=A);if(c===u?(xt=jt=L,qt=19):c===d?(xt=y,At-=257,jt=_,Ft-=257,qt=256):(xt=O,jt=x,qt=-1),ot=0,A=0,N=W,Rt=b,et=$,at=0,ct=-1,tt=1<<$,mt=tt-1,c===d&&tt>o||c===p&&tt>h)return 1;for(;;){Tt=N-at,L[A]<qt?(U=0,P=L[A]):L[A]>qt?(U=jt[Ft+L[A]],P=xt[At+L[A]]):(U=96,P=0),ut=1<<N-at,Ct=1<<et,W=Ct;do Ct-=ut,z[Rt+(ot>>at)+Ct]=Tt<<24|U<<16|P|0;while(Ct!==0);for(ut=1<<N-1;ot&ut;)ut>>=1;if(ut!==0?(ot&=ut-1,ot+=ut):ot=0,A++,--Bt[N]===0){if(N===X)break;N=g[m+L[A]]}if(N>$&&(ot&mt)!==ct){for(at===0&&(at=$),Rt+=W,et=N-at,pt=1<<et;et+at<X&&(pt-=Bt[et+at],!(pt<=0));)et++,pt<<=1;if(tt+=1<<et,c===d&&tt>o||c===p&&tt>h)return 1;ct=ot&mt,z[ct]=$<<24|et<<16|Rt-b|0}}return ot!==0&&(z[Rt+ot]=N-at<<24|64<<16|0),T.bits=$,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var n=e("../utils/common"),s=4,o=0,h=1,u=2;function d(S){for(var J=S.length;--J>=0;)S[J]=0}var p=0,y=1,_=2,O=3,x=258,c=29,g=256,m=g+1+c,C=30,z=19,b=2*m+1,L=15,T=16,D=7,N=256,A=16,W=17,X=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],et=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=512,ot=new Array((m+2)*2);d(ot);var ut=new Array(C*2);d(ut);var Ct=new Array(tt);d(Ct);var ct=new Array(x-O+1);d(ct);var mt=new Array(c);d(mt);var Rt=new Array(C);d(Rt);function xt(S,J,it,yt,M){this.static_tree=S,this.extra_bits=J,this.extra_base=it,this.elems=yt,this.max_length=M,this.has_stree=S&&S.length}var At,qt,Bt;function Nt(S,J){this.dyn_tree=S,this.max_code=0,this.stat_desc=J}function jt(S){return S<256?Ct[S]:Ct[256+(S>>>7)]}function Ft(S,J){S.pending_buf[S.pending++]=J&255,S.pending_buf[S.pending++]=J>>>8&255}function Tt(S,J,it){S.bi_valid>T-it?(S.bi_buf|=J<<S.bi_valid&65535,Ft(S,S.bi_buf),S.bi_buf=J>>T-S.bi_valid,S.bi_valid+=it-T):(S.bi_buf|=J<<S.bi_valid&65535,S.bi_valid+=it)}function U(S,J,it){Tt(S,it[J*2],it[J*2+1])}function P(S,J){var it=0;do it|=S&1,S>>>=1,it<<=1;while(--J>0);return it>>>1}function Y(S){S.bi_valid===16?(Ft(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):S.bi_valid>=8&&(S.pending_buf[S.pending++]=S.bi_buf&255,S.bi_buf>>=8,S.bi_valid-=8)}function rt(S,J){var it=J.dyn_tree,yt=J.max_code,M=J.stat_desc.static_tree,f=J.stat_desc.has_stree,a=J.stat_desc.extra_bits,k=J.stat_desc.extra_base,j=J.stat_desc.max_length,l,q,G,w,B,Z,wt=0;for(w=0;w<=L;w++)S.bl_count[w]=0;for(it[S.heap[S.heap_max]*2+1]=0,l=S.heap_max+1;l<b;l++)q=S.heap[l],w=it[it[q*2+1]*2+1]+1,w>j&&(w=j,wt++),it[q*2+1]=w,!(q>yt)&&(S.bl_count[w]++,B=0,q>=k&&(B=a[q-k]),Z=it[q*2],S.opt_len+=Z*(w+B),f&&(S.static_len+=Z*(M[q*2+1]+B)));if(wt!==0){do{for(w=j-1;S.bl_count[w]===0;)w--;S.bl_count[w]--,S.bl_count[w+1]+=2,S.bl_count[j]--,wt-=2}while(wt>0);for(w=j;w!==0;w--)for(q=S.bl_count[w];q!==0;)G=S.heap[--l],!(G>yt)&&(it[G*2+1]!==w&&(S.opt_len+=(w-it[G*2+1])*it[G*2],it[G*2+1]=w),q--)}}function Q(S,J,it){var yt=new Array(L+1),M=0,f,a;for(f=1;f<=L;f++)yt[f]=M=M+it[f-1]<<1;for(a=0;a<=J;a++){var k=S[a*2+1];k!==0&&(S[a*2]=P(yt[k]++,k))}}function vt(){var S,J,it,yt,M,f=new Array(L+1);for(it=0,yt=0;yt<c-1;yt++)for(mt[yt]=it,S=0;S<1<<$[yt];S++)ct[it++]=yt;for(ct[it-1]=yt,M=0,yt=0;yt<16;yt++)for(Rt[yt]=M,S=0;S<1<<et[yt];S++)Ct[M++]=yt;for(M>>=7;yt<C;yt++)for(Rt[yt]=M<<7,S=0;S<1<<et[yt]-7;S++)Ct[256+M++]=yt;for(J=0;J<=L;J++)f[J]=0;for(S=0;S<=143;)ot[S*2+1]=8,S++,f[8]++;for(;S<=255;)ot[S*2+1]=9,S++,f[9]++;for(;S<=279;)ot[S*2+1]=7,S++,f[7]++;for(;S<=287;)ot[S*2+1]=8,S++,f[8]++;for(Q(ot,m+1,f),S=0;S<C;S++)ut[S*2+1]=5,ut[S*2]=P(S,5);At=new xt(ot,$,g+1,m,L),qt=new xt(ut,et,0,C,L),Bt=new xt(new Array(0),at,0,z,D)}function kt(S){var J;for(J=0;J<m;J++)S.dyn_ltree[J*2]=0;for(J=0;J<C;J++)S.dyn_dtree[J*2]=0;for(J=0;J<z;J++)S.bl_tree[J*2]=0;S.dyn_ltree[N*2]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function Lt(S){S.bi_valid>8?Ft(S,S.bi_buf):S.bi_valid>0&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function Dt(S,J,it,yt){Lt(S),Ft(S,it),Ft(S,~it),n.arraySet(S.pending_buf,S.window,J,it,S.pending),S.pending+=it}function bt(S,J,it,yt){var M=J*2,f=it*2;return S[M]<S[f]||S[M]===S[f]&&yt[J]<=yt[it]}function Et(S,J,it){for(var yt=S.heap[it],M=it<<1;M<=S.heap_len&&(M<S.heap_len&&bt(J,S.heap[M+1],S.heap[M],S.depth)&&M++,!bt(J,yt,S.heap[M],S.depth));)S.heap[it]=S.heap[M],it=M,M<<=1;S.heap[it]=yt}function _t(S,J,it){var yt,M,f=0,a,k;if(S.last_lit!==0)do yt=S.pending_buf[S.d_buf+f*2]<<8|S.pending_buf[S.d_buf+f*2+1],M=S.pending_buf[S.l_buf+f],f++,yt===0?U(S,M,J):(a=ct[M],U(S,a+g+1,J),k=$[a],k!==0&&(M-=mt[a],Tt(S,M,k)),yt--,a=jt(yt),U(S,a,it),k=et[a],k!==0&&(yt-=Rt[a],Tt(S,yt,k)));while(f<S.last_lit);U(S,N,J)}function Xt(S,J){var it=J.dyn_tree,yt=J.stat_desc.static_tree,M=J.stat_desc.has_stree,f=J.stat_desc.elems,a,k,j=-1,l;for(S.heap_len=0,S.heap_max=b,a=0;a<f;a++)it[a*2]!==0?(S.heap[++S.heap_len]=j=a,S.depth[a]=0):it[a*2+1]=0;for(;S.heap_len<2;)l=S.heap[++S.heap_len]=j<2?++j:0,it[l*2]=1,S.depth[l]=0,S.opt_len--,M&&(S.static_len-=yt[l*2+1]);for(J.max_code=j,a=S.heap_len>>1;a>=1;a--)Et(S,it,a);l=f;do a=S.heap[1],S.heap[1]=S.heap[S.heap_len--],Et(S,it,1),k=S.heap[1],S.heap[--S.heap_max]=a,S.heap[--S.heap_max]=k,it[l*2]=it[a*2]+it[k*2],S.depth[l]=(S.depth[a]>=S.depth[k]?S.depth[a]:S.depth[k])+1,it[a*2+1]=it[k*2+1]=l,S.heap[1]=l++,Et(S,it,1);while(S.heap_len>=2);S.heap[--S.heap_max]=S.heap[1],rt(S,J),Q(it,j,S.bl_count)}function se(S,J,it){var yt,M=-1,f,a=J[1],k=0,j=7,l=4;for(a===0&&(j=138,l=3),J[(it+1)*2+1]=65535,yt=0;yt<=it;yt++)f=a,a=J[(yt+1)*2+1],!(++k<j&&f===a)&&(k<l?S.bl_tree[f*2]+=k:f!==0?(f!==M&&S.bl_tree[f*2]++,S.bl_tree[A*2]++):k<=10?S.bl_tree[W*2]++:S.bl_tree[X*2]++,k=0,M=f,a===0?(j=138,l=3):f===a?(j=6,l=3):(j=7,l=4))}function ce(S,J,it){var yt,M=-1,f,a=J[1],k=0,j=7,l=4;for(a===0&&(j=138,l=3),yt=0;yt<=it;yt++)if(f=a,a=J[(yt+1)*2+1],!(++k<j&&f===a)){if(k<l)do U(S,f,S.bl_tree);while(--k!==0);else f!==0?(f!==M&&(U(S,f,S.bl_tree),k--),U(S,A,S.bl_tree),Tt(S,k-3,2)):k<=10?(U(S,W,S.bl_tree),Tt(S,k-3,3)):(U(S,X,S.bl_tree),Tt(S,k-11,7));k=0,M=f,a===0?(j=138,l=3):f===a?(j=6,l=3):(j=7,l=4)}}function ee(S){var J;for(se(S,S.dyn_ltree,S.l_desc.max_code),se(S,S.dyn_dtree,S.d_desc.max_code),Xt(S,S.bl_desc),J=z-1;J>=3&&S.bl_tree[pt[J]*2+1]===0;J--);return S.opt_len+=3*(J+1)+5+5+4,J}function ge(S,J,it,yt){var M;for(Tt(S,J-257,5),Tt(S,it-1,5),Tt(S,yt-4,4),M=0;M<yt;M++)Tt(S,S.bl_tree[pt[M]*2+1],3);ce(S,S.dyn_ltree,J-1),ce(S,S.dyn_dtree,it-1)}function de(S){var J=4093624447,it;for(it=0;it<=31;it++,J>>>=1)if(J&1&&S.dyn_ltree[it*2]!==0)return o;if(S.dyn_ltree[18]!==0||S.dyn_ltree[20]!==0||S.dyn_ltree[26]!==0)return h;for(it=32;it<g;it++)if(S.dyn_ltree[it*2]!==0)return h;return o}var oe=!1;function fe(S){oe||(vt(),oe=!0),S.l_desc=new Nt(S.dyn_ltree,At),S.d_desc=new Nt(S.dyn_dtree,qt),S.bl_desc=new Nt(S.bl_tree,Bt),S.bi_buf=0,S.bi_valid=0,kt(S)}function ue(S,J,it,yt){Tt(S,(p<<1)+(yt?1:0),3),Dt(S,J,it)}function Kt(S){Tt(S,y<<1,3),U(S,N,ot),Y(S)}function ae(S,J,it,yt){var M,f,a=0;S.level>0?(S.strm.data_type===u&&(S.strm.data_type=de(S)),Xt(S,S.l_desc),Xt(S,S.d_desc),a=ee(S),M=S.opt_len+3+7>>>3,f=S.static_len+3+7>>>3,f<=M&&(M=f)):M=f=it+5,it+4<=M&&J!==-1?ue(S,J,it,yt):S.strategy===s||f===M?(Tt(S,(y<<1)+(yt?1:0),3),_t(S,ot,ut)):(Tt(S,(_<<1)+(yt?1:0),3),ge(S,S.l_desc.max_code+1,S.d_desc.max_code+1,a+1),_t(S,S.dyn_ltree,S.dyn_dtree)),kt(S),yt&&Lt(S)}function be(S,J,it){return S.pending_buf[S.d_buf+S.last_lit*2]=J>>>8&255,S.pending_buf[S.d_buf+S.last_lit*2+1]=J&255,S.pending_buf[S.l_buf+S.last_lit]=it&255,S.last_lit++,J===0?S.dyn_ltree[it*2]++:(S.matches++,J--,S.dyn_ltree[(ct[it]+g+1)*2]++,S.dyn_dtree[jt(J)*2]++),S.last_lit===S.lit_bufsize-1}i._tr_init=fe,i._tr_stored_block=ue,i._tr_flush_block=ae,i._tr_tally=be,i._tr_align=Kt},{"../utils/common":41}],53:[function(e,r,i){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=n},{}],54:[function(e,r,i){(function(n){(function(s,o){if(s.setImmediate)return;var h=1,u={},d=!1,p=s.document,y;function _(D){typeof D!="function"&&(D=new Function(""+D));for(var N=new Array(arguments.length-1),A=0;A<N.length;A++)N[A]=arguments[A+1];var W={callback:D,args:N};return u[h]=W,y(h),h++}function O(D){delete u[D]}function x(D){var N=D.callback,A=D.args;switch(A.length){case 0:N();break;case 1:N(A[0]);break;case 2:N(A[0],A[1]);break;case 3:N(A[0],A[1],A[2]);break;default:N.apply(o,A);break}}function c(D){if(d)setTimeout(c,0,D);else{var N=u[D];if(N){d=!0;try{x(N)}finally{O(D),d=!1}}}}function g(){y=function(D){process.nextTick(function(){c(D)})}}function m(){if(s.postMessage&&!s.importScripts){var D=!0,N=s.onmessage;return s.onmessage=function(){D=!1},s.postMessage("","*"),s.onmessage=N,D}}function C(){var D="setImmediate$"+Math.random()+"$",N=function(A){A.source===s&&typeof A.data=="string"&&A.data.indexOf(D)===0&&c(+A.data.slice(D.length))};s.addEventListener?s.addEventListener("message",N,!1):s.attachEvent("onmessage",N),y=function(A){s.postMessage(D+A,"*")}}function z(){var D=new MessageChannel;D.port1.onmessage=function(N){var A=N.data;c(A)},y=function(N){D.port2.postMessage(N)}}function b(){var D=p.documentElement;y=function(N){var A=p.createElement("script");A.onreadystatechange=function(){c(N),A.onreadystatechange=null,D.removeChild(A),A=null},D.appendChild(A)}}function L(){y=function(D){setTimeout(c,0,D)}}var T=Object.getPrototypeOf&&Object.getPrototypeOf(s);T=T&&T.setTimeout?T:s,{}.toString.call(s.process)==="[object process]"?g():m()?C():s.MessageChannel?z():p&&"onreadystatechange"in p.createElement("script")?b():L(),T.setImmediate=_,T.clearImmediate=O})(typeof self>"u"?typeof n>"u"?this:n:self)}).call(this,typeof we<"u"?we:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Cn)),Cn.exports}var Oo=Ro();const Lo=Ze(Oo);class Ao{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new Lo}catch{throw new Error("JSZip lib not loaded")}}open(t,e){return this.zip.loadAsync(t,{base64:e})}openUrl(t,e){return tr(t,"binary").then((function(r){return this.zip.loadAsync(r,{base64:e})}).bind(this))}request(t,e){var r=new Pt,i,n=new Oe(t);return e||(e=n.extension),e=="blob"?i=this.getBlob(t):i=this.getText(t),i?i.then((function(s){let o=this.handleResponse(s,e);r.resolve(o)}).bind(this)):r.reject({message:"File not found in the epub: "+t,stack:new Error().stack}),r.promise}handleResponse(t,e){var r;return e=="json"?r=JSON.parse(t):Qe(e)?r=Ce(t,"text/xml"):e=="xhtml"?r=Ce(t,"application/xhtml+xml"):e=="html"||e=="htm"?r=Ce(t,"text/html"):r=t,r}getBlob(t,e){var r=window.decodeURIComponent(t.substr(1)),i=this.zip.file(r);if(i)return e=e||Ve.lookup(i.name),i.async("uint8array").then(function(n){return new Blob([n],{type:e})})}getText(t,e){var r=window.decodeURIComponent(t.substr(1)),i=this.zip.file(r);if(i)return i.async("string").then(function(n){return n})}getBase64(t,e){var r=window.decodeURIComponent(t.substr(1)),i=this.zip.file(r);if(i)return e=e||Ve.lookup(i.name),i.async("base64").then(function(n){return"data:"+e+";base64,"+n})}createUrl(t,e){var r=new Pt,i=window.URL||window.webkitURL||window.mozURL,n,s,o=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(o?(s=this.getBase64(t),s&&s.then((function(h){this.urlCache[t]=h,r.resolve(h)}).bind(this))):(s=this.getBlob(t),s&&s.then((function(h){n=i.createObjectURL(h),this.urlCache[t]=n,r.resolve(n)}).bind(this))),s||r.reject({message:"File not found in the epub: "+t,stack:new Error().stack}),r.promise)}revokeUrl(t){var e=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[t];r&&e.revokeObjectURL(r)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let e in this.urlCache)t.revokeObjectURL(e);this.zip=void 0,this.urlCache={}}}class Qn{constructor(t,e,r){this.urlCache={},this.storage=void 0,this.name=t,this.requester=e||tr,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let t;typeof Zt>"u"&&(t=Zt),this.storage=t.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(t){let e=navigator.onLine;this.online=e,e?this.emit("online",this):this.emit("offline",this)}add(t,e){let r=t.resources.map(i=>{let{href:n}=i,s=this.resolver(n),o=window.encodeURIComponent(s);return this.storage.getItem(o).then(h=>!h||e?this.requester(s,"binary").then(u=>this.storage.setItem(o,u)):h)});return Promise.all(r)}put(t,e,r){let i=window.encodeURIComponent(t);return this.storage.getItem(i).then(n=>n||this.requester(t,"binary",e,r).then(s=>this.storage.setItem(i,s)))}request(t,e,r,i){return this.online?this.requester(t,e,r,i).then(n=>(this.put(t),n)):this.retrieve(t,e)}retrieve(t,e){new Pt;var r,i=new Oe(t);return e||(e=i.extension),e=="blob"?r=this.getBlob(t):r=this.getText(t),r.then(n=>{var s=new Pt,o;return n?(o=this.handleResponse(n,e),s.resolve(o)):s.reject({message:"File not found in storage: "+t,stack:new Error().stack}),s.promise})}handleResponse(t,e){var r;return e=="json"?r=JSON.parse(t):Qe(e)?r=Ce(t,"text/xml"):e=="xhtml"?r=Ce(t,"application/xhtml+xml"):e=="html"||e=="htm"?r=Ce(t,"text/html"):r=t,r}getBlob(t,e){let r=window.encodeURIComponent(t);return this.storage.getItem(r).then(function(i){if(i)return e=e||Ve.lookup(t),new Blob([i],{type:e})})}getText(t,e){let r=window.encodeURIComponent(t);return e=e||Ve.lookup(t),this.storage.getItem(r).then(function(i){var n=new Pt,s=new FileReader,o;if(i)return o=new Blob([i],{type:e}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsText(o,e),n.promise})}getBase64(t,e){let r=window.encodeURIComponent(t);return e=e||Ve.lookup(t),this.storage.getItem(r).then(i=>{var n=new Pt,s=new FileReader,o;if(i)return o=new Blob([i],{type:e}),s.addEventListener("loadend",()=>{n.resolve(s.result)}),s.readAsDataURL(o,e),n.promise})}createUrl(t,e){var r=new Pt,i=window.URL||window.webkitURL||window.mozURL,n,s,o=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(o?(s=this.getBase64(t),s&&s.then((function(h){this.urlCache[t]=h,r.resolve(h)}).bind(this))):(s=this.getBlob(t),s&&s.then((function(h){n=i.createObjectURL(h),this.urlCache[t]=n,r.resolve(n)}).bind(this))),s||r.reject({message:"File not found in storage: "+t,stack:new Error().stack}),r.promise)}revokeUrl(t){var e=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[t];r&&e.revokeObjectURL(r)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let e in this.urlCache)t.revokeObjectURL(e);this.urlCache={},this.removeListeners()}}Ne(Qn.prototype);class ei{constructor(t){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",t&&this.parse(t)}parse(t){if(!t)return this;const e=Gt(t,"display_options");return e?(Re(e,"option").forEach(r=>{let i="";switch(r.childNodes.length&&(i=r.childNodes[0].nodeValue),r.attributes.name.value){case"interactive":this.interactive=i;break;case"fixed-layout":this.fixedLayout=i;break;case"open-to-spread":this.openToSpread=i;break;case"orientation-lock":this.orientationLock=i;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const Tn="META-INF/container.xml",zo="META-INF/com.apple.ibooks.display-options.xml",Ee={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class mi{constructor(t,e){typeof e>"u"&&typeof t!="string"&&!(t instanceof Blob)&&!(t instanceof ArrayBuffer)&&(e=t,t=void 0),this.settings=he(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),he(this.settings,e),this.opening=new Pt,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Pt,spine:new Pt,metadata:new Pt,cover:new Pt,navigation:new Pt,pageList:new Pt,resources:new Pt,displayOptions:new Pt},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||tr,this.spine=new Ys,this.locations=new Vn(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),t&&this.open(t,this.settings.openAs).catch(r=>{var i=new Error("Cannot load book at "+t);this.emit(gt.BOOK.OPEN_FAILED,i)})}open(t,e){var r,i=e||this.determineType(t);return i===Ee.BINARY?(this.archived=!0,this.url=new ke("/",""),r=this.openEpub(t)):i===Ee.BASE64?(this.archived=!0,this.url=new ke("/",""),r=this.openEpub(t,i)):i===Ee.EPUB?(this.archived=!0,this.url=new ke("/",""),r=this.request(t,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==Ee.OPF?(this.url=new ke(t),r=this.openPackaging(this.url.Path.toString())):i==Ee.MANIFEST?(this.url=new ke(t),r=this.openManifest(this.url.Path.toString())):(this.url=new ke(t),r=this.openContainer(Tn).then(this.openPackaging.bind(this))),r}openEpub(t,e){return this.unarchive(t,e||this.settings.encoding).then(()=>this.openContainer(Tn)).then(r=>this.openPackaging(r))}openContainer(t){return this.load(t).then(e=>(this.container=new $s(e),this.resolve(this.container.packagePath)))}openPackaging(t){return this.path=new Oe(t),this.load(t).then(e=>(this.packaging=new on(e),this.unpack(this.packaging)))}openManifest(t){return this.path=new Oe(t),this.load(t).then(e=>(this.packaging=new on,this.packaging.load(e),this.unpack(this.packaging)))}load(t){var e=this.resolve(t);return this.archived?this.archive.request(e):this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(t,e){if(t){var r=t,i=t.indexOf("://")>-1;return i?t:(this.path&&(r=this.path.resolve(t)),e!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(t){var e=t;return t?(this.settings.canonical?e=this.settings.canonical(t):e=this.resolve(t,!0),e):""}determineType(t){var e,r,i;if(this.settings.encoding==="base64")return Ee.BASE64;if(typeof t!="string")return Ee.BINARY;if(e=new ke(t),r=e.path(),i=r.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return Ee.DIRECTORY;if(i==="epub")return Ee.EPUB;if(i==="opf")return Ee.OPF;if(i==="json")return Ee.MANIFEST}unpack(t){this.package=t,this.packaging.metadata.layout===""?this.load(this.url.resolve(zo)).then(e=>{this.displayOptions=new ei(e),this.loading.displayOptions.resolve(this.displayOptions)}).catch(e=>{this.displayOptions=new ei,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new ei,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new to(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(e=>{console.error(e)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(t){let e=t.navPath||t.ncxPath,r=t.toc;return r?new Promise((i,n)=>{this.navigation=new Pr(r),t.pageList&&(this.pageList=new Mr(t.pageList)),i(this.navigation)}):e?this.load(e,"xml").then(i=>(this.navigation=new Pr(i),this.pageList=new Mr(i),this.navigation)):new Promise((i,n)=>{this.navigation=new Pr,this.pageList=new Mr,i(this.navigation)})}section(t){return this.spine.get(t)}renderTo(t,e){return this.rendition=new gi(this,e),this.rendition.attachTo(t),this.rendition}setRequestCredentials(t){this.settings.requestCredentials=t}setRequestHeaders(t){this.settings.requestHeaders=t}unarchive(t,e){return this.archive=new Ao,this.archive.open(t,e)}store(t){let e=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,i=this.settings.requestMethod||tr.bind(this);return this.storage=new Qn(t,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(s,o)=>{o.output=this.resources.substitute(s,o.url)};this.resources.settings.replacements=e||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new ke("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((t,e)=>{e.output=this.resources.substitute(t,e.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(t){var e=new Mt(t),r=this.spine.get(e.spinePos),i=this.load.bind(this);return r?r.load(i).then(function(n){var s=e.toRange(r.document);return s}):new Promise((n,s)=>{s("CFI could not be found")})}key(t){var e=t||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${yr}:${e}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}Ne(mi.prototype);function ze(v,t){return new mi(v,t)}ze.VERSION=yr;typeof global<"u"&&(global.EPUBJS_VERSION=yr);ze.Book=mi;ze.Rendition=gi;ze.Contents=fi;ze.CFI=Mt;ze.utils=qs;const le=[];for(let v=0;v<256;++v)le.push((v+256).toString(16).slice(1));function Do(v,t=0){return(le[v[t+0]]+le[v[t+1]]+le[v[t+2]]+le[v[t+3]]+"-"+le[v[t+4]]+le[v[t+5]]+"-"+le[v[t+6]]+le[v[t+7]]+"-"+le[v[t+8]]+le[v[t+9]]+"-"+le[v[t+10]]+le[v[t+11]]+le[v[t+12]]+le[v[t+13]]+le[v[t+14]]+le[v[t+15]]).toLowerCase()}let ri;const Bo=new Uint8Array(16);function Uo(){if(!ri){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ri=crypto.getRandomValues.bind(crypto)}return ri(Bo)}const Po=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),In={randomUUID:Po};function sr(v,t,e){var r;if(In.randomUUID&&!v)return In.randomUUID();v=v||{};const i=v.random??((r=v.rng)==null?void 0:r.call(v))??Uo();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Do(i)}Zt.config({name:"NeatReader",storeName:"ebookStore",description:"Neat Reader"});const jo=ls("ebook",()=>{const v=Ue([]),t=Ue([]),e=Ue(null),r=Ue(null),i=Ue({storage:{default:"local",localPath:"",autoSync:!0,syncInterval:15,baidupan:{accessToken:"",refreshToken:"",expiration:0,rootPath:"",userId:"",namingStrategy:"1"}},reader:{fontSize:18,fontFamily:"system",theme:"light",pageMode:"page",brightness:100,lineSpacing:1.5,lineHeight:1.5,paragraphSpacing:8,autoSaveInterval:10},ui:{viewMode:"grid",language:"zh-CN"}}),n=Ue({id:"device-1",name:"",type:"desktop",platform:"windows",lastSync:Date.now()}),s=Ye(()=>v.value.filter(U=>U.storageType==="local")),o=Ye(()=>v.value.filter(U=>U.storageType==="baidupan")),h=Ye(()=>[...v.value].sort((U,P)=>P.lastRead-U.lastRead).slice(0,10)),u=Ye(()=>U=>v.value.filter(P=>P.categoryId===U)),d=Ye(()=>U=>t.value.find(P=>P.id===U)||null),p=U=>new Promise(async(P,Y)=>{try{const rt=await(await fetch(U)).blob(),Q=new FileReader;Q.onloadend=()=>P(Q.result),Q.onerror=Y,Q.readAsDataURL(rt)}catch(rt){Y(rt)}}),y=async()=>{try{console.log("...");const U=await Zt.getItem("books");U?(console.log(":",U.length),v.value=U,await Promise.all(v.value.map(async P=>{if(P.cover&&P.cover.startsWith("blob:")&&(console.log(" blob :",P.id),P.cover=""),P.format==="epub"&&!P.cover)try{console.log(":",P.id);const Y=await Zt.getItem(`ebook_content_${P.id}`);if(Y){const rt=ze(Y);await new Promise((vt,kt)=>{rt.ready.then(vt).catch(kt)});const Q=await rt.coverUrl();if(Q)if(Q.startsWith("blob:"))try{console.log(" Base64"),P.cover=await p(Q),console.log(":",P.id),URL.revokeObjectURL(Q)}catch(vt){console.warn(" Base64 :",vt)}else P.cover=Q,console.log(":",P.id)}}catch(Y){console.warn(":",P.id,Y)}})),v.value.length>0&&console.log(":",{id:v.value[0].id,title:v.value[0].title,author:v.value[0].author,cover:v.value[0].cover,storageType:v.value[0].storageType})):(console.log(""),v.value=[])}catch(U){console.error(":",U),U instanceof Error&&(console.error(":",U.message),console.error(":",U.stack)),v.value=[]}},_=async()=>{try{const U=v.value.map(P=>({id:P.id,title:P.title,author:P.author,cover:P.cover||"",path:P.path,format:P.format,size:P.size,lastRead:P.lastRead,totalChapters:P.totalChapters,readingProgress:P.readingProgress,storageType:P.storageType,baidupanPath:P.baidupanPath,categoryId:P.categoryId,addedAt:P.addedAt}));console.log(":",U.length),await Zt.setItem("books",U),console.log("")}catch(U){console.error(":",U),U instanceof Error&&(console.error(":",U.message),console.error(":",U.stack))}},O=async()=>{try{console.log("...");const U=await Zt.getItem("categories");if(U&&Array.isArray(U)&&U.length>0)console.log(":",U.length),t.value=U.map(P=>({id:P.id||`category_${Date.now()}_${Math.random()}`,name:P.name||"",color:P.color||"#999999",bookIds:Array.isArray(P.bookIds)?[...P.bookIds]:[],createdAt:P.createdAt||Date.now(),updatedAt:P.updatedAt||Date.now()}));else{console.log(""),t.value=[];const P={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};t.value.push(P),await Zt.setItem("categories",[P]),console.log("")}}catch(U){console.error(":",U),t.value=[];const P={id:`category_default_${Date.now()}`,name:"",color:"#999999",bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};t.value.push(P);try{await Zt.setItem("categories",[P])}catch(Y){console.error(":",Y)}}},x=async()=>{try{console.log(":",t.value.length),console.log(":",JSON.stringify(t.value));const U=t.value.map(Y=>({id:Y.id,name:Y.name,color:Y.color,bookIds:Array.isArray(Y.bookIds)?[...Y.bookIds]:[],createdAt:Y.createdAt,updatedAt:Y.updatedAt}));console.log(":",JSON.stringify(U)),await Zt.setItem("categories",U);const P=await Zt.getItem("categories");console.log(":",P),P&&Array.isArray(P)&&P.length===U.length?console.log(""):console.error("")}catch(U){throw console.error(":",U),U instanceof Error&&(console.error(":",U.message),console.error(":",U.stack)),U}},c=async(U,P)=>{try{console.log(":",U,P);const Y={id:`category_${sr()}`,name:U,color:P,bookIds:[],createdAt:Date.now(),updatedAt:Date.now()};return console.log(":",Y),t.value.push(Y),console.log(":",t.value.length),console.log("..."),await x(),console.log(":",Y.name),Y}catch(Y){throw console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),Y}},g=async(U,P)=>{try{const Y=t.value.findIndex(rt=>rt.id===U);return Y!==-1?(t.value[Y]={...t.value[Y],...P,updatedAt:Date.now()},await x(),console.log(":",t.value[Y].name),!0):!1}catch(Y){return console.error(":",Y),!1}},m=async U=>{try{const P=t.value.findIndex(Y=>Y.id===U);if(P!==-1){const Y=t.value[P].name,rt=t.value.find(Q=>Q.name==="");if(rt){for(const Q of t.value[P].bookIds){const vt=v.value.findIndex(kt=>kt.id===Q);vt!==-1&&(v.value[vt].categoryId=rt.id)}await _()}return t.value.splice(P,1),await x(),console.log(":",Y),!0}return!1}catch(P){return console.error(":",P),!1}},C=async(U,P)=>{try{const Y=v.value.findIndex(rt=>rt.id===U);if(Y!==-1){if(v.value[Y].categoryId){const Q=t.value.findIndex(vt=>vt.id===v.value[Y].categoryId);Q!==-1&&(t.value[Q].bookIds=t.value[Q].bookIds.filter(vt=>vt!==U),t.value[Q].updatedAt=Date.now())}v.value[Y].categoryId=P;const rt=t.value.findIndex(Q=>Q.id===P);return rt!==-1&&!t.value[rt].bookIds.includes(U)&&(t.value[rt].bookIds.push(U),t.value[rt].updatedAt=Date.now()),await _(),await x(),console.log(":",U,"->",P),!0}return!1}catch(Y){return console.error(":",Y),!1}},z=async U=>{try{const P=v.value.findIndex(Y=>Y.id===U);if(P!==-1&&v.value[P].categoryId){const Y=v.value[P].categoryId,rt=t.value.findIndex(Q=>Q.id===Y);return rt!==-1&&(t.value[rt].bookIds=t.value[rt].bookIds.filter(Q=>Q!==U),t.value[rt].updatedAt=Date.now()),v.value[P].categoryId=void 0,await _(),await x(),console.log(":",U),!0}return!1}catch(P){return console.error(":",P),!1}},b=async U=>{var P;try{console.log(":",U);const Y=v.value.filter(Q=>Q.title.toLowerCase().includes(U.toLowerCase())||Q.author.toLowerCase().includes(U.toLowerCase()));console.log(":",Y.length);const rt=await Ct();if(console.log(":",rt),rt){const{accessToken:Q,rootPath:vt}=i.value.storage.baidupan,kt=`${tt.apiUrl}/search`,Lt=vt||`/apps/${pt}`,Dt=`${kt}?access_token=${Q}&key=${encodeURIComponent(U)}&dir=${encodeURIComponent(Lt)}&recursion=1`;console.log("URL:",Dt),console.log(":",Lt);try{const bt=await fetch(Dt,{method:"GET",headers:{"Content-Type":"application/json"}});if(bt.ok){const Et=await bt.json();if(console.log(":",Et),Et.list&&Array.isArray(Et.list)&&Et.list.length>0)for(const _t of Et.list){if(!_t.server_filename)continue;const Xt=(P=_t.server_filename.split(".").pop())==null?void 0:P.toLowerCase();if(["epub","pdf","txt"].includes(Xt||"")&&!v.value.find(se=>se.baidupanPath===_t.path)){const se={id:`baidupan_${_t.fs_id||Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:_t.server_filename.replace(`.${Xt}`,""),author:"",cover:"",path:_t.path||"",format:Xt||"txt",size:_t.size||0,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"baidupan",baidupanPath:_t.path||"",addedAt:Date.now()};Y.push(se),console.log(":",se.title)}}else console.log("")}else console.warn("API:",bt.status)}catch(bt){console.warn(":",bt)}}else console.log("");return console.log(":",Y.length),Y}catch(Y){return console.error(":",Y),[]}},L=async U=>{try{console.log(":",U.title),v.value.push(U),await _(),console.log("")}catch(P){throw console.error(":",P),P instanceof Error&&(console.error(":",P.message),console.error(":",P.stack)),P}},T=async(U,P)=>{const Y=v.value.findIndex(rt=>rt.id===U);Y!==-1&&(v.value[Y]={...v.value[Y],...P},await _())},D=async(U,P)=>{try{const Y=v.value.findIndex(Q=>Q.id===U);if(Y===-1)return!1;const rt=P||v.value[Y].storageType;return v.value.splice(Y,1),_(),rt==="local"&&(Zt.removeItem(`ebook_content_${U}`),Zt.removeItem(`ebook_cover_${U}`)),console.log(""),!0}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),!1}},N=U=>v.value.find(P=>P.id===U)||null,A=U=>{e.value=U},W=async U=>{try{const P=await Zt.getItem(`progress_${U}`);return r.value=P||null,P}catch(P){return console.error(":",P),null}},X=async U=>{try{r.value=U,await Zt.setItem(`progress_${U.ebookId}`,U),await T(U.ebookId,{lastRead:U.timestamp,readingProgress:Math.round(U.position*100)})}catch(P){console.error(":",P)}},$=async()=>{try{const U=await Zt.getItem("userConfig");U&&(U.storage.baidupan.rootPath==="/NeatReader"&&(U.storage.baidupan.rootPath=""),i.value=U)}catch(U){console.error(":",U)}},et=async()=>{try{const U=JSON.parse(JSON.stringify(i.value));await Zt.setItem("userConfig",U)}catch(U){console.error(":",U)}},at=async U=>{i.value={...i.value,...U},await et()},pt="Neat Reader",tt={clientId:"WreV7F9LXSzyYOQzzP7Ih1UmvuDxN763",clientSecret:"hNAobFVEevG7kseZry9xq3LM6jxoWSLz",redirectUri:"http://localhost:8080/callback",apiUrl:"http://localhost:3001/api/baidu/pan",oauthUrl:"http://localhost:3001/api/baidu/oauth"},ot=async()=>{try{const{refreshToken:U}=i.value.storage.baidupan;if(!U)return!1;const P=new URLSearchParams({client_id:tt.clientId,client_secret:tt.clientSecret,grant_type:"refresh_token",refresh_token:U}),Y=`${tt.oauthUrl}/token?${P.toString()}`;console.log("URL:",Y);const rt=await fetch(Y,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log(":",rt.status,rt.statusText),!rt.ok){const vt=await rt.text();return console.error(":",rt.status,":",vt),!1}const Q=await rt.json();return console.log(":",{access_token:Q.access_token?"***":null,refresh_token:Q.refresh_token?"***":null,expires_in:Q.expires_in}),Q.error_code?(console.error(" API :",Q.error_code,Q.error_msg),!1):Q.access_token?(await at({storage:{...i.value.storage,baidupan:{...i.value.storage.baidupan,accessToken:Q.access_token,refreshToken:Q.refresh_token,expiration:Date.now()+Q.expires_in*1e3}}}),!0):!1}catch(U){return console.error(":",U),U instanceof Error&&(console.error(":",U.message),console.error(":",U.stack)),!1}},ut=()=>{const{accessToken:U,expiration:P}=i.value.storage.baidupan;return!!U&&P>Date.now()},Ct=async()=>ut()?!0:await ot(),ct=U=>U>4294967296?(console.error(` ${(4294967296/(1024*1024*1024)).toFixed(1)}GB`),!1):!0,mt=async(U,P)=>{try{if(!await Ct()||!ct(U.size))return!1;const{accessToken:Y}=i.value.storage.baidupan,rt=P?P.replace(/^\/+|\/+$/g,""):"";console.log("Go:",U.name,":",rt);const Q=new FormData;Q.append("accessToken",Y),Q.append("path",rt),Q.append("file",U);const vt=`${tt.apiUrl}/upload`;console.log("URL:",vt);const kt=await fetch(vt,{method:"POST",body:Q});if(!kt.ok)return console.error(":",kt.status,await kt.text()),!1;const Lt=await kt.json();return console.log(":",Lt),Lt.success?(console.log(":",Lt.path),!0):(console.error("errno:",Lt.errno),!1)}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),!1}},Rt=async U=>{try{if(!await Ct())return console.error(""),!1;console.log(" IndexedDB :",`ebook_content_${U.id}`);const P=await Zt.getItem(`ebook_content_${U.id}`);if(!P)return console.error(""),!1;console.log(":",P.byteLength);const Y=`${(vt=>{let kt=vt.replace(/[<>:"|?*\/\\]/g,"").replace(/\s+/g,"_").trim();return kt.length>200&&(kt=kt.substring(0,200)),kt})(U.title)}.${U.format}`,rt=new File([P],Y,{type:`application/${U.format==="epub"?"epub+zip":U.format}`});console.log(" File :",Y);let Q=i.value.storage.baidupan.rootPath;return(!Q||Q==="/")&&(Q=""),console.log(":",Q?`${Q}/${Y}`:Y),await mt(rt,Q)?(console.log(""),await T(U.id,{storageType:"baidupan",baidupanPath:`${Q}/${Y}`,cover:U.cover}),!0):(console.error("uploadToBaidupan  false"),!1)}catch(P){return console.error(":",P),P instanceof Error&&(console.error(":",P.message),console.error(":",P.stack)),!1}},xt=async U=>{try{if(!await Ct())return null;const{accessToken:P}=i.value.storage.baidupan,Y=`${tt.apiUrl}/file?method=download&path=${encodeURIComponent(U)}&fld_list=`;console.log("URL:",Y);const rt=await(await fetch(Y,{method:"GET",headers:{Authorization:`Bearer ${P}`}})).json();if(console.log(":",rt),rt.error_code)return console.error(":",rt),null;const Q=await fetch(rt.download_url);return Q.ok?await Q.blob():(console.error(":",Q.status),null)}catch(P){return console.error(":",P),null}},At=async U=>{try{if(!await Ct())return[];const{accessToken:P}=i.value.storage.baidupan,Y=`${tt.apiUrl}/file?method=list&path=${encodeURIComponent(U)}&web=1&order=name&desc=0`;console.log("URL:",Y);const rt=await(await fetch(Y,{method:"GET",headers:{Authorization:`Bearer ${P}`}})).json();return console.log(":",rt),rt.error_code?(console.error(":",rt),[]):rt.list||[]}catch(P){return console.error(":",P),[]}},qt=async()=>{try{if(!await Ct())return console.error(""),!1;console.log(":",v.value.length);const U={ebooks:v.value,timestamp:Date.now(),deviceId:n.value.id,deviceName:n.value.name},P=new File([JSON.stringify(U)],"books.json",{type:"application/json"});await mt(P,"/sync");const Y={categories:t.value,timestamp:Date.now(),deviceId:n.value.id},rt=new File([JSON.stringify(Y)],"categories.json",{type:"application/json"});await mt(rt,"/sync"),console.log("");let Q=0;const vt=10;for(let kt=0;kt<v.value.length;kt+=vt){const Lt=v.value.slice(kt,kt+vt).map(async Dt=>{try{const bt=await Zt.getItem(`progress_${Dt.id}`);if(bt){const Et=new File([JSON.stringify(bt)],`${Dt.id}.json`,{type:"application/json"});await mt(Et,"/sync/progress"),Q++}}catch(bt){console.error(`: ${Dt.id}`,bt)}});await Promise.all(Lt)}return console.log(` ${Q} `),!0}catch(U){return console.error(":",U),!1}},Bt=U=>{ut()&&(console.log(":",U),(async()=>{try{const P=await Zt.getItem(`progress_${U}`);if(P){const Y=new File([JSON.stringify(P)],`${U}.json`,{type:"application/json"});await mt(Y,"/sync/progress"),console.log(":",U)}}catch(P){console.warn(":",P)}})())},Nt=async()=>{var U;try{if(!await Ct())return console.error(""),!1;console.log("");const P=await xt("/sync/books.json");if(P){const Q=await P.text(),vt=JSON.parse(Q);vt.ebooks&&(v.value=vt.ebooks,await _(),console.log(":",v.value.length))}const Y=await xt("/sync/categories.json");if(Y){const Q=await Y.text(),vt=JSON.parse(Q);vt.categories&&(t.value=vt.categories,await x(),console.log(":",t.value.length))}let rt=0;for(const Q of v.value)try{const vt=await xt(`/sync/progress/${Q.id}.json`);if(vt){const kt=await vt.text(),Lt=JSON.parse(kt);await Zt.setItem(`progress_${Q.id}`,Lt),Q.id===((U=r.value)==null?void 0:U.ebookId)&&(r.value=Lt),rt++}}catch(vt){console.error(`: ${Q.id}`,vt)}return console.log(` ${rt} `),!0}catch(P){return console.error(":",P),!1}},jt=async U=>{try{console.log(" EPUB :",U.name);const P=`epub_${sr()}`,Y=await U.arrayBuffer();console.log(" IndexedDB:",`ebook_content_${P}`),await Zt.setItem(`ebook_content_${P}`,Y);let rt="",Q="",vt=U.name.replace(".epub","");try{const Lt=ze(Y);await new Promise((Et,_t)=>{Lt.ready.then(Et).catch(_t)});const Dt=await Lt.loaded.metadata;console.log("EPUB :",Dt),Dt.creator&&(Array.isArray(Dt.creator)?Q=Dt.creator.join(", "):Q=Dt.creator),Dt.title&&(vt=Dt.title);const bt=await Lt.coverUrl();if(console.log(" URL:",bt),bt)if(typeof bt=="string"&&bt.startsWith("blob:"))try{console.log(" Blob URL  Base64"),rt=await p(bt),console.log("Base64 :",rt.length),URL.revokeObjectURL(bt)}catch(Et){console.warn(" Base64 :",Et),rt=""}else rt=bt}catch(Lt){console.warn(":",Lt)}const kt={id:P,title:vt,author:Q,cover:rt,path:P,format:"epub",size:U.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return console.log(":",{id:kt.id,title:kt.title,author:kt.author,cover:kt.cover,storageType:kt.storageType}),await L(kt),console.log("EPUB "),kt}catch(P){return console.error(" EPUB :",P),P instanceof Error&&(console.error(":",P.message),console.error(":",P.stack)),null}},Ft=async U=>{try{const P=`pdf_${sr()}`,Y=await U.arrayBuffer();await Zt.setItem(`ebook_content_${P}`,Y);const rt={id:P,title:U.name.replace(".pdf",""),author:"",cover:"",path:P,format:"pdf",size:U.size,lastRead:Date.now(),totalChapters:0,readingProgress:0,storageType:"local",addedAt:Date.now()};return await L(rt),rt}catch(P){return console.error(" PDF :",P),null}},Tt=async U=>{try{const P=`txt_${sr()}`,Y=await U.arrayBuffer();await Zt.setItem(`ebook_content_${P}`,Y);const rt={id:P,title:U.name.replace(".txt",""),author:"",cover:"",path:P,format:"txt",size:U.size,lastRead:Date.now(),totalChapters:1,readingProgress:0,storageType:"local",addedAt:Date.now()};return await L(rt),rt}catch(P){return console.error(" TXT :",P),null}};return{books:v,categories:t,currentBook:e,readingProgress:r,userConfig:i,deviceInfo:n,localBooks:s,baidupanBooks:o,recentBooks:h,getBooksByCategory:u,getCategoryById:d,loadBooks:y,saveBooks:_,addBook:L,updateBook:T,removeBook:D,getBookById:N,setCurrentBook:A,loadReadingProgress:W,saveReadingProgress:X,loadUserConfig:$,saveUserConfig:et,updateUserConfig:at,loadCategories:O,saveCategories:x,addCategory:c,updateCategory:g,deleteCategory:m,addBookToCategory:C,removeBookFromCategory:z,searchBooks:b,syncReadingProgress:qt,syncReadingProgressFromBaidupan:Nt,importEpubFile:jt,importPdfFile:Ft,importTxtFile:Tt,importEbookFile:async U=>{var P;try{const Y=(P=U.name.split(".").pop())==null?void 0:P.toLowerCase();if(!Y)throw console.error(""),new Error("");switch(Y){case"epub":return await jt(U);case"pdf":return await Ft(U);case"txt":return await Tt(U);default:throw console.error(":",Y),new Error(`: ${Y}`)}}catch(Y){return console.error(":",Y),Y instanceof Error&&(console.error(":",Y.message),console.error(":",Y.stack)),null}},uploadLocalBookToBaidupan:Rt,downloadFromBaidupan:xt,listBaidupanFiles:At,isBaidupanTokenValid:ut,syncCurrentBookProgress:Bt,initialize:async()=>{await Promise.all([y(),$(),O()])}}});export{ze as B,Zt as Y,Ze as Z,jo as j};
